,Discussion ID,Author,Body,Likes,Date,Time
0,470717,zarnous,"Just a quick note,JOIN -combines data into new columns.UNION -combines data into new rowsSo if i understood your use case correctly , i may do it somehow like the below:dataset = microsoft_dhcp_raw| filter hostName != """" and ipAddress != """"| alter hn1 = split(hostName ,""."")| join (dataset = endpoints ) as EP EP.endpoint_name = hostName| dedup hostName| dedup ipAddressand this shouldn't return any run error , and if a match found by the hostname you should be able to see that in the result pane.I hope this helps.",0,03-05-2022,03:01 PM
1,470717,ESJosephPrinz,"Thank you This helped. I didnt explain why I was using the alter. It is because the hostname field has .domain.name in it and the ""endpoint_name"" fied does not. I was able to complete the script.dataset = microsoft_dhcp_raw| alter hn1 = if (hostname contains "".domain.local"",replace(hostname,"".domain.local"",""""),hostname)| join (dataset = endpoints ) as EP EP.endpoint_name = hn1| dedup hn1| fields hostName ,hn1 ,endpoint_name,ipAddressThis gives me any hostnames that are found in both microsoft_dhcp_raw and endpoints. Hopefully I can figure out how to find the reverse, anything in Microsoft_dhcp_raw that is not in ""endpoints"" as well. I think I went about this all wrong to be honest but at least I learned how to join two fields where one needs to be altered to match. 🙂Thanks again!",0,03-06-2022,08:30 AM
2,470717,zarnous,"you are welcome, glad this at least shed some light.",0,03-06-2022,10:00 AM
3,470717,nigsmi51,"Incase anyone else had the same issue, (needing to Not Match/Outer Join in XQL), here is a way I did it without using Join. This also finishes OP's question, since the below query also shows which devices do NOT have an event, or when they do NOT have software installed:Example for Restart event log NOT happening:dataset = xdr_data // Using the xdr dataset| alter conditional = if(action_evtlog_event_id = 1074,1,0) //if restart event happens, 1 is returned, anything else, then 2 is returned. Restart Event could be replaced with anything| fields agent_hostname as hostname, conditional as restartcount // Selecting the relevant fields| comp sum(restartcount) as totalrestarts by hostname // adds up and summarizes all ""restartcount"" values| filter (totalrestarts = 0) // if 0, that means that the sum of all restart events is 0 (ie. it never restarted)Example for chrome NOT Installed:dataset = xdr_data // Using the xdr dataset| filter event_type = ENUM.PROCESS and event_sub_type = ENUM.PROCESS_START //makes sure we get program logs| alter conditional = if(action_process_image_name ~= ""chrome"",1,0)//filters names that include ""chrome""| fields action_process_image_path as Process_Path, action_process_image_command_line as Process_CMD, action_process_os_pid as Process_PID, actor_process_image_path as Parent_Process, actor_process_command_line as Parent_CMD, agent_hostname as hostname, conditional as runcount // Selecting some relevant fields| comp sum(runcount) as totalruns by hostname //sums total runs by host| filter (totalruns = 0) // like before, change this to > if you want to see the opposite resultsThis shows how you check for machines that never had an event/program occur. You can replace Chrome.exe or the Event ID with anything.",0,07-15-2022,10:34 AM
4,508640,jtalton,"Hello Aiman_Fathima,Blocking files on endpoints is also enforced by the endpoint malware profile. Please ensure that your Malware Security Profile is set to block mode.In Action Center, on the Block list page, you may select Override Report mode to allow the agent to block hashes even if the Malware Profile is set to Report.If all is configured, please open a support case for troubleshooting.ReferenceEndpoint Security Profiles (paloaltonetworks.com)Add a New Malware Security Profile (paloaltonetworks.com)Thanks",1,07-13-2022,01:06 PM
5,508640,Aiman_Fathima,Thank you,0,07-15-2022,01:35 AM
6,508969,tugriceri,"Hi Nathan,FILE_CREATE_NEW is just related with file creation on disk without writing data. Could you check size ofevent_sub_type=FILE_WRITE ?",0,07-15-2022,12:45 AM
7,508591,afurze,"Hi Bojan-Totic,Unfortunately, at this time, Incidents and Alerts are not exposed as a dataset and therefor cannot be queried using XQL. The only available dashboard and report widgets related to these are those that come out-of-the-box. That being said, you can query Incidents and Alerts via the public API so you could import this data into another reporting tool to produce what you are looking for.",0,07-12-2022,12:47 PM
8,508591,Bojan-Totic,Thank you for the reply Afurze! Appreciate it. 🙂,0,07-14-2022,10:26 AM
9,505523,mfakhouri,"Hi @RFeyertag!Thank you for submitting the coverage request regarding DFSCoerce.At this time, our security engineers are working diligently to provide protection and coverage against the DFSCoerce NTLM Relay Attack for the Cortex XDR agent and Cortex XDR server. If you would like to receive direct notifications when advances in this coverage have been deployed or want a more immediate option for inquiries on future attack coverage, we highly recommend contacting our TAC team at https://support.paloaltonetworks.com/. We can update you on the availability of Cortex XDR coverage in the LiveCommunity when it is available, however, that would be best effort and may involve some delay.",0,06-29-2022,06:11 AM
10,505523,mfakhouri,"Hi @RFeyertagWith the release of Content Update 590-96665, a new XQL query has been provided for the DFSCoerce attack:Since the RPC functionality can be normal... this may require further tuning for your environment.The client can see the remote actor under actor_remote_ip , the affected server under agent_id or agent_hostname , and the possible relay server extracted under dfs_relay_server in addition to other fields there that might help triage.This is not guaranteed to be the attack, but will most likely show an unusual usage of DFS which can indicate a possible attack.",0,07-13-2022,11:26 AM
11,488018,jtalton,"HiPalomed,If you have a Cortex Data Lake license, Global Protect logs can be forwarded to the Cortex Data Lake for stitching from your PAN firewall. Please refer to your PAN-OS TechDocs Documentation for how to configure.Thanks",0,06-10-2022,12:03 PM
12,488018,Rodgerjon,"We have several hundred Global Protect users using Auto VPN. It would be nice tosee their global protect logs, ipconfig /all, netstat -rn information before calling themback on a filed ticket. Can Cortex collect these logs on a regular basis withoutuser involvement? What has to be enabled at the GP client and/or PAN toallow this log collection to occur?I am also having the same Issue. Did you get any solution?",0,07-03-2022,09:05 PM
13,488018,jtalton,You may forward Global Protect logs to the Cortex Data Lake for stitching from your PANW firewall. If you need assistance with configuring please open a support case.,0,07-13-2022,11:19 AM
14,508641,bbarmanroy,"Hi@Shashanksinhawhat is the use case that you're trying to achieve? It'd be ideal to get notified if a certain flagged binary is executed on endpoint fleet for action owners to perform appropriate investigation, containment and remedial actions.",0,07-13-2022,02:32 AM
15,508422,tugriceri,"HiCould you check your agent settings profile which is assigned to your endpoints.if Host insight enabled in agent settings profile, You should see your host data in ""Incident Response > Investigation > Host Inventory"".",0,07-11-2022,04:21 AM
16,508422,Guy.Ashkenazi,Thanks Working Well i just check the default for enable.,0,07-12-2022,11:46 PM
17,508548,afurze,"Hi Daniel_Itenberg,The context menu changes depending on the alert you select. If the alert is a Behavioral Threat Protection (BTP) alert, you will have the ""Create Alert Exception"" option under Manage Alert. If the alert is a Local Malware Analysis alert, you will have the ""Add initiator SHA256 to Allow list"" option under Manage Alert. Can you please confirm the source of the alert and the alert name? This will tell us what kind of alert you are trying to create an exception for.",0,07-12-2022,12:55 PM
18,508548,bbarmanroy,The broadsword approach to the solution is to add it to the Global Allow List :https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/investigation-and-respo...,0,07-12-2022,07:03 PM
19,508556,afurze,"Hi Balaraju,The Broker will not allow connection proxies to another tenant, so the easiest way is to allow your agents to connect directly to the internet for the migration. When you issue the Change Management Server action, they will connect directly to the new Cortex XDR tenant, you can then set a new agent policy to tell the agents to connect to a new Broker which is connected to the new tenant. Alternatively, if you have a more generic forward web proxy server, you can leverage that to proxy connections temporarily for the migration.",0,07-12-2022,11:29 AM
20,508333,tugriceri,"Hifor me its not clear why they disabled telemetry data collection or no telemetry data collection. If they enabled XDR Pro, There is telemetry data collection unless they disabled from agent settings > XDR Pro endpoints > Monitor and Collect Enhanced Endpoint data.",0,07-11-2022,05:27 AM
21,508333,Cyber1985,In my opinion you are right. There are more questions then answers about the settings.BRRob,0,07-11-2022,03:00 PM
22,507254,SilviuMihailDasaria-labelcalu,"Hi@Houston29115,Thanks for posting to our Live Community board.",0,06-30-2022,01:13 AM
23,507254,Houston29115,"still seeing the network filter pop up.Does the unified profile contain code to supress this popped? If so, specifically which key pair(s)?I'm using the code within the ""CortexXDR_UnifiedConfigProfile_Intel_V3_SignedPANW.mobileconfig"" from your own company website. If I open the file, then copy paste, it seems to work except for the content filter repeatedly popping up and asking to ""allow"" it. Dont wont to have to rely on my users to make the correct choice...",0,07-06-2022,04:15 PM
24,507254,Houston29115,"ran Beyond Compare text comparison tool to compare the ""Unified"" and ""Content Filter"" code - looks like there is definite overlap. So is the Content Filter code really required? In any case, either using both profiles or just one - scoped to a single test machine - nothing Ive been able to do causes the Content Filter to auto choose ""Allow"" and auto-suppresses its display. Same for the Notifications badge. We don't want users making choices here, thus the need to silent auto install...",0,07-11-2022,02:43 PM
25,508371,Mudhireddy,"Hi Nathan,Using Dynamic end-point groups you canimplicitly define group membership using dynamically evaluated endpoint characteristics such as partial hostnames or aliases, full or partial domain names, IP address ranges or subnets, and agent or operating system versions.The Endpoint Groups page is accessible from Endpoints > Endpoint Management > Endpoint Groups. The page displays all endpoint groups along with the number of endpoints.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/defin...",0,07-09-2022,08:13 AM
26,508371,NathanBradley,"This isn't specific to EndpointsCan I supply a list to any available field that i can filter onExample below: i want to only show 13 separate applications listed. It appears that I have to type one application and then hit the little blue arrow to drop it down, then type another application hit the blue arrow...etc 13 timesCan I just paste in, supply a list of the 13 applications, txt file, something so I don't have to type it in 13 timesMaybe a feature request if not available",0,07-11-2022,08:44 AM
27,507691,bbucao,"Hi@NathanBradley,Using the Cortex XDR Forensics add-on you could enable the collection of services via the Agent Settings Profile, that data can then be queried in XQL using the dataset forensics_services, you could then craft a correlation rule against that dataset to get the outcome you want.Another way would be via the Host Insights add-on you could retrieve a list of services for a given endpoint, but this data is not currently exposed in XQL so you would have to export from the UI and would not be able to build a correlation rule against it.Regards,Ben",0,07-01-2022,12:59 PM
28,507691,NathanBradley,"I can currently query and get a list of services using xqlUsing that query im building a correlation rule to save to a new datasetIm stuck on how to build a new rule to alert when a service has been addedconfig case_sensitive = false | dataset = host_inventory| filter services != null| arrayexpand services| alter Display_Name=json_extract(services, ""$.display_name"")| alter Path_Name=json_extract(services, ""$.path_name"")| alter Service_Name=json_extract(services, ""$.service_name"")| alter UserName=json_extract(services, ""$.start_user_name"")| alter Start_Mode=json_extract(services, ""$.start_mode"")| alter Started=json_extract(services, ""$.started"")| alter State=json_extract(services, ""$.state"")| alter Service_Type=json_extract(services, ""$.service_type"")| alter Accept_Pause=json_extract(services, ""$.accept_pause"")| alter Accept_Stop=json_extract(services, ""$.accept_stop"")| alter Delayed=json_extract(services, ""$.delayed"")| alter Desktop_Interact=json_extract(services, ""$.desktop_interact"")| alter state = replace(replace(replace(replace(replace(replace(replace(state, ""1"", ""Start_Pending""),""2"", ""Stop_Pending""), ""3"", ""Running""), ""4"", ""Continue_Pending""), ""5"", ""Pause_Pending""), ""6"", ""Paused""), ""0"", ""Stopped"")| alter start_mode = replace(replace(replace(replace(replace(start_mode, ""4"", ""Disabled""),""2"", ""Automatic""),""0"", ""Boot""),""1"", ""System,""),""3"", ""Manual"")| fields host_name,Display_Name,Service_Name,Path_Name,UserName,Start_Mode,Started,Service_Type,state,Accept_Pause,Accept_Stop, Delayed, Desktop_Interact| sort asc Display_Name | filter (host_name contains """"""NameofHost"""""")",0,07-08-2022,10:37 AM
29,507596,SilviuMihailDasaria-labelcalu,"Hi@MithunKT,Thanks for posting to our Live Community discussion board. I would recommend creating a dynamic endpoint groups based on the filters instead.Use the filters to define the criteria you want to use to dynamically populate an endpoint group. Dynamic groups support multiple criteria selections and can useANDorORoperators. For endpoint names and aliases, and domains and workgroups, you can use*to match any string of characters. As you apply filters,CortexXDRdisplays any registered endpoint matches to help you validate your filter criteria.Let me know if you have any questions or concerns!Thanks,SIlviu",1,06-30-2022,10:47 PM
30,507596,MithunKT,Thank youSilviu! It worked.,0,07-08-2022,03:44 AM
31,497098,bbarmanroy,"HI@RomainCouvreuryou can create a Correlation Rule and see if that meets your needs. Here's a sample query:Similarly, every new user creation is an event in Windows (event ID 4720). The entire list of event ID's that are captured by XDR is listed here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/custo...You can modify this to suit your needs, and wrap it in a Correlation rule as before:You can consider to run Correlation Rules every 10 mins and look at historical data that have timestamps that are less than 10 mins.Lemme know if that works for you!",1,06-01-2022,06:18 PM
32,497098,RomainCouvreur,"Hello bbarmanroy ,Many thanks for the trick.Please let me time to check it on customer environment and will confirm the result.Thanks again and have a nice day ahead.Best regards",0,06-03-2022,12:09 AM
33,497098,RomainCouvreur,"Hello bbarmanroy ,Customer has not provided us with feedback on this matter and i m not able to test it anymore.So i understand that Correlation Rules did the job and we can give this discussion as closed.Thanks again for your help on this !Very appreciate.Best regards",0,07-06-2022,07:43 AM
34,434071,jcandelaria,"Hi BocolP,Its not in the registry to check whether the agent is flag as vdi. Its on agent_settings.db. You have to use cytool command ""cytool persist print agent_settings.db"" then you will be able to see if the machine is installed as vdi and you will also see the golden image agent id.Your issue is most likely during the publication process where it doesnt take the OS base layer configuration changes of the image. I would suggest once you edit the OS image (install xdr as vdi enabled), save it first then edit again then do whatever task then save it again then publish. You can double check the setting by using the cytool command above to check if it has the right setting. If it has then you can publish again.If its still not taking it, then something is reverting the OS level changes you made during the publication.",0,09-15-2021,09:38 AM
35,434071,BocoIP,"Hi Jcandelaria,Thanks for the info on the settings location. I created a new version of the OS layer, booted that up, and ran cytool persist print agent_settings.db on it. According to the output, it is VDI enabled: true and I can see a Golden image ID as well as a Golden image name. So the OS layer itself is still VDI enabled, as it should be.But when I then start up a standard App layer with that same OS layer (or rather the previous version, but with nothing changed in between it's effectively the same), it is notVDI enabled and no golden image info exists. If I look at the Agent installation time (with cytool persist print agent_settings.db), I can see that the App layer's agent has an installation time of when I created the layer version, which is not the same as the installation time on the OS layer. So it would seem like it's sort of ""reinstalling"" the agent when the OS layer is used elsewhere, and at that point it gets some default settings which do not include VDI enabled settings.I then created a new empty App layer with that OS layer, and in there the agent againis VDI enabled. So it would seem that my App layer breaks this installation somehow. Perhaps there are some Cortex components installed on that layer, maybe as a result of an update or something like that. I will have to try to set up that layer with an OS layer version without Cortex installed, so I can uninstall whatever is on the App layer.Thank you for pointing me in the right direction! I will report back when I have more conclusive info, just in case someone else has this problem further down the line.",1,09-16-2021,03:44 AM
36,434071,jcandelaria,"Hi BocolP,Yes please update the thread so anyone in our live community can use this thread as a future reference if scenario exist.",0,09-16-2021,07:47 AM
37,434071,BocoIP,"It appears I forgot to update the thread with my findings, so here's the same message I recently sent to someone who had the same issue:Yes, we did manage to solve this. The problem seemed to be that we had updates happening in the wrong layer. We had Cortex installed in the OS layer, as per the instructions, but it had then auto-updated itself in another App layer, which then broke the installation, as we now had Cortex installed in two different layers.If you're having similar problems, try isolating the installation so that you only have Cortex installed in the OS layer, and then remove all traces of Cortex from the App layer(s). I think I actually reinstalled my App layers from scratch just to get rid of Cortex (as conventional uninstall did not work, as it was installed in two layers). You could probably also uninstall Cortex from the OS layer in a new version, use that version for the App layer, and then uninstall Cortex from the App layer (as it will then be the only version in use), and then scrap the OS version and use the one with Cortex still installed, with the newest App layer version which now doesn't have its ""own"" Cortex.To keep this from happening in the future, we have now created a policy in XDR Dashboard to not update the App layers, by creating a dynamic group including ""Endpoint NameContains CITRXAL"" and ""Endpoint Name!=*198000"", which effectively picks up all App layers which are not the OS layer (198000). Your numbers might vary, I'm not sure if these are set or dynamic.I hope this will help you get back on track with this. If you have any other questions, I'm happy to help if I can.",0,07-04-2022,03:36 AM
38,507310,SilviuMihailDasaria-labelcalu,"Hi@EJaspe,Thanks for posting to our Live Community board. Can you please log a support ticket with our Customer Support Team to review and assist with your issue?Thanks,Silviu",0,06-30-2022,01:01 AM
39,507310,EJaspe,"Hi Silviu,How to log a ticket to your customer support? May I know their email?Thank you!",0,07-03-2022,03:50 PM
40,507666,SilviuMihailDasaria-labelcalu,"Hi@JamesWiggins,Thanks for posting to our Live Community discussion board. At the moment information about CVE is only available inside the UI (via export function). As an alternative you can create a custom dataset containing the vulnerabilities in the CSV format and be able to map it against other datasets.Let me know if you got any questions or concerns!Thanks,SilviuThanks,Silviu",0,07-01-2022,11:27 AM
41,507666,JamesWiggins,"Thanks for the reply! Can you elaborate on what you mean by ""create a custom dataset""?Are you talking about just using the export function to create a CSV?",0,07-01-2022,12:46 PM
42,507481,SilviuMihailDasaria-labelcalu,"Hi@NathanBradley,Thanks for reaching out to Live Community discussion board.1. Unfortunately there isn't a description available. We are working continuously in providing more insights in the XQL value definitions. This information is coming directly from Microsoft and you can identify the meaning of each value behind here.2. You should be able to leverage the alter function in order to obtain your desired results. More information is available here.e.g| alterstart_mode = replace(replace(replace(start_mode, ""1"", ""Service Manual Start""),""2"", ""Service Manual Stop""), ""3"", ""Service Automated"")Please let me know if you have any questions or concerns!Thanks,Silviu",0,06-30-2022,11:55 AM
43,507481,NathanBradley,"thanks that works for me these are the 2 lines added| alter state = replace(replace(replace(replace(replace(replace(replace(state, ""1"", ""Start_Pending""),""2"", ""Stop_Pending""), ""3"", ""Running""), ""4"", ""Continue_Pending""), ""5"", ""Pause_Pending""), ""6"", ""Paused""), ""0"", ""Stopped"")| alter start_mode = replace(replace(replace(replace(replace(start_mode, ""4"", ""Disabled""),""2"", ""Automatic""),""0"", ""Boot""),""1"", ""System,""),""3"", ""Manual"")",0,07-01-2022,08:32 AM
44,503808,afurze,"Hi JamesWiggins,Unfortunately, Incidents and Alerts are not exposed as a dataset so they cannot be queried using XQL.",0,06-15-2022,12:25 PM
45,503808,DannyMulheran,Hi AfurzeAny idea how do the Palo Alto provided widgets filter on incidents (for example the widgets 'incidents by assignee' or 'incidents by status'?Danny,0,06-27-2022,12:31 AM
46,503808,SilviuMihailDasaria-labelcalu,These widgets are leveraging the built-in functions not currently exposed in the User Interface but via API.,0,06-27-2022,12:40 AM
47,503808,SilviuMihailDasaria-labelcalu,"Hey James,Have you ever thought about retrieving the incidents and alerts and then mapping them in the code to the endpoint groups? In short what I'm saying is that you can easily filter by endpoints directly from your code.",1,06-27-2022,12:46 AM
48,503808,DannyMulheran,,0,06-27-2022,01:00 AM
49,503808,JamesWiggins,"Yes, this is exactly what I ended up doing. I had to pull down all of the incidents for the tenant, and then filter the incidents by host in script with a list of endpoint ID's I had previously retrieved from the get_endpoints API. Thanks for your help!",0,07-01-2022,06:12 AM
50,506621,SilviuMihailDasaria-labelcalu,"Hi,Cloudflare supports sending logs via HTTP so the fastest way will be to setup a HTTP collector on the Cortex XDR tenant. More information available here. Let me know if there is any questions or concerns.Thanks,Silviu",0,06-27-2022,11:36 PM
51,506621,Christian985,"I have the same problem and really know, I do not know what to do I can not find a solution help me.Point Click Care CNA Login",0,06-28-2022,12:33 AM
52,506621,SilviuMihailDasaria-labelcalu,@Christian985- what the issue you are experiencing? have you tried setting up an HTTP collector?,0,06-28-2022,01:56 AM
53,506621,Rodgerjon,"I have the same problem and really know, I do not know what to do I can not find a solution help me.Point Click Care CNA LoginCloudflare provides detailed logs of your HTTP requests. Use these logs to debug, identify configuration adjustments to improve performance and security, and create custom analytics. Combine request logs with other data sources, such as application server logs, for end-to-end visibility.",0,06-30-2022,11:35 PM
54,470251,bbarmanroy,"Hi@brownchrisyour analysis is correct. By default, the query returns 100 results. This is explained in the API description page.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-api/cortex-xdr-apis/incident-manageme...Now as we look further down the page, we notice the details of a successful response. It contains three fields:Assuming you need to retrieve 160 incidents (i.e., more than 100), you'll need to make 2 calls at a minimum. The first call will retrieve the first 100 results, the next one will retrieve the remaining 60 results. This is how the response will look like:First calltotal_count = 160result_count = 100incidents = {[100 incidents]}Second calltotal_count = 160result_count = 60incidents = {[60 incidents]}The way to do that is by modifying the search_from and search_to fields in the request_data parameter in successive calls. This will return the results corresponding to the offsets that you're requesting for.Here is an example for retrieving larger datasets using the get_endpoints API. I have used Python as the scripting language, but you can use any language/script or querying tool that can make POST calls.Here, you can see the total_count value as 113, and the result_count value as 12. The way I am able to retrieve those specific entries is by changing the values of the search_from and search_to fields. As this is an example, I have hard-coded the values. In your case, you should programmatically change the values of the two fields by incrementing the values accordingly using counters and loops.Let us know how it goes.",1,03-03-2022,06:05 PM
55,470251,brownchris,"Thank you@bbarmanroy, really appreciate your response. The challenge I am finding PowerBI doesn't like when I declare the search parameters. I get a bad request error when I attempt to add the ""search_from"" & ""search_to"" parameters.",0,03-08-2022,10:24 AM
56,470251,bbarmanroy,Hi@brownchrisI don't think I see the parameters in the 'body' variable that you have defined.You might want to try wrap 'body' in 'Json.FromValue()' or check in PowerBI forums as this seems to be related to PowerBI and not Cortex XDR APIs.,0,03-08-2022,05:17 PM
57,470251,MichaelEdwards2,"Hi Chris, Did you ever get this resolved?, I am also finding the same challenge. I have tried different combinations for the data search strings and it is not accepting on each.",0,06-21-2022,10:01 AM
58,470251,SilviuMihailDasaria-labelcalu,@MichaelEdwards2 - can you paste the request that are you executing against the API? also what are the errors that are you getting? may I also ask if you have tried these requests with curl and see if they're working before implementing them in PowerBI?,0,06-21-2022,10:14 AM
59,470251,brownchris,"@MichaelEdwards2I did get it to work for endpoints, in my code I used the/get_endpointthat returned the maximum result set size is 100. So I used/get_endpointsinstead. Try that and let me know.I do ran into another problem however, the date fields are coming over as a date, and converting them leads to an error.",0,06-21-2022,10:15 AM
60,470251,MichaelEdwards2,"I dont get any error with the below, it just does not limit the results (.i.e get 100 results, instead of 10)letbody = ""{ """"request_data"""": {}}"",GetJson =Web.Contents(""https://api-mycompany.xdr.eu.paloaltonetworks.com/public_api/v1/incidents/get_incidents/"",[Query = [search_from = ""0"",search_to = ""10""],Headers=[#""Content-Type""=""application/json"",#""x-xdr-auth-id""=""34"",Authorization=""My secret Key""],Content = Text.ToBinary(body)]),FormatAsJson = Json.Document(GetJson),#""Converted to Table"" = Record.ToTable(FormatAsJson),Value = #""Converted to Table""{0}[Value],Incidents = Value[incidents],Result = Table.FromRecords(Incidents),#""Changed Type"" = Table.TransformColumnTypes(Result,{{""creation_time"", Int16.Type}})in#""Changed Type""",0,06-21-2022,10:21 AM
61,470251,SilviuMihailDasaria-labelcalu,"@MichaelEdwards2 - can you make sure you add the both properties search_from and search_to into the body variable? These two properties should be part of the request_data element.Changebody = ""{ """"request_data"""": {}}"",tobody = {""request_data"": {""search_from"":0,""search_to"":10}}Try this and let me know if it works.",0,06-21-2022,10:39 AM
62,470251,MichaelEdwards2,"Hi Chris, The ""get_endpoints"" api is only related to endpoint data like OS, version etc and not really what Im after. I need to create a monthly report for incidents and the ""Get_incidents"" api seems to be the logical one to use. When you say you had issues with the dates, do you mean the epoch format ?II used the below query to resolve this if this helps ?#""Added Custom"" = Table.AddColumn(#""Extracted Values2"", ""Unix Epoch Time"", each #datetime(1970, 1, 1, 0, 0, 0) + #duration(0, +1, 0, [Column1.last_seen]/1000)),#""Renamed Columns"" = Table.RenameColumns(#""Added Custom"",{{""Unix Epoch Time"", ""Last_Seem_UK_Time""}}),",0,06-21-2022,11:59 AM
63,367168,gjenkins,"Hi Mark,I would start by confirming that the Mac endpoint meets theMac requirements. Also, confirm that theMacOS version is compatible with the version of Cortex XDR Agent installed by viewing thisCompatibility Matrix.Assuming that your device meets the requirements, the installation logs would be needed to determine why the installation is failing. Depending on your version of MacOS, that location could vary as listed below and documented here:Troubleshooting Resources for the Cortex XDR Agent for Mac.My recommendation would be to confirm that you are indeed meeting the requirements, as stated previously. And due to the sensitive nature of the logs on your system, the next step would be to open a case with Support at the Customer Support Portal so that they could further analyze the logs.",0,12-03-2020,02:49 PM
64,367168,m455954,"Thanks for the reply, but I don't have a problem with the client not installing correctly if I run it manually, it's more about how I can deploy it.The deployment within InTune allows me to deploy a single .pkg file, and if I deploy the standard Cortex XDR.pkg file in that way it installs fine, but can't connect as it has no config. I can't deploy the Config.xml file alongside the .pkg file when done like that.So I tried to package up the Cortex XDR.pkg and the corresponding Config.xml into another package using the Packager app, and have a postinstall.sh file which runs the installer command line to kick off the installation of the Cortex XDR.pkg file now that it will have the Config.xml file with it - but that's not working at present - and I'm not sure why.What I was aksing was if there's a way to embed the config info into the pkg file directly rather than needing to have the Config.xml file, as then I could use the single .pkg file and it should just work.The documentation for deploying the Mac client shows either the manual installation, of for the Jamf deployment shows how to set up the extension policy, but nothing else - so I'm a bit in the dark about if I'm even trying to do this right. I've learnt more than I ever wanted to know about Mac packaging in the last week and am really none the wiser 🙂Hoping someone else on here has already been through this pain and has a simple method to get it working.Cheers,Mark.",0,12-03-2020,04:40 PM
65,367168,gjenkins,"Hi Mark,That is completely understandable! I am glad to hear that you were able to install the Cortex XDR Agent without InTune successfully. Let's hope that someone comments soon with a solution from their experiences.",0,12-04-2020,10:18 AM
66,367168,Hitesh-Jain,"Hi Mark,Did you manage to install using intune with the config file?Regards,Hitesh",0,04-28-2021,01:18 AM
67,367168,sjoey,"Also having the same issue - documentation is just covering the extension portion and not the package/xml files.What's the right solution here? I've currently got agents installed with error code 307, can't connect.",0,05-25-2021,10:52 AM
68,367168,MMoskovich,"HiDid someone try to use ICEBERG?1. We are aware that in terms of package deployment these applications only support packages (*.pkg) and metapackages (*.mpkg)There is a constraint here, but we can be work around that taking advantage of how packages work on macOS system (see additional information section for package definition)2. We are also aware that some applications, such as Apple Remote Desktop for instance (there may be others), also have the capabilities of copying files and running UNIX commands targeting multiple machines, which can also be leveraged to workaround the problem- Both packages and metapackages support containing multiple embedded packages inside the main package- This allows us to create a new package, that will contain both ""Traps.pkg"" and ""Servers.xml""/""Config.xml"" inside a single container- Deployment of the package to your entire macOS environment on a simple package is possible in this way- Several package creation applications for macOS are available that will facilitate this process.-""Iceberg"" application was chosen for this reference documentation, as it's free (and with BSD license)- Other applications can be used as PackageMaker or any other at your disposal1.1. Create new package:- Install Iceberg and open the application- Create new project- Select Darwin package- Give name to the project-NOTE:project name (which later will be the package name) cannot have spaces in it. Packages with empty spaces do not work and will fail, as you can see on the screenshot attached (""PackageNameBroken.png"").- Select Scripts tab- Check postflight script, choose the selected script file as per 1.2 below- Add ""Traps.pkg"" and ""Config.xml"" to additional resources- You can edit the others tab if wanted, although not required- Build- Package is ready on the project folder- You can upload the package to the macOS deployment applications1.2. Script file:- Script will just point to the package to install, the sub-package embedded inside the main package, ""Traps.pkg""- No file extension- TextEdit.app cannot be used to create or edit the file- File content:""#! /bin/shsudo installer -dumplog -verbose -pkg $1/Contents/Resources/Traps.pkg -target /""- Open terminal- Run command ""vi postflight""- Editor opens with new created file- Press G (uppercase G)- Press A (uppercase A)- Paste file content- Press escape- Type "":wq"" (write and quit)- Script is created- Run command ""sudo chmod 777 postflight"" and enter password- This will give the file run permissions2.1. Apple Remote Desktop copy + UNIX features:- Copy ""Traps.pkg"" and ""Config.xml"" and script to a location on all needed endpoints- Should be possible to place them on a folder and copy the folder with the 3 files- Run the UNIX Command to all needed endpoints- Command is ""sudo ./postflight""2.2. Script file:- Script will install ""Traps.pkg""- No file extension- TextEdit.app cannot be used to create or edit the file- File content:""#! /bin/shsudo installer -dumplog -verbose -pkg ./Traps.pkg -target /""- Open terminal- Run command ""vi postflight""- Editor opens with new created file- Press G (uppercase G)- Press A (uppercase A)- Paste file content- Press escape- Type "":wq"" (write and quit)- Script is created- Run command ""sudo chmod 777 postflight"" and enter password- This will give the file run permissionsScripts:Scripts for case 1 and 2 are attached for reference, file named ""Scripts.zip"". please feel free to modify or create yours if needed.Video:A video recording of the full tutorial following the instructions exactly as detailed above is attached to this article, file named ""TrapsMacOsPackagingIceberg.mp4"". This might help to clarify any doubts or follow the procedure more closely.Additional InformationNote:Please note that Palo Alto Networks does not enforce any specific software distribution tool, and it's each customer's decision to opt for the best tool for their environment. We provide the installation package and the config XML file, and with this data you can do everything that is needed to install Traps.Palo Alto Networks engineers are not expected or required to hold knowledge on how every software distribution tool works, since we don't support any 3rd party products. That said, each customer should be responsible for the decisions in terms of the deployment solutions and related implementations.Package Definition:Package is a file system directory abstraction. We can also define it as a container that encapsulates all the daemons, kexts (short for kernel extension, aka kernel drivers in Windows), config files, launching agents and daemons, any direct dependencies (libraries) and possible needed scripts for pre or post installation.- Additional information on macOS packages @https://en.wikipedia.org/wiki/Package_(macOS)- Additional information on encapsulation @https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)As a learning experience:- Grab any macOS package file (*.pkg)- Rename it to *.zip- Extract it to some location/folder- You will probably see a single extracted file named ""Payload~"" or ""Payload"". Maybe not, and you will see another package files (*.pkg) and config files (*.xml), etc - which is the exact kind of package embedding we did to resolve this initial problem described on this KB. It that is the case, start the procedure again on new packages.- Once again rename ""Payload~"" to ""Payload.zip"" and extract it again-You will probably see now the files mentioned above that are the content of the application. You might also see directly the application (*.app)- On some cases you might have to repeat the renaming and extraction process 1 or 2 more times depending on the level of the encapsulation donrAbout Iceberg:(extracted from their official website @ http://s.sudre.free.fr/Software/Iceberg.html)Iceberg is an Integrated Packaging Environment (IPE) that allows you to create packages or metapackages conforming to the Mac OS X specifications.With Iceberg, you can quickly create your installation packages using a graphic user interface similar to your favorite development tools.Iceberg can also be useful for Administrators who want to gather in a metapackage numerous packages for remote distribution via Apple Remote Desktop.- Additional information on Iceberg @http://s.sudre.free.fr/Software/documentation/Iceberg/English.lproj/documentation/index.html- Screenshots of all the application's views@ http://s.sudre.free.fr/Software/Iceberg.html",1,07-26-2021,11:50 PM
69,367168,poliveira,"@MMoskovichnext time, please quote your sources.Traps macOS Deployment: How to Build Custom Packages for Microsoft InTune, AirWatch, Apple Remote De...Iceberg is no longer supported on new macOS versions, but there are other apps out there like ""Packages"" that work similarly. A 2nd option is to deploy only the package and then push a script that will connect the agents to the right tenant:",0,07-28-2021,05:13 AM
70,367168,ITService,"@poliveira: 2nd Option ist working for us for MacOS up to Version 11. Awesome, Thank You!But i try to figure out how does it work with the 1st Option ""Packages"". I spend a lot of days for trying but it doesn´t work with packages. I am a rookie in Packages, maybe i make mistakes but i tried to mirrow the stuff from the tutorial Iceberg to packages.Please, would you be so kind and give a step by step Introduction for ""Deploy Cortex XDR agent for macOS with Packages for Intune""? I think a lot of people will be very thankfull for that help.Thanks and many Greetings!Sebastian",0,08-12-2021,09:12 AM
71,367168,hilippWeil,"Hey all,I have the same problem. It would be nice if there were such detailed instructions.GreetingsPhilipp",0,06-29-2022,03:51 AM
72,506977,SilviuMihailDasaria-labelcalu,"Hi@ahmadaliyev,You can enforce XDR disk encryption policy rules only on the Operating System volume. Have you had change to review this document?Let me know if there any questions or concerns!Thanks,Silviu",0,06-29-2022,01:54 AM
73,506977,ahmadaliyev,I enforced XDR disk encryption policy rules on OS volume only. Now I want to turn off encryption for OS volume.,0,06-29-2022,02:25 AM
74,503895,bbarmanroy,"Hi@RFeyertagthis boils down to the decision that your management team makes. What customers typically do is to procure an adequate number of Forensics licenses that should cover the count of endpoints that need to be triaged during an incident. That exact number depends on your internal teams based on experience.Like any process, the XDR Forensics capability can only run when an endpoint is in a power-on state. You can perform an online triage by making the appropriate changes in the corresponding Agent Settings profile and initiating an online triage.I also believe you're referring to the possibility of an Offline triage here. You can create a Forensics Collector and deploy it on an endpoint manually to collect Forensics evience as well. Once the collection is complete, the zip file can be uploaded to the XDR console for further analysis.",0,06-15-2022,07:52 PM
75,503895,RFeyertag,"From point of the technical aspect, I have no clue how the process can be in a real life scenario. Is there any ressource existing, where we can ask how to setup our Cortex XDR for a good practise way belonging to forensics incidents? I know in the end, we will have a team of forensics persons in the house, which will need informations quick. Therefore I thought we will collect every day forensics data from all endpoints.To divide them to endpoint forensic and endpoint non forensic is not solved well. I would like to see a type of tag to be more flexible without putting the client/server to another endpoint group/policy/profile and dividing the inventory.So now for my understanding, the triage is the function, which collects all forensic data based on the agent settings to the console/Host Timeline? When the collector in the agent settings is set to 12 hours, what will haben with this data? Is it collected, but the clients needs triage flag to get the informations to the host Timeline?BRRob",0,06-22-2022,01:20 PM
76,503895,jcandelaria,"@RFeyertagAdding perspective on this question as one of my customer had this process:1st --> isolated the potential compromise endpoint (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...)2nd --> assign agent profile with forensic enable (step 10-->item 4 --> https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/customiza...)3rd --> wait 24hrs to collect all forensic data (can be customize to lower hrs)4th --> once data is available, start triage.. (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...)Below are additional info on forensics:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...",0,06-28-2022,06:57 AM
77,503895,bbarmanroy,"Hi@RFeyertagto answer your question on creating groups/tags for Forensics, the reasoning is that when an endpoint is flagged for Forensics investigation, it is a potential case of assumed compromise. The endpoint should be ideally isolated to prevent any artefacts from being modified or destroyed in the host, or lateral movement/exfiltration etc. Assigning them to a specific logical partition using tags/groups is the recommended method to ensure the integrity of the forensics activities are maintained.Surely, you can collect Forensics for all endpoints - however that'd be a huge volume of data collected every day and you'd need to procure additional licenses to ensure all your endpoints are covered, and additional personnel to comb through all of that. You can discuss with your DFIR teams to understand if all endpoints need to be actively covered and how it impact your operations. Existing processes/playbooks are a good way to set a baseline.You can consider one of the following for creating logical groups for Forensics:Method A (using endpoint tags)1. assign user-created tags to specific endpoints as specified in the documentationhere.2. You can define endpoint policies based on the user-created tags like so and apply corresponding endpoint profiles with Forensics enabled:Method 2 (using static groups)You can refer to the documentation here.@jcandelariahas provided you with the links for optimizing your workflows.",0,06-28-2022,06:35 PM
78,506871,afurze,"Hi JacobSchembri,Check out this article https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-7/cortex-xdr-agent-admin/cortex-xdr-agent-for-... it discusses installing the agent on non-persistant VDIs and similar. You can set the VDI flag on install and prescan so that you avoid these sorts of issues.",0,06-28-2022,05:10 PM
79,198331,nhussaini,Thank you!,0,07-07-2021,07:44 AM
80,198331,sambhusarath,Which services are required when Pathfinder examines devices on the endpoint?,0,06-28-2022,01:49 AM
81,198331,SilviuMihailDasaria-labelcalu,"Pathfinder™ requires an optional component integrated with the Broker VM that deploys a non-persistent data collector on network hosts, servers, and workstations that are not managed by aCortex XDRagent. The collector is automatically triggered byAnalyticstype alerts with a severity of High and Medium as described in theCortex XDR Analytics Alert Reference, providing insights into assets that you would previously be unable to scan. Information is available here.",0,06-28-2022,05:32 AM
82,505316,bbarmanroy,"Hi@Kavurisowmyathere are a few workarounds to address your ask:- use starring configuration for those endpoints- use alerts/incidents API and retrieve 100 at a time, and then xref against endpoints API/datasetWhat is the use case that you're trying to solve? It is generally not recommended to filter alerts based on hosts as XDR stitches them in incidents.",0,06-22-2022,01:09 AM
83,505316,Kavurisowmya,"Hi @bbarmanroy ,We want to manage alerts for a particular group of assets related to the same environment. We have different endpoint groups with each <100 endpoint. So we want to group the alerts only for those endpoints.",0,06-22-2022,01:39 AM
84,505316,bbarmanroy,"Hi@Kavurisowmyathat is not a recommended approach to incident resolution in XDR. Since alerts are stitched to incidents, and an incident can contain alerts from multiple sources. The challenge is that one might miss attach path maps/chains with your suggested approach.",0,06-22-2022,03:14 AM
85,505316,Kavurisowmya,"Hi, We have alerts that need to be reviewed for specific assets/endpoints and enable block mode only for them. Can this be done with the starring/using Xref? Is there any other way?",0,06-26-2022,09:18 PM
86,505316,bbucao,"Hi Kavurisowmya,Cortex XDR Prevention Profiles contain the specific settings for how XDR will enforce the specific modules (Block or Report only), these profiles are then tied to endpoints via Prevention Policy rules. In order to enable blocking on a particular group of hosts, create an ""Endpoint Group"" that contains all of the intended hosts, then create a Prevention Policy that's target is set to the Endpoint Group you created and ensure that the Profiles you assign to this policy contain the specific settings you want applied to this group of endpoints.As@bbarmanroymentioned, you can then create a starring configuration specifically for that endpoint group you created. Once you do that you will be able to filter in the Alerts table based on if the Alert is ""Starred"". You can also filter the Incidents table based on the Starring field as well so you will be aware if any Incidents involve a host that is in your target group.",0,06-27-2022,07:04 AM
87,501775,SilviuMihailDasaria-labelcalu,"Hi@GolfHacker,Thanks for posting to our Live Community Forum. Currently the ASN information is not present in the XQL so we recommend leveraging custom datasets just like the one you've created for mapping.Thanks,Silviu",0,06-27-2022,04:04 AM
88,501775,GolfHacker,That is good to know that a custom dataset is the only option today.Do you know of an XQL command that will work with a custom CIDR dataset like I have listed above?,0,06-27-2022,06:54 AM
89,505979,bbarmanroy,Hi@JaitapkarYou can get the WF verdict with artefact details from the correspondingXDR APIResponse of XDR API,1,06-27-2022,02:55 AM
90,488390,jtalton,"Hi Houston29115,Please refer to the Install with a Unified Configuration Profile for MDMs (paloaltonetworks.com) TechDoc.A ready install script is not available, however scripting can be done using bash/zsh/ksh or python scripting. For example, here is a bash shell script for a silent installation:installer -pkg ""CortexXDR.pkg"" -target /*CortexXDR.pkg = Insert XDR installation package nameFor MacOS, the Cortex XDR agent needs full disk access to:Thanks",0,06-10-2022,12:59 PM
91,488390,Houston29115,"yeah, know about this... this method wont get around asking our Tech Team or the end user to manually bless the install.If you happen to find a method please update here - thank you for your time.",0,06-10-2022,01:17 PM
92,488390,Houston29115,"the problem with this advice is - if the user doesnt interact with the Full Disk Access prompt - (and most corp users rant admins, nor would they likely even know HOW to do FDA) - the computer will be left vulverable. This means Cortex will not be able to protect the entirety of files in storage.What's actually required is a self heal solution from Palo Alto Networks, so that if:a. the app, or either system extension become corruptb. the user somehow manages to corrupt or uninstall part of the original installCortex will detect this circumstance from a client computer and reinstall itself as soon as the user puts their computer on net again.Currently, is there any known way to set this up?",0,06-24-2022,04:51 PM
93,488548,kiwi,"Hi @pedrodias2020 ,In order to get more traction for this I have moved this topic to the Cortex XDR discussions area.Cheers,-Kiwi.",0,05-24-2022,06:25 AM
94,488548,uis,"Hi@pedrodias2020,the best practise is to uninstall from the tenant. If somehow these two endpoints have lost the communications with the tenant,I would recommend to get the uninstaller and boot the endpoints in safe mode. You should be able to uninstall this way.As a best practise, we also recommend to be updated to the latest releases of the agent. Version 7.7.1 has improved a lot in terms of health and how to manage the agent with tokens wich is a new feature.I hope this helpedKR,Luis",0,05-24-2022,06:31 AM
95,488548,moixsante,"@pedrodias2020If you are trying to uninstall on a Windows machine, I would suggest you also look at the XDR agent admin guide. In the uninstall section, it is explained how to use admin cmd and the msiexec method to uninstall the agent. Just remember that you need to have the same installation package version as the one installed locally for the method to work.You could also open a TAC case explaining the situation. It is quite odd that after you disable protections, the agent doesn't uninstall.",0,05-24-2022,07:30 AM
96,488548,pedrodias2020,Tnak you for allI used traps cleaner 6.2.0 and it worksRemove cortexThanks,0,06-24-2022,03:46 AM
97,505196,moixsante,"Hi@Aiman_Fathima,Even though, you have the possibility to resolve alerts from the Alert table, you need to work on the Incidents and close those.If you are looking at the Alert Table, right-click on an Alert and go to Pivots to views > View related incidents.You can also add the column Incident ID to the Alert table.But remember that you need to work from the Incident view and not from the Alert table directly.",0,06-21-2022,09:24 AM
98,505196,Aiman_Fathima,Thank you for your suggestion. We tried the above but still they do not get resolved sometimes so was wondering if there are any other methods,0,06-21-2022,09:34 AM
99,505196,SilviuMihailDasaria-labelcalu,"Hi Aiman,Can you share a snapshot of the issue you're experiencing?Thanks,Silviu",0,06-21-2022,09:35 AM
100,505196,Aiman_Fathima,Sorry cannot share the screenshot. The issue is that we have closed the incidents with 'resolve alerts option' but still the alerts are open.,0,06-22-2022,01:51 AM
101,505196,moixsante,"Hi@Aiman_Fathima,It seems it is still not clear who the incident and alert process work in XDR. You do not resolve alerts, you resolve incidents. When you set the status of an incident ""Resolved-xxx"", you get the option to ""resolve"" the associated alerts. In the Alert table, you have the column ""Resolution Status"". This column allows you to know if the alert was handled. The alerts will NOT disappeared. You can hide them by using filters, though.There are 2 ways to ""resolve"" alerts. One by resolving incidents, another by changing the resolution status directly on the alert.Andremember that you need to work from the Incident view and not from the Alert table directly",0,06-22-2022,02:14 AM
102,505196,Aiman_Fathima,"We had resolved the incidents andused the option to close the associated alerts, but still in the alerts table we see the alerts resolution status as ""NEW"". We currently have 2.8M alerts which are associated with already closed incidents and yet thier resolution status is still ""NEW"".",0,06-22-2022,05:33 AM
103,505196,Jaitapkar,"Hey@Aiman_Fathima,You can suppress the Alerts by using Alert Exclusions. By suppressing the alerts will auto resolved the incidents respectively.Regards,Mansoor",0,06-24-2022,03:08 AM
104,505533,bbarmanroy,@RFeyertagyes you can. Use an leading '\' escape character.,0,06-22-2022,08:03 PM
105,505533,RFeyertag,"Sorry, I don't get it.How would you type in, if i want to check exactly following string.""C:\Windows\System32\hh.exe"" C:\Program Files (x86)\ASSA ABLOY\Vision\Vision.chm::/Use_Guest_CheckIn_Steps_Single.htmBRRob",0,06-23-2022,12:09 PM
106,505533,SilviuMihailDasaria-labelcalu,"Just like@bbarmanroymentioned in the post you just need to escape the double quotes in the string.dataset = xdr_data |filter action_process_image_command_line = ""\""C:\Windows\System32\hh.exe\"" C:\Program Files (x86)\ASSA ABLOY\Vision\Vision.chm::/Use_Guest_CheckIn_Steps_Single.htm""|fields action_process_image_command_line ",0,06-23-2022,11:32 PM
107,501982,mfakhouri,"Hi @AnilRacharla,1. Cortex XDR’s default malware policy rules utilize both pre-execution and post-execution malware protection. WildFire is used for pre-execution and executes several checks:WF static analysisMachine learningDynamic analysisBare metalThe file will go to Local Analysis if there is no verdict to be found with WF. Cortex XDR post-execution malware prevention includes: behavior threat protection, anti-ransomware, password theft protection, and child process protection.2.Cortex XDR malware scans check for dormant malware and differs from the protection leveraged during the malware execution. These scans can be done either manually or periodically with prevention profiles and do not require any additional features/licenses.Here is a relevant, high-level graphic illustrating Cortex XDR file analysis:Are you expecting dormant detection or a detonation that may have been missed by the Cortex XDR agent? Are you able to share any hash info for verification?",0,06-23-2022,03:17 PM
108,505242,gjenkins,Incredible!,0,06-23-2022,11:56 AM
109,443904,gjenkins,Cool!,0,06-23-2022,11:56 AM
110,505718,moixsante,"Hi@rtsedaka,Is Google Chrome Helper being blocked by XDR? if yes, which alert type? Local Analysis? Wildfire? Suspicious Process Creation?",0,06-23-2022,02:08 AM
111,505507,afurze,"1) This is a feature of Threat Intelligence Management from Cortex XSOAR, you can ingest lists from Palo Alto Networks and other 3rd party sources and pass them in to Cortex XDR. You can reach out to your account/sales team for details2) Cortex XDR BIOCs as well as Analytics BIOCs are already tested against well known, safe, activity to reduce false positives, there is no action required for most out of the box Windows systems. If you are encountering false positives related to known trusted Windows processes, you can utilize the concepts discussed in the alert tuning webinar to implement appropriate exceptions/exclusions",0,06-22-2022,02:53 PM
112,505507,SilviuMihailDasaria-labelcalu,"To add more context XDR directly integrates with Autofocus, VIrustotal (requires API key from the customer) and Wildfire in order to provide TI information about indicators. More information here.",0,06-23-2022,12:50 AM
113,505587,bbarmanroy,"Hey@MarvinCthere are two use cases you seem to be aiming at. Let me address them individually:1. blocking hashes - one option is to add them to the global Block list. In this case, hope this helps:2. Blocking IP addresses: You can use Host Firewalls (recommended and easily managed). Alternately, use BIOC's .",0,06-22-2022,07:57 PM
114,505587,MarvinC,,0,06-22-2022,08:01 PM
115,505520,afurze,"Hi!When you click Exclude Alert from the context menu of the Alerts page, this does not create a rule, it is a one time action against one alert. If you want to create or manage exclusion rules, you can go to Incident Response -> Incident Configuration -> Alert Exclusions. Here you can create exclusions and set the parameters to match alerts and exclude.",0,06-22-2022,03:05 PM
116,503848,bbarmanroy,"Hi@RFeyertagTo answer your question: how long does a terminal server session last? Is it persistent across reboots like a regular Windows 10 endpoint? If so, please install as a standard installation.On the other hand, if the sessions are not persistent, like VDI's or Temporary Sessions, you can install as a VDI or Temporary Session instance on those endpoints. You can see the explanation of the differences here.",0,06-15-2022,07:31 PM
117,503848,RFeyertag,"In our case the sessions are lost, when we reboot the RDP-Server.The session only persits, when the employee disconnects its RDP-Session.But all the changes in the logged out and OS restartet sessions are persistent.A user can have X sessions with the same user, without disconnecting the other sessions.Sorry, my knowledge about Terminalserver needs improvement.BRRob",0,06-22-2022,01:53 PM
118,407545,gjenkins,"Dear communityWhen using the Vulnerability Assessment with Linux hosts, the results may include a lot of false positives.Distributions which are backporting security fixes (CentOS / Debian) do may not change the App Version when they got patched.https://access.redhat.com/security/updates/backporting""Backporting has a number of advantages for customers, but it can create confusion when it is not understood. Customers need to be aware that just looking at the version number of a package will not tell them if they are vulnerable or not""""We also supplyOVAL definitions(machine-readable versions of our advisories) that third-party vulnerability tools can use to determine the status of vulnerabilities, even when security fixes have been backported.""I didn't see much in the documentation, and I'm not sure if this is ""working as expected"" or if there is a way to improve the configuration for better detection.CheersFabianHi@fb-pan,Hi Fabian,Thank you for reporting on the backporting strategy implemented by RedHat and other potential Linux vendors. Are you finding that your endpoints encountering an increase in false positives in their vulnerability assessments as a result? I'm certain that Palo Alto Networks Engineers would be interested in hearing about your results and analyzing any data you could provide regarding the concern/issue.",0,07-20-2021,03:52 PM
119,407545,b-pan,"HigjenkinsThanks for your answer. I was in contact with a PAN Cortex SE and he told me, that they know about this (by design)..He did open an FR (not sure about the FR ID). If you want to vote for this FR, I can ask for the ID.Regards",1,07-20-2021,11:22 PM
120,407545,NathanBradley,"Ive also brought this up to out SE and sales when vulnerability assessment was added, I was told its working and the endpoint is vulnerable.I provided examples of applications that are patched and never received an acceptable answerIts unusable as a means to gauge a Linux devices vulnerability posture",1,07-21-2021,09:44 AM
121,407545,gjenkins,"Hi @fb-pan,It's quite understandable that a feature request had been logged as backporting had not been considered. In this case, monitoring for support in the next iteration of the Vulnerability Assessment would be the best next step. I look forward to seeing how this would be accomplished.",1,07-21-2021,10:55 AM
122,407545,NathanBradley,Any updates on this?,0,05-20-2022,06:39 AM
123,407545,NathanBradley,"Here is a specific example.A Centos server is reporting a vulnerability(cve-2018-10906) in fuseFuse has been patched via a backported update, as the changelog shows proof",1,05-20-2022,06:56 AM
124,407545,myu06kkn,"Just wondering, any support ticket filed for this? If not, any feature request to vote for... improve accuracy?",0,06-01-2022,02:44 AM
125,407545,NathanBradley,"We worked with our SE and support previously, we never received an acceptable resolution\explanation.",0,06-07-2022,09:52 AM
126,407545,afurze,"Just wondering, any support ticket filed for this? If not, any feature request to vote for... improve accuracy?Hi Myu06kkn,Please reach out to your Sales Engineer/Account Team to get added to this Feature Request and track progress.",0,06-07-2022,10:22 AM
127,499023,MarvinC,,1,06-03-2022,12:51 AM
128,499023,MatthewCollins,"I am unable to find any information regarding the broker vm and the proxy setting for xdr agents. I need to know if setting up the proxy broker vm will lower the amount of traffic sent to the cortex xdr cloud, as I have a very throughput sensitive environment.",0,06-20-2022,11:16 PM
129,499023,SilviuMihailDasaria-labelcalu,"Hi Matthew,Information regarding the broker vm and the proxy setting for xdr agents is available here. This will lower the traffic for content update and agent installs but everything will stay the same in terms of bandwidth consumption.Let me know if you have any questions or concerns!Thanks,Silviu",0,06-20-2022,11:59 PM
130,504692,SilviuMihailDasaria-labelcalu,"Hi,Please follow the below article(s) to uninstall Cortex XDR Agent depending on the OS type.- Windows- Linux- MacLet me know if you have any questions or concerns!Thanks,Silviu",0,06-20-2022,05:31 AM
131,504692,KiranKandel,"Hi Silviu,I followed all the articles and had zero luck with it.It has disabled myAgent Tampering Protection where I cannot open to do anything to it.I have no control on what I can do in the computer because of it. I was thinking about saving all my documents and files to external hard drive and factory resetting the computer. But this doesn't allow me to connect any external devices either.I don't know what to even do at this point.Thanks,",0,06-20-2022,04:45 PM
132,504692,SilviuMihailDasaria-labelcalu,You need to get in touch with your IT team to resolve this problem as you need the uninstall password.,0,06-20-2022,11:52 PM
133,443147,jcandelaria,"Hi Orkan,I would say, it depends on the organizations change control and upgrade strategy. Some environment that i worked with, have auto upgrade enabled and some have more conservative approach. Basically there is canary/pilot group (IT group themselves) have auto upgrade setup for certain # of weeks for evaluation and testing, then next change control after is where they will roll out the auto upgrade setting.Also you still have options below depending on your strategy (upgrade process)",2,10-25-2021,12:57 PM
134,443147,teJacobCF,"I only do the minor release automatically.having said that I do test out new versions on key assets (servers, workstations, supported builds of win10 and apple).Once I am ready to roll out a major version I use either the platform to push to my different sites or sometimes manually and sometimes, use the auto update feature only to turn it off once I have my assets on the new version I am going for.I have found that using the auto update feature sometimes will just stop working for whatever reason (kind of annoying).I then have to go back to my RMM tool and ensure that it is installing that new version for new/freshly imaged assets.",0,10-26-2021,07:48 AM
135,443147,SilviuMihailDasaria-labelcalu,"Hey Frances,How's your network in general meaning Do you have plenty of bandwidth? Also there is any broker VM involved in your setup?On the other hand the issue you were mentioning it's between 7.0 and 7.3 which are end of life at the moment ... Is this happening as well between 7.5 and 7.7?Thanks,Silviu",0,06-20-2022,05:35 AM
136,504144,bbarmanroy,"Hi@RameshShresthahaving a single Broker VM is not a recommended approach. The official guide indicates 1 Broker VM per 10,000 endpoints. Given that, we also need to keep in mind HA, which is to have minimum of 1 on top of the recommendation to ensure your endpoints continue to operate as usual. You can review the other options for download sources as listed in Step 14 here.If Direct Server Access is enabled in your tenant, the agents will fallback to connecting directly to the tenant via host proxy configurations.For your second question, I'd recommend you to leverage your exisitng infrastructure monitoring tools to detect when the BVM IP/domain/landing page is unreachable and trigger an alert.",1,06-16-2022,07:20 PM
137,504144,RameshShrestha,"Hi Bbarmanroy,One of our clients has only around 200 endpoints that don't have direct internet access and have only 1 VM. Those endpoints need Broker VM to access to Cortex Server. So in that case, if the VM goes down for some days, can we get the logs of activities of endpoints after VM comes online?",0,06-16-2022,08:41 PM
138,504144,bbarmanroy,"Hi@RameshShresthayes, the customer will get the logs once connectivity is resumed (assuming the alloted disk space is not full, else FIFO). Since this is an airgapped environment, the customer should have at least 2 BVM's to ensure the connectivity is maintained. You can also write a Correlation rule to count the number of endpoints that have gone offline. If the count is equal to the total number of endpoints, that should fire off an alert.You can use this as a sample XQL query:dataset = endpoints| filter endpoint_status = ENUM.DISCONNECTED| comp count(endpoint_name ) as Count by endpoint_status| filter Count =200 // indicates all endpoints are offline",1,06-17-2022,02:21 AM
139,504144,RameshShrestha,thank you@bbarmanroy 😊,0,06-17-2022,02:40 AM
140,504144,jcandelaria,additional info on broker VM losing connectivity.,0,06-17-2022,08:27 AM
141,503724,bbarmanroy,Hi@NitinYadavyou can reach out to your team with Domain Administrator or Super User roles in the PANW Customer Support Portal and request them to enable 2FA for your account.,0,06-15-2022,07:37 PM
142,503724,NitinYadav,Hi @bbarmanroy @2fa is already enable I need to disable but without 2fa i am not able to login to disable the same.,0,06-15-2022,07:45 PM
143,503724,bbarmanroy,"You cannot disable it by yourself as it is required to have 2FA. You'll need someone to remove your account from the CSP, and re-add you to go through the activation process to setup your 2FA from scratch.",0,06-15-2022,07:54 PM
144,503724,NitinYadav,While removing account from CSP is it will get impact to my other accounts on cortex weather my all account will get disappear ?,0,06-15-2022,08:27 PM
145,503724,bbarmanroy,"CSP is the central authentication platform for XDR and some other products. So yes, all products that leverage CSP as the IDP will not work until you're onboarded again to the platform.",1,06-15-2022,09:34 PM
146,503510,bbarmanroy,"HI@Marc_DenmanFor your first question, you can refer to the documentation here which lists the data that is collected by XDR.For your 2nd and 3rd question, they have been addressed earlier here.To add on to the response in 3rd question: the reasoning behind quarantining is to typically isolate a file and block it from being executed on the endpoints. This gives the investigation team the time to conduct their analysis to determine whether the file is benign or malicious. If the file is benign, you can manually ""un-quarantine"" the file. Else, the file should be removed from the endpoint as per your organization's information security policies. XDR does not delete a file from the endpoint even after quarantining as it might affect business processes etc.",0,06-15-2022,07:47 PM
147,349470,JohnSmith7732,"cytool proxy set ""<Proxy IP><Port>""Should workIm pretty certain you list several brokers separated by ; or comma. Youll have to check that",1,09-15-2020,01:39 PM
148,349470,MartinCimone,Exactly what I was looking for.Thanks,0,09-17-2020,04:40 AM
149,349470,AtanasBachvarov,"Hi,Thank you for the information, though I am unable to change the proxy following your guide. When I attempt to add any of the two commands you have shared:cytool proxy set ""<Proxy IP><Port>""Cortex_Installer.msi proxy_list=”<proxy>:<port>”I get the following message: ""cytool"" or ""Cortex_Installer.msi"" is not recognized as an internal or external command. Could you please advise?Just to clarify I am using Windows 10. Is your post about the Windows 10 Command line or another OS?Thanks in advance,Atanas",0,06-14-2022,04:56 AM
150,349470,MartinCimone,"""cytool.exe"" is an executable from Cortex XDR and the folder containing the executable is NOT in the Windows System Path.You need to be in the Cortex XDR installation folder before running the command.Ex: - Open a Command Prompt ""cmd""- Go to folder C:\Program Files\Palo Alto Networks\Traps- Run the command to set your proxy: cytool.exe proxy set 1.1.1.1 8888That's it.",2,06-14-2022,05:05 AM
151,349470,uis,"Hiadditionally you can addC:\Program Files\Palo Alto Networks\Traps to your windows pathKR,Luis",0,06-14-2022,05:48 AM
152,349470,AtanasBachvarov,"Thank you! Should there be the symbol "":"" , between the Proxy IP and the Port please?I do appreciate your patience with my query 🙂",0,06-14-2022,06:56 AM
153,349470,AtanasBachvarov,"Thank you! Should there be the symbol "":"" , between the Proxy IP and the Port please?",0,06-14-2022,08:00 AM
154,349470,MartinCimone,YES!The exact command line is:,1,06-14-2022,08:17 AM
155,349470,AtanasBachvarov,Thank you all so much Martin! Is there a way to add two Proxies at the same time please? 🙂Again your feedback is deeply appreciated.,0,06-15-2022,01:49 AM
156,503382,uis,"Hi@Phearak_SemDid you checked spam ? or other rule that might forward the pin email to another email folder ?if the above is Ok, please feel free to open a TAC support ticketKR,Luis",0,06-14-2022,05:45 AM
157,503382,hearak_Sem,"Yes, I checked already and didn't see it.",0,06-14-2022,11:50 PM
158,444022,slick,"Are you able to describe the problem, or what you are expecting that isn't showing?",0,06-14-2022,10:06 AM
159,498125,bbarmanroy,"Hi@Vishwasamudrawhat would be the reason for a rollback? My recommendation is to first deploy a new version of an agent on a set of UAT servers. Upon UAT validation, you can proceed to deploy on a wider set of endpoints. Irrespective of deployment sizes, this should be the process to ensure operational stability.",1,06-02-2022,06:10 PM
160,498125,shwasamudra,This could not be a solution its one of the deployment practice/method in production environment. what are the reasons to add agent rollback feature. other end point protection have providing why cant they.,0,06-02-2022,08:38 PM
161,498125,bbarmanroy,"Hi@Vishwasamudrait is not clear why you'd want to perform a rollback. Is it because of performance issues? If so, it'd be prudent to roll out a new version on UAT before production deployment. This would help identify any issues in UAT, work with support to fix the issue and proceed to production.Secondly, a rollback exposes the endpoints to known issues that were discovered and documented on older versions. This is not an ideal solution.Thirdly, a rollback is not a long-term solution as the organization would still need to push an upgrade to ensure the agents do not reach EoL. Once an agent reaches EoL, it stops receiving Content Updates and exposes an endpoint to known vulnerabilities, which are detected/prevented by Content Updates.Fourthly, a rollback to an older version removes the capability of the agent to have additional security modules which were introduced in newer versions.Finally, a rollback is a last resort - which can be managed with software inventory tools like SCCM, Intune etc.I look forward to hearing your points on the need for rollback and why my recommendations do not fit your need as a best practice.",0,06-03-2022,12:01 AM
162,498125,shwasamudra,"Hello,Solution from Polo alto on end point security..Cortex-XDR not provided auto upgrade with desired version for large scale of networks ( mostly 500 to 1000 systems)auto upgrade will take latest patch what released soon...Todays life every thing going to IOT/automation with less man power.If my XDR profile set to auto update, need provision agent rollback with N+1.",0,06-03-2022,12:34 AM
163,498125,bbarmanroy,"Hi@Vishwasamudrait is not clear from your last post what you are suggesting.I will try to explain your concerns:1. ""Cortex-XDR not provided auto upgrade with desired version for large scale of networks ( mostly 500 to 1000 systems)"" - XDR does it via Agent profiles. You can also set it to a desired minor release version in your profiles. You can also use Action Center to restrict the deployment to a desired agent maintenance release.2. ""Todays life every thing going to IOT/automation with less man power"" - absolutely. Please leverage your organization's GPO/SCCM to deploy agents for large environments such as yours.I look forward to your explanation on why you want to rollback to an older version (which exposes the environment to known issues), and what is preventing you from doing so with SCCM?",0,06-05-2022,07:43 PM
164,498125,RHolzer,"Hi @bbarmanroy! Maybe I can jump in as I have a similar need. Starting with CU 540-92670, our Windows 7/2008R2 clients with 7.7.x-agents installed used >=50% of CPUs of the machine. Machines with the 7.5 (CE) agent and the same CU didn't have this issue. The affected machines weren't usable at all so we were forced to react quick.We ""solved"" the issue by uninstalling the agents via the management platform (offtopic: because we didn't have the current agent remover - is there an easy way to get the latest version or do I really have to ask the support for every version?) and redeploying 7.5 (CE) agents to affected systems as those are about to be replaced anyway. This has happened for the first time in two years of using Cortex XDR, but the ability to downgrade would have helped to save some time for sure. Only ""a hand full"" (< 100) of clients were affected, so the process was no big issue, but imagine this happening for > 1.000 clients. That would be a big pain! 😉",0,06-06-2022,01:02 AM
165,498125,uis,"Hi@Vishwasamudra,it would be good to understand the reason for an agent version rollback. This action would open your systems to old security issues and attack vectors that are already blocked on newer versions. On top of that you might also come back to old versions performance issues or bugs that have been already solved.I agree with Bbarmanroy that the best practice is to have all your agents in the newest version and if you dont feel confident to move to the very latest for some critical endpoints, you can upgrade in UAT and once you feel confident you can move on with all your endpoints upgrade.KR,Luis",0,06-06-2022,02:15 AM
166,498125,bbarmanroy,"Hi@RHolzerThank you for your point. I can understand the challenges you went through. What you've explained is an issue with the CU. However, I'd like to reiterate the same process for CU rollout as with agent upgrades - consider a strategy for upgrading your CU's in a delayed fashion for your PROD environments after UAT validation. The issue withCU 540-92670 was resolved with540-92744. Rolling back to a CE version claws back the new features that were introduced in the later versions. You should consider using it in critical environments only: ""Critical Environment Versions are designed for sensitive and highly regulated environments and do not contain all updates and content existing in the standard version. Therefore, it is recommended to restrict the use of these versions to the required minimum."" Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/manage-co...That being said, we're discussing internally to see how we can let users control the CU version.",1,06-06-2022,03:03 AM
167,498125,RHolzer,"Hi @bbarmanroy would have the delay period actually helped in this case? In my opinion there are two possibilitys when delaying the CUs, for example the delay is 1 day:1. The faulty 540-92670 is being released and after 1 day it is being introduced to our environment. The 540-92744 is being released some hours later and also after1 day (but some hours later?) it is being introduced and superseeds the older 540-92744 CU. In thise case, the CU was delayed, but we would have had the same issue.2. The 540-92670 is being released and after 1 day it would have been introduced to our environment, but it's already superseeded by 540-92744, so 1 day later, we will get the 540-92744 and skip the 540-92670 (so it's 530-92303 -> 540-92744 instead of 530-92303 -> 540-92670 -> 540-92744).Which one is the case?We are aware of the drawbacks when going from 7.7.x to 7.5, but this was the fastest solution as the CU 540-92744 didn't seem to solve the issue immediately.",0,06-13-2022,03:16 AM
168,502579,afurze,"Hi JonathanYang_RX,This tends to come down more to your internal testing and change control processes and where you fall in the balance between having the latest features vs. having a known and steady environment state. The auto-upgrade is definitely a good option, but you can also issue upgrade actions to endpoints one-off or in bulk via the Action Center. One option is to put a group of endpoints into an auto-upgrade mode to have a test bed of devices running the latest version and then use the Action Center to upgrade the rest of your devices as you choose.",0,06-10-2022,06:37 AM
169,502579,teJacobCF,I turn on the auto-upgrade feature only when there is a version I want to go to. I wished you could get more granular with the auto-update versions... having said that they have really added some options for that I just want to be able to specify exactly what version I want to go to... when I use the feature it works well except there is alway remediation. auto update gets about 90% of my clients and I have to fight with the rest. usually a combination of no disk space left or I have to use the cleaner and then reboot and my rmm tool will re-install. I like to stay cutting edge with my version and unlike panos there is not a preferred version.,0,06-10-2022,10:11 AM
170,502579,KanwarSingh01,Agree with@PeteJacobCFwe should be able to target more specific version i.e. specific minor version with agent auto-upgrade as well. Hope this feature is introduced soon.,0,06-11-2022,03:02 PM
171,481787,jtalton,"HiKanwarSingh01,The Cortex XDR Agent features Behavioral Threat Protection modules leveraging the Anti-Malware Scan Interface (AMSI) to block PowerShell scripts.To create a BIOC rule, please check out Live Community How-to videoScript Block Query and BIOC | Palo Alto NetworksThanks",0,06-10-2022,02:01 PM
172,460865,jtalton,"Hi Faber,This may be due tothis process not being protected by a module. By default, your exploit security profile protects endpoints from attack techniques that target specific processes. Each exploit protection capability protects a different set of processes that Palo Alto Networks researchers determine are susceptible to attack. If there are no protection modules enabled on the process, no is exception needed. Please referenceProcesses Protected by Exploit Security Policy (paloaltonetworks.com)for more details.There are other modules where Process Exceptions will still apply, like Anti-Ransomware Protection, Child Process Protection, but for all Exploit Prevention Modules the process exception makes no difference for an unprotected process.If you're investigation has determined the process is benign, you can add the hash to the Allow List (*best practice is to whitelist by hash) and allow it to be executed on all your endpoints regardless of the WildFire or local analysis verdict.In the UI, Go to Incident Response, Response, Action Center, + New ActionEnter the SHA-256 hash of the file and clickYou can add up to 100 hashes at once.Click Next.Review the summary and click Done.ReferenceManage File Execution (paloaltonetworks.com)Thanks",1,06-10-2022,01:46 PM
173,502174,teJacobCF,Also keep in mind you can integrate virus total and autofocus as well. I have theCloud Identity solution (basically ad integration)it was super simple.,1,06-09-2022,04:59 AM
174,502174,afurze,"Hi CraigV123,With Cortex XDR Prevent, only the XDR Agent information can be ingested into XDR console, an XDR Pro license allows you to ingest alerts from 3rd party sources (including NGFW) and a Pro per TB license allows you to ingest the raw logs. Please refer to this doc page with detailed information on capabilities per license type (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/cortex-xdr-overview/cortex-...).Correction: You can use the AD integration feature to bring in data from AD for alerts and incidents. It's the Identity Analytics that you won't be able to utilize. Check outhttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...for information on configuring this.",1,06-09-2022,12:42 PM
175,502174,CraigV123,I appreciate the response and additional information. Trying to get our organization to see the benefit in the upgrade. This sort of stuff helps.,0,06-10-2022,03:34 AM
176,502200,teJacobCF,the only way i can think of is to uninstall the version you have. then use an installer that has the content with it and while installing use the switch to choose that content version. I hope this makes sense.,0,06-09-2022,08:55 AM
177,502200,afurze,"Hi Luc_Desaulniers,Unfortunately, there is no way to rollback a CU or to deploy an old CU from the console.",0,06-09-2022,10:07 AM
178,476724,tugriceri,"Dear@eumbachAs you mentioned forward from CDL is not including XDR data. If you have PANW Firewall has been integrated with CDL, You can use CDL forward option.I believe best option is to use Alert forwarding from Cortex XDR. (Configuration>Notification>Add Forwarding Notification). I dont know why syslog data dropped on splunk but i guess this is something you need to fix on splunk side.",0,03-30-2022,12:15 AM
179,476724,umbach,Syslog is not supported in the PAN_TA for Cortex XDR so there is no parsing of the fields.Cortex XDR · GitBook (paloaltonetworks.com)Cortex XDR incidents are cloud-hosted so logs are retrieved by Splunk using the Cortex XDR API (syslog not supported).The method that is supported is with API but it only pulls the INC# and a link to the XDR console which doesn't provide value for correlation. This use to work using the TRAPS syslog parsing but that was removed in 7.X and forward.,1,03-30-2022,09:29 AM
180,476724,RShoufi,"Bump. New XDR customer and going through the onboarding phone calls with our teams etc. We were told that Splunk integrates withj XDR and we will be able to pull in alert data fairly easily and have all of the functions that you have made multiple threads about which now has me worried that the XDR guys may not really understand everything thats going on and perhaps need to go ""find the small group of people that knows all about splunk integration and have done it before"". lol all I know is that Splunk people exist but are not easily found.",0,03-30-2022,04:55 PM
181,476724,umbach,"""...We were told that Splunk integrates with XDR..."" - We were told the same thing, and it does... in the since that XDR can ingest Splunk logs, but not the other way around. As a customer we have spoken with Product Management, Sales, VP of XDR, the Developmentteam for the Splunk App with no resolution hence us finally giving up and coming to the LIVEcommunity to see if anyone else out there has a solution.",0,03-31-2022,08:58 AM
182,476724,umbach,For Anyone following we have created our own Splunk App which uses the API to pull in alerts and map them by alert source to datamodels. The Python was not nearly as complex as we thought it would be.Get Alerts (paloaltonetworks.com),0,06-09-2022,08:36 AM
183,501653,bbarmanroy,Hi@RobertoPastorinoyou can consider using rollout delay for Content Updates to meet your needs. You will need to create a separate Agent Settings Profile and assign them to targetted endpoints.Refer to Step 12:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/customiza...,0,06-08-2022,07:39 AM
184,501653,RobertoPastorinaria-labelo,,0,06-08-2022,08:46 AM
185,501653,afurze,"Hi RobertoPastorino,In a case like this where a CU is identified as causing issues by Palo Alto Networks, the CU gets rolled back and then replaced. The endpoints that are delayed will never receive the ""bad"" CU, they will just get the next CU after the delay period ends. For example:Hour 0: New CU released, agents with out delay get updatedHour 24: CU is identified by PANW as causing issues, CU is rolled backHour 48: New CU is released, agents without delay get updated* 72 hours after new CU released, so hour 120 *Hour 120: New CU is installed to agents with delayThese are just hypothetical numbers, issue discovery, CU rollback and replacement are always dynamic and unique to a specific issue.",0,06-08-2022,09:08 AM
186,501653,RobertoPastorinaria-labelo,,0,06-08-2022,09:22 AM
187,501653,Luc_Desaulniers,"Are you 100% sure of that?This is what logically should happen, but I ran into the exact issue that the OP is referring to where a CU was pushed, broke things, the next day it got fixed by a new CU, but my machines that were set to a 3 days delay picked up the broken CU first.This happened to my environment back in early March 2022.Maybe things have changed now, but I can confirm that OP's concern is a valid one as I've seen it happen. There is no way for us customers to exclude a content update. What I ended up doing was work my way around it by changing the delay to a very long delay and then once I was sure the latest wasn't causing issues, I switched my initial group that had the delay setup to immediate content so they would pick up the latest one and then changed it back to 3 days delay once they were all to the point I wanted them.",0,06-09-2022,06:21 AM
188,501653,afurze,"Hi Luc_Desauliniers,It does of course depend on Palo Alto support identifying a widespread issue and engineering deciding to rollback the CU, but in the case with this most recent CU issue, I can confirm it was indeed rolled back. In your case it is possible it was not rolled back by engineering. I recommend you speak with your account team to get a feature request submitted to identify a better solution for managing CUs if needed.",0,06-09-2022,06:49 AM
189,501755,KanwarSingh01,Hi@BryanFordPlease see the below doco:https://www.paloaltonetworks.com/blog/security-operations/prevention-hunting-and-playbooks-for-msdt-...https://unit42.paloaltonetworks.com/cve-2022-30190-msdt-code-execution-vulnerability/Regards,0,06-08-2022,03:37 PM
190,501681,bbarmanroy,"Hi@Cyber1985yes you can!Try ""Scripts Library"" in Action Center:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...That'll meet your needs. It'll take more than a click though.",0,06-08-2022,07:34 AM
191,501681,Cyber1985,"Thanks a lot, this was what I looked for.BRRob",0,06-08-2022,12:04 PM
192,499961,afurze,"Hi Mbaltalksnis,Your query is filtering out 10.130.130.34 (action_local_ip != 10.130.130.34) which is why you're not seeing any additional traffic for that host. If you wanted to see traffic from that host where the local port is not 445, you just need to drop the '!' from the action_local_ip portion of the query, as follows:",0,06-06-2022,07:55 AM
193,499961,nKrieghoff,"In that filter that you provided in results i only get rest of the ports from10.130.130.34, and there are no other local IPs in output.",0,06-07-2022,12:48 AM
194,499961,afurze,"You can add an OR to the filter and use parenthesis to group your operators, like so:| filter (action_local_ip = ""10.130.130.34"" and action_local_port != 445) or action_local_ip != ""10.130.130.34""This selects either logs where the local IP is 10.130.130.34 and the source port is not 445, or logs where the local IP is not 10.130.130.34.",1,06-07-2022,06:40 AM
195,499961,nKrieghoff,"Thanks, that solution looks like is working, will try to work with that.",0,06-08-2022,07:37 AM
196,501477,afurze,"Hi Cyber,Please reach out to your SE/Account Team to get this feature request submitted for you! It isn't 100% relevant to that particular view since that lists all artifacts involved in an incident, not necessarily the response that was taken for them as that is instance/endpoint specific (which is why it shows up in the Executions tab), but it may still be something that could be summarized in that view.",0,06-07-2022,01:48 PM
197,501477,Cyber1985,"Thanks a lot! I will contact them.For our use case we have sometimes a lot of funds (about 30) through malware scans, like some grayware from sweetlabs. For uninstalling this software I need the uninstaller, etc. which is in quarantaine. But some files are not in quarantaine and to get it faster done, I would prefer a easier solution to get files into and out of quarantine. Every summarized overview would be be very nice.BRRob",0,06-07-2022,11:31 PM
198,500495,KanwarSingh01,"Hi@Cyber1985Generally I think customization of a BIOC rule should be on a Customer itself, I take BIOC rule by PA as more of an example for people like us and as well as detection rule for a generic environment not for a specific environment which means that if there is any rule which we think is not best for our environment we create a copy of that rule forked from PA BIOC rule and then add additional details accordingly for best interest of our environment.So lets say you can add all the portable browsers in that rule along with wave, brave etc.Thank you and Regards",0,06-07-2022,06:53 PM
199,501312,KanwarSingh01,"Hi@NathanBradleyAs far as I know I think the case still exists as outlined in the below community link:https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/device-control-violations-amp-xql/td-p/4...The link also provides a hint on how you can built your own custom notification using the ""Get Violation API"".https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-api/cortex-xdr-apis/endpoint-manageme...What you can do here is, create a csv file of the violation being pulled from XDR API and then ingest in SIEM for notifications or other stuff.Thank You",0,06-07-2022,05:57 PM
200,499537,TomYoung,"Hi @RameshShrestha ,This process has changed. Please review this doc -> https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClN9CAK. Jump to the link in the 2nd bullet, Configure 2FA Methods. You will see this URL https://sso.paloaltonetworks.com/enduser/settings where CSP users can setup their MFA methods. Please note that MFA is now turned on all accounts and cannot be turned off. Email should be enabled by default for all users.Thanks,Tom",0,06-05-2022,02:27 PM
201,499537,RameshShrestha,"Hi@TomYoung,I followed the same but I am unable to loginwith my CSP credentials inhttps://sso.paloaltonetworks.com/enduser/settings",0,06-05-2022,08:57 PM
202,499537,TomYoung,"Hi @RameshShrestha ,You can call support to create a case, and they will fix it.https://www.paloaltonetworks.com/company/contact-supportThanks,Tom",1,06-07-2022,01:01 PM
203,501321,Luc_Desaulniers,"It is normal in the fact that this how it's done currently, but now is it secure to do this, no it isn't. Try to raise it through a support ticket, I guess the more that raise those kind of issues the more chance there is for Palo Alto to fix it.",0,06-07-2022,10:42 AM
204,500779,afurze,"Hi Cyber1985,There's some Windows nuance happening here which is tripping you up. When you used CMD to launch Powershell, Cortex examined the command line arguments passed to powershell (i.e. powershell.exe wget [site_url]) and was able to match ""wget"", however, when you type ""wget"" into an interactive Powershell window, there are no command line arguments to examine, it all happens within the interactive shell without spawning a subprocess as was the case with CMD.To detect this, you will need to have Powershell logging enabled shown here from Microsoft,https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_logging_win...Assuming you have Cortex XDR Pro per Endpoint, Windows Event logs are ingested and can be searched.",0,06-06-2022,02:49 PM
205,500779,Cyber1985,"Hey Afurze,nice nickname, is it german?I tested it and it worked on my machine. So, we will need to activate the PowerShell logging on every domain.Thanks a lot!BRRob",0,06-06-2022,03:23 PM
206,500779,NathanBradley,is there a list of windows event logs thats are collected? i was not aware powershell event logs are available in cortex,0,06-07-2022,08:13 AM
207,500779,afurze,Here is the article which outlines whatWindows Event Logsare collected by Cortex.,0,06-07-2022,08:17 AM
208,498009,afurze,"Hi Balaraju. You do not need to install a different agent, broker, etc. to transition from Prevent to Pro per Endpoint. When the new license is applied to your tenant, you will have the option to enable Pro endpoint capabilities under the Agent Settings profile. As for moving tenant location, I recommend you reach out to your account team to discuss this.",1,06-02-2022,07:23 AM
209,498009,bbarmanroy,"Hi@Balarajuwhile you're engaging with your account SE to discuss specifics on your 2nd question, I'll summarize some salient points:1. Yes, this is possible. Your SE can help you create a new tenant in the EU region.2. Update your firewall profiles to allow traffic to EU tenant (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...).3. You will need to migrate your agents from UK to EU tenant (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/manage-co....4. You will likely lose all existing data in your current tenant as that might not be migrated due to restrictions.5. Your old tenant will be terminated upon completion of migration of endpoints.",1,06-02-2022,06:18 PM
210,498009,JayGolf,Hi@Balarajuplease provide more info regarding your issue.,0,06-07-2022,07:40 AM
211,500658,afurze,"Hi Mgreer,Cortex XDR does not natively support ingesting Duo admin/auth logs, however, the Duo log sync utility does support sending via CEF. You can deploy the Broker VM and enable the Syslog Collector applet (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/external-data-ingestion/add...) and configure to receive CEF logs. Cortex XDR will automatically create a data set for you and you can then search logs, as well as create BIOCs, IOCs, and correlation rules.",0,06-06-2022,02:54 PM
212,500658,mgreer,"You are correct, CEF is an option but there seems to be a significant difference between the CEF and JSON data:I can start with CEF though and go from there. Maybe Duo is on the roadmap for a native integration.Thanks!",0,06-06-2022,04:43 PM
213,500619,NagaVenkatesh,"Hello cyber,I have encountered the issue in the past and Palo confirmed that there is no way to customize the alerts you receive on your mobile phone.You can create a notification setting from management auditing to send an email notification to the user who is it assigned to.Navigate to Settings --> configurations --> Notifications--> add forwarding configurationconfigure log type as Management audit logs and scope section select subtype as assign incident.",0,06-06-2022,01:44 PM
214,500619,Cyber1985,"The management audit is perfect to get it done. It is so pity, that PA will not make this adjustable.Thank you for your help!BRRob",0,06-06-2022,02:47 PM
215,490147,bbarmanroy,"Hi@Cyber1985I believe what you're looking for is Restrictions Profile. You can create a BIOC and add it to a Restrictions Profile for it to block certain behavior. Please note that this will be a post-execution module.An example is preventing users from using Google Chrome to visit https://1.1.1.1. You can write that BIOC and add it a Restrictions Profile, and apply that to an endpoint/set of endpoints via Security policies.",1,05-24-2022,02:55 AM
216,490147,Cyber1985,"So correlation rules can't trigger a block, am I right?So I created a BIOC Rule, here you can see it:Where is the connection missing? I can remember in past I got that connection between BIOC and custom prevention rule which I could find under the restriction profile.But now I can only enable it, but cannot define only my custom once, I don't want cortex to block all BIOCs. How can I deal with that?BRRob",0,05-27-2022,03:02 PM
217,490147,bbarmanroy,Hi@Cyber1985please see the below screenshot where I am able to add it to a Restrictions Profile. I hope this meets your needs.,0,06-02-2022,07:57 PM
218,490147,Cyber1985,"Hey! Sure this fits somewhere my needs. But when I create a BIOC Rule out of a XQL, it won't work to put it into a restriction profile.I like XQL and how do I translate it to the ""standard input BIOC language""?BRRob",0,06-06-2022,10:59 AM
219,490147,afurze,"Hi Cyber1985,There are specific restrictions when attempting to use a custom prevention rule through the Restrictions Profile. Link to documentation is here (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...), however, I will summarize below:Please review your BIOC rule and ensure that it meets these guidelines, if possible, post the BIOC rule here for further troubleshooting.",0,06-06-2022,11:29 AM
220,490147,Cyber1985,"I found out, you should not take the fields and timeframe to your XQL Query, when a BIOC-Rule + Restriction Input should be created out of it.So I was able to get my goal 🙂Thank you very much@afurze@bbarmanroy!BRRob",0,06-06-2022,12:52 PM
221,499340,JimWaZ,Agreed.,0,06-03-2022,02:48 PM
222,499340,afurze,"Hi Ckopta,The best path forward for this is to open a TAC case to obtain coverage information for this CVE. You can open a case in your Customer Support Portal (https://support.paloaltonetworks.com) and submit the CVE info you have and ask for a determination of what coverage is available.",0,06-06-2022,08:03 AM
223,499340,hisingh,Hello@ckoptaThe App threat version 8577 has released the coverage forCVE-2022-26134I hope that helps.Himani,0,06-06-2022,08:45 AM
224,494619,bbarmanroy,Hi@RonaldWeissThis seems to be an issue with the backend. Please create a support ticket for this to be addressed.,0,05-30-2022,06:48 PM
225,494619,RonaldWeiss,"Hi,I already createt a ticket for this to our MSSP. Nevertheless hoped to speed up, or get Information, here...i also assume it's backend issue during creation of the installer package.",0,05-30-2022,10:52 PM
226,494619,bbarmanroy,"Hi@RonaldWeissI checked internally - please note that this is a desired behavior.""""""To better secure your Cortex XDR agent installations on Linux machines, installation packages are now signed by Palo Alto Networks. The installation package contains a new configuration file which includes the tenant ID and registration key. When installing the agent installation package, if signature-checking is configured, you will need to install a Cortex XDR public key.""""""Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-7/cortex-xdr-agent-release-notes/cortex-xdr-ag...https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-7/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",0,05-31-2022,12:47 AM
227,494619,RonaldWeiss,"Hi,Yeah, i have read that, too. BUT:In that guide it says:Ubuntu or Debian apt-get install ./filename.deb or dpkg -i ./filename.debBut that doesn't work because the package provided is NOT a deb package, but a tar.gz with the wrong file extension!#file 2022_05_30_Cortex_XDR_Linux_7_7_1_62043.deb2022_05_30_Cortex_XDR_Linux_7_7_1_62043.deb: gzip compressed data, was ""traps_linux-7.7.1.61152_deb.tar"", last modified: Mon May 30 08:29:27 2022, max compression, original size 55715840Why not just include the tennant ID and reg-key into the deb package?btw: i could do that myself, but thats not my job...",0,05-31-2022,12:54 AM
228,494619,bbarmanroy,Hi@RonaldWeissI went through the whole process as specified here and was successfully able to setup XDR agent on an endpoint.Can you clarify if you were able to successfully execute this step of extracting the contents of the tarball before initiating the installation:,0,06-01-2022,06:47 PM
229,494619,RonaldWeiss,"Hi,this might work. But if there is a deb package provided, it should work as expected, and not unveil as a renamed tar.gz.When you follow the part ""To deploy using package manager"" on your screenshot, this simply doesnt work.AND: the deb was working since 7.6!To clarify:i AM able to install a tar.gz, but there is the fact that the deb installer is not working as expected.So i think someone messed something up. The Intention of the post is to inform about the failing installer.PA should either change the manual below ""To deploy using package manager"" (add ""unpack the *.deb using tar -xfz, and copy the config file""), and get the laughts of every linux-admin,or just fix the creation of the deb file.",0,06-01-2022,10:51 PM
230,494619,bbarmanroy,"Hi@RonaldWeissI was able to follow the steps in sequence to extract the contents of the tarball. The tarball contained a .deb file, which I installed with dpkg -i ./cortex-7.7.1.61152.deb.What you're referring to in your last post is a recommendation, and not a break-fix. I will let the documentation team know about your recommendation.Have a good day ahead!",1,06-02-2022,06:03 PM
231,495350,RonaldWeiss,"Hello,hope it's ok to attach mine, as it is the same issue/idea...If this would work, your issue would be resolved as well:https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/cortex-does-not-block-windows-binaries/t...",0,05-31-2022,06:53 AM
232,495350,MartinPfeil,"I haven't seen anything from Palo Alto yet.We are using the following XQL query to detect attacks, obviously it is a little bit rough and any improvement is welcomedataset = xdr_data| filter action_process_image_name contains ""msdt.exe""| filter action_process_image_command_line contains ""PCWDiagnostic"" and action_process_image_command_line contains ""IT_RebrowseForFile""| fields _time, agent_hostname as host, actor_effective_username as user, actor_process_image_path as parent_process, action_process_image_path as executed , action_process_image_command_line as command_line",1,05-31-2022,06:53 AM
233,495350,RonaldWeiss,"@MartinPfeil: good idea, well done query. but you cannot prevent with it.That's the reason i'd love to see a hashblock for msdt.exe...",0,05-31-2022,07:00 AM
234,495350,SHoehne,"The problem could then be, that there could be different versions with different hashes...I just disabled the Diagnostics using a group policy which seems a better approach for me.",0,05-31-2022,07:09 AM
235,495350,RonaldWeiss,"Thats true. That is why i first searched for all occuring msdt.exe and added all hashes 😉As far as i see, disabling diagnistics doesn't seem to help here, as the binary is still there and handling urls.The only ""real"" workaround, afaik, is to disable msdt url protocol, as stated by microsoft.BUT you will have to do registry changes everwhere, and revert (if needed) later.So, blocking the hashes in the meantime, until a patch is available, seemes to be the less invasive way to go...",0,05-31-2022,07:17 AM
236,495350,RonaldWeiss,"FYI, some IOCs for this CVE, which might help:New Microsoft Office Attack Vector via ms-msdt Protocol Scheme (CVE-2022-30190) - SANS Internet Stor...At least the initial malicious document is already recognized by Cortex/Wildfire:4a24048f81afbe9fb62e7a6a49adbd1faf41f266b5f9feecdceb567aec096784",2,05-31-2022,07:49 AM
237,495350,SHoehne,"Hm, I'm not sure. I disabled both:Scripted DiagnosticsandAllow users to access and run Troubleshooting WizardsLet's see if there will be another way to block this with Cortex soon...Update - looks like a legit workaround:You can disable this via GPO (which is a fully supported method vs the reg hacks)you do this via registry:reg add “HKLM\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnostics” /t REG_DWORD /v EnableDiagnostics /d 0https://www.pwndefend.com/2022/05/30/office-microsoft-support-diagnostic-tool-msdt-vulnerability-fol...",0,05-31-2022,07:53 AM
238,495350,ZAB3115,"The following queries can be executed for hunting successful exploitation:// msdt.exe execution with suspicious argumentconfig case_sensitive = false timeframe = 30d| dataset = xdr_data| filter event_type = ENUM.PROCESS and action_process_image_command_line contains ""msdt.exe"" and action_process_image_command_line contains ""it_browseforfile""| fields agent_hostname , action_process_image_command_line , action_process_image_path , actor_process_command_line , actor_process_image_path , causality_actor_process_image_path// office processes spawning msdt.execonfig case_sensitive = false timeframe = 30d| dataset = xdr_data| filter event_type = ENUM.PROCESS and action_process_image_command_line contains ""msdt.exe"" and actor_process_image_name in (""winword.exe"", ""powerpnt.exe"", ""excel.exe"", ""msaccess.exe"",""visio.exe"",""onenote.exe"")| fields agent_hostname , action_process_image_command_line , action_process_image_path , actor_process_command_line , actor_process_image_path , causality_actor_process_image_path",1,05-31-2022,10:22 AM
239,495350,Luc_Desaulniers,"You could create a BIOC rule with that query and then assign this BIOC rule to a restriction profile so that it would prevent the action. It does the trick usually, keep in mind that BIOC rules aren't instantaneous, but depending of the actions, it usually reacts quickly enough to avoid most of the damage.",1,05-31-2022,11:42 AM
240,495153,villegas1992,Te sugiero sigas los siguientes pasos publicados por Microsoft hasta que tengas una respuesta por parted e Cortex Palo Alto.https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-...,0,05-31-2022,10:59 AM
241,495153,RonaldWeiss,"Hello,as Luc mentioned here (https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/cve-2022-30190-microsoft-support-diagnos...) the use of custom prevention rules with the BIOC works lika a charm here.So, this will be my solution until PA or Microsoft deliver a proper one. (Which, for PA, might be a BIOC, too 😉 )",0,05-31-2022,11:59 PM
242,480233,Craig_Secure,This is awesome to detect both ways - thanks so much!!!,0,05-31-2022,02:21 PM
243,495457,NagaVenkatesh,"Hello Latif,we haven't encountered any issue like that but something similar happened when we have defender on passive mode for systems on W10. As the sensor in defender checks for devices on the network , XDR terms as port scan.Hope this helps-naga",0,05-31-2022,06:47 AM
244,493724,Cyber1985,"Hello! I had a similar problem with some incidents. I created the white listing, but the process still blocked.The workaround was to restart the pc (and maybe to check in).Try it and give ma feedback if it is working for you.",1,05-27-2022,02:31 PM
245,493724,NivedaR,Hello ! Thanks a ton for the workaround ! This is only working on few of the system.,0,05-29-2022,10:50 PM
246,493724,MartinPfeil,"We have similar problems with white-listed binaries and received the following explanation: The white listing only adds the hash to a list of static IOC, if the binary acts in a suspicious way (either live or in WildFire) it will be blocked. One solution is to always run the latest version and report false positives, the other one is creating a malware profile which excludes certain files and folders from being scanned.",0,05-30-2022,12:45 AM
247,493724,uis,"Hi@MartinPfeilyou can also tweak wildfire verdict if you dont agree with it, and you will get an answer from us in 2 or 3 days.KR,Luis",0,05-31-2022,02:05 AM
248,493724,MartinPfeil,"Hello Eluis, this is a standard procedure when we identify false positive alerts: report an incorrect verdict back to Palo Alto. Unfortunatly we still have to deal with the results of the initial false positive detection, e.g. messed up and incomplete software installations and updates because WF blocked access to certain files on several systems. This happens especially with software development tools and foreign language software, especially Chinese.",0,05-31-2022,02:20 AM
249,494634,bbarmanroy,"Hi@Pieter.Rubens1. I am looking into this why this rule does not appear.2. These queries are managed by Cortex XDR Detections team and are constantly being added/updated to the existing list on the server side. As such, the queries are not viewable.3. You can of course create a custom BIOC rule where you ingest AD logs and look for entries that log these behavior and go off it. That being said, a Correlation rule might be a better fit for the same as you need to look at historical data to formulate your logic.",0,05-30-2022,07:03 PM
250,484046,MBTTSI,"Same issue here.Grabbing thousands of dollars for Hosts Insights and delivering an ""vulnerability assesment"" that it completly useless...",1,05-03-2022,11:42 AM
251,484046,bbucao,"Hi Cyber1985,You can Exclude specific CVE's by navigating to Assets>Vulnerability Assessment>Vulnerability Assessment and clicking the ""CVES"" box in the top right. Then right click the CVE you want to exclude and click ""Exclude"", this will give you a prompt where you can also add a comment and/or report the CVE as incorrect.",1,05-03-2022,08:38 PM
252,484046,MBTTSI,"This is completly useless. This is a major bug in the Vulnerabliitiy Assessments.CVEs missing, where a newer KB was installed.Very very bad Palo Alto Networks!",0,05-17-2022,01:23 PM
253,484046,NathanBradley,"Linux scans are even worse, backporting isnt taken into account.",0,05-18-2022,11:31 AM
254,484046,Cyber1985,"Hey Bbucao,will there be an improvement in the future? To click 100 times exclude CVE is not the daily business of mine and I would like to know if anybody works with the VA live?BRRob",0,05-27-2022,03:24 PM
255,484046,Cyber1985,Hello! Something happend in the background. Now none of our machines has CVEs. Is this a good sign?BRRob,0,05-29-2022,02:43 PM
256,494023,Cyber1985,Here the information about the agent version and content version,0,05-27-2022,03:21 PM
257,494023,Fowler69,"01 Sys_trigger job ""Event Management - Evaluate Alert Manage"" is stuckFind the sys_trigger job:/sys_trigger_list.do?sysparm_query=nameSTARTSWITHEvent%20Management%20-%20Evaluate%20Alert%20Manage&sysparm_view=Add columns ""Claimed by"" and ""System ID""Get thread dumps from the running jobReview node logs to look for reasons that the job could be stuck and provide resolution",0,05-28-2022,05:10 AM
258,488807,tsedaka,Thank you for your contribution!,0,05-22-2022,10:33 PM
259,488807,KanwarSingh01,@rtsedakaWelcome.,0,05-23-2022,05:55 AM
260,488807,Cyber1985,"Hey KS!Nice query. Can you please explain it to us, how this should run automaticly? What are the steps to take it live?And how do I test it in detail?BRRob",0,05-27-2022,03:07 PM
261,493862,afurze,"The field you are attempting to expand is not an array, it is a json field, so that won't work. If you remove this line from your query like so:dataset = xdr_data| filter event_type = ENUM.EVENT_LOG| alter Username=json_extract(action_evtlog_data_fields, ""$.TargetUserName"")| alter IP_Address=json_extract(action_evtlog_data_fields, ""$.IpAddress"")| fields IP_Address, UsernameYou should get values as you expect!",0,05-27-2022,10:50 AM
262,493862,NathanBradley,"Thanks, any documentation out there for items that are either arrays or json fields",0,05-27-2022,12:06 PM
263,493862,afurze,"There is no exhaustive list to my knowledge, however, you can easily tell by looking at the field data. Well formatted JSON data is always surrounded by curly brackets ('{', '}'), and then uses key-value format, whereas arrays use square brackets ('[', ']') and are simple collections of values. For example:{  ""store_name"": ""Sears"",  ""store_tags"": [""home"", ""automotive"", ""defunct""]}The overall object here is a JSON object, and it contains two keys, one of which has a value which is an array. If you see a comma separated list of values in square brackets, think array, if you see key-value data inside of curly braces, think JSON!",0,05-27-2022,12:52 PM
264,487822,uis,"Hi@Daniel_Itenberg,could you please try to reconnect using the following command on the subject endpoint and tell us the output ?c:\Program Files\Palo Alto Networks\Traps>cytool reconnect forceDoes it reconnect ? can the checkin be performed ? does it appear as connected in the tenant after the given command ?As a good practise try to always use the last agent releaseIf this doesnt work, please feel free to open a TAC support ticketKR,Luis",0,05-17-2022,08:46 AM
265,487822,NagaVenkatesh,"If the check in fails or does not connect the agent, then use the force command and it should work. I have tried and it worked and it is pretty simple. Once you ran it would ask for admin password. Please try it and it should work.Thank youNaga",0,05-17-2022,09:14 AM
266,487822,Daniel_Itenberg,What's the force reconnect command on mac?,0,05-18-2022,12:03 AM
267,487822,Daniel_Itenberg,The problem is on mac.. is the command the same on mac?,0,05-18-2022,04:14 AM
268,487822,uis,"Hi@Daniel_Itenbergyes, cytool exists in MAC with the same syntax. Under the directory/Library/Application Support/PaloAltoNetworks/Traps/binHope that helps, please mark it as a solution if it was, or click on like itKR,Luis",0,05-18-2022,05:12 AM
269,487822,Daniel_Itenberg,"Here's the weird thing - I only have a support folder in the path you mentioned, and in it a logs zip file. I cant seem to find the cytool at all on my machine. I am running the 7.7 agent - maybe Palo changed the path or something like that for the cytool?",0,05-25-2022,03:13 AM
270,487822,bbarmanroy,"Hi@Daniel_Itenbergcan you please confirm if the XDR agent is installed in the default path ""/Library/Application Support/PaloAltoNetworks/Traps/bin"" as stated here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-7/cortex-xdr-agent-admin/cortex-xdr-agent-for-...Can you please1. share a directory listing of the path ""/Library/Application Support/PaloAltoNetworks/Traps/bin"" as a screenshot?2. confirm if the endpoint shows as Connected in XDR tenant UI?",0,05-25-2022,06:37 PM
271,488336,KanwarSingh01,"@Bojan-ToticPlease try the below XQL query, you should be able to get your result in MB, similarly you can also convert into GB as per your convenience.Thank You.",1,05-19-2022,02:15 AM
272,488336,bbarmanroy,Hi@Bojan-ToticThis is what I use:,1,05-19-2022,08:08 PM
273,488336,Bojan-Totic,"Thank you both so much, that worked great 😄Love the visual representation as well!",0,05-25-2022,08:06 AM
274,486713,uis,"Hi@nikoolayy1cortex xdr is designed to work with the xdr agents in the endpoints. The more log sources you integrate of the type: FW, servers, Enhanced Data Collection, AD logs, etc, the better to be able to spot malicious activity.If you disable the agents or uninstall them, you will stop blocking any malware on the endpoint leaving them unprotected.Imagine that you detect on your network/fw logs a malicious connection, this means that at that moment your EPs are already compromised. If the agent is up and running full capabilities the agent will block the attack and report it.There is no much sense on buying an expensive KR, tool and disabling it. Or maybe I didnt fully get your pointKR,Luis",0,05-12-2022,06:34 AM
275,486713,WSeldenIII,"Hi@nikoolayy1Here is a noteworthy write up on NDR / Network Traffic Analysis (NTA)to provide an overview / insights. In a firewall-only deployment where the Cortex XDR agent is not installed on your endpoints, you can use of Pathfinder to monitor endpoints. Pathfinder scans unmanaged hosts, servers, and workstations for malicious activity. The Analytics Engine can also analyze the Pathfinder data collector in combination with other data sources to increase coverage of your network and endpoints, and to provide more context when investigating alerts.To provide greater coverage and accuracy, you can enable Enhanced Application Logging (EAL) on your Palo Alto Networks firewalls. EAL are collected by the firewall to increase visibility into network activity for Palo Alto Networks apps and services, like Cortex XDR .I hope this information provides you with a path forward.",1,05-12-2022,07:18 AM
276,486713,nikoolayy1,"Hello,Thanks for the reply as some clients use other EDR solutions and having 2 agents on the same workstation is not a good option, also the XDR I know can trigger a xsoar playbook that can block the bad users AD accounts or contact the 3rth party EDR to isolate the workstation and etc.The thing about enabling EAL sugggests to me that even if the firewall is deployed as a TAP what licenses should have like Threat Prevention and Wildfire and URL filtering enabled (https://docs.paloaltonetworks.com/pan-os/10-1/pan-os-admin/subscriptions/enhanced-application-logs) as this will provide more info to the XDR.The other thing I don't see to be mentioned in a palo alto article is if without an XDR agent the XDR autodetects, using the firewall logs which hosts are the AD controllers as I don't think there is a host field like the type of the host (workstation, ad controller). I have worked with other NDR solutions where the AD controller ip addresses are configured, so that the NDR to be able apply special monitoring to those hosts as I mentioned an AD controller will not try to access facebook for example, so this is a cause for an alarm and this adds extra accuracy to the NDR if the domain controllers are specified during a deployment of the NDR. I see that Palo Alto XDR has some alarms for the domain controllers but I see that an agent seems to be needed. Still there is a service like the Windows Event Collector (WEC) and maybe it can compensate for an XDR agent not being installed but I can't say.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/set-up-broker-vm/...",0,05-12-2022,11:03 AM
277,486713,nikoolayy1,"I asked around about people that have a lot of expiriance with XDR and without an XDR agent the detections are limited as when the agent is installed then the XDR autodetects the host's function like if they are AD controllers but without an agent the detections are limited, so maybe in the future the XDR without an Agent and just firewall integration (like NDR) will be able to do more detections expecially related to the Active Directory domain controller traffic but we will see.",0,05-21-2022,12:23 AM
278,486713,jcandelaria,"In addition to the information and replies, I would like to add the reference below. You can add third party ingestion sources which can provide added analytics detection. Also by adding more external data ingestion, you can build and create your own correlation rule alerts. Basically you can build your own analytics or alerts based out of these ingested data using XQL.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...",0,05-24-2022,10:05 PM
279,487459,tsedaka,Thank you for your contribution!,0,05-22-2022,10:35 PM
280,436413,uis,"Hi Raymond.Kwan,first make sure that you have created the installation package appropriately, please see the following doc:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/manage-co...After that, see how to manually install the Cortex XDR agent on your Mac:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-2/cortex-xdr-agent-admin/cortex-xdr-agent-for-...KR and have a good Cortex XDR agent 4 Mac installation time,Luis",0,09-24-2021,05:45 AM
281,436413,aymond.kwan,"Hi Luis,Thanks for your information. Now I have created the package and install the package manually.Btw, may I know can we run the package silently (without user interactive) via the command line or script?Thanks.Raymond",1,09-26-2021,08:39 PM
282,436413,Gabriela56,,0,09-27-2021,05:10 AM
283,436413,uis,"Check the following resource to make sure that you are compliant with the mac requirements for macos install:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-4/cortex-xdr-agent-admin/cortex-xdr-agent-for-...For your specific question on manual install/scripting. Manual install is possible from command line, scripting it will depend on your bash/zsh/ksh scripting skills and / or python habilities.Here is the doc to install the Cortex XDR Agent on mac manually:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-4/cortex-xdr-agent-admin/cortex-xdr-agent-for-...Please do not forget to thumbs up if you find these recommendations helpful.KR and enjoy your Cortex XDR for Mac,Luis",0,09-27-2021,07:34 AM
284,436413,aymond.kwan,I run the bash script in terminal:#!/bin/bashsudo installer -pkg 'Cortex XDR.pkg' -target /ApplicationsIt popups the System extension blocked and need to enable manually. How I can enable it var the script? Any hints?Thanks.Raymond,0,09-27-2021,09:05 PM
285,436413,Houston29115,right but how to automate this at install time?,0,05-18-2022,03:37 PM
286,436413,bbarmanroy,"Hi@Houston29115and@raymond.kwanWhat you are referring to are perform changes to the OS security profiles. This can be seamlessly performed with JAMF or similar solutions (e.g. Intune) for installation, deployment and upgrades.You can refer to the documentation here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-7/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",0,05-19-2022,08:05 PM
287,484143,bbucao,"Hi Fred.L,Can you share what agent version you are using?Thanks,Ben",0,05-03-2022,08:24 PM
288,484143,d.l,,0,05-04-2022,02:33 AM
289,484143,bbucao,"Hi Fred.L,Are you using the CE (Critical Environment) version? Or just the standard 7.5? The reason I ask is if you are not using the CE version then I would recommend using version 7.6 or later. Prior to 7.6 there were similar issues reported that were fixed in the agent 7.6 release. If you are using the CE version then I recommend opening a support case so our support engineers can conduct advanced troubleshooting.Regards,Ben",0,05-04-2022,06:24 AM
290,484143,d.l,,0,05-04-2022,06:26 AM
291,484143,d.l,,0,05-18-2022,06:37 AM
292,461368,teJacobCF,it looks likeAzure Virtual Desktop (WVD or AVD) is supported with v7.5 or v7.6https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...,1,01-27-2022,05:32 AM
293,461368,MBTTSI,"Sorry, but AVD is not Azure Stack HCI",0,01-27-2022,06:04 AM
294,461368,MBTTSI,Any updates?,0,02-04-2022,12:46 AM
295,461368,teJacobCF,I would say if its not on this list its not supported. have you talked to your cortex se about it?https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...,0,02-04-2022,07:15 AM
296,461368,MBTTSI,I know that it's not on the list and it is not supported.I asked when will it be supported.,0,02-18-2022,02:21 PM
297,461368,MBTTSI,"Any updates?Any support for Microsoft Operating System ""Azure Stack HCI"" that is based on Windows Server?",0,05-03-2022,11:37 AM
298,461368,bbucao,"Hi PMBTTSI,For questions related to the product roadmap please contact a member of your account team to setup a discussion.",0,05-03-2022,08:15 PM
299,461368,MBTTSI,I did. No Answer,0,05-17-2022,01:20 PM
300,487295,WSeldenIII,"Hi@chukaokonkwo,the identity of the user that resolved the incident can be references in the Incident Timeline tab of the incident(s) in question. You may also consider to filter the Management Audit logs as well. The following is an example filter: Type = Incident Management ANDSubtype Contains Change Incident Status ANDDescription Contains Resolved.",0,05-16-2022,06:24 AM
301,486920,bbarmanroy,"Hi@akash_totiayou can consider using Device Control to block portable media devices.Please refer to the link, and follow the steps in sequence. At a high-level, this is a two-step process:Step1: Identify the Device GUID. As per the documentation here, the GUID should fall under the class of Memory Technology Driver. Add it as a custom device in Endpoints -> Policy Management -> Device Management.Step 2: Add a new Extensions Profile and choose the custom class that you created, and set the Action to Block. Apply the profile to your endpoints.Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/hardened-...",0,05-12-2022,07:08 PM
302,486920,akash_totia,"Thanks,@bbarmanroy works perfectly 🙂",0,05-15-2022,04:39 PM
303,486920,GhostFly,Thank you for the explanation. It is clear for me.official website,0,05-16-2022,02:05 AM
304,487160,uis,"Hi@SahilJhambplease check this guide to get started with CXDR and enable access to CXDRhttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...and also I would recommend to contact with your sales representative to help in case you did not received welcome emails with links to start activating, etc..Hope this helpsKR,Luis",0,05-16-2022,12:49 AM
305,487095,uis,"Hi@DougNelson,could you please tell me the agent release with this behavior ? also please confirm if before it was working the way expected iwth the same agent version than when it starting to have an abnormal behavior or if you updated agent release or agent content.Let's try to dig into this a bit moreKR,Luis",0,05-13-2022,09:41 AM
306,487095,DougNelson,I'm on the latest agent version. I know it worked back in September(not sure the agent version when i tested) and i have not tested since then. So some agent in between caused it would be my guess.,0,05-15-2022,04:04 PM
307,475980,KanwarSingh01,"Hi Rob,If you need an example of useful XQL queries, you could click on Query Builder and then click on XQL Search which will open an IDE for XQL, in the bottom you will have 4 tabs out of which select Query Library and take a look at the XQL query example. Lets say in your in-built XQL library there is query for ""Rundll32 running HTML application via script""Query from XQL Library:preset = xdr_process // Using the XDR process execution preset| filter lowercase(action_process_image_name) = ""rundll32.exe"" and lowercase(action_process_image_command_line) ~= "".*script.*?mshtml.dll\,runhtmlapplication.*"" // Filtering for cases where rundll32 is being called to load an html application| fields action_process_image_command_line as cmd, actor_process_image_path as parent_path, actor_process_command_line as parent_cmd, causality_actor_process_image_path as cgo, causality_actor_process_command_line as cgo_cmd // Selectnig the relevant fieldsDescription (According to me):This query is useful in monitoring of html/hta file execution via rundll32.exe. Generally mshta.exe is used for execution of malicious html/hta files but rundll32.exe can also be used hence the query hunt.Searches for any process name which executed with an image name of rundll32.exe where the command line of the process matches a regex patterns which could match a command line such as below:Importance:HTML code could be used to run scripts such as javascript/vbscript which can be used maliciously in an environment.",2,03-27-2022,03:15 PM
308,475980,ERosendo,"This Querysearch for CVEs CVE-2022-0025 and CVE-2022-0026dataset = endpoints| fields endpoint_name , endpoint_type , ip_address , endpoint_status, last_seen, agent_version , content_version , last_content_update_time|alter content_version = to_integer(replex(content_version, ""-"", """" ))| filter content_version < 33000000 or (agent_version ~= ""7.7.0"" and content_version < 50000000)RegardsErnander",0,05-13-2022,05:22 AM
309,475980,NagaVenkatesh,"Hi Rob,Below is the query for scan errors for all endpointsdataset= endpoints|fields endpoint_name as hostname , endpoint_status , last_seen , install_date as Installationdate, agent_version, scan_status , agent_license_type , installation_type , ip_address, last_successful_scan as LastScan|filter endpoint_status = ENUM.CONNECTED or endpoint_status = ENUM.DISCONNECTED|filter scan_status = ABORTED or scan_status = CANCELED or scan_status = SCAN_ERROR|sort desc last_seenThanksNaga",2,05-13-2022,05:43 AM
310,476304,KanwarSingh01,"Hi,Are you looking for USB device plugin alert or alert on activity such as File operation, execution operation via removable media?USB Device plugin alert may not be possible but definitely you should be able to create a BIOC rule for USB/RemovableMedia file operation, process operation activity with a low severity priority which will only trigger an alert in Alerts Table but not create an Incident.Will be keen to know if someone has other idea.",1,03-28-2022,02:10 PM
311,476304,jtalton,"Hi JoaoSantos20,In the Restrictions Profile you have the option to configure notifications for Removable Media for file executions launched from external drives attached to endpoints in your network. To configure:**You may add files or folders to an allow list or block list as well.Save and then apply the Restrictions profile to the Security Profiles to Endpoints.If you already have a Restrictions Profile configured, you may edit and follow steps 5 - 8You may also create an alert via a BIOC rule from an XQL Query for event logs for Windows and Linux system. For example, an XQL query for the Windows event ID 6416: A new external device was recognized by the system. To build the BIOC rule query through a specific entity:Navigate to Detection Rules > BIOC > + Add BIOC > Select the Event Log IconEnterEVENT_ID = 6416 (optional to enter other parameters),SaveSelect the Type, Severity, Optional select a MITRE Technique or Tactic to associate with the event, such as Technique - T1092 Removal Media and Tactic - TA0010 - Exfiltration. Enter a comment for tracking, then OK.The rule will be displayed in the BIOC Rules table. Right-Click on the Rule to add it to the appropriate Restrictions Profile shown in the sub menu for the endpoints you would like monitored.ReferenceAdd a New Restrictions Security Profile (paloaltonetworks.com)Create a BIOC Rule (paloaltonetworks.com)",4,03-29-2022,02:19 PM
312,476304,KanwarSingh01,"Hi @jtaltonPretty cool way of monitoring of removable media activity, i think the only thing which will be required from the endpoint side will be enable event logging for Removable media?",2,03-29-2022,02:42 PM
313,476304,uis,"Isnt it enabled in windows by default ?Really good and creative solution from Jtalton.That deserves likes, isnt it ?",2,03-29-2022,02:44 PM
314,476304,jtalton,Thanks... Microsoft TechDoc doesn't specify if its enabled by defaultMonitor the use of removable storage devices (Windows 10) - Windows security | Microsoft Docs,1,03-29-2022,02:50 PM
315,476304,uis,"Open windows event viewer and go toApplications and Service Logs > Microsoft > Windows >DriverFrameworks-UserModeas shown in the pic1Double click there and you will see the value is 0Right click on it and select properties. You will find enable logging check box empty. See pic2I believe it should be possible to propagate this setting through all your endpoints using GPO instead of manually configuring each endpoint.KR,Luis",1,03-29-2022,03:08 PM
316,476304,uis,"Additionally in the registry we see that the enable value is 0 for the registry keyHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-DriverFrameworks-UserMode/OperationalChanging the value to 1 should also workKR,Luis",1,03-29-2022,03:19 PM
317,476304,KanwarSingh01,Hi @eluis and @jtaltonFor monitoring any new USB device it will be Event-ID 6416 but for monitoring removable media which is already registered by the system it will be 4719. So i guess a BIOC with a combination of 6416 and 4719 Event ID will help.,2,03-29-2022,04:20 PM
318,476304,micomi,Very interesting solution@eluis@jtaltonI'm referencing this Cortex XDR documentation:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/customiza...Will those Events (6416 & 4719) be collected automatically or would it be necessary to use the Broker VM to collect this additional IDs?,0,03-29-2022,11:15 PM
319,486891,bbarmanroy,"Hi@Eyyub_Alizadayou can use Security Settings to configure access restricted to users of an approved domain.The link to the setting is: Settings ->Configurations -> Security Settings -> Allowed Sessions.The default value is Disabled, change that to Enabled and enter the approved domain. Click Save on the bottom right and you should be able to enforce the restriction.",0,05-12-2022,06:58 PM
320,486111,KanwarSingh01,"@NathanBradleyThe below article can best explain you the logic behind all the ABIOC rules setup in Cortex.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...In general, informational alerts will only show up when an incident is triggered and get stitched with other alerts as part of insights in an incident to help better understand the incident.Speaking for myself, if we start investigating into informational alerts then we will end up chasing false positives but there might be cases where your investigation might lead to a possible suspicious activity.In order to find the suspicious activity you will first need to know some start point. For example:In this cases we are looking for a command called ""net user"" (we created a BIOC rule to detect this command as informational). So lets say the query returned a result from there on we dig into the causality chain and then click on the process itself and then see the activity for alert as informational. (Not the best way to look for informational alert but does the trick.) You can use a similar logic to find ABIOC informational alerts.Thank You.",0,05-11-2022,09:45 PM
321,486111,NathanBradley,Im looking for a way to either see the events that caused the analytic bioc to fireor a way to view the query behind the ruleFor example the rule below has 7 alerts,0,05-12-2022,07:05 AM
322,486175,mdb1998,We're getting the same type alert this morning on all our endpoints. We haven't determined what is causing it though.,0,05-10-2022,10:25 AM
323,486175,KMcKenna,We are seeing Cortex Behavioral Threat High Blocks related to Microsoft. Pretty much all end points. smss.exe .. a MSFT signed file is identified. Unclear what is the precise cause.,0,05-10-2022,10:42 AM
324,486175,mixzawa,Minor update my home office PC (Windows 100 Pro) now got the notification from XDR while at work we use Windows 10 Pro. Can never have a quiet day off can I? 😛,0,05-10-2022,10:46 AM
325,486175,as-mg,"Hi,We're seeing the same here as well. End users are shown no application name, but digging through the incidents in the console shows that it's killing of Smss.exe, which is the System Center Configuration Manager agent.All endpoints generating alerts are running 7.7.0.60725 here.Looking through the timeline there seems to be no evidence of foul play.",1,05-10-2022,11:09 AM
326,486175,KMcKenna,We are on 7.7.0 as well.Thanks for the comment,0,05-10-2022,11:12 AM
327,486175,as-mg,"This alert just trigged on my personal device when updating to content version 500-90199.Sooo... rollback, please?",0,05-10-2022,11:14 AM
328,486175,KMcKenna,We have a Support ticket opened (High Severity) and also are working with an inside (Palo) engineer associated with our Sales team. So hopefully we will learn more soon.,1,05-10-2022,11:20 AM
329,486175,as-mg,"@KMcKennaPlease let us know if they provide a workaround or a fix for the issue.Fingers crossed the update either get fixed or pulled tonight, so I won't have to deal with this when each endpoint boots tomorrow.",0,05-10-2022,11:48 AM
330,486175,KMcKenna,"Yes, absolutely.For reference, if anyone else opens a case, our Case # is 02191931.The rule triggering the alert is:Behavioral threat detected (rule: other.malware_gen_task.105)",0,05-10-2022,11:52 AM
331,486720,uis,"Hi @PierazzoDin this case, please feel free to open a TAC support case and be ready to provide support files. Agent releases and content releases... the more information you can give our support team, the betterKR,Luis",0,05-12-2022,06:27 AM
332,486720,WSeldenIII,"Hi@PierazzoD,The alert for the BTP rule mentioned above has been confirmed to be a false positive, and a fix has been implemented in content update version 510-90618. This content version was release on May 11, 2022 around 10:00 AM EST. Please ensure that you are enable configured to receive the latest content updates by reviewing the Agent Setting Profile - Content Configuration setting applied to your endpoints. If you experience any additional operational impact, then you may raise a support case to determine next steps.",0,05-12-2022,06:48 AM
333,485620,bbarmanroy,"Hi@MMenachem,Here's what I tried :Set up a HTTP CollectorI was able to send some data with Postman (see my configuration below)And using native curl (also generated from Postman):And with Powershell native requests (also generated from Postman):Here's the data when queried from XQL:I recommend you to review your configuration - I'd start with Postman and then build your use cases from there.The example curl command in the tenant is for Linux - the curl provided in Windows is actually a powershell cmdlet alias.",0,05-09-2022,09:45 PM
334,485650,uis,"Hi@Cyber1985you can go to the Incidents page, then to the alerts table there you can scroll to the right to see all the columns and fields populated, CGO (Causality Group Owner), paths, processes....If you click on the 3 dots menu at the top right corner of the alerts table you will see more columns and fields that are not shown by default. You can select them and incorporate them to your view.I believe that you'll find there all you'r looking for.I hope this helps.KR,LuisJust as an example:",0,05-09-2022,12:54 AM
335,485650,WSeldenIII,"Hi@Cyber1985It appears that you looking for guidance on how to investigate Analytics / Analytics BIOC alert sources. From the Alert Table, you may right-click to ""Investigate Causality Chain"" to view the event table. In this view and depending on the analytics alert type, then you may have host, endpoint connection status, IP, MAC, account of interest (E.g. Username), Parent process ID located at the top left-hand corner of the causality view. If you click the red icon in the view, then you can view context about the alert. If you hover you mouse over the related processes in the causality, then you can review process and analytics profiles information to support your investigation. If you click on the processes in the casualty view, then you will be presented with all applicable actions (E.g. Process, Network, File, Network Connections).In the alert table, then you can also leverage ""Pivot to View"" options to conduct additional analysis on user / asset in scope.",0,05-09-2022,11:52 AM
336,484451,bbucao,"Hi Michaelsysec242,You can do this by editing your alert notification forwarding rules, and on the summary page under ""Subject"" uncheck the box that says ""Use Auto Generated Subject"", then in the line underneath you can create a custom subject line that identifies the organization for each alert notification forwarding rule in each separate tenant.",0,05-03-2022,08:11 PM
337,484451,michaelsysec242,"Thanks for your response. Though this is an adequate solution and you can customize the Email Subject this is not the ultimate solution. Is it possible to have a customized subject alongside the auto generated one. From my experience from another Cortex Product XSOAR, you can use variables to render incident info on the subject line. Is this customization possible on XDR ?In any case I am going to accept your answer as the solution.",0,05-09-2022,12:37 AM
338,484451,bbucao,"Hi Michaelsysec242,Using variables to construct custom subject lines in the Notification forwarding policies is not currently a feature in XDR. If you would like to request this feature for consideration please contact a member of your account team to submit a Feature Request on your behalf!Thanks,Ben",1,05-09-2022,11:49 AM
339,483167,KanwarSingh01,"@fhu_omiWhat is the use cases behind this post?If I understand your question right you are looking to find the origin process which requested ""svchost.exe dnscache"" for a name resolution for a domain name?You are not interested in knowing the process which makes direct call to DnsQueryEx API, correct?",0,04-30-2022,07:46 AM
340,483167,hu_omi,"Hi @KanwarSingh01,The usecase is, that we saw on firewall dns request which where sinkholed. Now we need to know which process was the cause. We nailed it down to the svchost.exe dnscache, but we need process which made the dns request to svchost.exe dnscache. As i understand, if a process is programmed to use the api call DnsQueryEx, then is no svchost.exe involved and Cortex XDR is able to show direct the right process.Kind regardsFH",0,05-02-2022,10:54 PM
341,483167,KanwarSingh01,"Hi@fhu_omiDon't think so this is possible, cause the call to ""dnscache svchost.exe process"" relays the request on behalf of the process. But you can consider this to trace a process making calls to malicious domain.When a process which makes network comms to an external domain will lookup for ip address resolution via svchost.exe process and then DNS sinkhole will return a response if the IP is malicious with a sink hole IP, now we have an answer to a query which will be IP address aaa.bbb.ccc.ddd for example.Now, the process which asked for the lookup will get answer to the query via svchost.exe from Sink hole and then will start making network connection to the returned IP, from here what you can do is you can lookup for the process which is making IP address comms to your sink hole address via cortex queries etc and you will get your possible trace for the malicious DNS request.Please make sure your DNS Sinkhole return IP for malicious query should be a reachable IP address probably somewhere on network device or some server which points to a dead end but have ports such as 443,80,53,445 etc enabled. So that your network comms get a valid reply.These are just my thoughts. Please let me know, if that was helpful.Thank You.",0,05-02-2022,11:36 PM
342,438826,WSeldenIII,Hi@PeteJacobCFWindows 11 is not currentlysupportedwith the XDR agent.You may review the Palo Alto Networks Compatibility Matrix for updates on endpoint operating systems supported with Cortex XDR.,1,10-05-2021,08:27 AM
343,438826,AZelle,"Hi,Cortex XDR 7.5.1 on Windows 11 breaks DISM. No installations with DISM are possible if Cortex is enabled. DISM runs inHRESULT=80010111BRAndreas",1,10-29-2021,04:42 AM
344,438826,AriKukkonen,Cortex XDR 7.5.1 breaks Windows 11 snipping tool.,2,10-29-2021,09:35 AM
345,438826,WSeldenIII,"Hi,Windows 11 is not currentlysupportedwith the XDR agent.You may review thePalo Alto Networks Compatibility Matrixfor updates on endpoint operating systems supported with Cortex XDR. You may consider working with support in order to investigate these issues and determine any potential alternative solution.",1,10-29-2021,01:48 PM
346,438826,Thomas-Kiaer,"Hi,Cortex XDR 7.5.1 on Windows 11Microsoft Your Phone app is beeing closed down after 10 seconds, without any stamps in Cortex logs 😞if i uninstall cortex it works again.Picture above is shown in about 10 sec. at start and then it closes.",1,11-02-2021,10:54 PM
347,438826,uis,"Hi Thomas,please, just a kind reminder that cortex xdr is not supported on windows 11 so far, we support windows 10 though.Kind Regards,Luis",0,11-03-2021,05:20 AM
348,438826,moixsante,"Hi@PeteJacobCFCortex XDR agent 7.6, ETA release end of NOV-Early DEC will support Windows 11",4,11-09-2021,01:54 AM
349,438826,sschaupp,The Windows 11 snipping tool is still broken under Cortex XDR 7.6.0 (7.6.0.43032),2,11-17-2021,03:30 AM
350,438826,sschaupp,As well as under Cortex XDR 7.6.0 (7.6.0.43478),0,11-23-2021,02:48 AM
351,483246,bbarmanroy,"Hi@pdysart, you can create a support ticket and request for a support exception (SUEX) to increase the timeout for scheduled scans. You can import the SUEX to a Malware Profile applicable to those servers which need it.1. Create a clone of the existing Malware Profile applied to those endpoints.2. Import the SUEX to the Malware Profile.3. Create an static or dynamic endpoint group containing the only known set of servers.4. Create a policy that targets the endpoint group with the Malware Profile.That should resolve the timeout issue.",0,04-28-2022,08:23 PM
352,482612,bbarmanroy,Hi@PankajThakreyou can change managing servers from the Cortex Management console.Please follow the steps in sequence as specified in the documentation here for you to be able to migrate the managing server from the existing one to the one intended for your fleet. Please note that you need to have an administrator role as specified in Step3-substep2.,0,04-26-2022,06:36 PM
353,482612,ankajThakre,"Hi@bbarmanroy: That agent is not reporting to any console, but I can take remote of that system, hence we are struggling",0,04-26-2022,08:36 PM
354,482612,bbarmanroy,"Hi@PankajThakreas indicated in your screenshot, the endpoints are able to connect to a XDR tenant, but not the one you have access to.1. Is the tenant the endpoint is currently connecting to a test/trial environment that you had access to? That's the one you have grayed out in your screenshot.2. Do you have access to the tenant? You can reach out to your PANW account representative to know details about it. Since the endpoints are already connected to a tenant, it should still be active and the process to migrating endpoints from that tenant to the one you currently have access to should follow the steps that I have mentioned in the list I have mentioned in earlier post. Your account representative should be able to help you facilitate access to the trial/test tenant, or identify other employees in your organization who still have access to the Support Portal or Cortex Gateway to perform the migration action.3. If you've already explored point 2, talk to your account rep or Customer Success/Professional Services POC or via Support Portal to help you obtain a XDR Cleaner. With XDR Cleaner, you'll be able to uninstall the agent on the endpoints and then perform a fresh installation with an installer obtained from the tenant that you have access to. This is a last resort and should be explored only after you've exhausted option 2.",1,04-27-2022,01:13 AM
355,482612,ankajThakre,"@bbarmanroy: Let me open the case with customer support, as we don't have access to that tenant.Thanks for your suggestion 🙂",0,04-27-2022,09:06 PM
356,483034,uis,"Thanks@KanwarSingh01for sure it will be useful for many peopleKR,Luis",0,04-26-2022,11:58 PM
357,482180,KanwarSingh01,@Daniel_ItenbergIs the network connectivity on the endpoint working? Is it possible for you to upload the trapsd.log file?,0,04-24-2022,04:23 PM
358,482180,bbarmanroy,"Hi@Daniel_Itenbergthis is certainly not an expected behavior. Assuming that the endpoint is built with the same configurations as the rest of your fleet with identical network access permissions, the endpoint should be able to reach to all the URL's listed here.If this issue persists and/or if you are able to recreate the issue, please create a support ticket with the TSF and an extract of the alert data (see screenshot below on the retrieval process).",0,04-25-2022,05:54 PM
359,482180,uis,"Hi@Daniel_Itenbergplease also make sure that there is no exclusion created that prevents some or all alerts to be shown on your incidents.Ive seen a customer recently with the same issue and by mistake they created an exclusion with a too general filter that made alerts to be excluded, even they were still protected and malicous code blockedKR,Luis",0,04-26-2022,01:35 AM
360,482444,bbarmanroy,"Hi@RCDTI assume you are referring to the Analytics Alerts referred here.Once you have deployed Cortex XDR on your endpoints, you can enable XDR Analytics by referrring to Step 2- substep 3 here. Please take note that you need-2 weeks of EDR data from 30 endpoints deploying XDR Pro and enabling Enhanced Endpoint Data collection (Step 10 substep 2 here)- Cloud Audit logs for 5 days.In addition for Identity Analytics alert, you will need to enable that after installing Cloud Identity Engine (Step 2-substep 4 here).",0,04-25-2022,05:31 PM
361,482038,KanwarSingh01,"@SGarringerWhat cortex licenses version are you using? Seems Prevent.Can you take a look at the prevention folder in c:\ProgramData\Cyvera\Prevention Folders and look into the prevention alert which is generated around that time, this will give a little bit of more information for your investigation around the alert.According to me this alert triggers when you have a hash of a process which is similar to wscript.exe, cscript.exe, cmd.exe or powershell.exe (scripting engine process) but the ""process name"" is not a scripting engine process but has a same hash value. When triggered by a suspicious parent process as setup in PA Cortex defined rule set.hash of cmd.exe == hash of blahh.exe (Trigger Rule.) if the parent is x, y or z.exe (Something like this.)List of scripting engine:https://attack.mitre.org/techniques/T1059You will come to know more about the story when you take a look at the prevention alert data in the folder which i have mentioned.",2,04-23-2022,06:08 PM
362,482038,SGarringer,This was exactly the information we needed. In this case it was an SCCM folder that we needed to exclude as per best practices from Microsoft. We've done that now and hopefully that will resolve the issue. It's unfortunate that the file information doesn't flow back into Cortex XDR for easy viewing and instead we have to pull these files. I'm new to supporting Cortex XDR Protect so that's great to know about the additional info in those files.,0,04-25-2022,12:40 PM
363,481927,KanwarSingh01,"Is there anything common in your endpoints? Can you post a screenshot?If there is anything common try to filter the common attribute and once the endpoints show up post applying the filter, do not select any endpoint it will auto select all matching your filter rule and you should be fine there.Hope that helps?",1,04-23-2022,08:14 PM
364,481927,Elbedin,"Thanks, it solved my problem.",0,04-25-2022,02:32 AM
365,481715,KanwarSingh01,@rkaltenbachYou can achieve this by using the agent profile under Prevention settings for policy management:Policy Management > Prevention > Profile > Agent Profile > Response ActionsSupporting Documentation: https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/custo...Thanks.,0,04-21-2022,04:29 PM
366,481715,kaltenbach,"Yes, I'm aware of where the exceptions go... Curious as to what the community has put there. Intune seems to rely on services, which are not executables. I believe this is my biggest hang-up here. I'm also not finding any good logging as to what the endpoint is trying to use to access the internet while in isolation.",0,04-22-2022,08:10 AM
367,481843,uis,"Hi@Catalin_Butiseaca,I would recommand to check the followingare you admin when trying to install ? is your windows 2022 fully updated and patched ?if possitive on the former, please gather installations logs and fell free to open a TAC support caseHope this helps,KR,Luis",0,04-22-2022,03:17 AM
368,480700,KanwarSingh01,"@FidoPractically I think you should take defense in depth approach here and not just rely on Cortex XDR.> Ring fence server i.e. make sure you lock it down into its own network.> Monitor logons and expose what is required to the internet if a public facing internet.> Enable IPS system for network traffic. (Test first by enabling IDS before IPS)Apart from above, you should be able to get prevention on post exploitation activity with Cortex for un-known threats and as well for known threat.Example: A command interpreter process such as cmd.exe or powershell.exe spawn from w3wp.exeYou can also create your own detection which can help you detect threats related to your environment.What version of Cortex XDR are you looking to install?",0,04-19-2022,05:57 PM
369,480700,uis,"Hi@FidoI agree with what @KanwarSingh01suggests.You could develop some use cases and implement them through your own correlation rules, BIOCs, .... You could even ingest logs from your IIS6.1with Cortex XDR Collectors or Filebeat, parse them on XDR and from there you can be creative on what are your defensive goals (from which threats do you want to protect your web server)KR,Luis",0,04-19-2022,11:12 PM
370,480700,Fido,Thanks guys for the feedback.@KanwarSingh01We want to install Cortex XDR 7.7,0,04-20-2022,12:22 AM
371,480700,KanwarSingh01,You should be good here.,0,04-21-2022,03:37 PM
372,481508,bbarmanroy,"Hi@reg_naidu, by definition, a True Positive is when a behavior was correctly detected after it was performed.On the other hand, a False Positive is when a behavior that was not performed was detected.In this case, as the behavior was benign but was incorrectly categorized as malicious, this would be a False Positive.Do note that these are low severity Analytics alerts - you will need to take into account if the alert was due to the endpoint leveraging VPN or similar solutions that use different gateways for optimal connectivity etc. That is the reason why the severity is low.A low severity alert will not create an incident by itself, but will be stitched to an existing incident which would have medium/high sev alerts. You can also look at the corresponding Analytics alerts here.",1,04-20-2022,07:20 PM
373,479794,Rindsland,"We are seeing also a new Service with Name ""Cortex XDR Health helper"" which is set to Automatic but not started.This causes Issues with our Monitoring. Not sure if this service runs only from time to time and what is the purpose of that Service.(Even a restart of the Device, doesn't start the Service.)Seems to be something new with Agent 7.7.0.",1,04-12-2022,01:44 AM
374,479794,MarvinC,,0,04-12-2022,04:34 AM
375,479794,akash_chhetri,"Hi everyone,The product team has published the public documentation for the XDR Health Service.Please find the relevant links below:1. https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-7/cortex-xdr-agent-release-notes/cortex-xdr-ag...2. https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-7/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",3,04-14-2022,10:58 AM
376,479794,Dominic-Erni,Here are some additional infos about the behaviour of Cortex XDR Health Helper Service:Cortex XDR Health Helper service does not start after upgrade t... - Knowledge Base - Palo Alto Netw...,1,04-20-2022,08:01 AM
377,480865,Luc_Desaulniers,"Hello@PankajThakre,As far as I know, the way to do this is to have an XDR Pro license for your endpoints and have the Host Insights add-on.With that, you have the inventory of apps installed on each of your endpoints where the Cortex XDR agent is installed and has the Enable Host insights capabilities in your agent settings.You will then be able to access the inventory from the UI under Assets > Vulnerability Assessment > Host inventory > ApplicationsDirect link:https://<yourCortexTenant>.xdr.<countrycode>.paloaltonetworks.com/host-insights/apps/apps-onlyYou can also query the info with the following XQL query:*************************************dataset = host_inventory| arrayexpand applications| alter software = json_extract(applications, ""$.application_name""), install_date = json_extract(applications, ""$.install_date""), version = json_extract(applications, ""$.version"")| filter applications contains $Software| fields host_name, software, version, install_date*************************************$Software is a variable that if you save in your Query Library, it will ask you for the software that you want to search for. You can replace that with whatever you want to search for.Hope that helps.ThanksLD",1,04-19-2022,09:39 AM
378,480865,ankajThakre,"Hello LD,Thanks for the quick replyAlso I found a article where we can find software inventory information in the TSF logs of the individual agent. There is a file that is called ""InstalledAppsList.txt"" that is stored when downloading the TSF.RegardsPankaj Thakre",0,04-20-2022,01:19 AM
379,480713,akash_chhetri,"Hi Daniel,Indeed, you currently cannot add comments.If you think this would be a useful feature, you could request your associated Sales Engineer to raise a Feature Request indicating the use case of the feature. You can raise a support case for this as well.",1,04-20-2022,01:03 AM
380,480764,uis,"Hi@PeteJacobCF,Im not sure if your post is because your organization works with Spring Framework which is affected as you know by a recent reported vulnerability (see CVE-2022-22965for more information).If possitive to the former, we at PANW highly recommend to upgrade your spring framework to the release/s 5.3.18 and 5.2.20 and also your Cortex XDR agents to the latest release, and more specifically to release 7.7and content above470-88704.If somebody tries to exploit this vulnerability , it will be blocked by the Java Deserialization Exploit protection module, which will be active if you enable Known Vulnerable Processes Protection at the Linux Exploit Security profile.Please check that ""Known Vulnerable Processes Protection"" module is set to block, so that exploitation attempt is blocked and you will get an alert of the type Suspicious Input Deserialization.Hope this helps,Luis",0,04-18-2022,10:52 AM
381,480764,teJacobCF,"@eluisthanks for the reply back man! I was just thinking that if its an available option now for windows if it would be good to enable it... I have read up on what it is but don't really understand fully what it is and what it does. I think for now I will just work on the ""OpenSSL Infinite Loop Vulnerability"" and put this on the back burner.",0,04-19-2022,04:46 PM
382,480764,KanwarSingh01,"@PeteJacobCFIf you have Java application using spring framework, i would assume it will be good to turn on this policy on your test system and work from there to implement to your live systems.",0,04-19-2022,05:37 PM
383,480820,KanwarSingh01,@PankajThakreWhat is the alert description for an incident and can you post the logs if possible?,0,04-19-2022,05:29 PM
384,480869,Luc_Desaulniers,"Hello@mgussoni,Here's my two cents.A couple of things that I believe you should consider when whitelisting.Try to see whitelisting as a last resort, this will keep your organization safer and will slowly enforce better security practice from product development team you deal with.Depending on which module is triggering the detection, the course of action could differ. Example, if Wildfire is doing the detection and you know the product is legitimate and isn't malicious/suspicious, you can challenge the verdict on the file and Palo Alto will usually change it if they agree with your suggestion in a couple of days. Now when the hash of the file changes, it most likely will match on the same detections on Wildfire unless it is a really popular product and PA adjusts their detections to tailor them to this product.Usually what I would recommend is to try to have the detection resolved by the product vendor if time permits, recommending to properly sign with a trusted public SA if possible. If it is still detecting once the file signature is legitimate, then you can open a support case for Palo Alto to try to address part of a support exclusion or part of a content update push.If you need to whitelist, I would recommend the hash approach over the files/folder approach considering that if someone knows that your clients have an exclusion in place for a specific folder/file path, they could leverage it for malicious activities.Hash approach will indeed require you to whitelist it again when the hash of the file changes with updates but it is a more secure approach.Thank you",1,04-19-2022,09:20 AM
385,480869,uis,"My cent contribution:Once you know the signature of your legit software. You can add this signer as a trusted signer.KR ,Luis",1,04-19-2022,12:50 PM
386,477713,jcandelaria,"@denis.wongDefinitely support is the way to go so it can be track for investigation and enhancement if possible.Unfortunately, you need to have a standard support account, please reach out to your account super user/admin so you can be added to the account.",0,04-03-2022,09:13 PM
387,477713,bbarmanroy,"This appears to be a known issue for certain Mac OSX endpoints and the issue seems to be a bug in OSX. Once you raise a support ticket, you should receive a support exception for OSX profiles. Your XDR administrator should apply that to the corresponding Mac OSX exceptions security profile for it to solve the issue on a tactical standpoint.",1,04-07-2022,11:01 PM
388,477713,akash_chhetri,"Hi Everyone, an update to what@bbarmanroysaid.This indeed appears to be a known issue caused due to Apple's framework bug found in MacOS systems 10.15 and later.Since the bug is in Apple's framework, the issue can only be fixed by Apple but we have a workaround for Cortex XDR. Agent versions 7.7 and later with Content Version 450 and later should be able to mitigate these issues.Nevertheless, if this does not resolve the issue, please open a support ticket for a thorough analysis of the issue.",0,04-14-2022,05:53 PM
389,477713,denis.wong,Thanks for this update! I can now confirm the issue has been resolved.,1,04-19-2022,11:38 AM
390,477713,akash_chhetri,Happy to help! 🙂,0,04-19-2022,11:48 AM
391,474836,MarvinC,,1,03-21-2022,08:24 PM
392,474836,Balaraju,Thanks . How is full system scan initiated from console different from a 'all drives' scan executed from agent ?,0,04-19-2022,03:30 AM
393,479429,Cyber1985,"The two data sources deliver completly other results:preset = xdr_agent_network | filter action_remote_ip = ""185.x.x.x""preset = network_story | filter action_remote_ip = ""185.x.x.x""Will there be a possibility to move the informations from XDR_AGENT_NETWORK to NETWORK_STORY?",0,04-09-2022,12:19 PM
394,479429,Cyber1985,"Am I right? PA will take this useful feautre away, because they wan't to sell us a firewall? We allready have a firewall and we just need this information, which is shown in thexdr_agent_network preset.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-release-notes/release-information/fea...",0,04-09-2022,02:29 PM
395,479429,KanwarSingh01,@RFeyertagPlease see if the below XQL helps your case? Please replace the necessary fields as per your requirements.,0,04-12-2022,10:18 PM
396,479429,RFeyertag,Hello to ALL!I found the mistake.It was my fault. I didn't check the period in the top right corner when writing the query *shame on me*The network_story works like the agent_network_story!Thanks you very much for the help!BRRob,0,04-15-2022,05:33 AM
397,479147,bbarmanroy,Hi@AHECSupportyes you can! This is listed in Cortex XDR Tech Docshttps://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...,2,04-07-2022,06:35 PM
398,479147,shawn_south,"We run Cortex on all of our core servers, and it works exactly as it should.",0,04-14-2022,09:31 AM
399,478551,bbarmanroy,Hi @KanwarSingh01I am looking into this and will get back to you.,0,04-06-2022,06:17 PM
400,478551,bbarmanroy,"Hi@KanwarSingh01this certificate might be in use for some older agent versions. YThe newer agents do not use these. In any case, the documentation is in the process of being updated to reflect the changes.",0,04-07-2022,10:27 PM
401,478551,bbarmanroy,Hi@KanwarSingh01the documentation has been updated - please see Step 3. Thank you for bringing this to our attention.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/get-started-with-cortex...,0,04-13-2022,05:26 PM
402,458967,bbarmanroy,Hi@GarethDaviesDoes the query below aid you?,1,01-16-2022,06:37 PM
403,458967,GarethDavies,"Hello Thank youthat solution will work and gives me the raw output that I can investigate further , I see I can add more fields that I may want in the last line",0,01-17-2022,12:17 PM
404,458967,huwang,"Hi Bbarmanroy，thank you for sharing. I try to output more fields, such as the application version, but it doesn't work. Look forward to your suggestions.config case_sensitive = false timeframe=365d| dataset = host_inventory| filter applications != null| arrayexpand applications| alter applications=json_extract(applications, ""$.application_name"")| alter version=json_extract(applications, ""$.raw_version"")|fields applications, ip_addresses, host_name, version",0,04-12-2022,08:28 PM
405,458967,bbarmanroy,Hi@huwanguse version instead of raw_version.,0,04-12-2022,08:59 PM
406,460517,slick,"At this time, PM is not considering plans for DLP integrated into Cortex XDR.",1,04-11-2022,02:20 PM
407,436886,malalade,"Please check out1. XQL Query library: you can search for ""upload"" to see all related queries like Large FTP Sessions, Curl uploading more than 1MB etc2. XDR Analytics currently do large uploads computation if there is applicable data. It triggers whenendpoint transferred an excessive amount of data to an unpopular destination.Please check-out:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...You can get more interesting data if you have enhanced application logging from NGFW. Sample fields (like session upload) from the session detail is attached.",1,09-27-2021,11:58 AM
408,436886,Luc_Desaulniers,"Hi Malalade,Thank you for the info, but this doesn't really answer my question which is how can you identify what data was uploaded.Let me know if you can think of anything. Right now I go with file reads from the process generating the large upload, but this is far from a 100% science, was wondering if others figured out other more efficient ways.ThanksLuc",0,09-27-2021,02:32 PM
409,436886,MrDuck,Were you able to find a solution? Having a similar issue where I want to pull all large file uploads,0,04-08-2022,10:37 AM
410,436886,uis,"Hi @MrDuck,@Luc_Desaulnierswhat @malaladeanswered with he links to the alerts is how you will see the uploads and be able to identify which uploads were those since this information will be in the alerts and incidents created.KR,Luis",0,04-11-2022,02:23 AM
411,475966,KanwarSingh01,"I personally feel that it wont be a valid test to test Cortex XDR with the methodology used on TPSC. I have seen videos of other AV vendors on that Youtube channel too, I think TPSC test can be valid for signature based AVs more.",0,03-27-2022,03:35 PM
412,475966,Cyber1985,Thank you @KanwarSingh01.The question was ist we are allowed to go to public with a pentest and its results?BRRob,0,04-10-2022,12:59 AM
413,475966,bbarmanroy,"Hi@Cyber1985Palo Alto Networks has a coordinated vulnerability disclosure process. You can report any vulnerabilities either through your SE/CS teams, or through the portal athttps://security.paloaltonetworks.com/report.",1,04-10-2022,09:35 PM
414,475966,Cyber1985,Thank you! That is exactly what I needed to know.BRRob,0,04-10-2022,10:50 PM
415,475967,uis,"About the threat intelligence feed, Im not sure of what is your purpose uploading the to cortex. We already work with thousands of TI entries that we use in our detection infrastructure (including wildfire)KR,Luis",0,03-27-2022,02:18 PM
416,475967,Cyber1985,"My purpose is, we know if our mobile workers creates a ip block. This ip-feed takes about 900k lines of bad ip-adresses and would be a good thing to protect our employees. The xdr network agent would inform us, when there was a connection.Other NDR vendors allready have implemented this.BRRob",0,04-10-2022,01:11 AM
417,479226,bbarmanroy,"This looks like a bug. Can you please raise a support ticket with the screenshot and an alert dump of one alert where you're seeing this behavior? You can retrieve the alert dump by right-clicking on an alert, Retrieve Additional Data -> Retrieve Alert Data.",1,04-08-2022,01:31 AM
418,478615,bbarmanroy,Hi@SeanDeHarrisyou can consider leveraging on MDM controls to disable bluetooth on endpoints.,0,04-06-2022,06:29 PM
419,478615,SeanDeHarris,"Thanks for your sharing.I did some testing with the GUID, the Bluetooth devices will be blocked either by the Class GUID for Network Adaptor or Bluetooth level.Network Adaptor (Bluetooth device PAN){4d36e972-e325-11ce-bfc1-08002be10318}Bluetooth{e0cbf06c-cd8b-4647-bb8a-263b43f0f974}With the class GUID of Bluetooth device, it will block everything bluetoothish, eg built-in Windows bluetooth services, headset, mouse...Seems cannot block individual bluetooth headset.",0,04-06-2022,09:26 PM
420,478615,uis,"Hi@SeanDeHarrisevery single device should have a unique number for identifying it, try to investigate which one is yours.This number appears an registry keys once you plug it in on a windows systemthe same with bluetooth or any other device connected. Otherwise the OS wont be able to handle it.This unique identifiers are used as evidences in courts of law when performing forensics and they all leave traces in registry keys",0,04-07-2022,01:15 AM
421,478761,KanwarSingh01,I am not aware of any built-in utility in XDR agent or cloud console but you can do the following:There are multiple types of alerts which can be created by yourself:The easiest way could be as simple as deleting shadow copies of your system where the agent is installed.Please note: The above command will delete your Shadow Copies on your endpoint and generate a BIOC detection alert.,1,04-06-2022,05:06 PM
422,478761,bbarmanroy,"Hi@DanielMasseplease use the Windows PE malware file found here:https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/submit-files-for-wildfire-analysis/ver....Once you execute the file, you'll get a notification on the agent as well as in XDR console.",1,04-06-2022,06:25 PM
423,477735,bbarmanroy,"Hi@KanwarSingh01Cortex XDR uses several protection modules both on the agent as well as on the tenant-side, including integrations with Wildfire as well as other integrations (e.g. VirusTotal) that you may have added to your tenant. They range from behavioral techniques (BTPs/BIOCs), ML models, malware and exploit protection modules, YARA signatures, sandboxes, local analysis etc. These protection modules are both pre-execution and post-execution in nature, as well as both detective/preventative in nature.Customers are not able to tune YARA rules in XDR as that is entirely evolving in the backend and is managed by dedicated Threat Hunters, malware researchers and exploit researchers.Lastly, your tenant modules are seamlessly upgraded to respond to evolving threats and attacks as observed by the relevant domain experts. On the agent side, please ensure that the CU's are rolled out ASAP while being inline with your organizational security policies. The agents themselves should also be regularly updated to address the vulnerabilities/capability improvements that are packaged with each new minor/maintenance release.Please go through this article that talks about XDR's capabilities with recent malware in-the-wild that touches upon the various levels of protection within XDR.",0,04-04-2022,06:42 PM
424,477735,KanwarSingh01,Thanks@bbarmanroy are there any plans of integrating Custom Yara Rules in the future?,0,04-05-2022,01:30 PM
425,477735,bbarmanroy,"We are discussing this internally to see what can be done. On a tactical basis, if you're having any issues with any detections, please raise a support ticket.",0,04-05-2022,07:07 PM
426,477735,KanwarSingh01,Not having issues just questions.Thank you.,0,04-05-2022,10:25 PM
427,477730,bbarmanroy,"Hi@DanielMassethere are no changes to API key usage within XDR. API keys are managed by Cortex XDR, while admin passwords are managed by PANW Support Portal.",1,04-04-2022,06:25 PM
428,477745,uis,"Hi @Daniel_Itenberg,have you thought of adding the signer as a trusted signer ? this will not take into account the hash. This is useful also for drivers from specific vendors that sign their software.Please check this doc on how to do it at the malware profile:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/endpo...I wont recommend much to add a whole folder to the allow list since malicious actors might drop their malware there and go undetected.If hash and trusted signer do not work either of them, open a TAC support case to get a suex.Hope this helpsKR,Luis",0,04-03-2022,07:55 AM
429,477745,Daniel_Itenberg,"What if the signature filed says ""invalid signature""?",0,04-04-2022,02:11 AM
430,477745,uis,"Hi@Daniel_Itenberg,I would open a TAC support case to see what is the issue here. Our TAC engineers will provide you help on thisKR,Luis",0,04-04-2022,03:10 AM
431,477745,MartinPfeil,"If the file is always in the same location you can create a malware profile and exclude this location from scanning.That is the easiest solution, as chaning hashes will invalidate the entires in the allow list",1,04-04-2022,07:36 AM
432,339318,dfalcon,"Hi @SimonTan-Just curious, did you try to run these binaries or leverage a scan. What enforcement did you specify in your profiles / policy rules? On the malware side there are several checks:WildFirefor unknown, the local analysis should do the examination at the point of execution.In addition to the malware prevention, Cortex XDR includes behavior threat protection, anti-ransomware, password theft protection, child process protection, and approximately 30 ways to exploitation.If you are using a scan for dormant malware, it is not the same as having all of the different protection levels that are leveraged during point of execution. Are you able to share any hash / artifact info for verification?",1,07-17-2020,03:13 PM
433,339318,dfalcon,"Hi@SimonTan-I would actually be happy to set up a Zoom with you to look over your configuration. Based on your screenshot from MB, I believe that you may not have Cortex XDR configured to your needs. For instance, in your screenshot, I see a large number of Potentially Unwanted Applications. These are not malware. Cortex XDR can be configured to treat these the same as malware. On the malware side, I'd be very interested in checking into these as well.Please let me know if you would like to set up a session.",0,07-21-2020,08:50 AM
434,339318,SimonTan,how to retrieve a support file and malware scan log?,0,07-21-2020,10:17 AM
435,339318,dfalcon,"Right click on that entry and select Additional Data.Once in the details screen, right click on the entry in the list to download the TSF.",0,07-21-2020,12:26 PM
436,339318,dfalcon,"On the malware scan log. Same thing. Right click on the entry within the All Actions interface and select additional data.From there, locate the entry, right-click and select View Related Alerts.",0,07-21-2020,12:28 PM
437,339318,SimonTan,"got it, send file to the tech and see what they say.",0,07-21-2020,12:48 PM
438,339318,Balaraju,"Hello , Is there any document or link which can summarise all the protection capabilities of Cortex XDR ? There seem to be many modules/techniques but what is lacking is not all are listed at one place and its difficult to understand how it all works in real world and deliver protection , so list all protection capabilities/modules and give a brief of what each of them achieve .",0,03-18-2022,10:16 AM
439,339318,kcross,Please take a look at:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...andhttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...Let me know if this helps.,1,03-18-2022,10:38 AM
440,339318,Balaraju,"Thanks for quick reply , I will refer this surely .",0,03-18-2022,10:49 AM
441,473394,MarvinC,"Hi@chukaokonkwo,Hope this will be relevant to what you are looking for.These are PA Malware Test File.https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-admin/submit-files-for-wildfire-analysis/ver...When I tested this before, this will just trigger WF alerts.If you are looking in particular like sample malware that trigger BTPs maybe opening a ticket to the support team can help you with this.",0,03-15-2022,04:00 PM
442,473394,uis,"Hi Chukaokonkwo,additionally to my colleague's link with WF trigerring malware. I would recomend you to install SANS malware analysis and reverse engineering tranining samples on a ""Virtual Machine"" (because this is real malware) and test it under a closed and controlled environment where you can play with CXDR agent and real malicious stuff. Ive done this before and even tested Forensic Module to see the traces from artifacts and evidences on prefetches, registry to gain persistance ....I cant remember now a website where you could download even ransomware samples like wannacry, NOT-Petya... and play with it to see that our agents will block itAnyways if you find another interesting samples feel free to share here with the community.And watch out, always test on a closed VM to not to damage any real asset in productionKR,Luis",0,03-16-2022,02:23 AM
443,473394,KanwarSingh01,"@chukaokonkwo@eluisIf you would like to simulate a fake attack and use free of cost tool. Please check out Infection Monkeyhttps://www.guardicore.com/infectionmonkey/This should definitely trigger Cortex XDR (Red, Yellow, Blue and Grey)If you would like to fetch some real stuff, you can use URLHaus and browse to malware links which are tagged with Office Doc Tags such as xlsx, docx etc and download, run it in a controlled environment away from production systems or any critical system.Note: I would personally recommend not to take this route as you will be exposing yourself to real Threat Actors if corrective measures are not taken by yourself.",0,04-02-2022,01:21 PM
444,473394,uis,Thanks@KanwarSingh01 !!! it all adds up,0,04-03-2022,07:58 AM
445,474639,WSeldenIII,"Hi@OsamaKhan,you have ability to convert your eval license to a production license in order to continue operations. You will need to coordinate with your account team to determine the applicable Cortex XDR license type. You will also want to ensure that you are tracking the Cortex XDR license expiration date, and aware of the expected behavior.",0,03-21-2022,01:31 PM
446,474639,Luc_Desaulniers,There should be no need to re-install for going from eval to purchased license.One thing you might want to ask your account team is to make sure that the environment is properly scoped in terms of resource capacity as I've seen in the past customers that went from eval to licensed tenant run into capacity issues because the eval tenant aren't scope with as much firepower as fully licensed tenant.,0,03-31-2022,09:36 AM
447,474639,uis,"Hi @Luc_Desaulniers,Ive seen some issues when moving from evalutation license to production when forgetting to change the testing/POC CDL license with 5TB storage to the license they actually paid for (120TB)So keep an eye to migrate/setup new licenses appropriatelyKR,eLuis",0,03-31-2022,04:40 PM
448,439754,blebail,"Hi,Please reach out to your Cortex SE. we can’t share roadmap information here.ThanksRegards,",0,10-08-2021,11:50 AM
449,439754,RSteffens,I also need Cortex XDR for iOS/iPadOS BADLY. I'm having to look at other competitors simply because Cortex is not available for iOS or iPadOS. ,1,01-10-2022,10:01 AM
450,439754,DustinReed,looks like they are trying...Palo Alto Networks iOS Developer (Cortex XDR) | SmartRecruiters,0,03-31-2022,12:39 PM
451,439754,RSteffens,Great to hear! Do you have any further details? Any ETA?,0,03-31-2022,03:18 PM
452,439754,DustinReed,"No, I was just googling the same thing, this was the first result and the job req was the next. We are currently using defender for mobile because it is free with our subscription, but it isn't great. I have an email out to my SE to get more details.",0,03-31-2022,03:26 PM
453,361587,dfalcon,"Hi@Abdul_Razaq-You can set the quota allowance within the agent profile. Once the quota is reached, it is first in - first out.",1,11-19-2020,07:20 PM
454,361587,MohanKumar1,"Same issue, I can see ~40GB is full with xdr logs. But, rather limiting quota; should be technical reason why there are filling so fast.",0,12-29-2021,11:46 PM
455,361587,NCherbib,"hello,same issuehappened to me, the file size attempt 40Go, but le size is limited to 5Go",0,03-31-2022,03:13 AM
456,361587,tugriceri,Im gonna recommend open a TAC case for this. Default quota is 5 Gigabyte (Max 10) and should not spend more than this. Should be investigated by TAC engineer.,0,03-31-2022,03:22 AM
457,476289,KanwarSingh01,"Hi @Seka ,If i guess your agents are not able to check-in to cloud console,I think you will have to use a 3rd party tool here. We use 3rd party tool to check on services of Cortex XDR if it is running or not.Or probably you can use the below command and loop over your endpoint list:wmic /node:""you-pc"" service list brief | findstr cyserverThe above command wont be useful if the endpoints are not on domain and also where IP connectivity is limited.",0,03-28-2022,04:57 PM
458,476289,bbarmanroy,"Hi@Sekaif your endpoint is not connected, run the following commands to identify if XDR is running.cytool runtime queryEnsure your endpoint agent has access to internet (host firewalls, perimeter firewalls, corporate proxies etc.). Check if this is an isolated incident with one endpoint/few endpoints or if it is happening with all endpoints in your estate.Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-6/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",1,03-29-2022,01:41 AM
459,476289,uis,"Hi@Seka,if with the command that @bbarmanroy provided you see that services are not running, please try the following in your non connected endpoint and as admin user:C:\Program Files\Palo Alto Networks\Traps\cytool.exe runtime startThat should start the services/xdr processes and if it doesn't, it will give you an error or some clue of what might be going on at your endpoint.If this command does not get your xdr services/processes up and running and/or if your agent is not able to do the checkin, please open a TAC support case and our TAC engineers will help you further.You can also try to force the checkin (once your xdr processes are running) with cytool.exe checkinMake sure that your endpoint is not network-isolated so it can reach the tenant. That might be another issueKR,Luis",0,03-29-2022,03:06 AM
460,476289,Seka,"thank you for your reply , i will try it and get you back",0,03-30-2022,08:21 AM
461,476289,Seka,"hi ,thank you for you reply , please see in attachment the screenshot on cytool runtime query command",0,03-30-2022,08:26 AM
462,476289,uis,"Hi@Sekaplease check that the following existsC:\Windows\System32\drivers\telam.sysIf it doesnt exist open a TAC support ticketIf it exists, typeC:\Program Files\Palo Alto Networks\Traps>sc config telam start= bootC:\Program Files\Palo Alto Networks\Traps>cytool runtime startcheck that everything is runing with cytool runtime queryIf not running reboot and check again with cytool if the telam is running (as well as the other processes). For the sc config command you will need the supervisor pass (the same as the uninstall pass)If it doesnt work please open a TAC support ticket.Please let me know if this happened after trying to upgrade and having it failed ?KR,Luis",1,03-30-2022,09:02 AM
463,476916,uis,"Hi @Balaraju,you can open a terminal on the Broker VM and type# uname -aThis will give you the kernel versionIf you want to check the OS release# cat /etc/os-releaseKR,Luis",1,03-30-2022,08:49 AM
464,476916,Balaraju,Thanks a lot for quick response . Thanks again .,1,03-30-2022,08:55 AM
465,472195,bbarmanroy,"Hi@KanwarSingh01as it is an uninstaller, it will cause the monitoring to stop immediately by killing running processes, and then remove the files/directories. You receive XDR Cleaner on-demand as a break-glass procedure, so its usage and distribution should be monitored.",0,03-10-2022,10:40 PM
466,472195,KanwarSingh01,"How would you monitor? Will you be using XDR and create a BIOC detection rule? If this will be the approach then you would need data to be shipped for the alert to be fired on the XDR console, isnt it?",0,03-27-2022,02:37 PM
467,472195,bbarmanroy,"When I referred to as 'its usage and distribution should be monitored', I mean that your organization should have tight controls on who should have access to XDRCleaner. The usage of XDRCleaner is for removing Cortex XDR from the endpoints when the agent cannot be removed using the console (for reasons). The XDRCleaner agent should not be used as part of your standard operating procedures where end-users are expected to be in charge of removing endpoint security products. If this is the norm, please review this with your leadership to identify potential misuse and abuse cases, and the ramifications it might have on your organizational assets and IP.",1,03-28-2022,01:28 AM
468,472195,KanwarSingh01,I think in some orgs the processes are not there to control who does what with a software. I think if PA can create a logic where before erasing traces of Cortex with XDR Cleaner it should be able to write to some place on system itself referencing XDR Cleaner was used OR send data to data lake for a XDR console from there a BIOC alert can be created to detect any malicious usage of XDR cleaner.Threat actors do look for uninstall software for Security solution for defense evasion.,1,03-28-2022,02:24 PM
469,472195,uis,"Agree with@bbarmanroy, if you provide the agent cleaner to your users, it would be better to keep an eye on who has it and how are they using it.As with any other security product, if users have access to uninstall them this should be monitored. Doesnt matter if it is a McAfee, Kaspersky, Windows Defender deactivation or even a FW might be shutdown or configuration changed if given access to do so.When uninstalling xdr, you will notice that the endpoint will appear as disconnected during some days and later it will completely dissapear.With any other antivirus you wont get any alert if a user dissapears otherwise you would have thousands of false possitives when a user shutdown computer or goes on holidays ...Something you might do depending on the license you have and if you have Broker VM deployed in your set up is to1- Activate the Network Mapper so you can scan your network to identify unmanaged hosts in your environment that will appear in the asset table. You need CXDR pro per EP or CXDR pro per TB license for this.2- Activate pathfinder (same licenses as before): This will deploy a non-persistent data collector on unmanaged hosts (that is, where you dont have CXDR agents installed) so that whenever an Analytics medium or high severity alert is raised, this paathfinder collector will be triggered to collect EDR data from your unmanaged hostsBroker VM, Network Mapper and Pathfinder are optional AND highly recommended to be deployed within your CXDR environment.Have a good CXDR time and if this was helpful, please rate and thumbs up, like itKR,Luis",0,03-29-2022,12:18 PM
470,472195,umbach,"1.With any other antivirus you wont get any alert if a user dissapears otherwise you would have thousands of false possitives when a user shutdown computer or goes on holidays ...Maybe I'm misunderstanding but that's really not the case we get alerts when any part of windows is disabled shutdown or not, we just filter out those services when next to a shutdown event. Nor is any of this finger pointing productive.@KanwarSingh01: You can setup a simple IOC to alert you when the XDR Clearer is utilized. The SHA and/or the filename can be used as each version is different depending on the agent. As soon as the cleaner is Dropped on the device's HD and executed this can be alerted on in the functional situation you are referencing. If the Agent is truly offline then you will not be able to monitor it's use without external tools like Sysmon / Windows Event logging.",0,03-29-2022,03:34 PM
471,472195,uis,"@KanwarSingh01Some malware modules are able to detect which AV solution you have running and are able to disable it, no need to run the Antivirus Uninstall.Checking just the execution of a hash (for the cleaner) is not either a solution. A botch job will give you a fake feeling of safety, since changing a hash is child's play about as easy as renaming a file. That is the reason why even we at xdr use hashes we do not totally rely on them, we do behavioral analytics and ML to spot the malicious.Skilled attackers are not going to use known hashes or file names. That is why when having an AV just based on hash/signature wont protect you from real threats, but just from script kiddies and naive testers.The use of Network Mapper and Path Finder will help you in cases where an insider or external attacker might be able to disable Cortex, with the cleaner (remember we do also have anti-tampering to protect our xdr)A complementary tool might be implementing a NAC solution to monitor your endpoints so that when an endpoint do not comply with your policies , for example the AV or CXDR or any other security software is uninstalled/missing, the endpoint is isolated and reported.Hope this helps,Luis",1,03-29-2022,04:28 PM
472,472195,KanwarSingh01,"@eluisYour comment:""A complementary tool might be implementing a NAC solution to monitor your endpoints so that when an endpoint do not comply with your policies , for example the AV or CXDR or any other security software is uninstalled/missing, the endpoint is isolated and reported. ""Is probably the requirement however we do not have one. In my mind i am guessing it will be a combination of some detection rules and analytical hunting of suspicious usage of XDR cleaner.My scenario for asking this question is as below:Valid Credential Compromise of an Admin > Access to IT tool kit > Execute XDR Cleaner > Boom!! (No AV and telemetry, domain compromise, no need to use a malware or anything just use same tool sets what Sysadmins use.)",1,03-29-2022,04:56 PM
473,472195,umbach,"""..That is the reason why even we at xdr use hashes we do not totally rely on them, we do behavioral analytics and ML to spot the malicious....""And yet the number one solution on the Live community forms for tuning is to whitelist/blocks list by hash.... you can't have it both ways. It's either a solution or it isn't.",0,03-29-2022,05:26 PM
474,476892,uis,"Hi@IREPhil,you can forward your notifications to syslog receiver, email, or even slack. Please check the following doc on how to do ithttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/logs/create-notificationsSo you need also this doc to configure it:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/logs/integrate-a-syslog-rec...Additionally you can use API, please check the following doc:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-api/cortex-xdr-apis/incident-manageme...The difference is that you can be more granular/selective via API and might more informative sending the alerts/incidents than just a notification. Depends on your scenario/use case.Please if this was helpful feel free to like, rate it or mark it as a solution.KR,Luis",0,03-30-2022,07:01 AM
475,473396,bbucao,"HiChukaokonkwo,There are a variety of tuning options within XDR to help reduce False Positives and any adverse impact to normal operations. You can add the sha256 file hash of the application to the allow list located in the Action Center which will allow the applications to execute and therefore override the Wildfire verdict. Within the Malware profile itself you are able to allow PE's and DLL's to run based off of a list of approved signers, or by adding file/folder paths into the allow list for that module. Reference step 3 sub steps 3 and 4 in the documentation linked below for instructions on how to accomplish this.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...Best Regards,Ben",0,03-15-2022,03:56 PM
476,473396,bbarmanroy,"Hi@chukaokonkwoto add on to what@bbucaosuggested for tactical fixes, you should also raise a Verdict Change Request within Cortex XDR console or raise a Support ticket with the hash/sample for a systemic fix. The Wildfire verdicts should reflect the nature of the applications being run.",0,03-15-2022,06:30 PM
477,473396,MartinPfeil,"Unfortunatly Wildfire produces a lot of false positives, we have to unblock and whitelist Cygwin binaries in regular intervals. Of course, I report the incorrect verdict to PA and it is reversed in a short time. But that doesn't help with binaries blocked initally using an incorrect verdict. Apart from adding known hashes to the whitelist, the only workable solution I found out is to exclude known folders from being scanned. Of course, this is not very secure and has it's own issue but it allows our developers to continue with their business",0,03-16-2022,03:40 AM
478,473396,chukaokonkwo,"Wow, so this high rate of false positives cannot be tweaked from the Palo Alto side of the house huh?? ...you're literally limited to having to create exceptions for the legitimate hashes one-at-a-time?",0,03-16-2022,08:12 AM
479,473396,bbucao,"Hi Chukaokonkwo,The Wildfire malware team is constantly working to keep up with evolving threats while maintaining a high fidelity rate. The risk of false negatives is generally viewed as more dangerous to an organization than the risk of false positives. Custom applications can at times cause Wildfire (or any sandbox) to flag as malware due to the behavior of the application if it resembles behavior patterns commonly seen in malware. As rare as these false positives may be on a large scale, I understand that it can be frustrating to deal with when they are affecting your organization. For that reason Cortex XDR offers a variety of ways to handle these. If handling these individually by either submitting Verdict Change Requests or adding to a sha256 hash allow list is not feasible or desirable, consider adding the digital signature of your organizations custom applications to the malware profiles allow list, that way any application that is signed by your organization will not be prevented from running by Wildfire. Best Regards,Ben",0,03-16-2022,08:58 AM
480,473396,umbach,"Yep we currently have over 2100 ""Allowed"" hashes (growing 300+ a month) and had to drag our dev team kicking and screaming to sign every tiny little application across the entire environment. And still get about 700 LC alerts a week.",0,03-29-2022,03:49 PM
481,476118,MarvinC,"Hi@RahulPrajapati,With Cortex XDR protection process on attaching its protection during write/create/read, I think this is not currently possible.What you can do is to add it the hash on block list and Cortex XDR will block during execution and upon scan.",0,03-27-2022,10:47 PM
482,476118,RahulPrajapati,"Hi@MarvinC,Thanks for your response !",0,03-28-2022,06:46 AM
483,476118,KanwarSingh01,"Just to add on what @MarvinC suggested. You can create a BIOC rule which can alert on file write operation of the desired applications. Please note file write/create operation via BIOC will be a ""detection rule"" which will trigger an alert in the alerts table if the severity is Low for a detection rule.",0,03-28-2022,04:48 PM
484,475968,bbarmanroy,"XDR uploads hashes to VT. If you have a free VT license, you'll be limited to the restrictions of a free API key.",1,03-28-2022,01:33 AM
485,476143,bbarmanroy,"Hi@RichardRosalesVthis is a very broad topic to be discussed in a forum.I would recommend you start by completing the Beacon training for Cortex XDR. Once done, you can start looking at how to manage incidents and alerts for your tenant. Review your endpoint policies and profiles on a regular basis and see what needs to be fine-tuned on an ongoing basis. Create dashboards for your analysts and senior management for them to review Cortex XDR fleet review.",0,03-28-2022,01:21 AM
486,476044,uis,"Hi@paloalto_mpdanswering your questions.Yes it is safe to install cortex xdrYou can install xdr in VMs, and on premise endpoints, kubernetes.... so you can have your cloud also protected. If I understood you properlyFor the architecture check this doc:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/cortex-xdr-overview/cortex-...Basically our xdr tenant in the cloud receives all kind of logs from agents (installed in different platforms as mentioned above), and also network logs, 3rd-party ... you name it. In our cloud tenant we do process them with the analytics engine correlating and stitching all together to be more accurate in our detections and at the same time enriching your alerts and incidents with all the mentioned logs. So we do not just give alerts, we also provide the context in which those alerts and incidents happened saving thousands of hours to the analysts that have the majority of the work already done by xdr (but of course not all the job, there are still a bit if human intelligence to be added from the security analysts).About the Broker VM, it has several funcionts:Hope this helped. Please feel free to click on like or recommend if this was helpful for you.KR,Luis",0,03-27-2022,02:07 PM
487,475437,WSeldenIII,"Hi@justbekid, There are a lot of resources for you to leverage in terms of training / enablement of the XDR product in the following:",0,03-25-2022,01:30 PM
488,475804,WSeldenIII,"Hi@Kevin_Robers, We want to maintain security of environment while reducing operational impact. I believe obtaining some additional context on the alert criteria / scope will assist in determining the most effective path forward. The following information will help to guide you on determining next steps:",0,03-25-2022,09:48 AM
489,474860,WSeldenIII,Hi@weejhI suggest to by confirming the CISCO ISE Syslog format. Cortex XDR can receive Syslog from vendors that use CEF or LEEF formatted over Syslog (TLS not supported). You may reference the external data ingestion vendor support for additional details on log/data types and vendor support (E.g. custom external sources).,0,03-23-2022,01:55 PM
490,474860,uis,"In case that your Cisco is not sending CEF or LEEF, you could still parse the logs so that xdr will, so to say, ""understand"" them.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/data-management/create-pars...I would also check how are you sending them and how is broker vm listening to them. Meaning as WSeldenIII pointed (TLS is not supported), which port are you using ? standard 514 port for syslog ? tcp/udp (confirmed/unconfirmed). Check also that no Fw is dropping your traffic and that cisco can reach broker vm (network routes, etc...)",0,03-23-2022,03:44 PM
491,474860,jh,"HiHiThanks for the update.Yes, I need to confirm Cisco ISE syslog format, which I missed it earlier.",0,03-23-2022,11:57 PM
492,474860,jh,HiThanks for the update.I believe the Cisco ISE syslog format may not be CEF or LEEF formatted and need to create necessary parsing rules.For broker vm is configured to listen to TCP514 and firewall enabled to allow broker vm IP with TCP514.,0,03-24-2022,12:09 AM
493,474890,moixsante,Hi@JirapanMuencharernThis is something our PANW Devops and Engineering are looking into as we speak. Thank you for your post.,2,03-22-2022,03:44 AM
494,474890,moixsante,"Hi @JirapanMuencharern,This is the latest comment from our TAC support,""As part of our efforts to improve security PANW, an internal scanner generated a chain of events which caused our UI to have sporadic availability issues. The local agent protection as well as all analytics and detection capabilities were functioning throughout the issue.""",1,03-23-2022,03:09 AM
495,474623,moixsante,Hi@GradyI am taking note of this behavior and I will contact our internal teams to inquiry more about this discrepancy. I will post back here as soon as I have more information.,0,03-21-2022,06:20 AM
496,474623,Grady,"Hi@fmoixsanteThank you for your feedback, is there any news, there is no malicious intent, I just want to ask if this is a bug?",0,03-23-2022,12:42 AM
497,468593,jburton1103,Same here. Been scraping the internet for a solution. I saw someone say they deployed the package only and then used cytool to script a reconnect to the xdr console. But I was unable to even just deploy the package alone using the pkg.intune wrapper.(https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/deploying-xdr-agent-for-mac-with-intune/...),0,03-22-2022,12:04 PM
498,474727,bbarmanroy,"Hi@SaratMudduplease take a look at the SOC2 compliance reports for XDR and see if it meets your need. If you're not able to retrieve the report, reach out to your Sales rep to be able to assist you with one.As far as the logs are considered, it is read-only from XQL. Tenants don't have access to the underlying infrastructure that hosts the data at rest.",0,03-21-2022,06:42 PM
499,474454,bbarmanroy,"Hi@BalarajuYou'll need to take a look at the alert itself, and investigate through the Causality Chain to identify the DLL that is being tried to load. You will see a process that is trying to load the DLL for each alert.Next, look at your Exploit profile applied to the endpoint/set of endpoints. You probably have a list of DLL's blocked in the Profile configuration.The configuration of that setting determines if the attack is disabled, reported or prevented.Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/endpo...",1,03-21-2022,02:41 AM
500,474454,Balaraju,Thanks for your response . This is helpful,0,03-21-2022,02:56 AM
501,474454,bbarmanroy,"Great, happy to advise you on the right track!",0,03-21-2022,03:01 AM
502,474454,Balaraju,"The process in almost all cases is 'rundll32.exe' , though the Exploit profile is set as Default(Block) , all the alerts show up as Detected(Reported) . Noblock list has been configured either in the Exploit profile .",0,03-21-2022,03:03 AM
503,474454,uis,"Hi Balaraju,apart from following the useful recomendations given by Bbarmanroy, and check if the DLLs on those alerts are in block lists or allowed, just reported but not blocked, etc.The SOC/Security analysts need to know what are this dlls used for, are they legit windows ? something coming from a 3rd party or custom app you have installed ?XDR can identify the dlls that are signed by microsoft and figure out or determine that they are benign, even though we do not know and control all dlls available out there from 3rd parties, custom created by individuals.... this is part of the analyst job. And once identified malicious or benign you guys can add a trusted signer or allow hash.....XDR can also spot the malicious ones even they are unknown by their behavior or even based on ML, and block (depending on your settings) and alert you. After further analysis from your security guys you can decide if you want to continue blocking or allowing, lets say that this is part of the human intelligence we need to put on our daily security analysis.Hope this helps alsoKR,Luis",1,03-21-2022,04:24 AM
504,470909,bbarmanroy,"Hi@LukasB, the source of the alerts are from NGFW, as you've correctly stated. Threat ID 9999 refers to URL filtering (see here).Here is a KB that explains the various categories for URL filtering:https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000Cm5hCACYou can look into the alert details to determine the URL, and take action from there (block etc.), which gets driven by your firewall configurations.",0,03-08-2022,01:24 AM
505,470909,LukasB,"The thing is that these URL are benign. See screenshot. It creates an alert for a benign link under threat ID 9999, but according to the documentation -I cannot understand, why I have a alert for a benign link.On NGFW all URL categories are set for an alert, but in case that URL, etc,.. is benign, there is no need to create an alert in XDR, right?",0,03-11-2022,02:25 AM
506,470909,LukasB,"another example - alert for an URL of drug store, but benign. can be seen that the URL is opened from Outlook.",0,03-11-2022,02:31 AM
507,470909,bbarmanroy,"Hi@LukasBsorry I missed your earlier comments. Please@ whoever commented so that we get a notification as well. I hope you understand.URL's do occasionally get recategorized for several reasons. If the URL is benign and you are confident of its category, you'll have to raise a URL recategorization request through the standard channels. Please refer to this link here: https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-admin/url-filtering/url-category-change.htmlHope this helps. Also, please note that this is a Cortex XDR forum, you should consider posting in the Panorama forums for better traction.",0,03-21-2022,03:00 AM
508,474474,bbarmanroy,"Hi@Daniel_Itenbergthis appears to be a bug with Cortex XDR. Can you please raise a support ticket with the agent support file to identify and remediate any systemic fixes with the agent?I assume these are flagged by WildFire as malware? If so, please raise a Verdict Change Request in the XDR console for a faster remediation.Say, you have confirmed that the binary of Google Chrome is benign, navigate to the incident in concern, click on ""Key Assets and Artifacts"", and click on the small icon that takes you to WildFire Analysis report.Then click on ""Report Verdict as Incorrect"" for requesting a verdict change for the Google Chrome binary.Hope this helps!",0,03-20-2022,10:41 PM
509,474214,bbarmanroy,"Hi@Phil007The way I'd try to handle pagination is by iterating through calls based on the total_count parameter. Note that the list of results,The search size must fulfill the requirement: 0 < search_size <= 100. So you'll need to iterate through the total_count of incidents, incrementing the starting and ending values of the search_size by 100 with each iteration.An example of that would be a tenant with 256 incidents (incident values 0-255).I have also provided another example in this post here for you to review and see if it meets your needs.",0,03-17-2022,11:13 PM
510,474214,hil007,"Thanks@bbarmanroy, I had seen your post, but unfortunately I don't currently have the ability to track the number of times I have called the API as the CCP is closed code ATM.",0,03-17-2022,11:22 PM
511,474214,bbarmanroy,You're welcome@Phil007. I'm assuming you've already played around with the pageSize andnextPageUrlQueryParameters to see if those can solve the issue.,0,03-17-2022,11:30 PM
512,472028,bbarmanroy,"Hi@Stephane.BI assume the hosts were in a Connected State at the time of upgrade. After a few failed attempts (depending on the agent connection status), the uninstallation fails.If the hosts were in a Connected state, this seems to be an issue that requires analysis of the agent logs. Can you please create a support case with the TSF that you obtained?",0,03-10-2022,06:17 PM
513,472028,Stephane.B,"Yes a ticket was opened, requesting the log level to be put to 7 and retry the upgrade to get better logs. it's still work in progress with the customer.",0,03-17-2022,08:43 AM
514,472028,uis,"Hi Stephane,how you are describing your issue. Could it be that you have network bandwidth issues ??If the first time 50% were able to upgrade, and the ones that failed, then you tried again and 50% succeded. I assume you did not do anything else for troubleshooting, just trying again wondering why many of the ones that failed the 1st time were successful ... maybe bandwidth ?¿At the same time you are handling the issue with TAC. I would also recommend to check the network issues you might have when a bulk upgrade is taking place.KR,Luis",0,03-17-2022,11:05 AM
515,473561,tugriceri,"Hi @GradyYes, There might be kind of buffering. I didnt test this with BrokerVM but i know there is a buffering with XDR Collector. If your fortinet firewall is not super active firewall which is creating so much syslog data, you may see kind of latency.Btw, My recommendation is verifying logs from the Query Builder. with that way, you can see latest logs and can able compare with current data/time.",0,03-16-2022,06:44 AM
516,473561,Scott_Pan,"Hi EtugriceriI understand looking at raw log data, so which dataset filter should I choose in XQL? xdr_data? Because the dataset of fortinet is empty",0,03-16-2022,06:51 AM
517,473561,tugriceri,"HiNo, xdr_data dataset is just including xdr agent telemetry datas. could you check log_log_raw or unknown_unkown_raw data sets?When you activate syslog on BrokerVM, You are configuring ""New Syslog Data Source"" and You should select, Vendor and Product information with this two information XDR is understanding log type. If you've choosed Auto/Auto. maybe due to version of Fortinet, XDR cannot able to parse very well and keep logs in unknown_unknown_raw. otherwise, should be in fortinet dataset.So just check it out.",0,03-16-2022,07:02 AM
518,473561,Grady,"Hi EtugriceriI checked unknown_unknown_raw in xql, and I didn't find the data of the tower, this seems to be a confusing problem",0,03-16-2022,07:55 AM
519,473561,tugriceri,"hiCould you verify that you selected product=fortinet, vendor=fortinet in brokerVM syslog configuration.Also could you check tcpdump output from BrokerVM cli. For connecting BrokerVM, you can upload your ssh keys to Bvm via web console of BrokerVM or XDR management console. Another option is to use Live Terminal to BrokerVM.This is just for verification whether you are receiving logs from Fortinet firewall. Because, if syslog enabled and Vendor and product set correctly in syslog configuration, You should have logs on xdr management console.",1,03-17-2022,05:51 AM
520,473561,Grady,"Thank you for your reply, the Fortis dataset has data today, I think it should be caused by the Broker cache",0,03-17-2022,07:15 AM
521,473673,bbucao,"Hi Pdysart,It does not look like this is a known issue with agent version 7.6.I recommend validating that the OS version on the effected host is supported by the 7.6 agent. See documentationWhere Can I Install the Cortex XDR Agent?If the OS is listed as supported under agent version 7.6 then I recommend opening a support case with PANW to investigate further.Regards,Ben",0,03-16-2022,09:15 AM
522,473487,bbarmanroy,"Hi@Grady, XDR agents send data to XDR's own datalake. The sizing recommendation is 1 TB for every 200 endpoints (see sizing calculator here).Here are a few points for your understanding:1. The data in XDR's datalake stores logs, alerts, incidents etc. for XDR only. This data is isolated and does not show in the Cortex Data Lake which you see in Palo Alto Networks App Hub.2. The Cortex Datalake (CDL) you see in App Hub is used for storing logs for PANW firewalls and Prisma Access. As you don't have Pro per TB, I assume that you do not have PANW NGFW's in your portfolio. If you had it, you would be able to scroll in CDL and observe you have firewall/Prisma Access logs only. See screenshot below which lists the type of data present in CDL.3. However, if your CDL is setup to receive firewall and Prisma logs, they will show up in XDR as well.4. If you don't have Pro per TB, you should not see a Cortex Data Lake app enabled in your Palo Alto Networks App Hub.Hope this clarifies.",0,03-16-2022,01:29 AM
523,473487,tugriceri,"Hi@GradyCortex Data Lake is a PANW service for keeping logs. Cortex XDR is also using benefit of Cortex Data Lake and keeping telemetry data on CDL for further analyses. Your XDR license is also including CDL license but this usage on CDL is limited to XDR telemetry datas.if you want to keep and ingest other type of datas with XDR datas,(Firewall logs, windows event logs, Cloud provider logs, etc), You need to purchase XDR Pro per TB license.You cannot see XDR data directly from CDL. but you can search XDR data by using XQL queries from Investigation > Query Builders.",0,03-16-2022,01:34 AM
524,473487,Grady,"Hi BbarmanroyThank you for your explanation, but there are still some doubts. I understand that the license of 200 pro can store data for 30 days. Does the 30-day data belong to the range of 1TB? What happens if you exceed 1TB",0,03-16-2022,01:41 AM
525,473487,Grady,"Hi EtugriceriThanks for the explanation, then if I have XDR Pro per TB, I can see firewall logs in datalake, right? For example, can forinet logs be quota in datalake?",0,03-16-2022,01:45 AM
526,473487,tugriceri,"Yes. totally correct. Panw firewall can able to send logs directly to CDL. for any other type of logs, you are able use BrokerVM , XDR collector, XDR API and FileBeat.if log type does not known by XDR, You need to write your parser rules on XDR management console and last things, logs will be searchable by using XQL and will be ingestedXDR log rotation date is 30 days. You don't need to concern if you exceed 1TB. This is SAAS service. Please check you average daily log size from XDR Management console > Configurations > Dataset management. Filter out ""dataset name = xdr_data""if your license is not enough for keeping 30days xdr data, you may choose to increase your license. But sizing calculator is pretty accurate.",0,03-16-2022,03:24 AM
527,473203,uis,"If you have network connection Ok. And traffic is not dropped by FW, and bare in mind that if you are using proxies you should have them properly configured at the agent, try to:cytool reconnect forceHaving the protection mode enabled should not be a problem for connecting to the tenantKR,Luis",0,03-15-2022,04:27 AM
528,473203,tugriceri,Hi @NCherbibCould you check trapsd.log to know more about problem?You can find trapsd.log from agent console or ;windows =c:\programdata\cyvera\logsMac OS X 10.10 and OSX 10.11= /var/log/traps/macOS 10.12 and later releases= View logs from the Console application in /Library/Logs/PaloAltoNetworks/Cortex XDR/.,0,03-15-2022,04:27 AM
529,473203,NCherbib,that's what i got:2022/03/15T01:40:10.207+01:00 <Info> ********** [5300:1368 AgentOperationalStatusReporterThread:5] {trapsd:Telemetry:AgentOperationalStatusReporter:} Waiting for 300 seconds2022/03/15T01:40:46.098+01:00 <Info> *********** [5300:7880 ReportScheduler:2] {trapsd:Forensic:Reporting:} Wait is over because of time-out2022/03/15T01:40:46.098+01:00 <Info> ********** [5300:7880 ReportScheduler:2] {trapsd:Forensic:Reporting:} All report types triggered due to: timeout2022/03/15T01:40:46.102+01:00 <Info> ********** [5300:7880 ReportScheduler:2] {trapsd:Communication:Reporting:} No authentication ID - checking if registration is required2022/03/15T01:40:46.102+01:00 <Notice> *********[5300:7880 ReportScheduler:2] {trapsd:Communication:Reporting:} The agent is not registered. Registering with the cloud.i notice that the server fqdn isn't mentionned in the agent is that normal ?BR.,0,03-15-2022,08:31 AM
530,473203,bbucao,"Hi NCherbib,Toenable access to Cortex XDRcomponents, you must allow access to various Palo Alto Networks resources. Can you confirm if access is allowed from the server in question to the specific resources relevant to your deployment? You can reference the document linked below to find what specific resources are required for your region.Resources Required to Enable Access to Cortex XDRRegards,Ben",0,03-15-2022,08:48 AM
531,473203,NCherbib,"Hello Bbuco,but it's working for other ressurces, i'm faing the issue with few hosts and they are using the same network.BR.",0,03-15-2022,09:31 AM
532,473203,tugriceri,"Hi@NCherbibinstallation package is including necessary URL's for agent communication. You agent could not registered somehow to XDR management console and could get license, Thats why its normal to see protection status is not green.I believe, You should have logs about API accesses. kind of reject, timeout etc.My recommendations is checking again network layer (fw, proxy etc) and dns resolutions. on the network layer, there should not be any SSL interception for palo alto network urls.if there is no problem on the network layer, could share full trapsd.log?",0,03-15-2022,10:01 AM
533,473203,bbarmanroy,@NCherbibit seems like the endpoint never managed to connect to Cortex XDR. What happens when you run 'cytool reconnect force'?You might want to open a Support ticket in parallel with the Agent Support logs for an investigation.,0,03-15-2022,10:27 PM
534,473171,tugriceri,Dear@weejhIngestion telemetry data is not searchable data by using XQL. You need to use predefined widgets to see ingestion results.,0,03-15-2022,03:14 AM
535,472952,bbucao,"Hi Rcamposb,Currently XDR data sets with Incident or Alert data are not available through XQL. You may consider reaching out to your account team to inquire about any future plans to support this capability.Best Regards,Ben",2,03-14-2022,12:34 PM
536,472910,tyler_bailey,"See if this query gets what you are after.config case_sensitive = false| dataset = endpoints| fields endpoint_name , endpoint_type , endpoint_status , last_seen| alter last_seen_days = timestamp_diff(current_time(), last_seen, ""DAY"")| filter last_seen_days <= 30",2,03-14-2022,10:11 AM
537,472910,MartinCimone,Working like a charm ... ! Thanks@tyler_bailey,0,03-14-2022,10:20 AM
538,471706,cstone,Something similar to the below command?,0,03-09-2022,11:32 AM
539,471706,C-TomS,"Thanks, I suppose I should have mentioned it is the Windows 64bit package and I am using msiexec switches.My bad for not clarifying.Tom",0,03-09-2022,12:27 PM
540,471706,C-TomS,And I tried Accept_Eula=1 as well. I wonder if a transforms would do the trick.,0,03-09-2022,12:28 PM
541,471706,cstone,And I tried Accept_Eula=1 as well. I wonder if a transforms would do the trick.What about ACCEPTEULA=1?,0,03-09-2022,12:31 PM
542,471706,C-TomS,"Nope, same error 1603. I dug in to the MSI and there is a LicenseAccepted property that must return a value of '1' for the install to continue.I'm a bit rusty on my MSI so I was hoping someone else had the same issue.",0,03-09-2022,12:39 PM
543,471706,cstone,So this is a wild solution someone tried for something similar:,0,03-09-2022,12:43 PM
544,471706,C-TomS,"Sadly, it is not in the property table but there are references in several other tables.It is also not a EULA afaik. That is typically used for Microsoft products.There are several references to the license dialog throughout the msi and I am not versed enough to figure out which ones to change.I appreciate you trying to help and I have reached out to our support team and may open a case if that doesn't work out.ThanksTom",0,03-09-2022,01:13 PM
545,471706,C-TomS,"Oh yeah, I tried what you posted too.",0,03-09-2022,01:14 PM
546,471706,bbarmanroy,Hi@PC-TomShave you tried with the '/qn' switch?https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-6/cortex-xdr-agent-admin/cortex-xdr-agent-for-...,0,03-09-2022,10:26 PM
547,472833,uis,"Hi NCherbib,please find a couple of guides.1- The Broker VM overview:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/broker-vm-overvie...2- The configuration guide:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/set-up-broker-vm/...In the second doc you can also find links to google cloud, amazon or azure VM deploymentHope this helps.Feel free to click on like and/or rate this messageKR;Luis",0,03-14-2022,05:14 AM
548,472833,NCherbib,"Hello L3,thnx for your reply but u miss understood me, my issue isn't with broker VM it's about deploying the agent automaticlly and setting the proxy parrameters automatic too.BR",0,03-14-2022,05:21 AM
549,472833,bbucao,"HiNCherbib,Understep 7 in the document linked below you can find instructions on setting proxy parameters when usinguse Msiexec in conjunction with System Center Configuration Manager (SCCM).https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-6/cortex-xdr-agent-admin/cortex-xdr-agent-for-...Regards,Ben",0,03-14-2022,06:34 AM
550,472833,tugriceri,"Dear@NCherbibif you are first time installing XDR, you can use below--proxy-list parameter to pass your proxy server../installer -- --proxy-list ""10.19.20.244:8080,10.19.20.245:8080""if you want to set new proxy or change it, you use cytool like below.cytool.exe proxy set ""192.168.50.1:8080,192.168.60.2:8080""This will ask password, in that case you can echo to cytool.echo password|cytool.exe proxy set ""192.168.50.1:8080,192.168.60.2:8080""",0,03-14-2022,06:39 AM
551,471578,KanwarSingh01,Can you provide more details please?,0,03-10-2022,04:39 PM
552,471578,bbarmanroy,"Hi@KiranBashyalwhat kind of sharing are you referring to? Is it file sharing over SMB or uploading files to WF? As you are aware, Cortex XDR manages endpoint protection of malicious behavior. If you're looking at volume quotas, that should be an operating system specific control that are centrally managed by existing solutions.",0,03-10-2022,06:22 PM
553,471578,KiranBashyal,"Sharing of files from endpoint to endpoint, Endpoints cud be on same network or different network. Simply the sharing should contain the size restriction. i.e upto 500mb of any files can be shared from certain endpoint",0,03-13-2022,09:30 PM
554,471578,bbarmanroy,"Hi Kiran, it is not possible to restrict such features OOB.However, there are Analytics detectors to raise alerts of such a nature. Here's an example for HTTPS (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...)You can also use the network_story preset to query for upload sizes and convert it into a BIOC for alerting. Look at thefield action_total_upload.",1,03-14-2022,01:38 AM
555,472335,bbarmanroy,"Here's a XQL query to get you alerts if a directory gets created| dataset = xdr_data| filter event_type = ENUM.FILE and (event_sub_type = ENUM.FILE_DIR_CREATE or event_sub_type = ENUM.FILE_DIR_RENAME)| filter action_file_path in(""C:\Coffee"")However, you might also want to look at additional controls like: why are users able to create directories in such paths and not under ""C:\Users\<username>\"", and how those permissions should be reviewed and applied to users.",0,03-13-2022,10:48 PM
556,470532,zarnous,"I haven't encountered this behavior, but i would take a step back and verify the below:1- The endpoint is meeting the minimum requirement to run the agent (the higher the better) , this can be found here2- Verify if another Third-Party Security Products running alongside XDR on the endpoint, since this may cause performance issues and some unexpected behaviors, more info can be found hereI hope this helps.",0,03-05-2022,09:54 AM
557,470532,Grady,"1. I checked the user's hardware resources, it is no problem, it fully meets the resource requirements of the agent2. In addition to XDR protection, there is no other third-party protection software on the user's computer",0,03-06-2022,05:38 PM
558,470532,zarnous,"do you happen to notice any CPU spike when you start Visual Studio? , and also if you identified the scope of the issue (on how many endpoints) and they all experience the same, then i would have a TAC case open to look at this specific issue and run some analysis, you may proactively collect some logs from one of the impacted endpoints and submit those to your ticket, something like:1. Raise the log level -cytool trace stopcytool trace set all verbose 0x7FFFFFFcytool trace start2. Run ProcMon, and reproduce the issue in full3. Save the ProcMon capture and close ProcMon.4. Turn off / exclude the responsible component5. Run ProcMon again to capture the behavior.6. Collect the agent support file & .PML files.7. Reset the logging level -cytool trace stopcytool trace resetcytool trace startAnd have those uploaded to the TAC case for further analysis.",0,03-06-2022,06:22 PM
559,470532,Leo-L,"Hello everyone,We are facing the same issues. Our developers reportserious performance issues.XDR has been identified as the root cause of these performance issues. We have taken metrics with and without the XDR agent and the build time is substantially longer with the agent installed.Proper exclusions in ""Malware"" and ""Exceptions"" profiles/sections do not seem to make any impact at all.In our case, XDR should not monitor at all the MVS in order to make sure thatdelivery timelines are not affected.Any advice?Thank you very much in advance.Kind regards.",0,03-11-2022,01:55 AM
560,470532,Grady,HelloYou can generate trapd.log in the relevant terminal for analysis. My terminal analysis result is that VS is slow because XDR detects Citrix and causes VS to get stuck and crash. It is recommended to find the corresponding crash file name or path and whiten the BTP module,1,03-11-2022,02:00 AM
561,453624,moixsante,"Hi@tejasp04,What do you see when you execute ""./cytool proxy query""?Below, you can see how to query the proxy settings using ./cytool, setting a new proxy ipaddress:port and confirming that the settings are configured properly.",0,12-16-2021,10:01 AM
562,453624,OrkanAlibayli,"Hello,We have same problem.Has this been solved? If yes, can you please share solution to us?Thanks in advance!",0,03-11-2022,12:02 AM
563,453624,bbarmanroy,Hi@OrkanAlibaylican you please share some screenshots of the output when you run the commands that@fmoixsantehas stated in the screenshot above?,0,03-11-2022,01:09 AM
564,471635,bbarmanroy,Hi@Katerob21you can request for a demo by clicking the 'Request a demo' button at the URL https://www.paloaltonetworks.com/cortex/cortex-xdr.,0,03-09-2022,10:39 PM
565,471158,AZelle,"Hi,yes, I can confirm. This happend yesterday on several hundred machines. But not only SoftwareUpdater.exe was affected, some other obviously clean tools, also.The verdicts were already changed to benign yesterday in the evening.Strange behaviorwhich makes me a little nervous. Could happen to critical programs, too.BRAndreas",1,03-07-2022,11:27 PM
566,471158,bbarmanroy,"Hi@ReisingerMand@AZellethis might be due to a potential issue with Wildfire verdicts within the last 24 hrs, which have been re-analyzed and re-categorized appropriately. Can you cross-check and validate if most of those alert types are Detection (Post Detected) or Prevention (Post Detected)?",1,03-08-2022,01:32 AM
567,471158,ReisingerM,Hello@bbarmanroy indeed all alerts concerning this problem are Detection (Post Detected).,0,03-08-2022,01:36 AM
568,471158,AZelle,"Hi@bbarmanroy,yes it has been all Post Detected.",0,03-08-2022,01:36 AM
569,471158,ReisingerM,I also Posted this in General Topics to see if someone ther was able to confirme mysuspicion and i got answere therehttps://live.paloaltonetworks.com/t5/general-topics/apple-softwareupdate-exe-got-blocked-by-cortex-x...,0,03-08-2022,01:45 AM
570,471158,MartinPfeil,"It is benign software, initally identified as malware.Same thing happend in the last two days for other software updates, like for Epson and HP:Initially identified as malicious but then the verdict was reversed a few hours later.Files had to be released manually and hashes had to be added by hand to the whitelist",1,03-08-2022,01:52 AM
571,471158,bbarmanroy,Hi@ReisingerMand @AZellethank you for confirming. The issue has been resolved now.@MartinPfeilI understand the problems you faced and added the files to the global Allow List as a tactical measure. I'd suggest you can remove them now from the Allow List to prevent it from expanding with time and make it difficult to manage. Allow Lists and Block Lists are short-term measures and should ideally be avoided as a long-term solution.,0,03-08-2022,05:08 PM
572,464655,uis,"Hi PBurns,CXDR could protect WSL as a process running in windows as it would protect VMware running in windows or any other software/process.In case of virtual machines, and the like XCDR agent should be installed within the virtual machine/kubernetes .... this means that if you dont/cant install CXDR agent within the virtual machine or container whatever that happens inside the VM is not visible to CXDR agent.So CXDR protects the running processes for which it has visibility.",0,02-14-2022,05:03 AM
573,464655,Burns,"ThanksEluis - I checked with our account team and they confirmed, XDR doesnt protect WSL today, installed on Windows and is not supported to be isntalled in WSL. There may have some capabities in the future in an upcoming release.",0,03-07-2022,11:51 AM
574,352162,BenHooper,"While I'm awaiting a reply, just so others know, a side effect of modifying an existing BIOC rules is that a significant number of its alerts / incidents get re-created.",1,10-28-2020,04:35 AM
575,352162,DJohnson84,"BenHooper,I'm not saying this is the ""recommended"" way for excluding legitimate behaviors, but what I have done so far.When an alert is created, and verifying that it is legitimate, I add it as an alert exclusion.The thought being that the alert exclusion would be a smaller print versus excluding the whole BIOC rule.Hope that helps,DJohnson84",1,11-24-2020,05:05 AM
576,352162,Balaraju,Hello In the second line above do you mean ' I add it as alert exclusion ' or ' I add it as alert exemption ' ?,0,03-04-2022,02:55 AM
577,352162,bbarmanroy,"Hi@Balarajuboth rule (alert) exceptions and alert exclusions exist in Cortex XDR.When you exclude an alert, the alert will still be triggered by the agent and sent to XDR tenant. However, it will not be stitched into an incident. Here the action is performed by the XDR tenant. The alerts will appear in the Alerts table.On the other hand,an alert exception will cause the alert not to be triggered by the agent. The action is performed by the agent.",1,03-06-2022,09:47 PM
578,444570,teJacobCF,if you don't have any sort of RMM tool and your running prevent you can do a dump out of cortex and and dump out of AD and run a compare. if your running xdr pro look farther down in the topics and there is a good discussion on how to do this.,0,11-01-2021,06:17 AM
579,444570,ESJosephPrinz,"Ive dumped all devices that asset manager reports as no cortex XDR and run a script to reverse DNS. What I found was hundreds of false negatives. In other words, cortex asset manager reports no xdr but xdr is indeed running. So for us anyway, asset manager is erroneous. Perhaps something on our firewall side.We are running Pro, what discussion are you referring to?Ive spoken to a sales engineer and several support tickets. No real solution. Ive been pointing down futile paths however.Ive tried pathfinder and it does not detect non cortex xdr devices only high alerts.We wont run ""open source"" software on our network so the DHCP logger is a no go. Not to mention we have many dhcp servers so this would be a large deploy.Options left are perhaps the new 7.5 agent which does a peer to peer discovery. However no documentation on the amount of traffic it generates so we wont enable it on our network without proper docs. And I guess global protect HIP detection. Looking into that.",0,11-01-2021,06:59 AM
580,444570,teJacobCF,https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/best-way-to-detect-endpoints-that-do-not...,0,11-01-2021,07:01 AM
581,444570,ESJosephPrinz,"Thanks. I have posted in that thread.. there is no solution, just a link to this vague document.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/asset-management/about-asse...And it is marked as a answer. Funny. What is really funny is it refers to pathfinder as a solution but after several tickets on this, cortex support says it does not work. Honestly, I dont think anyone at cortex knows how pathfinder works.. When I run a ""test"" in pathfinder on an IP, it does EXACTLY what I need in the log, it does a reverse lookup and determines if cortex is installed. But yet network mapper does not pass on the IPs it finds to pathfinder to interrogate.Bottom line... has anyone gotten cortex PRO to report names of devices and or platforms name into asset manager that do NOT have xdr installed? If so, how did you do it? This should be doable.. the field is there..",0,11-01-2021,07:12 AM
582,444570,umbach,Have you looked at network discovery from 7.5?About Asset Management (paloaltonetworks.com),0,11-12-2021,06:51 PM
583,444570,palcev,Hi@ESJosephPrinzMaybe the Network Mapper could help you?https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/set-up-broker-vm/...,0,11-14-2021,12:36 AM
584,444570,teJacobCF,thank you I am going to try this,1,11-15-2021,07:20 AM
585,444570,ESJosephPrinz,"Wanted to update this.. what we found is in our environment the solution was to install cortex dhcp log collector on all Windows dhcp servers and make sure the global protect HIP data was being sent to the cortex lake. This have us all DHCP devices into asset manager so we could report on devices with the agent.However, currently the match between asset manager and endpoint admin is IP.. So it is the ""join"" if you will. Problem is the IP is not updated in endpoint admin when it changes for a long time so we have many false positives. working on a xql report to resolve but dont know if this will be possible yet. But at least we have devices to audit.",0,03-06-2022,08:37 AM
586,444570,teJacobCF,"hello I am very interested in doing this. not too sure what the ""cortex dhcp log collector""? I will look it up, also can you do this with the prevent subscription? vs the pro subscription?",0,03-06-2022,10:52 AM
587,470522,zarnous,"Since this is aBehavioral Threat , you may consider to ""Add a Global Behavioral Threat Protection (BTP) Rule Exception"" if this is what you are trying to accomplish, more details can be found in here Add a Global Endpoint Policy Exception,This will take you to the below steps:Rather than creating global BTP rule exception, if you wishTo configure module specific exceptions relevant for the selected profile platform, you still can do for the module you choose, which is in your case BTP and limit the scope to a specific profile as below:Behavioral Threat Protection Rule Exception—When you view an alert for a Behavioral Threat event which you want to allow in your network from now on,1- Right-click the alert and Create alert exception.2- Cortex XDR displays the alert data (Platform and Rule name).3- Select Exception Scope: Profile and select the exception profile name. Click Add.Link for the above -configure module specific exceptions.I hope this helps.",1,03-05-2022,09:21 AM
588,470522,Balaraju,"Thanks a lot for your response , this is very useful and thanks for all the explanation and URL Links .Appreciate it .",1,03-05-2022,09:57 AM
589,470322,bbarmanroy,Hi@chukaokonkwoWhat I'd advise you is to create a Starred Alert Configuration using Featured Fields.That'll star all incidents containing alerts of this nature. Populate the hosts and save the filter for quick retrieval for future use.,0,03-03-2022,06:27 PM
590,460574,bbarmanroy,Hi@jframeauRL is not officially supported for Cortex XDR. You should be able to possibly install XDR agents on the hosts.,0,01-24-2022,10:10 PM
591,460574,MichaelRios,"Hm....that's only half the question I think. Will it be officially supported on Rocky Linux? Is any certification process currently in the works?It does look like it'll work after mucking with the pre-install script a little, but the preference would be that it's an official thing where no mucking is involved.",1,03-03-2022,08:21 AM
592,469818,bbarmanroy,"Hi@Balarajuthis depends on the configuration of your Malware profiles.Assuming your profile is configured with Wildfire (WF) analysis enabled and configured to blocl/report for known samples or run Local Analysis for unknown verdicts, your explanation is correct for both points. However, this does not include the reaction of post-execution modules like Behavioral Threat Protection, ransomware, NPI etc. Even if WF verdicts are benign, post-execution modules will continue to operate independently and can mitigate threats in-flight.I don't have any statistical data at hand - but again, it depends on the tenant configuration. Some organizations might have WF disabled, and thus, solely depend on Local Analysis verdicts. Verdicts can vary between industry verticals, types of software used, internet access control (air-gapped systems vs direct internet exposure), administrative rights of endpoint user, firewall configurations and the list goes on. So,it depends!Please refer to this detailed documentation on Cortex XDR file analysis and protection flows:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/analy...",1,03-02-2022,08:56 PM
593,463670,MarvinC,"Hi Ammar,We are both having the same experience yet I believe this'll be going to a feature request since they'll be adding features to format the PDF itself (e.g. landscape orientation, number of rows)The PDF is much more targeted for summary reports.",0,02-06-2022,04:53 PM
594,463670,bbarmanroy,Hi@AmmarBahasanCan you please describe the steps to create a PDF report?Thank you@MarvinCfor your advice!,0,02-06-2022,05:54 PM
595,463670,MarvinC,"Hi@bbarmanroy,Go Reporting > Report Templates > Create new report template.You can utilize Palo Alto pre-created widgets to be attached on the PDF or you can create widget yourself via the Widgets Library.",0,02-06-2022,06:05 PM
596,463670,bbarmanroy,"Hi@AmmarBahasan, When you're referring to ""when i generate the report as CSV i get the full list"", you're exporting a table from the tenant portal (e.g., Endpoints Administration, Alerts Table etc.) in TSV format.As@MarvinChas correctly pointed out, a PDF report is a summarized version for your senior and executive leadership.Hope this clarifies.",0,02-07-2022,10:09 PM
597,463670,bbarmanroy,Hi@AmmarBahasanplease take a look athttps://live.paloaltonetworks.com/t5/cortex-xdr-discussions/enabling-csv-export-on-cortex-xdr-report...and see if this meets your needs.,0,02-28-2022,06:44 PM
598,465848,uis,"Hi@chukaokonkwo,I wonder about the reason to have the reports in csv format since the most visual and human/user friendly is a pdf to read and understand the report.KR,Luis",0,02-15-2022,03:01 PM
599,465848,bbarmanroy,"Hi@chukaokonkwoThis is listed in the XDR guide (Create a Report from Scratch Step 11): https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/monitoring/cortex-xdr-dashb...Please see an example below:1. Create a custom XQL widget (Reporting -> Widgets Library) which will provide the data you need, and save it. In my example, I am listing endpoints without EED capabilities. My end goal is to obtain the results as a CSV format.2. Create a new Report template and click Next twice after designing your template. I have left mine as blank as an example.3. Choose the custom XQL Query (the same widget you created in Step 1) in the drop-down menu and click Save.4. If you chose ""Generate Now"" in step 3, the report will be present as a zipped file in the Reports section. If you have set a schedule, the reports will be created as per schedule.See an example where the report results were created in CSV format for the XQL query in step 1.",2,02-15-2022,06:42 PM
600,465848,chukaokonkwo,@bbarmanroy a million thanks to you for this awesome write-up. I'll surely be trying it out.,1,02-28-2022,02:08 PM
601,465848,bbarmanroy,"You are welcome,@chukaokonkwo!😁",0,02-28-2022,06:21 PM
602,469039,bbarmanroy,Hi@pdysartIt is not currently in the roadmap. Tenants will be notified via standard channels once this feature is incorporated. BTP's and other endpoint protection modules (and Wildfire analysis) will continue to monitor running processes and detect/prevent signs of malicious actions.,0,02-27-2022,05:22 PM
603,468379,bbarmanroy,Hi@MrDuckthis is not the expected behavior.Is this happening across all endpoints or only one a single device?Can you please elaborate a bit more about your problem?,0,02-24-2022,06:55 PM
604,468379,MrDuck,"One MacOS device at the moment.I am not sure what changes occurred overnight but that ""seems"" to have corrected the issue, so I will post a solution once found",0,02-25-2022,06:04 AM
605,468087,bbarmanroy,"Hi@JacobHustedBTP's are raised by the XDR on the basis of information analysed by agents and the XDR tenant. An example of that could be a suspicious behavior that was flagged by an Analytics BIOC, which uses EED to generate an alert. The term ""Behavioral Threat"" is an umbrella of capabilities based on the behavior.Furthermore, an incident is a container for alerts. Alerts have a detect/prevent/block attribute associated with them.To answer your question: You can search in the fields Alert name or Descriptionin the Alerts table containing the term ""behavioral threat"".",1,02-24-2022,07:21 PM
606,468169,bbarmanroy,"hi @Balaraju As a tactical measure - look at the corresponding incident, and you'll be able to find the hostname.Raise a support ticket with the incident and alert ID, and upload the support file for the endpoint for good measure.",0,02-24-2022,07:01 PM
607,467888,bbarmanroy,"Hi@BalarajuTo answer your first question where the WF verdict is malware: create a filter where ""Wildfire Hits >=1"".Firstly, please go through the Cortex XDR Beacon training from the Support portal.Secondly, I recommend you to review all incidents, (sort by severity, if possible), and immediately start tuning your alerts to prevent alert fatigue. At the same time, assign incidents to your analysts for investigation and perform remedial actions depending on your SOP (Standard Operating Procedures). This is a very broad topic and is subjective to your organizational security standards and incident management playbooks.Take a look athttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response....which provides you a guideline for you to start your investigations.In addition, you should keep an eye out on the several dashboards that are provided out of the box, create custom widgets and add them to your custom dashboards based on your use case for daily monitoring/analysis. This can include anything from reviewing agent operational status to vulnerability assessments, MTTR for incidents etc. Look at : https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/monitoring.htmlIn summary, look at everything, and determine holistically what need not be looked in the future. Only you can determine that as you know your estate the best. Review your XDR configurations and policies periodically and work on building incident response playbooks for standardization of tasks and processes.",1,02-23-2022,08:58 PM
608,467588,uis,"You have done the right thing opening the TAC case.In the meantime double check that you meet the requirements for installing cxdr agent on windows. Please see the attached dochttps://docs.paloaltonetworks.com/cortex/cortex-xdr/7-5/cortex-xdr-agent-admin/cortex-xdr-agent-for-...KR,Luis",0,02-23-2022,04:47 AM
609,467588,Clint_UICCU,I did some more testing/troubleshooting and found it was related to a GPO. Disabled the settings in the GPO and that seemed to fixed the issue. The GPO in question was related to some old Windows 7 power options and set some registry keys for Policy Pak about power options.,0,02-23-2022,08:04 AM
610,467244,uis,"Hi Gdomenech,you can add your legit software signer as a trusted signer. Second choice will be to add that hash to the allow list.Kr,Luis",0,02-21-2022,06:58 AM
611,467244,gdomenech,"Hi Luis,We are not clients of Palo Alto but some of our clients are clients of yours and havethe false positive detection problem. Is there a way you can fix it globally?Thanks!Gonzalo",0,02-21-2022,07:06 AM
612,467244,bbarmanroy,"Hi@gdomenechthe ideal process is to get your clients to raise a support ticket athttps://support.paloaltonetworks.com/ with the details of the alert (tenant ID, alert ID, incident ID, signer, hash etc.). That'll make sure that the problem is documented and resolved though the standard channels for a global fix.As tactical fixes, as @eluishas mentioned, your customer can allow the hash. Allowing the hash is a one-time process, and your clients might run into the same problem when a new version of the software is released. Similarly, allowing the signer is a broad-based control and I wouldn't recommend that either as a systemic fix.",0,02-21-2022,07:12 PM
613,467244,gdomenech,"Thanks, We will ask our customers to raise a support ticket.",0,02-22-2022,01:25 AM
614,467337,bbarmanroy,"Hi@PGP1234The attack vector can be Teams, emails, or any other communication tool that is being used by a malicious actor to compromise an end-user. That is the first-stage dropper that is then used to gain persistence and/or perform malicious activities on the endpoint etc.How Cortex XDR detects this: behaviorial analysis. XDR will monitor all running processes and look at the actions being performed (registry entries, network activities, disk activities etc.) Take a look at this document, which explains the capabilities of Cortex XDR in detail:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...The payload can evolve over time, as can the second- or third-stage payloads. Blocking via hash is a tactical fix, and not to be confused with a strategic fix. The fix can be on multiple levels: firewalls, endpoints, permissions review, user awareness etc.",0,02-21-2022,10:13 PM
615,339365,SimonTan,"i have a similar question,how does cortex deals with malware? does tech support have to take another antivirus to scan and clean the infected endpoint computer?",0,07-21-2020,02:35 PM
616,339365,KRisselada,"hello@PKhemarithperhaps I am not understanding your question or task requirement, but is this what is being asked?""Retrive Files from an Endpoint""https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...I found the above in the Cortex XDR Pro Administrators Guidehttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin.html",0,07-21-2020,03:35 PM
617,339365,dfalcon,"Hi there- Assuming you have quarantine malware enabled in your malware profile, no action is needed on your part. If enabled, the agent will quarantine the file which means that it will encrypt the file and move it to a location that is inaccessible (left there in case it needs to be restored.) The agent will delete the malware itself based on the quota settings specified in the agent profile.Hope this helps.",0,07-21-2020,04:31 PM
618,339365,Balaraju,"Similar to above question is there a equivalent Palo Cortex tool as below from Microsoft ?https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/safety-scanner-down...Also if we do not have Quarantine = Yes then does the file stay infected or is it cleaned and left there ?Also unable to understand the link between the question and 'quota settings specified in the agent profile' ? How is it related ?Overall I see Cortex talks of always protection ( blocking ) and Quarantine , so what about cleaning a infected file ?",0,02-18-2022,08:09 AM
619,339365,SimonTan,my solution is to get another antivirus to remove the source file (virus).,0,02-18-2022,10:31 AM
620,339365,bbarmanroy,"Hi@Balaraju, quarantined files will need to be unquarantined manually.The process of ""cleaning a file"" is very subjective. The file could be malicious by nature, or can be affected by a malicious process, among others. An example of that would be a ransomware attack. While the ransomware file is malicious and needs to be removed from the host, files affected by the ransomware are encrypted on disk and needs a decryption key for ""restoring"". The process of ""cleaning"" ensures a complete disk-wipe, and additional investigative and forensic activities to understand the limit of attack, exposure and compromise while figuring out the remediation plan including restoring from backups and enforcing stricter security controls to prevent such activities. This requires human intervention and analysis.",0,02-21-2022,07:25 PM
621,339365,bbarmanroy,"Hi@SimonTanhow about leveraging the existing capabilities of XDR to search and delete a file? Take a look athttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...If you don't have Host Insights, you can write your own custom Python script for search files by names or hashes and delete them. See it here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...",0,02-21-2022,10:02 PM
622,467102,palcev,Hi@TimGowenHow did you connect the Syslog?To forward Syslogs from XDR to Syslog listener you need to go to Settings=>General=>Notifications=>Add forwarding ConfigurationIn the summary choose the Syslog server:Let me know if you have any additional questions.,1,02-21-2022,05:14 AM
623,467143,palcev,Hi@Daniel_ItenbergThis is something that requires more deep investigation.Can you please open a support ticket and don't forget to attach the logs from the Broker VM?Let me know if I can assist with something else.,0,02-21-2022,05:09 AM
624,466803,jcandelaria,"Hi Dgagnon,With regards to the vdi, did you use the vdi switch install procedure for this non-persistent vdi? So that way it accurately reflects the actual use of your VDI environmenthttps://docs.paloaltonetworks.com/cortex/cortex-xdr/7-4/cortex-xdr-agent-admin/cortex-xdr-agent-for-...As for the License dashboard, its the total of connected and disconnected.. once it goes to connection lost state, it doesnt count anymore.. you get your license back.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/cortex-xdr-prevent-over...",0,02-18-2022,10:17 AM
625,466208,jcandelaria,"Hi LukasB,Typically during an application install, it will create tmp file just like what you see, then after the install, it will clean those temp files that's why its gone. During that time of install execution, XDR will do its checking, thats the reason why you see those alerts.",0,02-16-2022,08:35 AM
626,466208,LukasB,That's exactly what I thought.... what is the best practice? Exclude the folder from malware scan or... ? creating an exception can be potentially dangerous,0,02-17-2022,01:00 AM
627,466208,bbarmanroy,"@LukasBMark the incident as Resolved - False Positive since you're aware this is the case. There is no need to exclude any folder from Malware scans as you correctly stated - malicious actors can use temporary directories for staging and short-lived persistence.Furthermore, XDR Agents will monitor all running processes, raise alerts, perform detection/blocking actions and/or create incidents , whether or not the corresponding files were scanned in disk, and will flag accordingly upon execution.",0,02-17-2022,06:14 PM
628,466236,jcandelaria,"Hi Colton_Morrison,This would be a support case, where our support needs to investigate. Also have you tried updating the agent on this server?",0,02-16-2022,08:40 AM
629,464471,bbarmanroy,"Hi@ocardielAre you able to view the Active Directory field populated in the Endpoints Administration table? I don't have an Azure AD setup, but I am able to do so for ""on-prem"" AD's.Here's my view when I try to create a Dynamic group for domain-joined endpoints.You should be able to filter via groups or OU's while creating your Dynamic group.",0,02-09-2022,07:00 PM
630,345719,Tobi,Why no answer yet?,0,11-16-2020,07:09 AM
631,345719,cohen,"Hi@JimWaZMy name is Or and i'm from the XDR PM group.Allow me to explain.The right click --> exclusion option is meant to quickly hide FPs but it does not create any policy or changes anything. It will not suppress future alerts of the same type, nor will it cause them to not fire. It's just for that one alert.The reason the process is a different for an exception is because we want to allow the granularity of choosing who gets this exception. You can do it by profile + policy, hence only some machines get it (so according to your example, in some sections of the company a coffee cup will be able to change channels and in other it won't) or apply it to all endpoint as a global exception. There are many cases in which you need more granular policies like this.Another, more specific option, is to add a hash to the allow list - which can be used for cases where you know the hash and you don't expect it to change. It probably won't be effective in cases where dev teams build/test a lot of code.I hope it helps, but if you want i'd be happy to have session with you to dive deeper into this and listen to any feedback you may have as we're always happy to get any feedback and improve our workflows.Please email me if you are interested at ocohen@paloaltonetworks.comOr",1,11-20-2020,01:01 AM
632,345719,RSteffens,"Thank you!@ocohenYou mentioned: ""You can do it by profile + policy, hence only some machines get it:"". Can you or someone post documentation about how to set an exception like this, with a profile + policy? I wouldlike more details on how to set an exception for only certain computers in a fleet, like this.",0,02-08-2022,03:06 AM
633,345719,bbarmanroy,"@RSteffensyou can create a Security Profile as per your requirements, and then attach it to a policy where you choose the list of endpoints you wish to apply on, i.e., dynamic or static groups, list of endpoints, operating systems, endpoints based on domain groups, or other criteria as you may deem fit. The process to create a policy is detailed here, and you'd be looking at Step 6.",0,02-08-2022,07:14 PM
634,345719,Jeffrey7034,"Hello all,Exclusions versus Exceptions, why is excluding an alert so much easier than creating an exception when it should be the opposite?According to Palo Alto, ""If you do not want Cortex XDR to display alerts that match certain criteria, you can create an alert exclusion policy. After you create an exclusion policy, Cortex XDR hides any future alerts that match the criteria, and excludes the alerts from incidents and search query results."" In regards to alert exceptions, PA states ""In some cases, you may need to override the applied security policy to change whether Traps allows a process or file to run on an endpoint."" In practically all cases I am going to need to override the security policy that is blocking a homegrown PE that allows a department the ability to control their TV with their coffee cup. Do I want to just ignore (exclude) the action, and allow the Cortex agent to continue blocking the coffee cup from changing the channel? NO! The department is going to be irate with me because I can't even see the blocking action.Within Cortex XDR it is easy to create an exclusion, you can right-click, exclude, you're done. For an exception, you need to pull your exception attributes from the alert, open the exception page, and input attributes where they are needed. Why can't I right-click a hash, process, description, etc., and add as an exception? Take it a step further, would you like to add this hash or whatever as a global exception or apply to a specific policy?As a security analyst, I'm not going to suppress an alert but still allow it to continue blocking the file, process, etc. I need to see all that is happening and suppressing an alert but allow the blocking action to happen is probably the last thing I'm going to do. This exclusion action can be buried deep in the Cortex realm of dark actions that never get used.The reason the process is a different for an exception is because we want to allow the granularity of choosing who gets this exception. You can do it by profile + policy, hence only some machines get it (so according to your example, in some sections of the company a coffee cup will be able to change channels and in other it won't) or apply it to all endpoint as a global exception.",0,02-08-2022,10:30 PM
635,462612,WSeldenIII,"Hi@AndrewGalvinGHIf you have the host insights add-on, then Search and Destroy can be leveraged dynamically and in real-time with XQL:Example query:file_search = existing_files|filter path = ""C:\testfile.txt"" Requirements:endpoint status = Connected, Disconnected AND agent version >= 7.2.0 AND disabled capabilities doesn’t contain File Search and Destroy AND host insights = Enabled AND platform = Windows) OR (endpoint status = Connected, Disconnected AND agent version >= 7.3.0 AND disabled capabilities doesn’t contain File Search and Destroy AND host insights = Enabled AND platform = macOS AND os version >= 10.15.4There are two actions to consider here. Thesearch and destroyactions can be completed on all endpoints with an XDR agent. In my gif, I am demonstrating the search action on a specific file path, so the query will only return results on endpoints containing the file path in question. If you want to ensure the file in question is completed on all endpoints, then you will want to search and /or destroy on the file hash (e.g. Sha256), because the file could have been modified, moved...etc.In addition, the ""endpoints"" dataset includes information in regards to your endpoint administration. You will want to query in the xdr_data dataset, or you may leverage the applicable presets. Your results are going to vary depending on the file access type. Example:preset = xdr_file | filter action_file_sha256 = ""90be1c2c0fc5c36b3e10dcd89a8cda61462cb420a043a5759a7e1e3bba3eee38"" and event_sub_type in (ENUM.FILE_CREATE_NEW, ENUM.FILE_OPEN, ENUM.FILE_RENAME, ENUM.FILE_REMOVE, ENUM.FILE_WRITE)I hope this helps.",1,02-02-2022,02:29 PM
636,462612,AndrewGalvinGH,I don't have the file_search option.,0,02-08-2022,12:16 PM
637,428786,yalonso,"Hi Expert,Please give me advice, So I have assesment for exclusion folder and file .exe and file etc extension.The asessment from Sophos for agent existing my customer.The example exclusion files like a below :C:\Windows\System32\backgroundTaskHost.exeC:\Program FIles (x86)\Microsoft SQL Server\*.txt, more againSo my question is, where I can add the exclusion folder/files, Malware Profile or Exception Profile?Hello Muhammad-Rusli,It would be a best practice to first check the details of the incident and alarms within it to understand why the application was prevented, alert sources and the need for the exception. You can add more granular detail to your baseline policies configuring an exceptions profile. (f.e Process Exceptions, Support Exceptions, Behavioral Threat Protection Rule Exceptions, Local Analysis Rules Exceptions",0,08-26-2021,01:01 PM
638,428786,magarcias,I'm also having a difficult time looking for file extensions exclusions if that is even possible?,0,02-08-2022,07:13 AM
639,464109,moixsante,"Hi@GradyThanks for your question, for maximum reach and support, could you please re-post your query in English?Thanks in advance.",0,02-08-2022,02:10 AM
640,464109,Grady,"Sorry,I re-edited the question",0,02-08-2022,02:18 AM
641,461165,tugriceri,Dear fhu_omiThere is no content update specifically forCVE-2021-4034 yet but this does not mean that you'll be unprotected. Cortex XDR focuses TTP's and unknownsand You'll be protected by BTP module.,0,01-26-2022,08:34 AM
642,461165,hu_omi,"Dear @etugriceriI will test it, then we will see if there existing modules will cover this pointer vulnerability. There is a test program out now: https://pythonrepo.com/repo/kimusan-pkwner",1,01-30-2022,11:30 PM
643,461165,Luc_Desaulniers,"Hello@fhu_omi, did you get a chance to run some tests?I ran a test on a test environment with XDR pro enabled and the exploit was allowed to execute without tripping anything on Cortex side initially. I did get a wildfire post detection a few hours later.I'd like to hear others feedback for this one.Thanks",0,02-02-2022,09:23 AM
644,461165,teJacobCF,what version and content release is your asset on?,0,02-03-2022,01:25 PM
645,461165,tugriceri,"Hi@fhu_omidid some test on this and I'm sharing a couple of sample below. You can play with them better detection or prevention. For the prevention, You need to create BIOC rule and add to Linux restriction profile. I'm sharing for demonstration purposes, might be intrusive and might need find tuning on it before using production. But the point is, even if PANW not shared BIOC via content update, still you can write your own prevention rule.For detectionpreset = xdr_process| filter action_process_image_command_line contains ""GCONV"" and action_process_image_name in (""sh"",""bash"",""zsh"") and actor_process_image_name = ""pkexec"" and agent_os_type = ENUM.AGENT_OS_LINUXpreset = xdr_process| filter action_process_image_command_line contains ""GCONV"" and action_process_image_name in (""sh"",""bash"",""zsh"") and agent_os_type = ENUM.AGENT_OS_LINUXfor PreventionProcess [ action type = execution AND target process cmd = *GCONV* ] AND Host [ host os = linux ]Process [ action type = execution AND target process cmd = sh*GCONV*sh , bash*GCONV*bash ] AND Host [ host os = linux ]Process [ action type = execution AND target process name = sh , bash , zsh AND target process cmd = *GCONV* ] AND Host [ host os = linux ](three different sample)",1,02-07-2022,08:18 AM
646,463021,WSeldenIII,"Hi@Jordan.SchuldIt appears that you seeking a reference to Uninstall the Cortex XDR Agent.The reference link that I provided is for the Windows OS, but on the left-hand side of the tech. doc. you can reference the additional OS types as applicable.If you continue to experience challenges with this process, then you may need to engage with Support in order to assist with troubleshooting / remediation.",0,02-03-2022,07:23 AM
647,463021,Jordan.Schuld,"I tried that, but the first command in step one did not work",0,02-03-2022,07:49 AM
648,463021,Jordan.Schuld,"I figured out I was in the wrong directory, but it asked for a password. I tried the password to the computer and Password1 but neither worked",0,02-03-2022,08:56 AM
649,463021,WSeldenIII,"It appears that the uninstall password may have been changed from the default configuration with in the agent setting profile assigned to the policy on the endpoint. You may need to coordinate your XDR admin. in order to obtain the uninstall password, or two assign the endpoint to policy where the anti-tampering agent security has been disabled (see second bullet point in step 1).If you continue to experience challenges with this process, then you may need to engage withSupportin order to assist with troubleshooting / remediation.",0,02-03-2022,12:49 PM
650,463021,teJacobCF,you could get the cleaner from support. or you could create a profile that disables the anti tampering and push that to that asset.,0,02-03-2022,01:24 PM
651,462996,moixsante,"Hi@Daniel_Itenberg,What's the Malware module alerting about fixdep?",0,02-03-2022,05:55 AM
652,462401,moixsante,"Hi@Daniel_ItenbergThe Broker's proxy option does not affect the whole network connectivity of your endpoint. The Cortex XDR agent is the only application using the Broker's Proxy.Did you check the Windows Internet Option to see if there is anything configured there?In the malware profile, we have the Network Packet Inspection Engine, are you using this module? If yes, did you try to put it in Report mode? or even disabling it?",0,02-01-2022,01:59 AM
653,462401,Daniel_Itenberg,"The user's laptop died before IT had the option to check it, so i guess that it wasn't related to the xdr",0,02-03-2022,02:52 AM
654,462635,WSeldenIII,"Hi@M_BrownAs a best practice you will first want to ensure that you are running the latest agent cleaner version (E.g. 7.6.1). Please raise a support ticket to receive the latest version accordingly.If a third-party tool needs to be used to run the install silently, then one can encrypt the uninstall password. This generates a password string that can be used with additional parameters. This method avoids using plaintext passwords. Listed below are some of the available parameters:XdrAgentCleaner.exe --encrypt <password>XdrAgentCleaner.exe [--silent] [--password <password> | --encrypted-password <password> | --advertised] [--log <logpath>]XdrAgentCleaner.exe -? | -h | --helpOptions:-? -h --help Show this screen.-e --encrypt Encrypt password.-s --silent Silent mode. No UI will be displayed while running. --password or --encrypted-password is requiredif self-protection was enabled (including am-ppl).Please coordinate with support if you require any additional troubleshooting.",0,02-02-2022,09:07 AM
655,462635,M_Brown,Thank you for this! I couldn't for the life of me get the help parameter to work. I finally found the parameters using Process Explorers String tab right before you answered. Hopefully your answer helps others :).,1,02-02-2022,09:14 AM
656,460811,bbarmanroy,"Hi@MarioStockinger, you can adjust the Agent settings to ensure the license is not revoked. In your case, the Agent Deletion (days) entry should be a high value within your organization's acceptable standard for a host to remain offline and yet retain the license. Once the license is revoked, the agents won't be able to reconnect to the tenant and automatically update to the supported versions (if the Agent Settings profiles are applied to allow automatic upgrades).",0,01-24-2022,11:33 PM
657,460811,MarioStockinger,"We have set 30/180 days , so the second value is responsible that the client will loose the licence and can't reconnect ?Did i understand that correctly ?Is it Possible to pin a licence to a client so it will never loose the licence ?",0,01-24-2022,11:42 PM
658,460811,bbarmanroy,"The 30/180 is default. You're right, you'll need to adjust the '180' (Agent Deletion) to a higher value to ensure the licenses are not revoked. Please take a look at the license revocation process here.No, it is not possible to pin a license to a host/client as per the current license process. You can use the cytool reconnect command from the endpoint to resume connectivity.",1,01-25-2022,12:11 AM
659,460811,MarkusKnappe,Have a look at this:https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/reconnect-disconnected-xdr-clients-remot...,0,02-01-2022,01:51 AM
660,461778,teJacobCF,"hello@KRisseladayeah I am running just XDR prevent not pro and it can be a chore for sure.I basically have to monitor for the email content release and then check my console and sort by content version.I have talked to support a few times and my SE. The only real fixes are remove the agent and re-install specifying that content release during install (this is not always ideal). or download a support file from the console and sort thru it... the reasons why can be quite a few but some are low diskspace. I wished that you could force a content update and get a better answer without having to spend a ton of time. Basically support tells you to ""just wait"" it will come when it comes, or check hard drive space.keeping up to date with content releases is really very important and overlooked imo",1,01-28-2022,07:47 AM
661,461722,tugriceri,"There are two important facts about licensing. Even your agents are not active, Cortex XDR is keeping Agent data's and after 180 days, Data's will be deleted and count 481 will be decreased. But Licensing is calculating totally different. After 30 days connections lost status, agent license will be returned to pool.Connection Lost (Days)—Configure the number of days after which the license should be returned when an agent loses the connection to Cortex XDR. Default is 30 days; Range is 2 to 60 days.Agent Deletion (Days)—Configure the number of days after which the agent and related data is removed from the Cortex XDR management console and database. Default is 180 days; Range is 3 to 360 days and must exceed theConnection Lost value.Hostname and ip address are not impacting to calculating Uniq machine ID. But mac address changes does. Even a host changes ip and hostname, will not consume another license. You can re-image host, as long as you keep same hardware, same license will be applied to host.For the duplicates, You can delete manually from management console or API. otherwise cortex xdr will delete agents after 180 days.",1,01-28-2022,01:53 AM
662,458898,bbarmanroy,"Hi@Cyber1985From the article, it appears that the bypass attempts were blocked, or am I reading it incorrectly?For your endpoint issues,for #1, are you able to reproduce the issue or is it a one-time incident? Does the BSOD happen every time you try to quarantine or delete a file?for #2, it is not clear from your explanation if the issue is related to Cortex XDR agent or the Java-based application. It might be an issue with the JVM's on the hosts and not Cortex XDR. If your issue persists, please create a support ticket at support.paloaltonetworls.com with agent logs for the corresponding teams to analyse the issues.Hope this helps!",0,01-16-2022,08:41 PM
663,458898,Cyber1985,"Hey @bbarmanroyThanks for the fast reply!As I understood the final showdown can bee seen in the last Video and the Text above.#1 could be reproduced, but our PoC is over and there wasnt enough time to submit a Ticket.#2 You are right, the issue came from jvm. I Dont except a solution, i wanted to share my XP.Best RegardsRob",0,01-16-2022,10:25 PM
664,458898,bbarmanroy,"Hi@Cyber1985What I see in the last gif is the Cobalt Strike beacon being detected and a Cortex XDR agent popup that says ""Cortex XDR agent has blocked a malicious activity!"", which contradicts the text. It's a bit unclear here.Cortex XDR engineering teams continuously looks for evasion techniques and bakes appropriate detection and/or prevention techniques to mitigate such actions. My recommendation is to try to recreate the POC and if successful, reach out to your account teams who will guide you through the next steps.",0,01-16-2022,11:36 PM
665,458898,Cyber1985,"hello!The correction of the above mentioned evation technique was allredy fixed I was told by the researcher himself.For issue#1: yes, everytime I tried to delete or quarantined a not existing file I got an BSOD.Issue#2: yes indeed, the root of the problem was caused by not well configured JVMs.Best RegardsRob ",0,01-26-2022,10:36 PM
666,458898,bbarmanroy,"Hi@Cyber1985Thank you for reaching out and confirming the point on XDR capabilities.For your case where the endpoint is experiencing a BSOD for triggering a File Search and Destroy for files that are deleted or quarantined, I recommend you to open a support ticket and upload the support file for the affected endpoint. Please ensure your endpoint is running a supported version of Cortex XDR and has not reached End-of-life.",0,01-27-2022,05:06 AM
667,458898,teJacobCF,what agent version and what content version was this performed with?,0,01-27-2022,05:29 AM
668,458898,Cyber1985,It was around Version7.4.2.3569.We are out of PoC. So we cannot open any support case.,0,01-27-2022,11:19 PM
669,461313,tugriceri,"Dear PierazzoDWindows 2008 or Windows 2008R2 is not supported by Cortex XDR 7.4 agent. You need to have at least Windows 2008R2 SP1 for XDR Agent 7.4.https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...You can verify compatibility from above link. If you are trying to install Windows 2008R2 SP1, Could you try to install with below command. Msiexec will create install.txt file in C drive and please check that file content for failing reason.msiexec /i Emre_pkg_x64.msi /l*v c:\install.txt",0,01-27-2022,12:44 AM
670,461313,azzoD,"The OS is Windows Server 2008R2 SP1I've tried also with that command and it failed.In the zip there is the log file of the installation, it fails to start dependance services.",0,01-27-2022,02:10 AM
671,461313,tugriceri,"Dear PierazzoDmsiexec is throwing 1603. This is generally related with account permissions that you are trying to install but might be other reasons which described in below article. Also you can check service status from windows event logs. You may have more detailed information.ExecServiceStartCA: Error 0x80070241: StartServiceW failedExecServiceStartCA: Error 0x800705b4: Service failed transition to 4 state (current state 1)ExecServiceStartCA: Error 0x800705b4: StartServiceWait failedExecServiceStartCA: Error 0x800705b4: ServiceStartInternal failedCustomAction ExecServiceStartCA returned actual error code 1603 (note this may not be 100% accurate if translation happened inside sandbox)Action ended 10:11:21: InstallFinalize. Return value 3.MSI (c) (A8:84) [10:11:37:757]: Windows Installer installed the product. Product Name: Cortex XDR 7.6.0.43778. Product Version: 7.6.0.43778. Product Language: 1033. Manufacturer: Palo Alto Networks, Inc.. Installation success or error status: 1603.https://docs.microsoft.com/en-us/troubleshoot/windows-server/application-management/msi-installation...",0,01-27-2022,03:06 AM
672,461313,teJacobCF,honestly if your up to date on patches for 2008r2 sp1 and are still getting that error I would run the cleaner reboot and then install that version.,0,01-27-2022,05:34 AM
673,461313,azzoD,"I've controlled the permission of the user and seems to me that it has the right privilege.these are the log i got from event viewer of Windowslog1:Log Name: SystemSource: Service Control ManagerDate: 27.01.2022 12:33:35Event ID: 7000Task Category: NoneLevel: ErrorKeywords: ClassicUser: N/AComputer: MyServer.DomainDescription:The cyvrmtgn service failed to start due to the following error:Windows cannot verify the digital signature for this file. A recent hardware or software change might have installed a file that is signed incorrectly or damaged, or that might be malicious software from an unknown source.Event Xml:<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event""><System><Provider Name=""Service Control Manager"" Guid=""{555908d1-a6d7-4695-8e1e-26931d2012f4}"" EventSourceName=""Service Control Manager"" /><EventID Qualifiers=""49152"">7000</EventID><Version>0</Version><Level>2</Level><Task>0</Task><Opcode>0</Opcode><Keywords>0x8080000000000000</Keywords><TimeCreated SystemTime=""2022-01-27T11:33:35.055852400Z"" /><EventRecordID>1005547</EventRecordID><Correlation /><Execution ProcessID=""1056"" ThreadID=""3788"" /><Channel>System</Channel><Computer>ITSPDB01.intranet.salewa.com</Computer><Security /></System><EventData><Data Name=""param1"">cyvrmtgn</Data><Data Name=""param2"">%%577</Data></EventData></Event>Log2:Log Name: ApplicationSource: MsiInstallerDate: 27.01.2022 10:11:37Event ID: 1033Task Category: NoneLevel: InformationKeywords: ClassicUser: DomainAdminComputer: MyServer.DomainDescription:Windows Installer installed the product. Product Name: Cortex XDR 7.6.0.43778. Product Version: 7.6.0.43778. Product Language: 1033. Manufacturer: Palo Alto Networks, Inc.. Installation success or error status: 1603.Event Xml:<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event""><System><Provider Name=""MsiInstaller"" /><EventID Qualifiers=""0"">1033</EventID><Level>4</Level><Task>0</Task><Keywords>0x80000000000000</Keywords><TimeCreated SystemTime=""2022-01-27T09:11:37.000000000Z"" /><EventRecordID>17677055</EventRecordID><Channel>Application</Channel><Computer>ITSPDB01.intranet.salewa.com</Computer><Security UserID=""S-1-5-21-861567501-484061587-725345543-500"" /></System><EventData><Data>Cortex XDR 7.6.0.43778</Data><Data>7.6.0.43778</Data><Data>1033</Data><Data>1603</Data><Data>Palo Alto Networks, Inc.</Data><Data>(NULL)</Data><Data></Data><Binary>7B46364144333634302D434530432D344539312D413446392D4343313836433530464335337D3030303033656464653732656261356330373032353264656631623930346337623261643030303030393034</Binary></EventData></Event>I've tried also with localadmin of server, but i've always the error at the moment to start new services (cyvera).",0,01-27-2022,06:40 AM
674,461313,tugriceri,"Dear PierazzoD""Windows cannot verify the digital signature for this file."" log is clear indication of the problem. You can clean XDR with cleaning tool. For the getting this tool, You need to open a ticket via support portal and then you can try again to install.Alternative solution, Required certificates are installing to certificate store when you install XDR. so You may try toDDISABLE_INTEGRITY_CHECKS with bcdedit. Try to upgrade and restore to old configs (enable integrity check). Btw, I've never tried this before and thats why I'm gonna recommend open a support request again.",0,01-27-2022,07:24 AM
675,460796,bbarmanroy,"Hi@RahulPrajapatiusers cannot uninstall or disable any functionalities without the Agent password defined globally or in Agent settings profile applied to a host. If you have a PoC to demonstrate the bypass, we can definitely take a deep dive at it to fix the issue.In short, you won't get a notification for such behavior at this point in time.",0,01-24-2022,10:16 PM
676,460796,RahulPrajapati,"Hi@bbarmanroy,Some local engineers had the uninstall password so we have changed it. I can see the Agent service stop logs from Agent Audit logs. But many of them can possibly means that system got shutdown and so Agent service got stop. But if any user tries to disable the agent service using cytool command. Can we know that information from the Agent audit logs?Regards",0,01-25-2022,12:50 AM
677,460796,bbarmanroy,"Hi@RahulPrajapatiyou are correct - a shutdown will stop Agent services.If a user is successfully able to stop one or more XDR agent services, that will be listed as an event in the Agent Audit logs. Unsuccessful attempts won't be listed.",0,01-25-2022,05:40 PM
678,460782,bbarmanroy,"If this problem started right away after installing on your host, you can try removing and reinstalling the agent. Otherwise, please raise a support ticket to advise you on your break-fix issue. Please upload the support logs in the support center for the team to take a look at.Is the space left in your installation path significantly greater that the alloted storage for Cortex XDR?",0,01-24-2022,10:38 PM
679,460157,bbarmanroy,"Hi@Rindsland, your question seems to be similar to this. You can create a Malware Profile(Step 3, sub-step 3) allowing the PS script (full path) to be exempted from analysis and associate it with a policy that is applied to the selected set of servers.If this works for your case, please let us know if it worked, and accept the response as a solution for others to refer to and follow.",0,01-23-2022,06:38 PM
680,460157,Rindsland,"Hi@bbarmanroy, it comes from Module Anti-Ransomware Protection, so I am not sure, if it really helps here, but I will give it a try.Looks for me that the Anti-Ransomware Modul doesn't have really a exception, or?I am also aware that I also can stop the Modul completely via Malware Profile on our Remote Session Host Servers, but I think you will also agree, that this not a good idea.Anyway thank you for your Input and trying to help for finding a Solution for this.Best regardsMarcus",0,01-23-2022,11:41 PM
681,460157,bbarmanroy,"Hi@Rindslandthe Powershell script that you're trying to execute is vetted and trusted within your organization, if I understand correctly. If Cortex XDR is flagging it as a ransomware and preventing it from executing, that is because the script possibly has some actions that are similar in nature to a ransomware. Which is good - it is a sign that you're running the Ransomware module protection in Block mode!Coming back to your need, what I am recommending is for you to create an Exception only for that trusted script, and apply it to only those set of servers. No other modules or protections are being disabled, for anything else that is running in your organization.The recommendation is:1. create a copy of your existing Malware profile that is currently applied to those servers.2. Edit the new Malware profile to create an exception for the trusted powershell script.3. Create a new policy that will apply the Malware profile to the specific set of servers.Hope this clarifies my recommendation.",1,01-24-2022,02:00 AM
682,328138,dfalcon,"Hi@Marsooq-Akkaradathil-The current version of the product can only block an IP Address. You can, create an IOC that will alert on this. If you use XSOAR, you could also action on the IOC.",2,05-18-2020,08:48 PM
683,328138,NikolayDimitrov,Great thank you! Hope they add the new feature to block also domains if not URL with the host firewall. Till then if the customer also has Palo Alto firewalls maybe this is an option for the Cortex XDR to generate EDL lists that the Palo Alto firewall (Palo Alto Firewall and Cortex XDR integration) can consume:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...Also it is good to enable the firewalls access to the Cortex XDR and for the firewall to send its logs to the Cortex Data Lake so the Cortex XDR can see the network taffic:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/get-started-with-cortex...https://www.paloaltonetworks.com/blog/2020/03/cortex-busted-by-cortex-xdr/,1,01-24-2022,01:50 AM
684,460036,bbarmanroy,"Hi@RahulPrajapatiyou can use a Malware profile to key in a file path (see Step 3, substep 3 here).Alternately, you can also look at using Exception Profile for specific modules that you want the process to be exempted from (Step 3 here).",0,01-20-2022,10:10 PM
685,460036,RahulPrajapati,"Hi@bbarmanroy,But this will allow/block the file on all endpoints on which this profile is applied right? But I want to allow/block the file for specific endpoint not all endpointsRegards",0,01-20-2022,10:31 PM
686,460036,bbarmanroy,@RahulPrajapatiyes. Please create a new profile and apply it to a single endpoint/set of endpoints/static or dynamic groups as per your prevention policies.,1,01-20-2022,11:44 PM
687,459840,bbarmanroy,"Hi@PierazzoDthere are a few ways that XDR can detect it. If Cortex XDR is installed after the malware is already in the process of encrypting files (e.g., ransomware), BTP's will protect against anything deemed suspicious/malicious, including ransomware-related activities.To ensure complete protection, it is recommended to restart the host after a successful agent installation and ensure the security profiles are configured and applied appropriately.Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...",0,01-20-2022,10:18 PM
688,459563,bbarmanroy,"Hi@OtisMclaughlin, Welcome to the forum!There is a bit to unpack here, but I'll keep it concise. This announcement was originally announced on Oct 2021, and affects endpoints which meet the following criteria:Cortex XDR agent version 7.2.1 - 7.3.3 and 7.4.0Windows 10 version 20H2 (build 19042) and aboveIntel Tiger Lake or AMD Zen-3 processorsTo answer your question: the sub-components listed in the ""Impact"" section will be disabled due to incompatibility. What it means is: the affected endpoints won't be secured against any attacks that are protected by those sub-components, one of them being BTP. You can read up on BTP's here.What you can do is to upgrade affected systems to Cortex XDR agent 7.3.4 or higher, 7.4.1 or higher, or 7.5.0 and higher, and 7.6.0 and higher.You should also note that the affected versions (v7.2, v7.3 and 7.4) are nearing end-of-life, so you should review your endpoints and upgrade them inline with your organizational upgrade strategy.",1,01-19-2022,07:59 PM
689,459232,bbarmanroy,"Hi@chaim_AvisrurPlease try the following steps in sequence:Step 1You can stop XDR agent and start it with the following commands:1. cytool runtime stop2. cytool runtime startIf it fails, try step 2.Step 2Check if the problem persists after a rebootIf this fails, try step 3.Step 3Create a support ticket and upload the support logs. You can collect support logs by referring to the documentation here.",0,01-18-2022,07:34 PM
690,459232,jcandelaria,"Hi @chaim_Avisrur,Just to verify as well, any of the criteria on this guide are met? even after the runtime stop/start command provided by@bbarmanroyhttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/monitoring/monitor-agent-op...",0,01-18-2022,10:26 PM
691,458918,Cyber1985,"Hey! As far as I know, you could try windows safe mode?Best regardsRob",0,01-16-2022,01:29 AM
692,458918,bbarmanroy,Hi@KiranBashyalDo you have access to Powershell? Try uninstalling with Powershell (with administrator privileges) instead of Command Prompt.Ref: https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-5/cortex-xdr-agent-admin/cortex-xdr-agent-for-...,0,01-16-2022,09:34 PM
693,458918,KiranBashyal,Thank you for the response. No the CLI (CMD and Powershell) is also been blocked . This is the new case i have discovered.,0,01-16-2022,11:45 PM
694,458918,uis,"Hi all,if you cant disable anti-tampering with the link my colleague @bbarmanroy provided(https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-4/cortex-xdr-agent-admin/cortex-xdr-agent-for-...I guess that you neither can't open a live terminal from the consoleYou might need to reboot windows in secure mode and use the cleaner (this should work). If you cant manage to do it by yourself, I recommend to open a support case and our TAC engineers will help you on this uninstall.KR,Luis",0,01-17-2022,03:33 AM
695,458228,bbucao,"Hi Zaffrul,Rebooting after agent install is not a requirement but is always recommended.",0,01-12-2022,06:54 AM
696,458228,N2Z2,"As far as I know, rebooting is not required but the processes that are already started upon installation will not be monitored until reboot.Is that correct?Thanks",0,01-12-2022,07:01 AM
697,458228,bbucao,"Hi Nicola_Nuzzi,That is exactly correct! Thanks!",0,01-12-2022,07:05 AM
698,458228,bbarmanroy,"Hi All,BTP's also monitor for any suspicious activities, so any malicious actions (which may be already running, e.g. ransomware) will be detected and appropriate actions taken based on policies.",0,01-12-2022,11:22 PM
699,457937,bbucao,"Hi Nicola_Nuzzi,XDR does support the use of ""wildcarding"" when defining criteria for a dynamic host group, which would allow you to define the first characters you want to match in the given field followed by ""*"" which will cause the filter to match anything that starts with those characters.Examples:Endpoint Name = QQ* (The filter will match any endpoint whose name starts with ""QQ"")Endpoint Name != QQ* (The filter will match all endpoints whose names do NOT start with ""QQ"")Please reference step 4 in the documentation linked below for defining criteria for dynamic endpoint groups. Thank you for choosing Cortex XDR!https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/define-en...",2,01-11-2022,07:29 AM
700,457937,N2Z2,"Hello,it turned out to be a silly question ‌‌😐Thank you!",0,01-11-2022,08:31 AM
701,457937,bbarmanroy,"@N2Z2it is not a silly question! Thank you for raising the question, and thank you@bbucaofor answering it. We learn together as a community. 🙂",0,01-11-2022,11:01 PM
702,457492,jcandelaria,"Hi Grady,The first top two highlighted are referring to the OS Windows Snapshot (Shadow Copy) and the periodic snapshot refers to our host insights data that XDR is collecting periodically.",0,01-10-2022,12:42 PM
703,456896,Casey69,I am looking for the same.njmcdirect,1,01-05-2022,04:23 AM
704,456896,bbarmanroy,"@MohanKumar1@Casey69HIPS stands for Host Intrusion Prevention System. Cortex XDR is an EDR solution, and I assume what you're looking for is explained in detail here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...Yes, XDR supports Host Firewall capabilities. You can refer to this documentation here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/hardened-...",1,01-06-2022,06:41 PM
705,456896,MohanKumar1,@bbarmanroyThanks for the information. It is confirmed HIPS is not support or not the module available in Cortex XDR as an endpoint security. Or let me know if I am wrong.Host Firewall is available in EDR.,0,01-09-2022,04:59 PM
706,456896,bbarmanroy,"@MohanKumar1Cortex XDR certainly covers the capabilities of a traditional HIPS, and much more. What features of HIPS are you looking for?",0,01-09-2022,07:05 PM
707,456896,MohanKumar1,"Does the default XDR update IPS signatures automatically. If yes, How do we check / ensure.",0,01-09-2022,07:08 PM
708,456896,bbarmanroy,"Hi@MohanKumar1the logical equivalent of that would be the ""XDR Content Updates"", commonly referred to as CU's. You can check the corresponding CU's for an agent via the Endpoint Administration page.Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/about-con...You can modify the CU updates based on your Agent settings (see brief explanation here).",1,01-09-2022,07:21 PM
709,456896,MohanKumar1,"Thanks, this was the clarification I was looking.😊",0,01-09-2022,08:24 PM
710,456896,uis,"Hi MohanKumar1,xdr agent can perform packet inspection in its own fw (dont take it as a full featured FW as our NGFW) in the link that my colleague@bbarmanroysent you can see at the end of the features list the packet inspection.Also realize that we can gather your network traffic and analyse it on the cloud not just with signatures, better than that we perform ML and detect malicious traffic from new attacks that will not be detected by standard signatured based IDS. All this signatures and intelligence is maintained by PANW, you dont need to worry about them.Please check out these two docs:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/cortex-xdr-overview/cortex-...https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-release-notes/set-up-network-analysis...Hope this helps also.KR,Luis",0,01-10-2022,03:06 AM
711,457205,bbarmanroy,@LinsongGuois the question for XSOAR? This is a XDR forum.,0,01-06-2022,06:36 PM
712,457205,LinsongGuo,oh sorry yes it is XSOAR question can you move it or I should create another one?,0,01-09-2022,01:13 PM
713,457205,bbarmanroy,@LinsongGuoIt's best you mark this as Solved and create a new topic in the XSOAR forum.,0,01-09-2022,07:07 PM
714,456271,EddieRowe,"As luck would have it I cannot duplicate the issue now that I am back in town on test systems.I did add the IP address to the malware profile under ""Respond to Malicious Causality Chains"", but I am not sure if this will resolve this issue.  The Action Center does not show the IP address of the security scanner as being blocked, but I don't know if that resets after some period of time.Respond to Malicious Causality Chains",0,12-31-2021,12:54 PM
715,456271,palcev,"Hi@EddieRoweheuristic.b.205 - POWERSHELL DOWNLOAD CRADLES.What do you mean by ""Instead I would want to allow this activity only when initiated by this IP address""? Do you want to allow/block this BTP from a specific group of endpoints?",0,01-03-2022,01:33 AM
716,456271,IonPuscasu,Content Update version 320-79444 seems to fix this False-Positive alert.,0,01-03-2022,10:13 AM
717,456271,EddieRowe,I was looking for a way to exclude behavior protection from the IP address that is used by the scanner.,0,01-07-2022,01:16 PM
718,457085,teJacobCF,"I would think that you should at least be able to look at your ""assigned prevention policy"" and ensure that the ""malware"" profile assigned to all assets has scans enabled.does this make sense?",0,01-06-2022,07:41 AM
719,457085,pdysart,"Yes, the assigned prevention policy is set to scan all of these endpoints on a weekly basis. But we have several thousand endpoints that have not had a successful scan in months, and those are the endpoints I am interested in looking at.I am less concerned about endpoints that ""Aborted"" their last scan, but had a successful scan a couple weeks ago, and more concerned about endpoints that haven't successfully scanned in several months.",0,01-06-2022,09:10 AM
720,457085,jtalton,"Hello Pdysart,For monitoring, you can generate a Custom Dashboard by navigating to Reporting>Dashboards Manager+ New Dashboard.You may build the report by creating a Custom XQL Widget and build an XQL query filtering on the last_succesful_scan attribute:dataset = endpoints |fields last_successful_scan, endpoint_nameYour query can have a specific time range such as an endpoint last scanned in 24H (hours), last 7D (days), last 1M (month), or select a Custom time period. Save and Run to review the results.Please reference for assistance with creating XQL queries.Build a Custom Dashboard (paloaltonetworks.com)Search Queries (paloaltonetworks.com)",1,01-07-2022,11:36 AM
721,410992,gjenkins,"We will be rolling out to production soon and we need to have full AV protection while Cortex XDR is in monitor mode for up to 2 weeks. The previous Cylance AV agent must be uninstalled prior to the Cortex agent being installed so running in parallel is not an option. Any thoughts on how other organizations have approached this or a recommend approach?Thanks in advanced any suggestions,DougHi @DougHolmes,I understand that you are looking to uninstall your previous AV while the Cortex XDR Agent is in monitor mode. Could you elaborate on the reasoning behind uninstalling the previous AV? Also, could you provide more context around why the Cortex XDR agent cannot run in block mode to provide the required protection for that period? If any recommendation could be made here given the information provided, it would certainly be to install the Cortex XDR agent in block mode as there will be no other endpoint protection software available to stop malicious activities in their tracks. I hope that this helps.",0,06-25-2021,08:48 AM
722,410992,jcandelaria,"Hi Doug,Hopefully my reply isnt that too late.. as you know XDR have compatibility issue with Cylance so yes, uninstall cylance before install xdr agent. And hopefully, you have done some canary group with no Cylance and XDR in block mode. That way at least you will get somewhere around 60-70% of the executables known to xdr and the rest, you can deal when incident triggers. Also when you remove cylance, usually the defender takes over if the xdr profile is set to report mode but once you switch to blocking mode then xdr will be registered as primary AV in security center.What I've seen from some customer, remove the cylance, install xdr agent but only specific modules are in blocking mode while the rest are in report mode. That way the SOC doesnt get overwhelm with all new alerts at the same time.. then slowly switching each module to block mode. What i would suggest is get a good understanding of XDR agent as incident source as those are the ones that will get blocked and how to address them so that way even if you deploy xdr agent all modules in block mode, you can easily manage and address those incidents on the right away.",2,06-25-2021,03:25 PM
723,410992,GarethDavies,"HelloWere currently doing the exact same thing, but through testing we have found while not officially compatible in the XDR docs XDR and Cylance can run side by side. We have found that in some server situations they don't work well together but Cylance has an undocumented (you can get it from cylance support) compatibility mode you can set in the windows registry that allows them to work side by side.",2,06-30-2021,08:55 PM
724,410992,AViola,Hi Gareth.DI have the same situation. Do you have the document about Cylance undocumented compatibility mode?,0,01-07-2022,10:51 AM
725,456639,bbarmanroy,"Hi@AsifSid, You're the best person to know what is running in your environments. You can run a XQL query to partially identify if the vulnerable JAR's are being loaded or if JNDI calls are being made in your estate.This should get you started on the right track:https://www.paloaltonetworks.com/blog/security-operations/hunting-for-log4j-cve-2021-44228-log4shell....",0,01-04-2022,07:15 PM
726,456639,ctor1,"The link asks us to log into a google account. We're a Microsoft shop, is there anywhere else we can download the file from?",0,01-05-2022,10:41 AM
727,456639,bbarmanroy,@Victor1It isa publicly available link. Are you able to view the link from your mobile or another device?,0,01-06-2022,06:34 PM
728,455546,uis,"Hi Systemsi,I recommend to boot windows in safe mode (pressing f8) and use the agent cleaner software.To install the new agents you need to create the agent package from the Cortex xdr console in your tennant, you choose operating system, agent version (recommended always to use the last release), copy the package to your endpoint and install it.References to installhttps://docs.paloaltonetworks.com/cortex/cortex-xdr/7-4/cortex-xdr-agent-admin/cortex-xdr-agent-for-...KR,Luis",0,12-28-2021,01:25 AM
729,452730,bbarmanroy,"Hi @JonathanYang_RXthe data is not available, IIRC.If your intention is to leverage XDR, you can write a Python script and execute it via Action Center, and parse the data for your needs.",0,12-13-2021,02:21 AM
730,452730,tugriceri,"Dear Jonathon,You cannot query active network state of hosts. Best way is doing this, as@bbarmanroymentioned, Action Center.You can write python script or you can execute command (netstat, ss etc) for the check current state of ports.with XQL, you can only query historical data. that might be either process data or firewall data.for process, you can usedataset = xdr_data | fieldaction_local_port = ""80"" orfieldaction_local_port = ""443""for windows firewall, (if enabled)dataset = host_firewall_events| filter local_port = 443 or local_port = 80in case of a made a connection towards to ports, you should have telemetry data.",0,12-13-2021,07:34 AM
731,452730,uis,"Dears,contributing with my 5 cents.for the command to runnmap -p 80,443 192.168.1.0/24or alsonmap-p 80,443 192.168.1.*Will scan your 80,443 ports on the whole 192.168.1.X network with /24 network mask, you will be able to see which ones are open from the output of that command and if on top of that you can see the traffic on the defender fw as @etugriceri shown on his XQL query, you could check also which ones had traffic (even due to your nmap) on the mentioned ports.Take into account that with this commands you will see if the ports are open (not if there was traffic previous to the nmap command)KR,Luis",0,12-13-2021,02:09 PM
732,452730,JonathanYang_RX,"Hello -Apologies for late response. Once the script runs, will the result be available in xdr_data dataset or it will be locally available on each target machine?",0,12-23-2021,02:50 AM
733,452730,JonathanYang_RX,"Hello Emre -Thank you for these suggestions, though I could not seeaction_local_port = ""80"" orfieldaction_local_port = ""443"".Tried using Firewall data and I think it's easier, though unfortunately we haven't deployed/enabled the firewall feature across our estate.",0,12-23-2021,02:53 AM
734,452730,tugriceri,"Dear Jonathan,Scripts which is located in Action Center is not updating xdr_data. You can only search data from that dataset, if an application establish TCP connection via that ports. (not listen).Thats why you can use execute_command script with ""netstat -a""or you can develop your own python script for getting that information from remote systems.",0,12-24-2021,06:04 AM
735,455055,uis,"Hi Pdysart,have you checked that you have physical network connection from this endpoint to the xdr tenant/console both ways (outbound/inbound). I mean, no Fw dropping connection, endpoint on isolated network or any other kind of network issue ....KR,Luis",0,12-22-2021,11:26 PM
736,455055,pdysart,Looks like other schools were having the same issue yesterday and the issue resolved itself. Today they are connecting to the console. Must have been a temporary network issue that has been resolved. Thank you!,0,12-23-2021,10:19 AM
737,453972,tugriceri,"Dear@chaim_AvisrurYou have two option as you know. You can write your own python script or ""execute_commands"" script.for both of them, You may need to import traps lib path in to environment variables. Could you try like below?export LD_LIBRARY_PATH=/usr/local/lib:/usr/lib:/usr/local/lib64:/usr/lib64:/opt/traps/glibc/lib/x86_64-linux-gnu/ && /opt/traps/bin/cytool ....Emre",1,12-20-2021,12:24 AM
738,453972,bbarmanroy,"@chaim_AvisrurIf you prefer not to change the LD_LIBRARY_PATH, you can consider changing the working directory usingos.chdir('/opt/traps/bin') before executing cytool. That should pick up the libraries from the relative paths.",0,12-21-2021,04:03 AM
739,453972,chaim_Avisrur,"hi@bbarmanroy,i tried it before(it didnt work) and also did some research ,if the change ofLD_LIBRARY_PATH if excuted within the script it is notpermanent on the machine only while the script is running.i did some tests and there is no change on that varible after the run.thanks",0,12-21-2021,04:30 AM
740,453972,bbarmanroy,"@chaim_AvisrurYou're right. The library paths need to be set before the script is executed. If you can run a shell script from your management tool, you can set the library path in the script and execute ""/opt/traps/bin/cytool reconnect force <password>"". This way, your global library path won't be altered, and the script should still execute successfully within the temporary environment of the session.",0,12-21-2021,05:38 PM
741,452723,bbarmanroy,"Hi @GarethDavies, I'd suggest you to use the file hashes instead of file names to search for the vulnerable libraries to narrow down to the exact list.If your search results are still exceeding maximum results, please consider searching via subsets of hosts by OS type, or a subset of hashes at a time. This is dependent of your search results, and I recommend you to tune it as you dig around.",0,12-13-2021,01:59 AM
742,452723,tugriceri,"Dear@gareth.dCortex XDR does not collect content of the files as telemetry data. Which means that you cannot search particular string which is in file by XQL.But you can write a python script for file content check and upload and execute via Action Center or execute command from action center again.But please be aware, This action will be pretty exhaustive and might create so much Disk IO.",0,12-13-2021,03:56 AM
743,452723,benjamin.murray,Any chance you could give an example XQL query that would let me load 30+ hashes into one search?,0,12-13-2021,10:15 AM
744,452723,bbarmanroy,"Hi@benjamin.murrayfresh off the press from Palo Alto Network's Managed Threat Hunting team, you've the query that you're looking for in the sectionHunting for Log4Shell in Your Network Section A. Search for the phrase ""Attempt to target all hosts that contain a file that matches the SHA256 hash of the Log4j vulnerable versions."". This will only detect any invocation/use of the vulnerable libraries. For searching for the presence of the same, you'd can use the method@etugricerisuggested for searching via Action Center or Python script with the well-known hashes.Link:https://www.paloaltonetworks.com/blog/security-operations/hunting-for-log4j-cve-20210-44228-log4shel...",1,12-13-2021,11:19 PM
745,452723,hu_omi,"Hello,Is there a possibility to extend the xql search to the firewall logs ""Session end reason""? Because, if i see sesssion end reason Threat, then i'm not interested because it is blocked. But in the xdr_data dataset is the session end reason not present.How can Cortex XDR stiching the Agent Logs togther with the firewall logs? Do they build a key in both datasets, like time, srcIP,dstIP, srcPort,dstPort,Protocol?",0,12-17-2021,06:14 AM
746,381151,dfalcon,Hi@DKasabji-Are you using Prevent or Pro?,0,01-21-2021,04:35 AM
747,381151,DKasabji,"Hey@dfalcon,I am inquiring about Pro. We are PAN partners and I am responsible for Cortex XDR POCs etc. and it often comes this question, how to detect endpoints that do not yet have installed XDR Agent in their environment.D",0,01-21-2021,04:55 AM
748,381151,dfalcon,Hi@DKasabji-Please see the bottom of this post:https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/directory-sync-usage/td-p/376055,0,01-21-2021,05:23 AM
749,381151,DKasabji,"Yep, aware about this one. However, this only works if all endpoints are joined into to the Domain (AD). It cannot detect endpoints that are not part of the domain.Was hopping Cortex would have some sort of passive scanner with Pathfinder to detect endpoints in environment and then populate them in Endpoint Administration console and mark them if they do not have agent installed (similarly like Directory Sync does).Best,DWas hopping there was some sort of passive scanner that would di",0,01-21-2021,05:51 AM
750,381151,dfalcon,Hi@DKasabjiCortex XDR does use more than Directory Sync -- the key is Asset Management. Please see this doc on how assets are discovered.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/asset-management/about-asse...,1,01-21-2021,06:04 AM
751,381151,DKasabji,"This look like a solution I was looking for David, thanks. I will give it a read.I have to see what else it requires to gain such visibility (Network Mapper, Pathfinder, Directory Sync, etc.).Thanks.D",0,01-21-2021,06:08 AM
752,381151,ESJosephPrinz,"Has anyone come up with a solution for this? I have been going round and round with cortex engineers and nothing. Pathfinder, after being told would do this, will not. I recently exported all the assets reported as no cortex agent, ran them through a reverse dns scripts and found hundreds and hundreds of PCs that were false negatives. It seems to me Palo has not solution for this which seems very very fundamental. Looks like we will need to develop our own. FYI we are all palo alto firewall, I dont know why the logs from the firewalls are not providing the names of the devices.",0,10-28-2021,08:10 AM
753,381151,ESJosephPrinz,This is not a solution unless names can be provided. Anyone have names in their asset manager? Platform even?,0,10-28-2021,08:11 AM
754,381151,teJacobCF,This stinks that it is for pro only. This should be available to all regardless of license pro or prevent. having the cortex agent loaded is the best way to have the product and your customers most successful.,0,10-28-2021,12:38 PM
755,453382,moixsante,"Hi@Kamal.KishoreIf you know the hash value of macro part of the Excel file, yes. You can use Hash View to search for it, or Query Builder, or XQL queries.",1,12-15-2021,09:49 AM
756,453382,Kamal.Kishore,"Ya I wouldn't know the hash value, it would be a general search or audit looking for any Office Macros by their file properties.",0,12-15-2021,10:04 AM
757,453382,moixsante,"Hi@Kamal.Kishore,The XDR agent office protection ignores Excel files with no macros and will only report on those with a seemingly malicious macro. What you can do is look in XQL for all executed Excel files.You could try something like thisdataset = xdr_data | filter event_type = ENUM.FILE and event_sub_type = ENUM.FILE_OPEN and actor_process_image_name = ""EXCEL.EXE""",1,12-15-2021,10:31 AM
758,453382,Kamal.Kishore,"Hi Fmoixsante,Thank you for your response.That's a great query to identify where Excel.exe is running but I don't see any data pertaining to macro events.",0,12-15-2021,11:00 AM
759,453382,jcandelaria,,1,12-15-2021,10:56 PM
760,453382,jcandelaria,"Hi Kamal,Try .xlsm instead.Thanks",1,12-15-2021,10:57 PM
761,453382,moixsante,"The query I shared also gives all the files that Excel has opened. The query is just a basic query that you could use and modify as you like.For instance,dataset = xdr_data| filter event_type = ENUM.FILE and event_sub_type = ENUM.FILE_OPEN and actor_process_command_line contains ""xlsm""I would suggest you check our XQL documentation hereand here.I would also recommend you check our Cortex XDR Walkthrough videos. We have many videos showcasing every part of the Cortex XDR product.",1,12-16-2021,01:43 AM
762,453550,jcandelaria,If you referring about Log4J exploit. Below are the details.https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/https://www.paloaltonetworks.com/blog/security-operations/hunting-for-log4j-cve-20210-44228-log4shel...The exploit attempt will be blocked by the Java Deserialization Exploit protection module which is automatically activated when you enable Known Vulnerable Processes Protection in the Linux Exploit Security profile. We highly recommend making sure the Known Vulnerable Processes Protection module is set to block (which is the default configuration). Once the module is set to block (which is the default configuration) Cortex XDR agent will block this activity and raise a Suspicious Input Deserialization alert.,1,12-15-2021,11:10 PM
763,453550,tejasp04,Thanks for reponse.,0,12-15-2021,11:16 PM
764,453340,moixsante,"Hi @AsifSidThe XDR agent will not uninstall itself for no reason. I would suggest you check your tenant. Also, the XDR agent, leaves log files in ""c:\programdata\cyvera\logs\""",0,12-15-2021,09:56 AM
765,453340,bbarmanroy,"Hi@AsifSid, as@fmoixsantesuggested, please refer to your Agent Audit Logs in the tenant portal to verify if the agent was uninstalled from the endpoint.",0,12-15-2021,06:31 PM
766,448169,teJacobCF,"I see that as well on a handful of assets as well. I spoke to the tac on this and they basically said to either un-install or run the cleaner.you can also try to use cytool to disablehttps://docs.paloaltonetworks.com/cortex/cortex-xdr/5-0/cortex-xdr-agent-admin/traps-agent-for-windo...Having said that I always see this on a handful of assets, and find it is just quicker to either uninstall the old version then re-install.would be nice to know why this is happening.",0,11-17-2021,05:44 AM
767,448169,ssentinel,Hello.I have tried uninstalling and running the cleaner. Also with the cytool tool to disable.this is the error that appears when reinstalling the new version.,0,12-14-2021,03:31 AM
768,448169,moixsante,"Hi@irissentinelAs@PeteJacobCFmentioned, you first need to disable the Agent Tampering protections.You need to open CMD in admin mode, cd to ""c:\program files\Palo Alto Networks\Traps\"", then type ""cytool protect disable"". You will need to enter the Supervisor/Uninstall password. All protections are disabled. Now you can continue with uninstall/install process.",1,12-14-2021,04:04 AM
769,452094,tugriceri,"Dear Shmuel,What did you see in the log exactly ? Could you share?What is the current status of the upgrade?Could you check from action center?Also, could you verify status fromEndpoints > Endpoint Administration > Auto Upgrade Status column.Emre",0,12-08-2021,06:56 AM
770,452094,Shmuel,,0,12-08-2021,07:34 AM
771,452094,KRisselada,"@ShmuelI believe what they were asking was to first go into the ""Endpoints > Endpoint Management > Endpoint Administration"" and THEN you may need to select the 3 dots, in the upper right hand corner, then select FILTERS and select the other fields that are not normally selected (you may have the ""default view"" currently)One of the options to select to view is: Auto Upgrade StatusAs a Layout Configuration option. By default this is not selected, thus not in the view.See screenshot belowHope that helps",2,12-08-2021,08:42 AM
772,452094,Shmuel,Thank you,0,12-08-2021,09:22 AM
773,452094,apuga,my windows 11 machine - pushed out the update and it disabled cortex and never installed 7.6. I had to reboot to get Cortex 7.5.x to restart.,0,12-08-2021,02:46 PM
774,452094,tugriceri,"Dear Shmuel,Thank you for log. Noticed that you have ""Installation success or error status: 1603."" in your log. This is typical msi package installation error.That error might related with the permission of the installer account but i guess in your case, windows installer cannot able to install an app which is already existing on the system and checking XDR folders, still there and throwing this error.https://docs.microsoft.com/en-us/troubleshoot/windows-server/application-management/msi-installation...Im gonna recommend to try installation manually first. check detailed installation logs. please use below command.msiexec /i XDR_pkg_x64.msi /l*v c:\install.txtand then please try uninstallmanually and manually install again.",0,12-09-2021,06:42 AM
775,452094,tugriceri,Dear Papuga7.5 agent is not supported for Windows 11. I'm recommending to use 7.6 agent for Windows 11https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...,0,12-09-2021,06:45 AM
776,452094,moixsante,"Hi@Shmuel,As@etugricerimentioned, error 1603 could be related to permissions for the msi installed. I reason for this could be related to pending reboots in the machine. For instance, Windows updates were applied, and the endpoint needs a reboot to finish installation. MSI gets ""blocked"" and does not allow other msi installations. I would suggest a reboot if possible and try again.",0,12-09-2021,08:27 AM
777,452094,Shmuel,Thank you!!,0,12-13-2021,05:57 AM
778,452530,tugriceri,"Dear OrkanAlibayli,Without checking directly from hosts, not easy to understand reasons. Best thing is to be in touch with Support and they can collect required log files from you and analyse them.2Gb memory usage is normal for windows, 2Gb is required minimum.But my advise would be if problem occurring specific servers like database, web servers etc, you can focus just that servers and please open case without restart XDR. High memory usage is not common problem and you may hit a bug and needs to be analysed.https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-0/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",0,12-13-2021,04:50 AM
779,452206,tugriceri,"Dear Ben-Price,One of the role of brokerVM is working like HTTP proxy. not necessary to be in same vlan with you XDR agents unless xdr agent located in private vlan. if a vlan does not have a gateway for routing, yes one of the interface of brokerVM should be in this vlan.BrokerVM is not router. its not routing TCP packages of agents. its proxying of HTTP requests.Proxy server on BrokerVM is for parent proxy. if brokerVM cannot able access internet (due to your infrastructure), you can define parent proxy. in that case, agent will connect BrokerVM and BrokerVM will connect parent proxy.Internal network configuration is a configuration for avoiding potential conflict with docker network which is located on BrokerVM. By default172.17.0.1/16 subnet is configured for docker containers. If this network conflicting with your internal network, you can set new docker network with this configuration.",0,12-09-2021,12:26 AM
780,452039,uis,"Hi@NCherbib,please check that config is Ok with the procedure explained in this doc:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/set-up-broker-vm/...You will see at the footer of this document some other related documents related to proxy config. Review your configurations to make sure you did not forget something.Additionally check the following document:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/set-up-broker-vm/...Check also that you have communications between the endpoint and the broker VM. Ping, or any other tool to make sure that there is a physical network path connecting both devices and there is no FW in the middle dropping your traffic or any other issue with your network communications, even on the endpoint tcp/ip stack, that could cause this error.If the error persists I would recommend to open a TAC support ticket to investigate further.Hope this helps,Luis",0,12-08-2021,04:14 AM
781,452039,tugriceri,"Dear NCherbib,Could you check agent status with below command.cytool runtime queryThe error which you shared coming from XDR agent and not directly related with BrokerVM .if you have any additional security product which is installed on same server, please also check that logs, also please check windows logs.",0,12-08-2021,04:19 AM
782,452039,NCherbib,"u find bellow the service status, they are runing fine, i will check windows logs and the other security product.BR.",0,12-08-2021,05:01 AM
783,451859,KRisselada,"@ShmuelWhen you say ""...500 computers..."" is it possible you have OVER 500I will note that I was informed a while back (perhaps 2 or so months ago) from a Palo Alto Cortex Support engineer, that I found that even though we have the Automatic update to the latest supported version applied the Agent Profiles, every time I find that we only have ~500 endpoints upgraded immediately.He informed me that is correct, when a release is done, only 500 Endpoints are updated.Then, a week later, another batch of 500 are identified and upgraded.AFAIK, this is the MAX that can be done (and time frame) without you MANUALLY selecting and upgrading the remaining.I would ask anyone else here to correct or further refine what I have here to ensure its correctly stated.",2,12-07-2021,12:13 PM
784,451859,tugriceri,"Hi Shmuel,Thats correct. We have upgrade limit and its max 500.Could you check below setting and increase batch number to 500?Also please check one of the machine logs underC:\ProgramData\Cyvera\Logs\trapsd.log and upgrade-2021-*.loghttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/customiza...",1,12-08-2021,12:29 AM
785,451859,moixsante,"Hi @KRisseladaThis is correct. Since Cortex XDR 3.0/7.5, only up to 500 agents are update the first week. After that, it follows the normal auto-upgrade rollout.",1,12-08-2021,12:44 AM
786,451859,Shmuel,,0,12-08-2021,03:29 AM
787,446838,uis,"Hi,you can change your scan schedules when you create your malware profiles.Please check this:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...So if you have already created your malware profile, go to the config of that profile and almost at the end of the profile you will see theEndpoint Scanning config area. There you can play with the Periodic Scan fields to change it. Please check the attached pic.Regarding the best time to scan your endpoints, it depends on your organization schedules, the best is when the users have less work load on their endpoints. This is something you should check by yourself depending on your specific scenarios. F.e. on a previous assignment we got all desktops awaken at 8pm (by windows AD policy) and we scanned them at that time. But again you should realize when is better for your users, or maybe even create different malware profiles for different departments or office locations and scan them at a different time.Trouble shooting failed scans: try to figure out if they failed maybe because they had their endpoints switched off, or do they interrupted the scan maybe switching off the endpoint ? if you identify such a case could be good to ask the end user the reason, was it all of a sudden too slow and they rebooted ? these are just some ideas, anyways be creative and try to realize about the reasons why they might failed, maybe they were human reasons.And of course play with the schedules for different departments or locations to suit the scans to your best potential success times.NOTE: Please to not take our Cortex xdr scans as a traditional antivirus scan this is not the same concept. For us a scan is more to create a model/baseline of what is normal in your endpoint and have a control on it. When you download a new file, it will be check by us when being written on disk, at this time this file will be scanned. So basically, if you run one scan, everything that has been already scanned and is trustable do not need to be re-scanned again and again.Have a good XDR scan time !!Luis ",2,11-11-2021,02:30 AM
788,446838,pdysart,"Luis, thank you for the reply, very helpful!When a scheduled scan is aborted, will it stay in that status until the next scheduled scan? In other words, if it is aborted this week, will it reinitiate a scan on that endpoint next week, or do we need to do it manually on the backend for endpoints that get aborted?Also, for endpoints that are disconnected at the time of the scheduled scan, will it initiate the scan as soon they are connected again?",0,11-12-2021,09:22 AM
789,446838,umbach,"Hey Eluis,I'd have to disagree with the scan once and you're good comment. We've had Cortex XDR for a year and scan weekly, and it is always a challenge.Found 11,059 out of 76,738 results. This was our last 30 day results. I also haven't noticed XDR scanning at time of write to disk. I can download anything I want and XDR won't pop off until it is executed. When I dedupe this list with the month before it's reduced from 11k to 56 😞 More than happy to discuss with you on how you managed to achieve your results. Most of these are marked Benignso I'm not sure why it wants to alert on them again.",0,11-12-2021,06:17 PM
790,446838,uis,"Hi Pdysart,if the scan is started at the cortex management console the user wont be able to stop the scan. He might do it just if he switches off his computer. Once the computer is switched on again the scan should resume and complete.If the user starts the scan locally at his endpoint agent, then he might be able to interrupt it manually, in this case the scan has to be started from scratch.If the user reboots or system crashes while on-demand scan, the scan will continue once the endpoint is booted again.Notes:Hope this helps,Luis",0,11-17-2021,12:51 PM
791,446838,pdysart,"Hi Luis,Thanks again for the reply. I am a new team member and I am investigating why we have such a large percentage of endpoints that do not have successful scans. We consistently have about 25% of endpoints aborting the scan. Even when I take a smaller group and start a scan from the endpoint administration, the majority of endpoints that failed on their last scan end up failing again.Any insight on how I should approach this problem will be helpful.Thank you,Phil",0,11-17-2021,02:58 PM
792,446838,uis,"in your case if the reason is that the user is not rebooting or OS crash or power-off, I would recommend to open a support ticketKR,Luis",1,11-18-2021,02:08 AM
793,446838,uis,"I did not get your point on your sentence "" Found 11,059 out of 76,738 results"" Please explain what do you mean ? what did you find out of 76k? malware ? endpoints ?Please check my last answer a few mins ago to Pdysart in case it helps you.About the alerts with benign verdicts: if somehow the endpoint is not connected to cortex management console/WF, or the verdicts from WF last too much, local analysis kicks in and this might have the reason of those alerts, later the verdict might be resolved once the alert is already created (or maybe buffered to be sent when comms are recovered).Please investigate and realize if you have an issue with WF verdicts in terms of time to get it. If you have a real isssue there open a TAC support ticket. If your endpoints are isolated when the alerts are generated by local analysis, then you should solve this matter.Note: if the file is unknown to WF, then the agent uses local analysis to figure out if the file is benign of malware.Ways to get rid of alerts for benign processes: -Add hash to allow list -Add the signer to trusted signersAbout the on-write scan you will have to wait until you update the agent to 7.6Hope I helped on your issues",0,11-18-2021,02:29 AM
794,446838,umbach,About the on-write scan you will have to wait until you update the agent to 7.6We are on 3.1 and 7.6. Did this feature get pushed on this release?,0,12-06-2021,08:47 AM
795,446838,tugriceri,"Dear Eumbach,on-write scan feature is not on prod yet. Yes, its part of 7.6 but still just enabled for EA customers.",0,12-07-2021,12:26 AM
796,451544,tugriceri,"Dear SaimaFoster,Welcome to the forum. First of all, If would you like to use CDL for cloud logging, you must have Cortex XDR Pro per TB license. If you have this license, you can configure your cloud provider and Cortex XDR like below.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/external-data-ingestion/ing...Ingesting cloud provider logs are configuring via XDR Management console and you cannot reach that logs via CDL. You should reach and search via XDR console. This is also applicable for XDR logs as well. When you complete the configuration, you can use XQL to search your logs.",0,12-06-2021,07:04 AM
797,450722,moixsante,Hi@CraigV123I think something like this is what you are looking for.File Analysis and Protection Flow (paloaltonetworks.com)Protection Capabilities (paloaltonetworks.com),2,12-01-2021,12:20 PM
798,450722,CraigV123,Thank you for the response. I'll see if I can slim down those explanations any bit. It's been incredible to see the negative reactions from these folks when you tell them that exceptions aren't being placed unless it is the last resort.,0,12-02-2021,03:33 AM
799,450722,moixsante,"Hi@CraigV123,In my opinion, Exceptions are not a last resort. They can certainly be use as such, but they can be used in many other use cases. You need to remember that normal exceptions will disable security capabilities, among other things.One of the cases where you would need a Support Exception, is to handle Exploit Alerts as the Exploit profile does not provide any way to add whitelist. The only way to do is to retrieve the Alert data, allow XDR to analyze it, if if XDR cannot provide an Exception, you need to open a TAC case, upload the alert data file and they will be able to debug it. TAC will be able to tell you if the Exploit alert is a false/true positive. If it is a false positive, they will provide a Support Exception that will take care of the compatibility issue on that specific Exploit module.I hope this makes Exceptions a bit more clear.",1,12-02-2021,01:48 PM
800,450722,CraigV123,"Thanks for the additional insight to the exceptions. Our old AV system had exceptions for everything it seemed and made the platform look like swiss cheese with all of the security ""holes"" in it. XDR has been a total 180 to that system but we still have users that insist on having the vendor recommended exceptions in place as a ""comfort blanket."" Not because they're being blocked but because of how they remember legacy AV systems operate... still working on that culture change I guess you can say. Anyways, thank you again for your help.",0,12-03-2021,04:22 AM
801,450722,moixsante,"Hi@CraigV123,PANW provides already a set of compatibility policies in the form of Content Updates, which are provided weekly/biweekly automatically to every customer's tenant and automatically to all XDR agents.Anyway, thank you for your interest in our product, and please keep coming back here whenever you have any doubts or seeking advice.",1,12-03-2021,07:57 AM
802,450873,moixsante,"Hi@NCherbibYou need to execute Cytool from its location, ""c:\program files\Palo Alto Networks\Traps"". Alternatively, you could add this location to your Environment Variables in Windows.",0,12-02-2021,02:02 AM
803,450873,NCherbib,"thanks for your reply, but i'm alerady in this directory also i run the cmd as administrator, but still the same issue.",0,12-02-2021,02:06 AM
804,450873,moixsante,"Hi@NCherbibIt seems you installed the 32bit version of XDR, right? Could you also post a screenshot of your CMD utilizing the DIR command in that location?Thanks",0,12-02-2021,03:13 AM
805,450873,NCherbib,issue resolved thnxx,0,12-02-2021,03:24 AM
806,393897,Alexandre_Jodoiaria-labeln,"I can't say that I saw 1) but 2) sounds too familliar.I estimate that we have, at any given time, about 3-5% of the agents in that situation.Basically, I have a script that will re-create/re-enable the runtimes, as I found this is mostly the case with corrupted installation.The cyserver services won't start as one of the dependencies is borked. So the script tries to fix them all.This works in 20% of the corrupted agent cases.For the others it is an issue with the file system filter. trying to reload it using fltmc fails with a ""file not found"" error and I haven't been able to find a solution for those, so it is xdrcleaner, reboot, xdrcleaner, re-install.But 3-5% of 18k agents is a lot to manually fix month after month.",1,03-25-2021,11:37 AM
807,393897,btenberge,"I'm sorry I don't have an answer to your question either, but I think this is a good subject because I'm having the same ""revelations"" lately.I have encountered some agents in our environment that appear to be working (they appear online and up-to-date), but half the files are missing in the installation folder, only cyserver.exe is running and upgrade attempts fail all the time.These specific instances do make it seem like everything is fine and dandy, while it's not.I'm currently trying to figure out a way to find these half-, or non-operational agents, myself, but I have nothing yet.I'm sure we're not the only ones dealing with this problem, so I'm hoping that there are some people that have already found a working solution.",1,03-30-2021,05:37 AM
808,393897,thenetworksfine,@Alexandre_JodoinWe are working through a wide range of hosts with support to get to the bottom of this situation. One of the commonalities ended up being deleted Installation Packages under Cortex XDR Administrative Console >> Endpoints >> Endpoint Management >> Agent Installations. I'm not saying this is the case for you but we did not know that someone was cleaning up these packages and wouldn't have though it would put the agent dead in the water. The agent is not smart enough to go out and get the latest version from the console if the previously sent version no longer exists.A helpful command that we used is below. This prevented us from having to reinstall the agent in a number of situations.We are working through some other scenarios so I will update this post accordingly in hopes to help out some other customers in our situation.,1,04-12-2021,11:04 AM
809,393897,thenetworksfine,@btenbergeSee my reply to@Alexandre_Jodoinbelow.,1,04-12-2021,11:04 AM
810,393897,Alexandre_Jodoiaria-labeln,"Thank you for this, it is an option I wasn't aware of, and I will give this a try on a few agents to see.When trying to delete and installation package from the console it DOES give a warning:""This will prevent new agents using the package, including VDI, from registering.""So I've never deleted a single package. Not sure if that will be an issue 5 years from now...Our main issue has to do with the file system filter driver/main cyserver service.Here's a bacth file I created to help with service issues. However this does NOT fix thecyvrfsfd filter issue we are seing.NOT the silver bullet but might help to re-enable some agents...-----------------------@echo onREM Stop the runtimesecho PasswordHERE!!!|""C:\Program Files\Palo Alto Networks\Traps\cytool.exe"" runtime stopREM remove autoprotectionecho PasswordHERE!!!|""C:\Program Files\Palo Alto Networks\Traps\cytool.exe"" protect disablesc create cyvrfsfd binpath= ""C:\Program Files\Palo Alto Networks\Traps\cyvrfsfd.sys"" type= filesys start= system error= normal group= ""FSFilter Anti-Virus"" tag= yes displayname= cyvrfsfd depend= FltMgr || sc config cyvrfsfd binpath= ""C:\Program Files\Palo Alto Networks\Traps\cyvrfsfd.sys"" type= filesys start= system error= normal group= ""FSFilter Anti-Virus"" tag= yes displayname= cyvrfsfd depend= FltMgrsc create cyverak type= KERNEL start= system error= normal binpath= ""C:\Program Files\Palo Alto Networks\Traps\cyverak.sys"" tag= no displayname= cyverak || sc config cyverak type= KERNEL start= system error= normal binpath= ""C:\Program Files\Palo Alto Networks\Traps\cyverak.sys"" tag= no displayname= cyveraksc create cyvrmtgn type= KERNEL start= system error= normal binpath= ""C:\Program Files\Palo Alto Networks\Traps\cyvrmtgn.sys"" tag= no displayname= cyvrmtgn || sc config cyvrmtgn type= KERNEL start= system error= normal binpath= ""C:\Program Files\Palo Alto Networks\Traps\cyvrmtgn.sys"" tag= no displayname= cyvrmtgnsc create tedrdrv type= filesys start= system error= normal binpath= ""C:\Program Files\Palo Alto Networks\Traps\tedrdrv.sys"" group= ""FSFilter Activity Monitor"" tag= yes displayname= tedrdrv depend= FltMgr || sc config tedrdrv type= filesys start= system error= normal binpath= ""C:\Program Files\Palo Alto Networks\Traps\tedrdrv.sys"" group= ""FSFilter Activity Monitor"" tag= yes displayname= tedrdrv depend= FltMgrsc create cyserver type= own start= auto error= normal binpath= ""C:\Program Files\Palo Alto Networks\Traps\cyserver.exe"" tag= no displayname= ""Cortex XDR"" depend= Cyvrmtgn/Cyverak/Cyvrfsfd/EventLog/CryptSvc/TEdrDrv || sc config cyserver type= own start= auto error= normal binpath= ""C:\Program Files\Palo Alto Networks\Traps\cyserver.exe"" tag= no displayname= ""Cortex XDR"" depend= Cyvrmtgn/Cyverak/Cyvrfsfd/EventLog/CryptSvc/TEdrDrvREM Oh CRAP! sc start ftlmgr -> The specified service does not exist as an installed servicesc config FltMgr type= filesys start= boot error= critical binpath= ""C:\Windows\system32\drivers\fltmgr.sys"" group= ""FSFilter Infrastructure"" tag= yes displayname= FltMgr || sc create FltMgr type= filesys start= boot error= critical binpath= ""C:\Windows\system32\drivers\fltmgr.sys"" group= ""FSFilter Infrastructure"" tag= yes displayname= FltMgrREM Set the services/drivers/filters to auto start, not required since we did it already.REM sc config cyserver start= auto && sc config cyverak start=system && sc config cyvrmtgn start= system && sc config cyvrfsfd start= system && sc config tedrdrv start= systemREM Enable autoprotectionecho PasswordHERE!!!|""C:\Program Files\Palo Alto Networks\Traps\cytool.exe"" protect enableREM start the services/drivers/filters. Use one or the other. Or both.sc start cyverak & sc start cyvrmtgn & sc start cyvrfsfd & sc start tedrdrv & sc start cyserverREM ""C:\Program Files\Palo Alto Networks\Traps\cytool.exe"" runtime startREM Try reconnecting if communication with server has been disabledecho PasswordHERE!!!|""C:\Program Files\Palo Alto Networks\Traps\cytool.exe"" reconnectREM Update Cortex XDR from server""C:\Program Files\Palo Alto Networks\Traps\cytool.exe"" checkinREM Check Protection determined by policyREM echo PasswordHERE!!!|""C:\Program Files\Palo Alto Networks\Traps\cytool.exe"" protect policyREM Query product components running state""C:\Program Files\Palo Alto Networks\Traps\cytool.exe"" runtime queryREM Altitude and volumes for the filter can be found by issuing this command on an agent in working order:REMfltmc instancesREM Filtre Nom du volume Altitude Nom de l’instance Cadre SprtFtrs VlStatusREM -------------------- ------------------------------------- ------------ ---------------------- ----- -------- --------REM cyvrfsfd 321234 Cyvera FSFD 0 00000007REM cyvrfsfd C: 321234 Cyvera FSFD 0 00000007REM cyvrfsfd 321234 Cyvera FSFD 0 00000007REM cyvrfsfd \Device\Mup 321234 Cyvera FSFD 0 00000007REM Saw this one once. Not bother fixing it for all. But here's the info if required.REM SERVICE_NAME: telamREM TYPE : 1 KERNEL_DRIVERREM START_TYPE : 0 BOOT_STARTREM ERROR_CONTROL : 1 NORMALREM BINARY_PATH_NAME : \SystemRoot\system32\drivers\telam.sysREM LOAD_ORDER_GROUP : early-launchREM TAG : 0REM DISPLAY_NAME : telamREM DEPENDENCIES :REM SERVICE_START_NAME :REM sc create telam binpath= ""C:\Windows\system32\drivers\telam.sys"" type= kernel start= boot error= normal group= ""early-launch"" tag= no displayname= telam",1,04-12-2021,11:57 AM
811,393897,btenberge,"@thenetworksfineThanks for your reply!I haven't ever removed any old installation packages, I think, but it's worth checking out for sure.",0,05-06-2021,11:22 PM
812,393897,btenberge,"Your reply could also be quite helpful,@Alexandre_Jodoin,thanks for sharing your solution!You guys are giving me some interesting things to look at.",0,05-06-2021,11:24 PM
813,393897,MParker4,"Does anyone have an update to this issue, it seems to exist around version upgrades that a small percent will stop responding.",0,11-30-2021,07:54 AM
814,393897,bbarmanroy,"Hi@MParker4, this seems like an issue with the agent. Please generate a support file for a few affected endpoints, create a Support Ticket, and upload the support files for the PANW TAC Engineers to investigate.",1,11-30-2021,06:18 PM
815,450385,bbarmanroy,"Hi@Daniel_ItenbergThere are a couple of steps that I would suggest, my assumption being that the endpoint tried to connect to a malicious site.1. Drill down into the alerts that are a part of the incident. Identify the sources and destinations, and the actions that led to the alert. If a malicious file is initiating the connections, you can block it, and retrieve it for further analysis in a sandboxed environment. Based on you analysis, you can proceed to remove the file/s based on your organizational processes. You can also proceed to investigate how the file came to be present in the host.2. If the connection destinations are deemed malicious/suspicious, you can block them via EDLs or better still, update your firewall policies to block such connections in the event the destinations are alive in the future.If the connections are port scans, lateral movements (wmiexec etc.), please investigate the reason for those activities as well.I hope this gets you started off in the right direction.Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...",0,11-30-2021,06:16 PM
816,449878,bbarmanroy,"Hi@RahulPrajapati, an incident is an aggregation of alerts. You may have incidents with the same description if the actions that create the alert keeps occuring.There are two items that you need to verify from your end:1. Have you identified from the endpoint or event source if these actions are happening repeatedly to cause new incidents to get created?2. Have you identified from the Incidents if the artefacts are the same for all duplicate Incidents, and if the actions are happening at the timestamps specified in the alerts grouped inside each Incident?If you know that these incidents are benign in nature, you can consider creating one or more Alert Exclusionsto suppress alerts.",0,11-29-2021,01:45 AM
817,449878,RahulPrajapati,"Hi@bbarmanroy,Yes these action are occurring repeatedly and from same artefacts. The file on which we are receiving alerts is malicious in nature and we have blocked its hash. But still, it keeps appearing again even if it is in blocked state.As per your suggestion to create an alert exclusion to suppress alerts. Will the file remain in blocked state after creating an exclusion? We want that file to remain in blocked state after creating an exclusion.Regards",0,11-29-2021,09:18 PM
818,449878,bbarmanroy,"Hi@RahulPrajapatiYes, the file continues to remain blocked after creating an exclusion. Exclusions do not influence any XDR agent actions.Ref: https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000PO8MCAW",0,11-30-2021,01:38 AM
819,449878,uis,"Hi @RahulPrajapati,after creating the exclussion the malware will be still blocked. Alert exclussion just excludes the alert to create more incidents, but the alerts will be still created (you will be able to find them with xql queries) but wont create noise on your incidents table, just that. And you will still be in safe (malware will remain blocked).Watch out do not confuse exclussion with exception, exception will make the malware to not to be blocked (alerts wont be created then). So make sure when you create an exception that you know what you are doing otherwise you might be allowing a malware to run and spread over your infrastructure and without being alerted.On the actions for the malware profile you can choose different actions, try to put it in quarantine.It will also be good to figure out why this malware is appearing again and again. This is something for you guys to investigate if somebody is downloading it repeatedly or something. So try to figure out the root cause of your infection to end it up for ever.You can also choose to delete your malware file from all your infrastructure.Hope this helps,Luis",0,11-30-2021,01:41 AM
820,449878,RahulPrajapati,"Hi@bbarmanroyand@eluis,Thanks for the reply. My queries has been answered.",0,11-30-2021,05:26 AM
821,441030,tvilas,"Hello,To remove Broker VM you must go to cogweel > Configurations> Select Broker VMGo to the Broker VM you want to remove, righ-click, Select Broker Management, and Select Remove BrokerReference guide:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/manage-your-broke...",1,10-15-2021,10:32 AM
822,441030,jh,"HiThanks for the updates.After theBroker VM is removed, can I add theBroker VM back tothe Cortex XDR management console?",0,10-17-2021,07:13 PM
823,441030,NCherbib,"Hi,after i remove it, i'm not able to readd it again, any help for this subject??BR",0,11-29-2021,02:46 AM
824,441030,jh,"HiIf I'm not mistaken, after I removed the broker VM from theCortex XDR management console. I waited for a few days and I'm able to it back to console via https://<broker_vm_ip_address>/. Hope this helps.",0,11-29-2021,05:24 AM
825,449592,bbarmanroy,"Hi@NCherbib, once you delete a Broker VM from the console, you cannot re-register it back to the tenant. Please create a new Broker VM, and register it with the tenant via the steps listed here.",0,11-26-2021,01:06 AM
826,449592,NCherbib,"Thnx, i will try it",0,11-29-2021,02:59 AM
827,449843,bbarmanroy,"Hi@Muhammad-Rusli, you need to useevent_sub_type(in your case, these should be FILE_CREATE and FILE_REMOVE). Please see a basic BIOC to get you started. You can tune it to your needs.Link:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...",0,11-29-2021,01:37 AM
828,449329,bbarmanroy,"Hi@RahulPrajapati, the agent will not remove itself automatically from the endpoint. You can manually uninstall the agent though with the steps listed here.Hope this helps!",0,11-24-2021,11:11 PM
829,449329,RahulPrajapati,"Hi@bbarmanroy,Thanks for the reply. My doubts has been answered by you.",0,11-29-2021,12:09 AM
830,449329,bbarmanroy,"You are welcome,@RahulPrajapati. You can mark the response as Solved if this worked for you.",0,11-29-2021,01:02 AM
831,449329,moixsante,"Hi @RahulPrajapati,As mentioned by@bbarmanroy, the agent will remain installed. Please note that ""Connection Lost"" means that the machines have been in Disconnected status for 30 days (default), or for as many days as you configured it in the Global Configurations.If a machine remains in Connection Lost for 180 days (default),or for as many days as you configured it in the Global Configurations, it will be automatically deleted from the XDR database. This means that if there is a machine that stays disconnected for that long, you will only be able to have it connect to the tenant by reinstalling the agent or or using the Cytool Reconnect command.",1,11-29-2021,01:17 AM
832,449809,apjoshi,"Hi DinieSyahmi,Please note that a Broker vm acts as a Cortex Agent proxy only and not an internet proxy i.e. all the air gapped Cortex Agents can reach Cortex Cloud via secure Broker vm, without being exposed to public internet.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/broker-vm-overvie...To provide internet for all air gapped devices kindly look into an internet proxy.",0,11-28-2021,07:03 PM
833,449674,uis,"Hi Pdysart,the standard and recommended way to uninstall agents is through the console. This is the way to maintain a clean and non-duplicated infrastructure.The agent cleaner is for emergencies when for example you cant uninstall from the console because you've lost the admin password to uninstall the agents. In this case you boot into secure windows mode and use the cleaner without the need of a password.Im not sure if once you uninstall with the cleaner and before the console realizes that you have removed an agent, you install it again manually and that might be the reason whey you are getting duplicates. As I said Im not totally sure of how you are operating to get your results.If you are getting duplicates without any reason and you believe that this is a malfunction or bug, please open a TAC support ticket.And be aware: always try to do everything from the console to avoid any mismatch between the console and the reality.Hope this helps,Luis",1,11-26-2021,09:19 AM
834,449386,bbarmanroy,"Hi@Daniel_Itenbergthis is highly subjective, based on the host activities. Each detector has its own activation time, based on the data present in CDL. The baseline is also recomputed over time based on newer activities. There might be some FP's in the beginning, but with alerts tuning and recurring baseline computations, the baseline gets normalized (""better"") over time.You can refer to the explanation of various components of detector timelines here.You can refer to the list of Analytics Alerts here, with the respective timelines.",0,11-25-2021,07:49 PM
835,449386,bbarmanroy,"I grabbed a screenshot for a tenant. As you can see - beaseline creation can take up to 3 hours, so you were right on the money for baseline creation. I assume EDR was already enabled for 2 weeks or more.",0,11-25-2021,11:56 PM
836,436166,uis,"Hi Chris,what I can think firstly is to double check that you have run the following command paying utmost attention to the last part of it when you enable the VDI.msiexec /i c:\install\cortexxdr.msi /l*v C:\temp\cortexxdrinstall.log /qn VDI_ENABLED=1Could you please confirm that VDI_ENABLED=1If the former was done correctly, please perform the following in a couple of VDIs and check that the ID and the VDI name are different. This should make the difference between two different instances of the same VDI golden imagecytool vdi updateI've seen also that you have Citrix. If positive, please also make sure that you have read and completed the following steps:Configure Agent Compatibility for Citrix App LayeringDue to a Citrix App Layering limitation, you must install the Cortex XDR agent only on the OS layer according to this workflow. This enables the Cortex XDR agent to provide full protection of your endpoints:Install the Cortex XDR agent on OS layer during the preparation process of the App Layering image.Cortex XDR agent installations on the Application layer or User layer are not supported.Stop the Cortex XDR agent.Before you finalize the OS layer, you must make changes in the Cortex XDR agent settings. To make these changes, you must first stop the agent by running the Cytool runtime stop command.Delete two Cyvera folders.Delete the following folders to allow them to be recreated later on:c:\ProgramData\Cyvera\LocalSystem\Download\contentc:\ProgramData\Cyvera\LocalSystem\Persistence\cloud_frontend_dbAdd the Cortex XDR agent to the Citrix App Layering exclusion list.Add the following entry to the Windows Registry: HKLM\SYSTEM\CurrentControlSet\Services\Unirsd\ExcludeKey [REG_SZ] = ""\Registry\Machine\System\Cyvera""Shut down the OS layer and finalize the layer.Please come back with feedback and dont forget to thumbs up if this answer was helpful.KR and have a good VDI - Cortex XDR game time,Luis",1,09-27-2021,04:54 AM
837,436166,ChMueller,"Hi EluisSorry for the late answer. The following steps before finishing the Golden Image solved the issue:""%ProgramFiles%\Palo Alto Networks\Traps\cytool.exe"" protect disable""%ProgramFiles%\Palo Alto Networks\Traps\cytool.exe"" runtime stopdel /f /q ""%ProgramData%\Cyvera\LocalSystem\OsPersistence\agent.id""del /f /q ""%ProgramData%\Cyvera\LocalSystem\OsPersistence\hardware.id""del /f /q /s ""%ProgramData%\Cyvera\LocalSystem\Persistence\cloud_frontend.db""Regards Chris",0,11-24-2021,01:52 AM
838,446767,uis,"Hi Enewman,typically the signer block list is maintained by PANW team and it is distributed via content updates.The way to block a process by the customers is to block the hash as you have done. The hash will be checked before the WF verdict so it will prevail before WF check.An indirect way to create a signer block is the following:You create a custom BIOC for this signer and then you push it on to a restriction profile.This way the process will execute but inmediately the behavioural threat protection will kick in and block & kill the processI hope this helps, like it please if it was usefulHave Fun with it,Luis",3,11-11-2021,06:30 AM
839,446767,teJacobCF,"its funny your brining this up, I have seen tons of activity on this as well this week. I ended up blocking the hash but I am sure that will change at some point.",2,11-11-2021,07:36 AM
840,446767,umbach,"Same, just added a new BIOC to take care of it.",0,11-12-2021,06:41 PM
841,446767,KRisselada,"Hello@eumbachwould you possibly share what your BIOC looked like. Looking for tips, not had much experience in creating.",0,11-23-2021,10:17 AM
842,321878,dmichelucc,"Hi Fabio,Could you run again the installation following thehttps://docs.paloaltonetworks.com/content/dam/techdocs/en_US/pdf/cortex/cortex-xdr/7-0/cortex-xdr-ag...page 9 to get installation logs?msiexec /i c:\install\cortexxdr.msi /l*v C:\temp\cortexxdrinstall.log /qnPlease post the logs so we can have more context and help you out.Thanks,",1,04-09-2020,12:00 PM
843,321878,hhiggins,Make sure you have the two certificates installed on the machine then try to re-start the installation.,0,04-14-2020,06:20 AM
844,321878,dfalcon,"Hi@FabioGarcia-Were you able to run the installers with verbose logging? If so, and you are still having the issue, can you please post the log snippet with the error description?",0,04-16-2020,08:43 AM
845,321878,FabioGarcia,Hello thanks for the feedback!I am attaching some log files,0,04-16-2020,01:59 PM
846,321878,dfalcon,"Hi there. Out of curiosity, have you tried to launch a command prompt as an administrator and kick off the MSI from there? The 1603 error in the logs makes me lean this direction. Also, TAC should be able to resolve this one quickly. Have you tried reaching out to Support?",0,04-20-2020,10:57 AM
847,321878,Muhammad-Rusli,"Sorry Expert, I have same issue.The Cortex XDR agents appears pop up same like above, but after I tried to uninstall XDR agent, the process is stuck.I tried to generate logs for TAC support, but cytray/icon XDR console is not showing.Please help me how to Can I generate support log XDR if the cytray not appears.",0,11-22-2021,03:41 AM
848,321878,teJacobCF,"sounds like you need to run the agent cleaner on the asset first, then reboot and you should be good to go.",0,11-22-2021,07:11 AM
849,321878,Muhammad-Rusli,How can do that? do u have tutorial for that?,0,11-22-2021,06:37 PM
850,321878,bbarmanroy,"Hi@Muhammad-RusliLooks like there are two parts to your problem:Generating a Support FileYou can generate support file from the XDR console . You can do it from the Endpoint Administration page or from Action Center.1. Navigate to Endpoints -> Endpoint Management -> Endpoint Administration.2. Right-click on the affected endpoint, navigate to Endpoint -> Endpoint Control -> Retrieve Support FileThe process to retrieve a support file from the Action Center is described here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...Uninstalling an agentPlease create a Support ticket at the Customer Support Portal (link), with the Support File. The TAC Engineer will advise you accordingly on the uninstallation process.Hope this helps!",1,11-22-2021,08:06 PM
851,447124,uis,"Hi Tejasp04,I see here several things to do.Hint: From key artifacts of the incident/alert open the WF report and on the upper right corner you can click to report the incorrect WF verdict.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/excep...I hope this helpsGood weekend,Luis",1,11-12-2021,06:49 AM
852,447124,tejasp04,"Hi Eluis,Thanks for your reponse.I've checked above documents/article for exception profile and signer exception. But unfortunetly it didnt worked in my organization. As developer are creating exe by compiling the codes and running those directly, so signatures they are not addin g there and not required in there projects. For local analysis exception as checked visual code application is running/compiling that codes and geneating exe with powershell.exe process and creating exception for powershell.exe is not recommended in our org as it might lead to any other threat execution.Very strange behaviour of XDR i observed when 1 developer was compiling and running code through visual code application. same code was generating diff hash valued exe every time so xdr was taking long time for analysis and it was in evaluation status for every time. So there are such case where user is frequenlty creating and running exe's and it not feasible every time to ask wildfire to recheck verdicts.Is there anything which we can check more on this or creating exceptions is only way to resolve these issues.Thanks in advance😀",0,11-22-2021,10:08 PM
853,447124,uis,"Hi Tejasp04,in this case I could recommend opening a support ticket. It might be that you need a support exception for your specific scenario.At this point I believe this is the best option, this should solve your issue.KR,Luis",0,11-22-2021,11:59 PM
854,420955,gjenkins,"Hi@VictorMolosnic,Thank you for reaching out.It would seem that the uninstaller is having trouble removing the software. While though I'm not familiar with the error, in particular, this appears to be a use-case for a cleaner that can be furnished to you by our Tech Support engineers. Is it possible for you to open a case with Support to request the cleaner? If you would like further analysis into why this error is occurring, they may be able to do so as well.",1,07-22-2021,07:09 AM
855,420955,ctorMolosnic,"Hi@gjenkins,I opened a support case. The support team provided me the TrapsCleaner tool.Thanks.",1,07-22-2021,07:24 AM
856,420955,Muhammad-Rusli,"Sorry expert I wanna ask something, I have same issue. But I wanna create open ticket to TAC, but I cant generate logg because cytray/icon XDR not appears. Please give me advice how Can I getting generate support logg for TAC?",0,11-22-2021,06:47 PM
857,420955,bbarmanroy,"Hi @Muhammad-Rusli, please consider creating a new query once a solution is marked as approved.You can generate support logs from the XDR console as well. You can do it from the Endpoint Administration page or from Action Center.1. Navigate to Endpoints -> Endpoint Management -> Endpoint Administration.2. Right-click on the affected endpoint, navigate to Endpoint -> Endpoint Control -> Retrieve Support FileThe process to retrieve a support file from the Action Center is described here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...Hope this helps!",1,11-22-2021,08:00 PM
858,442516,Daniel_Itenberg,"I should add that the user is using ubuntu 21.10 and that the xdr shows that the files are unsigned(signature n/a) in the incident ""key assets & artifacts"" view",0,10-21-2021,05:29 AM
859,442516,uis,"Hi Daniel,Ive realized that this question of yours was not answered yet. I apologize about it in name of all of us and will try to answer.When you have a false positive detection you can do several things in this cases ""generally speaking"":1- add the hash to allow list2- add the signer as a trusted signer3- create a support exceptionIn your case and due to the description you have given that just one endpoint user is experiencing this, I might recommend to reinstall the agent in that endpoint or create a support ticket.About how to check if a process/file is malware you can use WildFire from Palo Alto (similar to virustotal).If within the incients and alerts you go to the key assets and artifacts you should be able to see there the verdict from WildFire (WF) that can be malware or benign... also you should be able to see there some Unit42 blue links that when clicked on will give you more info about the artifact.I hope I helped to bring some light to your issue.KR,Luis",0,11-22-2021,11:08 AM
860,448949,teJacobCF,looks like in the new v3.1 version you can do this:,0,11-22-2021,07:13 AM
861,447954,palcev,"Hi Daniel,Yes. As long as you insert a storing device to the thunderbolt it will detect it and block it (if this is what is configured in the policy).",0,11-17-2021,12:05 AM
862,447954,WSeldenIII,"Hi@Daniel_Itenberg,to address the second part of your question, you can monitor device control violations by navigating to Endpoints > Device Control Violations within the XDR App.",0,11-17-2021,08:31 AM
863,447954,Daniel_Itenberg,"So if I set up the policy to block all disk drives, then if i connect a disk drive to a dock the dock will be blocked as well?",0,11-18-2021,01:03 AM
864,447954,Daniel_Itenberg,"Here's the thing - I see the disk drive violation, however I don't the dock that is reportedly being blocked as well(when it has a disk drive connected) does not show up in the violations screen",0,11-18-2021,01:04 AM
865,447954,bbarmanroy,"This is most likely because your Thunderbolt dock is not a disk drive, but a dock/hub.You can try the following sequence to see if this works for you:1. Verify if the Thunderbolt dock connect/disconnect action in is being detected via the following XQL query:If you're able to verify the dock is getting registered as a USB device, proceed to the following steps:2. Add the Thunderbolt dock serial number/GUIDunder Policy Management -> Settings ->Device Management.3. Add the device your Device Configuration Profile under ""Custom Device Type"" and Action as ""Block"".Ref:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/hardened-...",0,11-18-2021,02:23 AM
866,447843,palcev,"Hi Asif,You can get full documentation for the PRO and all its' capabilities here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin.htmlJust one important note. Don't forget to enable the pro capabilities in the agent profile under ""XDR Pro Endpoints""",0,11-16-2021,12:36 AM
867,447843,slick,"To add, the Pro/Prevent backend is the *exact same.* So really all the change that occurs is PAN allows you to check the ""Pro Endpoint Capabilities"" box, and then that data is now feeding the data lake and you are seeing more of it in the console. Have migrated many customers to pro, since you already have agents deployed most of your heavy lifting is done already.",0,11-16-2021,10:41 AM
868,447828,palcev,"Hi Rahul,Maybe the files got Quarantine?",0,11-16-2021,12:37 AM
869,447828,RahulPrajapati,"Hi Epalcev,Thanks for the reply!The file was not quarantined. Actually, the file was present in the temp folder and I confirmed with the user, he deleted the temp files yesterday. So, that might be the reason the file was not present in the system.",1,11-16-2021,12:55 AM
870,442787,SStonebraker,Cortex XDR lacks a unified data model which impedes the ability to rapidly perform useful searches across disparate datasets. Are there plans to address that gap?,1,11-02-2021,01:41 PM
871,442787,uis,"Hi SStonebraker,if you mean that Cortex XDR doesn't have a dataset that holds all the datasets, that is correct. But so far we dont need that becausein Cortex XDR, you can query and search with XQL any dataset and a combination of them in a very good response time. Creating a dataset of datasets will screw the searches response and so far there is no point to do so.On top of that we have Cortex XDR Collectors that can collect data/logs from a miriad of sources ftp, linux system logs, windows, webservers of many flavors (IIS, apache, nginx), Fw, you name it. Once that those logs are uploaded in our Cortex management console in the cloud you can perform XQL queries on them.Additionally you can save the XQL queries in a public area so you and all your work mates can reuse them without reinventing the wheel.You can also save the queries as correlation rules and set the timing to launch them...As a source for XQL query center documentation, please visit the link:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...From there you can also jump to other very good XQL documentation sources.Hope this helped.Kind Regards,Luis",1,11-03-2021,09:18 AM
872,442787,umbach,PAN Cortex XDR isn't a SIEM!Also PAN check out Cortex XDR 3.0 now with correlation searches and the ability to ingest data from anywhere!!!😄,0,11-12-2021,06:45 PM
873,442179,gjenkins,"Hi, We received a PA notification about Microsoft Windows 10 version 21H2 running on specific hardware architectures are incompatible with a security engine in Cortex XDR agent 7.0.0 – 7.4.0. In our case we have the following scenario:- Cortex agent version: 7.4.3 and 7.5.0- Cortex XDR PRO license (Endpoint protection + behavior analytics)- Microsoft Windows 20H2 version At the beginning of the year we plan to upgrade to Windows version 21H2.We would need to know how this announced incompatibility affects our case and it is necessary to take some action. On the other hand, we do not quite understand what impact the following paragraph has on us: While only Windows 10 version 21H2 and higher are incompatible, the Cortex XDR agent will disable the affected security engine in Windows 10 version 20H2, since it must be disabled prior to the upgrade to Windows 10 version 21H2.What ""affected security engine"" do you mean? From the ""Impact"" section, how does it affect us if the BTP module is disabled? Can anyone respond to out questionHi@BigPalo,The Cortex XDR Agent incompatibility and upgrade recommendation email mentioned the following affected systems:Your scenario would not be affected by this incompatibility as the agent versions mentioned, ""Cortex [XDR] agent version[s] 7.4.3 and 7.5.0,"" are not impacted.I hope this helps.",0,11-12-2021,03:38 PM
874,442371,gjenkins,"Hello @KarenW,""dypd"" is the injection service used by the Cortex XDR agent.Documentation on the file is here while the description of how injection protects an endpoint from malware is here.",1,11-12-2021,10:44 AM
875,445496,kiwi,"Hi @PaulDownes ,In order to get better traction for this, I have moved your query to the Cortex area.I would recommend that you visit this area to see your discussion and others on Cortex.Cheers,-Kiwi.",1,11-09-2021,05:02 AM
876,445496,moixsante,Hi@PaulDownesThe scan malware option is not part of the cytool commands.There are some alternatives,1,11-09-2021,05:10 AM
877,445496,teJacobCF,looks like looking at the official docs you can just start a scan:https://docs.paloaltonetworks.com/cortex/cortex-xdr/5-0/cortex-xdr-agent-admin/traps-agent-for-windo...I would however confirm with the tac,0,11-09-2021,07:00 AM
878,445496,aulDownes,"Thanks folks, all very helpful. I'm going to accept Fmoixsante's suggestion about the imageprep scan as the accepted solution, might be able to run with that. If there was something flagged on the client machine to say the scan marked the file safe / unsafe, I could possibly use that to trigger a subsequent action to admins also. I appreciate the insights from you all, thanks again.",1,11-11-2021,06:22 AM
879,446491,malalade,"An alternative is to use the saved filter (persistent) on the alerts page. Although, this will require one more step1.https://YOURTENANT.xdr.us.paloaltonetworks.com/alerts2. Top right - 3 dots > filters > pick the saved filter (example: severity=low)Note: before you can use a save filter, you need to create one first and save it for later use.",0,11-09-2021,08:40 AM
880,446491,MichaelMcGinley,"Hi I already have various saved filters set up already. I was trying to streamline my workflow just to make things a bit easier. Also if I load the alerts page as normal and add filters, and then leave the tab open for a while when it refreshes it removes the filter which is a pain, so that's why I would like to just have consistent URLs I can use. Thanks for your help though 🙂",0,11-09-2021,08:49 AM
881,446375,moixsante,"Hi @ReisingerM,Cortex XDR agent 7.6, ETA release end of NOV/Early DEC will support Windows 11",1,11-09-2021,01:52 AM
882,444559,malalade,"For specific phones, you can broadly define the ""Vendor/Manufacture e.g. Apple"" and optionally, further restrict it by specifying the serial.There is also flexibility with device exception. From Endpoint > Policy Management > Extensions > Specific Profile (Device Exceptions) or Global (Device Permanent/Temporary) ExceptionsFor common phone types: Class(mostly, Windows Portable Devices), Vendor/Manufacturer (e.g. Apple), Product(e.g. iPhone), Serial (Optional)",0,11-08-2021,11:19 AM
883,442107,malalade,"The following resources could help validate compatibility, linux agent requirement, linux agent troubleshooting tools, and if all the resources are provided and still there is no communication, we would recommend you open a supportticket.Compatibility-checkCortex-xdr-for-linux-requirementsTroubleshooting-guide",0,11-08-2021,10:56 AM
884,445589,malalade,Yes. After successful license activation. Please see the attached screenshot. We recommend you open a support case -https://support.paloaltonetworks.com/,0,11-08-2021,10:20 AM
885,443751,jcandelaria,"Hi Daniel,Just to make sure version/kernel is supported? Otherwise you can submit a support case so PA support can investigate further.https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/cortex-xdr-supported-kernel-module...Or maybe just corrupted installer that needs to be re-installed?",0,10-28-2021,01:08 PM
886,443751,Daniel_Itenberg,"The kernel version is is supported, I checked prior to installing the agent on the hosts",0,10-31-2021,12:14 AM
887,443369,jcandelaria,"Hi Weejh,Basically you need to setup/configure the Broker VM first, (1st link below) then once you configure the Broker VM, then you can activate/configure the Local Agent Settings app inside the Broker VM (2nd link below)1. https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/set-up-broker-vm/...2.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/set-up-broker-vm/...",0,10-26-2021,08:29 AM
888,443369,jh,"HiThanks for your reply.Yes, the broker VM is setup according to links you've shared. I guess the next step is ""When using the broker VM, ensure that youactivate the Local Agent Settingsapplet with theAgent Proxyenabled.""May I know how validatethat Agent Proxy is enabled?",0,10-26-2021,10:37 PM
889,443369,jcandelaria,Click on gear icon (top right corner) --> configurations --> Broker VM list (left side) then select the deployed broker vm and should be able to see if you configured and activated it.,0,10-28-2021,12:27 PM
890,443369,jh,"HiThanks for the reply.from the screenshot, is this the proxy setup that we should use to proxy Filebeat communication?If yes, what should be the address and port?",0,10-29-2021,01:50 AM
891,443369,jcandelaria,"Hi Weejh,the screenshot you attached is the configuration of broker VM itself. If your broker vm doesnt have restriction going to internet then you dont need to configure the proxy server. But if your broker vm need proxy to go out then you need to configure this setting.But back to your question on filebeat.once you deploy and configure broker, you need to configure the local agent setting app on the broker.Then once its activated, now you can use the broker ip and port in your filebeat configuration",1,10-29-2021,12:14 PM
892,442369,agalindo,Happening today from 8 a.m. to 10 a.m. PDT! Join us to learn all aboutEducation Services Training and Credentialing opportunities for all things Cortex.,0,10-27-2021,07:39 AM
893,443715,jcandelaria,Check the compatibility matrix.MacOs 12.x is officially supported...https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...,0,10-27-2021,07:07 AM
894,441951,jcandelaria,"Hi Vudoo408,Let me answer your question directly first then follow up with additional questions and solution. 🙂With regards to standalone agent installer, you can check the link below (Install or Update Agents Using Installer and Content Package Manually)https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-5/cortex-xdr-agent-admin/cortex-xdr-agent-for-...Follow up questions: with regards to satellite facilities, are they air gapped environment or they have access to internet directly? If they have then technically as long as the required communication ports/fqdn are open then agents should be able to check-inIf they are air gapped, would setting up broker vm on those satellite facilities an option?https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/broker-vm/set-up-broker-vm/...Q:The two VM shows to be checked in and communicating with the trap server but is showing to be disabled. A:(need to check the policy and profile assigned to the agent whether modules are enabled). Also try installing the latest agent, 7.5.1 instead.Q: The physical Win 10 refuses to connect to the server at all.most common culprit are:A: firewall (either ports are not open from network segment or endpoint firewall itself is blocking)A: doesnt have updated certificatehttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...You can also submit a support case for PA support to analyze the logsOnce you open/double click the xdr agent icon and open the xdr agent console from the bottom right corner of your screen. You can click the generate tech support file which will grab the needed support files and output in zip file which you can attach to the case,as alternative if generating tech support file doesn't work, You should be able to see Open Log File, copy/upload that log file on the case.",0,10-25-2021,10:54 AM
895,442851,jcandelaria,"Hi KirkH,Try the solution posted here....https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/reconnect-disconnected-xdr-clients-remot...If it continues to disconnected and many are affected of the same reconnect-disconnected pattern, kindly submit a support case so PA support can investigate further on the root cause..",1,10-22-2021,09:27 PM
896,441045,teJacobCF,not really adding much value here but I feel the exact same way. I am thinking I should just deploy v7.5.1. I wished that with the cortex versions there was a preferred version like with pan os.,0,10-15-2021,10:14 AM
897,441045,BigPalo,i understand that cortex disables security engine. But this is only in those CORTEX versions?,0,10-21-2021,06:54 AM
898,441045,teJacobCF,"I think all you can really do is to follow this page for compatibility, looks like it was just updated on 10/14https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...We have some win11 and 21h2 slowly creeping into our environment, not sure what the official word is on cortex validation for new OS's.",0,10-21-2021,07:40 AM
899,441048,tvilas,"Hello,Hello,Can you please verify the pre-requisites?https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/hardened-...""Not Complaint"" means that one of the prerequisites is not followed.",0,10-15-2021,10:39 AM
900,441048,Muhammad-Rusli,"Hi Tyvilas,Sorry i wanna ask again, We need activate / turn on BitLocker in device manually? or no needed, just create policy?",0,10-20-2021,08:00 PM
901,441563,teJacobCF,just curious why you would not block (at lease the file name) based on hash? (seems safest).,0,10-18-2021,06:36 AM
902,441563,WSeldenIII,"Hi@Daniel_Itenberg,Yes there is an option to block file execution in XDR utilizing the BIOC use-case. It is first important to understand thatCortex XDR rules(E.g. BIOC and IOC) are detection rules; therefore, they do not include prevention functionality. These rules will create a detection alert once the criteria has been met.You have the option create a BIOC rule based on specific behavior andadd that BIOC to a Restriction profile.Please note,The BIOC to BTP feature (RestrictionSecurityProfile) is meant for specific custom BIOC rules to be written, and not configured built off of existing predefined detection BIOC rules which may be problematic for prevention. The BTP engine monitors larger data and has a separate data collection pipeline than EDR data; therefore, the recommendation is to create a specific custom rule, and deploy it slowly on small groups and / or non-production endpoints in order to monitor for any operational impact.",0,10-18-2021,09:04 AM
903,441563,Daniel_Itenberg,"I want that too, but i also want to block by file name - for example i don't want people using utorrent, so i want to block the installer by it's file name together with hash",0,10-18-2021,10:54 PM
904,441563,Daniel_Itenberg,"I created a custom BIOC for bittorent web\utorrent web dmg files, and added them to a restriction profile that is currently deployed only to my endpoint. However, I can run those files without so much as a peep from the xdr. I put the file name and sha256 in the BIOC.",0,10-19-2021,01:57 AM
905,441563,WSeldenIII,"Hi@Daniel_ItenbergIf you are simply looking to block file execution based on file criteria (E.g Hash), then you could utilize the Global Block List within the Action Center. If you are looking for more granularity on the your block list use-case, then you are add a file or folder directly to a Restriction Profile and add the profile to a policy and assign the updated policy to your targeted endpoints. You will need to ensure the targeted endpoints are online and connected with the XDR console in order to receive the policy update.FYI...Configure a Custom Prevention Rule Insight, there are additional criteria that has to be met in order for the user-define rule to be applied as a custom prevention rule. If you want more context on what EDR data is collected from your testing efforts, then you can navigate to the Endpoint Administration, and right-click on ""Endpoint Name"" from your connected test endpoint, and select ""Open in Quick Launcher"", then select ""Search all events on <endpoint name>"". This will open an XQL query, and you utilize the magnifying glass icon to search for your desired event details. This workflow will provide you with additional context on the associated field that may be used for additional query related use-cases.",0,10-20-2021,10:48 AM
906,441142,tvilas,"Hello, you can create an alert exclusion.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...",0,10-18-2021,09:40 AM
907,441142,CGirouard,...yes. Of course. But that isn't the question.How can I create an exclusion based upon theaction_local_ip field?I don't see a way to do so.,0,10-18-2021,10:19 AM
908,441142,tvilas,"Hello,I'm assuming you are referring action_local_ip field from xdr_data, for alerting exclusion you must use the fields on your alert details, you can check this in your Alert table. In this case, most likely will be ""Local IP"" Nonetheless, the best way is to look at your alerts and check which field the IP you want to exclude encounters, and then move forward with an alert exclusion rule.",0,10-18-2021,05:09 PM
909,441377,teJacobCF,"hello, I have always used those and have not had an issue. I was using them to get all my alerting setup to ingest into my siem.have tried to execute them? simply downloading them won't get caught unless you have the file scanning set up.",1,10-18-2021,06:34 AM
910,440628,teJacobCF,"while installing you could do something like:I wished you could force a content update from the cloud platform but I think they saying with a ""check in"" or a ""perform heartbeat"" it should just check in and do that automatically. I think as an admin keeping an eye on all your managed cortex assets and their corresponding content versions is really important, I see I have a few active devices that are a version or so behind not sure how to remediate.",0,10-14-2021,11:54 AM
911,440628,newman,Thank you! I think I can work with this. I agree that keeping our content versions up to date on our endpoints is mega important and saves us from a ton of unnecessary alerts and false positives.,0,10-16-2021,01:39 PM
912,440538,tvilas,"Hello,You should be able to run a live terminal on the endpoints even though they are using broker VM. There is no additional specific configuration necessary for the live terminal as long the endpoint has live terminal functionality enabled (default) you will be able to use it.",1,10-14-2021,03:31 PM
913,440150,tvilas,"Hello,In this case, I would recommend opening a support case if you have concerns that this being a false positive. The support team can assist you to further investigate what behavior changed, in the meantime, you have the option to suppress these alerts.",0,10-12-2021,02:57 PM
914,438699,WSeldenIII,Hi@OrkanAlibayliPlease reference the Cloud Identity Engine System Requirements documentation to ensure that you have enabled the required access.,0,10-12-2021,06:56 AM
915,353274,dfalcon,"Hi@WilliamFoisseau-Have these machines ever been able to communicate with the Cortex XDR tenant? If not, have the certs in step 3 of this document been added to the certificate store on the affected server?https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...",0,10-05-2020,06:16 PM
916,353274,WilliamFoisseau,"Hi,A just install the root certificat on all device",2,10-09-2020,12:53 AM
917,353274,Dalbir.Monga997aria-label01,"Can anyone help me with the location to download the root certs required and the location to add these .crt files to? I have got the certs and added them to the ca-bundle.crt file in /etc/ssl/certs and have restarted but it does not work, unfortunately.",0,10-11-2021,10:22 PM
918,439187,WSeldenIII,"Hi@FWPalolearner, It appears that you are looking to understand more on the Cortex Portfolio, which is one integrated platform for security operations. Each one of the security tools provides multiple solutions to your security posture. For example, Cortex XDR provides the ability to stitch together network, endpoint, cloud, and identity data for threat detection. Cortex XSOAR optimizes the SecOps workflow by automating incident response with playbook automation. Please take a look at the Cortex Portfolio reference links mentioned above for additional details on the security tools and the additional solutions/use-cases. If you have any specific questions about any one of the security tools, then I suggest to contact your Palo Alto Networks representatives to assist with providing you a path forward.",1,10-06-2021,11:54 AM
919,439187,uis,"Palo Alto Networks XSOAR is Security Orquestration and Response. There you can design and develop your process and procedures framework for your SOC and Security Operations and Response. Including there your playbooks for your analysts and Incident Responders. This is a very useful tool for Incident Response / Incident ""Management""XDR is to detect, investigate and give lets say the technical response to the incident. In this last sentence technical response I mean that you might follow the processes, procedures, playbooks ... that you have written on your Palo Alto XSOAR.Palo Alto Cortex XDR will automatically detect the malicious/suspicious activity in your infrastructure/assets create the alerts within the incidents for your analysts who just go there to see that tons of technical work has been already done and all meaningful events are put together and in context. So your analysts will understand what is going on. Which kind of incident they are facing understanding the real threats taking place at your organization. They can even give a response gathering more information, malicious files, deletion of those files in all your infra, isolating endpoints or groups of them in just seconds and all this with just a few clicks.",1,10-07-2021,03:50 AM
920,425407,malalade,We would recommend you open a technical support case and work with our TAC engineer - https://support.paloaltonetworks.com/,0,08-13-2021,02:25 PM
921,425407,JJohnson29,This exact thing is happening to me. I can boot into safe mode but not in normal mode. Worked fine until I restarted after cortex is installed. AAD joined precision 5560.Did they find a resolution for you?,0,09-08-2021,08:15 PM
922,425407,pasmartin,"No, never got as far as creating a ticket as I was swamped with other stuff, and since this PC was not to be used before september (luckily), it was not prioritized until a week or two after I wrote the post. A new version of XDR was available (7.4.0 if I'm not mistaken), and that did not trigger the issues.The version that seemed to be the cause for me was 7.2.2.Which version are you running?",0,09-09-2021,12:15 AM
923,425407,JJohnson29,I have installed 7.3.2.26319 and have had troubles uninstalling it to try the newer 7.5. It sounds like the newer version of Cortex XDR may be the resolution.,0,09-09-2021,10:02 AM
924,425407,pasmartin,"Yeah - feel free to report your results if you manage to get v7.5 installed - nice to know whether I got lucky, or if it's something with 7.2.* / 7.3.* versions that is causing this behavior.",0,09-13-2021,03:39 AM
925,425407,crmflo1919,I had the same issue with our new Dell Latitude 5521 laptops. I was installing version 7.3.1. Issue persisted on 7.3.2. We then switched to Cortex XDR 7.5.0 and the PCs appears to be stable now.,0,10-05-2021,06:58 AM
926,433228,CraigV123,"Haven't had the issue ""yet"" per say. Getting ready to update our departments workstations to 7.5 today actually. This is good to know. I wish they'd stop EOL'ing their versions so fast. Making it hard to keep up and operate efficiently. I'll keep you posted on our results too. Thanks for the heads up on this.",2,09-13-2021,05:22 AM
927,433228,mbahen,"Just to Update I monitored a server over the weekend. The memory usage of the Cortex XDR service continually went up. Starting at 400MB on Friday and now, on Monday, it's at 700+. If I restart the service or machine, it goes back down to a more normal range of 250-350MB and the memory usage starts slowly creeping up again.Nothing helpful or insightful to add from the Support crew either. Just a lot of file uploads and analyzing.Will update if I hear something.",1,09-13-2021,10:47 AM
928,433228,CraigV123,I cancelled my IT workstation update for today until I/we can learn more. I hope they have a 7.5.1 version coming soon to maybe address some of these issues.,0,09-13-2021,12:25 PM
929,433228,Alexandre_Jodoiaria-labeln,We got a server where cyserver.exe is taking 20GB of memory. Also in contact with support.,0,09-14-2021,07:21 AM
930,433228,mbahen,Is it version 7.5.0 too?,0,09-15-2021,09:05 AM
931,433228,Alexandre_Jodoiaria-labeln,"yup, 7.5.0.36150",1,09-15-2021,09:06 AM
932,433228,jcandelaria,"@Alexandre_JodoinPlease work with support on this one, using 20GB is really really really too high. This needs to be investigate thoroughly..They probably need to look deeper at the low level logs on this one.",0,09-15-2021,09:45 AM
933,433228,Alexandre_Jodoiaria-labeln,"Yes, I haveCASE 01947582 open for this issue.",0,09-15-2021,09:47 AM
934,433228,mbahen,"Just to update the thread. We've been working with support on this issue. They stated it may be an issue with the Network Packet Inspection module of the client. They released some new content releases to try and resolve the issue. So far with those releases (197 and 198) they appear to at least slow the memory leaking. Still working to see if we have to restart the cyserver.exe process to make the ""fix"" take hold or not",1,09-23-2021,02:39 PM
935,438490,WSeldenIII,"Hi@BoonHweeCortex XDR analytics offers the ability to detect and alert anomalies with USB storage activity. The following are just two XDR analytics alert references:Please note, Cortex XDR analytics requires an XDR Pro license, and the USB Storage Device alerts have required data sources (Palo Alto Networks Firewall Logs and XDR agent), and a required detection module with the Identity Analytics.In terms of XDR Device Control, the feature is designed to block or allow USB-connected removable devices depending on how you have configured your Device Configuration - Extensions profile. If I understand the scope of your question correctly, then the device control configuration option is not available at this time. If you would like to request feature enhancements to device control / alerting, then please coordinate with your XDR SE or Customer Success POCs where applicable.",0,10-04-2021,09:31 AM
936,438433,uis,"Hi OrkanAlibayli,please check this doc with the requirements for the live terminal session and make sure you are compliant with thathttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...at the following document you will see how to at step 4 you can disable the notifications to the user. Please realize that this is just available for Windows and Mac endpoints.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/customiza...I also hope that the following procedure helps:ProcedureTo investigate and respond to security events on Windows endpoints, you can use theLive Terminalto initiate a remote connection to an endpoint.The Cortex XDR agent facilitates the connection using a remote procedure call.Live Terminal enables you to manage remote endpoints.Live Terminal is supported for endpoints that meet the following requirements:If the endpoint supports the necessary requirements, you can initiate a Live Terminal session from theEndpoints page. You can also initiate a Live Terminal as a response action from a security event. If the endpoint is inactive or does not meet the requirements, the option is disabled.After you terminate the Live Terminal session, you also have the option to save a log of the session activity. All logged actions from the Live Terminal session are available for download as a text file report when you close the live terminal session.Please dont forget to thumbs up if this answer was helpful.KR,Luis",1,10-04-2021,07:29 AM
937,438433,OrkanAlibayli,"Hello Eluis,Thanks for answer. All requirements in above is compatiable in our endpoints. But problem still going on.",0,10-04-2021,07:40 AM
938,438433,WSeldenIII,Hi@OrkanAlibayliPalo Alto Networks is currently reporting Cortex XDR - Limited Functionality in Remote Terminal Services in Americas and Europe Regions. You may subscribe to the updates to monitor the status.,1,10-04-2021,08:49 AM
939,438299,ShaiW,"HiXDR Users are retrieved from the CSPortal (support.paloaltonetworks.com) -> Members -> Manage Users.Note that you will have to delete the account from your CSP in order for it to be removed (not shown at all) from XDR/Users screen, if this is not desirable, this article can help:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...Shai",0,10-03-2021,02:31 AM
940,438299,apjoshi,"Hi Ronnie,If you are the ""Instance Administrator"" you will be able to remove the user after selecting it from the ""Access Management > Users"", check the user you wish to delete and you will be able to see an option on the right hand side for the same user, to delete it.AJ",0,10-03-2021,11:53 PM
941,436179,uis,"Hi Labric,could you please try with the password:Password1and please tell us the outcome. You should be able to uninstall it with this one.The usual way to uninstall customers should be better from management console. Locally on the agent for example when you lost communications with the management console or in you case that the tenant was deleted.KR,Luis",0,09-23-2021,09:41 PM
942,436179,LABRIC,"Hi Luis,We try this password but it doesn't work.KRLaurent",0,09-24-2021,01:27 AM
943,436179,uis,"Hi Laurent,Please open a support ticket with TAC. They will give you a tool for xdr agent cleaner and instruccions on how to proceed. Youll have to boot windows in safe mode and execute the cleaning app in such safe mode.Please note that you will have to boot in safe mode manually every single computer that you need to uninstall.The above is valid for windows OSIf your OS is linux or macOS. You dont need to boot on safe mode. In this case, your uninstall password is the root password for the OSPlease give us feedback on the results.KR,Luis",0,09-24-2021,03:30 AM
944,436179,yogisun,"Hi @eluis,I am facing same issue as@LABRIC.Could you please explain what ""TAC"" is? is it some sort of open in LIVE community or do we need to register separately?If it is a separate registration, could you share the url for TAC where I can open a ticket..It would be great if there is a public file share repository which can be used for download of ""tool for xdr agent clean up"".regards",0,10-02-2021,06:41 PM
945,436179,uis,"Hi Yogisun,TAC is the support for customer facing problems related to bugs on our products. You can open a ticket when you have a technical issue related to a bug or malfunction of Cortex XDR.The url is as follows and yes, you should register there as a customer:https://support.paloaltonetworks.com/For the agent uninstall in lets say non-standard procedure, the supported way is to open a ticket. They will provide instructions on how to proceed and also the software needed.I hope this helped you.KR,Luis",0,10-03-2021,02:03 AM
946,330225,dfalcon,"HI @Marsooq_A -Yes, this is the uninstall password. If you need to change the password, this can be done within the agent profile.",0,05-28-2020,05:20 AM
947,330225,Marsooq_A,"well , It didn't work for me, even I created a dedicated policy for an endpoint with customized agent profile with a known uninstall password to test this. But did not work",0,05-28-2020,05:30 AM
948,330225,Marsooq_A,,0,05-28-2020,05:39 AM
949,330225,dfalcon,"Hi @Marsooq_A-When you go to to your list of endpoints, can you right-click on the machine in question then select Endpoint Data > View Endpoint Policy.From there, can you please confirm that the machine received the correct profile?",0,05-28-2020,05:46 AM
950,330225,Marsooq_A,"@dfalcon, Yes the endpoint is configured with right policy.",0,05-28-2020,05:50 AM
951,330225,dfalcon,One more thing to confirm -- did you run cmd.exe as administrator?,0,05-28-2020,06:00 AM
952,330225,Marsooq_A,"@dfalconThanks for the suggestion, its working with cmd with admin privilege",2,05-28-2020,06:17 AM
953,330225,vigneshmohan,"Same issue even if i amworking with cmd with admin privileges,but got resolved once I set new uninstall password as specified above.Thanks Dfalcon",0,08-15-2021,11:34 PM
954,330225,yogisun,"Hi@vigneshmohan,Could you share the steps to change uninstall password? did you perform that using Cytool or other tools?Thanks",0,10-02-2021,06:45 PM
955,437774,malalade,"Yes. There are multiple workarounds.1. You can either use the ""Endpoint Administration"" Tab to get the equivalent ""hostname"" of the ""IP Address""/""user"" and then use ""quick Launcher"" on the top right to get the ""Asset View"" of the endpointChange the view to applications. That provide the list of application and the count2. Alternatively, you can use XQL query. Target ""Host Inventory"" tableNote:Agent_id is the primary key for the host inventory table. But you can execute the query with a filter such as- host_name- ip_addresses- usersAlso, note the timeframe specified because host inventory collection happens daily and you could have multiple countsWith IP Addressdataset = host_inventory| filter ip_addresses = ""10.10.10.10""| arrayexpand applications| alter apps = json_extract(applications, ""$.application_name"")| fields appsTo make it a re-usable query, change the hardcoded IP Address to ""$system_ip"" and save it into your query libraryWhenever you want to use the query, you will need to supply the target IP Address as the parameter. See attached screenshotdataset = host_inventory| filter ip_addresses = ""$system_ip""| arrayexpand applications| alter apps = json_extract(applications, ""$.application_name"")| fields appsWith User namechange the target_user e.g. Smith (case sensitive)dataset = host_inventory| arrayexpand users| alter target_user = json_extract(users, ""$.name"")| filter (target_user = ""\""target_user\"""")| arrayexpand applications| alter apps = json_extract(applications, ""$.application_name"")| fields appsFor the count of applications per IP Addressdataset = host_inventory| filter ip_addresses = ""10.10.10.10""| arrayexpand applications| alter apps = json_extract(applications, ""$.application_name"")| dedup apps by asc _time| comp count(apps) as Counter by _time",1,09-30-2021,03:39 PM
956,437153,malalade,"Yes, there is a tool you can leverage in that situation.We recommend you open a support case with Palo Alto Networks Support -https://support.paloaltonetworks.com/They will securely provide you the appropriate version of Cortex uninstaller tool and the process without re-installing the OS.------------------In future, to cleanly uninstall Cortex XDR from endpoints, disable tamper protect first before you start uninstall process.https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-4/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",1,09-28-2021,02:03 PM
957,437153,moixsante,"Hi there,as@malaladestated the best course of action would be to open a case with support but not just for the so-called ""XDRcleaner"" but to find out why ""tdevflt.sys"" prevents you from uninstalling/upgrading the agent.By the way, do you start the upgrade process from the XDR console?",0,09-29-2021,01:42 AM
958,436521,Luc_Desaulniers,"Hi Nathan,I haven't seen a way to convert queries from query builder to XQL as a feature in the product right now.But from XQL query library you can use the one named:",0,09-27-2021,07:06 AM
959,436521,malalade,"dataset = xdr_data| fields action_file_device_info as drive_info| alter device_type = json_extract(to_json_string(drive_info), ""$.storage_device_drive_type"")| filter drive_info != null| filter device_type = ""2""==========================Note: Device type could be==========================Unknown = 0,Fixed = 1,Removable = 2,Cdrom = 3,Network = 4,Ramdisk = 5The ""storage_device_drive_type"" field is taken from this enum (json):",0,09-27-2021,09:15 AM
960,436521,NathanBradley,"Thanks I ended up with the following as i needed to include the user, file path, and file nameNow i just need the report to print all data in the PDF rather than a subsetdataset = xdr_data| filter event_type = FILE and event_sub_type = FILE_CREATE_NEW| alter Drive_Type = json_extract(to_json_string(action_file_device_info),""$.storage_device_drive_type"")| filter drive_type = ""2""| fields action_file_path as File_Path, actor_effective_username as Username, action_file_name",0,09-27-2021,09:45 AM
961,435504,jdelio,Can you please provide more info,0,09-21-2021,09:58 AM
962,435504,RRomih,I have put all hash to allow list but installation is still blocked,0,09-22-2021,02:01 AM
963,435504,RRomih,No the problem still remains. I didn't got any tip what it would be good to do...,0,09-24-2021,12:16 AM
964,435504,jdelio,"OK, this is using Cortex XDR?Please let us know what version, and then I will make sure that this discussion is moved to the Cortex XDR area.",0,09-24-2021,08:28 AM
965,435504,RRomih,we are using Cortex XDR Prevent - Agent version 7.5.0.2248,0,09-26-2021,11:45 PM
966,435417,uis,"Hi Tejasp04,You can customize the amount of disk space that the cortex xdr agent uses to store logs and information about events. See in your specific case/instace the space you have occupied so far.By default the disk space for storing logs is 5GB. You can check the config under the agent settings and you can increase it up to 10Gb max APROX.If you reboot the system the agent is cycling the logging schema in the following way:The logs are created under folder C:\ProgramData\Cyvera\LogsGo there and check the files trapsd.log*The file trapsd.log stores the newest logs.The file trapsd.log.9.gz stores the oldest ones so the ones that are deleted/cycled first.Once trapsd.log is full, it is renamed to trapsd.log.0.gz and trapsd.log.0.gz to trapsd.log.1.gz and so on ... so trapsd.log.9.gz is lostSo the log storage and retention period within cortex xdr agent may vary depending upon your config setup, and logs generated by your agent instance.If agent lost the logs your are looking for. You could go and look for ""some"" of the logs at Cortex Data Lake in case you have it (the security related logs should be at CDL but not the agent operations related logs). Again depending on your setup there and the volume of logs generated by your xdr agentS, log retention may vary also at CDL.So please take into account that the log limitation is not related to time but to Space quota on the hard disk which means that the more logs your agent/computer generates, the less time log preservation you will have.I hope I brought some light to the subject.KR,Luis",0,09-24-2021,05:04 AM
967,435515,uis,"Hi Enewman,I was wondering yesterday when I read your message if there might be some difference between the computers with this strange behaviour and the other ones that are not giving you any problems. Do they all have the same OS ? any kind of app installed in the ones giving problems that might mess up with xdr agent ?Otherwise I would recommend you to open a support ticket.KR,Luis",0,09-22-2021,12:25 AM
968,435515,newman,"Same OS, same version, same updates even, nothing different installed anywhere. These machines are very cookie-cutter as they are used in retail stores and must all be the same.",0,09-22-2021,05:28 AM
969,435367,uis,"Hi LorenPeterson,to start with Cortex Data Lake you need to first plan your deployment.Im gonna give you good resources to start with it, plannify your deployment calculate storage space depending on different log sources you might integrate in CDL. There is also a calculator for the sizing (find the link to it on the 1st document on how to plan your CDL implementation)Please check the following docsGeneral info on CDL. I guess that you've already seen this:https://docs.paloaltonetworks.com/cortex/cortex-data-lake/cortex-data-lake-getting-started/get-start...Plan your CDL deployment (including links to calculator and log integrations):https://docs.paloaltonetworks.com/cortex/cortex-data-lake/cortex-data-lake-getting-started/get-start...Start sending logs to CDL:https://docs.paloaltonetworks.com/cortex/cortex-data-lake/cortex-data-lake-getting-started/get-start...Kind Regards and have a good CDL time,Luis",0,09-21-2021,12:16 AM
970,435084,uis,"Hi Basinilya,xdr decoy files for ransomware detection start with!!!!! andZZZZZSo the recommendation is to avoid to copy/touch those files (with the usage of regex or something to exclude them from your copy)Touching those files is not recomended if you dont want to have unexpected effects on ransomware detection/prevention.KR,Luis",0,09-20-2021,03:14 AM
971,434060,jcandelaria,"Hi OrkanAlibayli,Its basically a timer that you can set to monitor and collect forensic data..The default is Off which means there is no interval hours of collecting the data. If you put say 24hrs that means it will collect every after 24hrs which means you might missed some data collection within 24hrs which might be vital on your forensic investigation. That's why the default is OFF.",1,09-15-2021,09:21 AM
972,434060,OrkanAlibayli,Thank you very much!,0,09-15-2021,09:50 PM
973,433932,jcandelaria,"Hi John_Acoba,I assume you went and follow the guide below already? What version of the agent that keeps getting listed on the same tenant? Is this happening to all agents or only certain versions?https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/manage-co...",0,09-15-2021,09:08 AM
974,433409,jcandelaria,"Hi Felixcao,""Cortex XDR permits a small grace over the permitted number but begins enforcing the number of agents after 14 days. If additional Pro agents are required, increase your Cortex XDR Pro per Endpoint license capacity.""At the same time, after 14 days, if there is no add new license, the no:201 terminal will lose the link and lose the prevent function. Is this correct? YesSo contact your account team as soon as possible to get additional licenses",0,09-13-2021,08:38 AM
975,433409,Felixcao,"hi jcandelarial:Thank you very much for your reply.about permits a small grace over the permitted numberHow many endpoints can be added? What percentage of the order?If the order number is exceeded, after 14 days, if there is no new license, is the newly installed endpoint or random disconnected",0,09-13-2021,08:33 PM
976,433409,jcandelaria,"Hi Felixcao,How many endpoints can be added? What percentage of the order?I apologize but you have to consult your account team on this one.If the order number is exceeded, after 14 days, if there is no new license, is the newly installed endpoint or random disconnected. what will happen on the newly installed agents status will have disconnected status. If one of the 200 connected agent shutdown the machine then the 201 agent will get connected since there is available license. Then the previously shutdown agent when it boots up now will get the disconnected status.I would highly advise to engage with your account team to get the proper licensing count to avoid the scenario above.",2,09-15-2021,09:04 AM
977,422108,jcandelaria,,0,07-26-2021,10:17 AM
978,422108,CraigV123,Thanks for the response. It's a backup server and doesn't get a lot of traffic throughout the day but I'm awaiting the owning engineers confirmation on that. I'll update when I know more. Thanks again.,1,07-27-2021,06:49 AM
979,422108,CraigV123,My apologies on the delayed response. We couldn't find any rhyme or reason exactly. Ended up updating the agent and it has been working alright since. Not sure what happened exactly but I did the same on other servers experiencing the same symptoms and it didn't help.,0,09-13-2021,05:24 AM
980,422108,jcandelaria,"Hi CraigV123,So server is still an issue on high memory? how much memory are you seeing constantly on that backup servers?",0,09-13-2021,08:31 AM
981,422108,CraigV123,"Doesn't seem to be an issue anymore. The engineer just said ""it's running fine."" It's been extremely rare that I've heard of issues with XDR in terms of memory consumption. I had some servers that process medical images that would cause the XDR process to spike then return to normal. Not an ""issue"" but XDR was being blamed for crashing the boxes.",1,09-13-2021,12:27 PM
982,432871,TomYoung,Ugh! That online training is terrible! The NGFW online training is much better. The only instructor training I know is EDU-260. You can Google it. Partners and employees can take it for free on Beacon the next time it is scheduled. I would guess PANW will update it to 3.0 soon.This community page looks really cool -> https://live.paloaltonetworks.com/t5/cortex-xdr-walkthroughs/cortex-xdr-kick-off/ta-p/376481.,1,09-10-2021,07:56 AM
983,432871,jcandelaria,"Hi Chukaokonkwo,I'm not sure whats your reasonable price range but if you want to, you can engaged with professional services offering below with your account team..https://www.paloaltonetworks.com/resources/datasheets/service-description-optimization-service-for-c...",0,09-13-2021,08:43 AM
984,433374,uis,"Hi PankajThakre,I recommend you to open a support ticket which seems to be the best option for the issue you are having.Kind Regards",0,09-13-2021,02:44 AM
985,346933,Nachum,"btw:echo 5Nstall22#| ""c:\program files\Palo Alto Networks\Traps\cytool.exe"" protect disablethis works locally...",1,09-04-2020,10:15 AM
986,346933,Max.Segura,"Try this:If that doesn't work, you can try the following bat:You also have other possibilities by running, one time, remote scheduled tasks. You have options.",2,09-04-2020,06:48 PM
987,346933,Nachum,"thank you! the results I got was:Executing (Win32_Process)->Create()Method execution successful.Out Parameters:instance of __PARAMETERS{ProcessId = 5032;ReturnValue = 0;};--------------------------------------------------yet the query shows its still Enabled...--------------------------------------------------c:\PSTools>psexec -i -d -s \\9020m-77 cmd /c ""c:\program files\Palo Alto Networks\Traps\cytool.exe"" protect queryConnecting to 9020m-77...Protection Mode StateProcess Enabled EnabledRegistry Enabled EnabledFile Enabled EnabledService Enabled EnabledStarting cmd on 9020m-77...ice on 9020m-77...cmd started on 9020m-77 with process ID 5044.-----------------------------------------------Thank you though, you are right, I have other options... I decided to just use the web console to update the agents... it was more of a challenge and if it did work, I would use it in the future in other cases where its needed.",1,09-07-2020,07:41 AM
988,346933,mrowland,You have to make sure there is no space between the end of the password and the | otherwise the space is included as part of the password.,1,09-12-2021,09:46 PM
989,432506,avelK,Hi@PKhemarithCortex XDR management console is created by Tenant activation in Step No.4 of the following document:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/get-started-with-cortex...Kind RegardsPavel,0,09-08-2021,12:18 AM
990,432506,jrzepka,You can reach your XDR Gateway from the link below. That will give you a link to your specific tenant.https://xdr-gateway.paloaltonetworks.com/accounts,0,09-10-2021,10:53 AM
991,433046,moixsante,"Hi@Grady.Chen,Like that it is not easy for anybody to provide a proper response to your question, I would recommend opening a case with TAC and provide the logs of the agent for further investigation.",0,09-10-2021,05:24 AM
992,433046,jrzepka,"If you look under the response tab, action center. You can see on the left side the Endpoint Blocked IP Addresses. That is where you should remove that IP address to allow communications again. Screenshot is provided below.Hopefully this cleared up your issue.",0,09-10-2021,10:51 AM
993,432845,moixsante,"Hi@EddieRowe,The auto-upgrade work in 3 ways.The recommendation is to use ""Latest maintenance version"" and as long as you do not upgrade your agents to the latest version available, at the moment, 7.5, you should be fine.",0,09-10-2021,05:16 AM
994,432845,EddieRowe,"Thanks. Now, if I can only get Palo Alto support to agree and resolve the issue of agents < 7.4 not upgrading to 7.4 when I am using option 3.",0,09-10-2021,07:22 AM
995,432845,jrzepka,You can accomplish this by use of the grouping filters. You can set the dynamic group to include agents with a version less than 7.4 and not apply this auto upgrade policy to them; or use a 7.3.x autoupgrade to maintenance versions if you like. Then have a separate group for agents with greater than or = 7.4 to have the auto upgrade policy apply for the 7.4.x line. This will allow you to specify the agent upgrade policies based on the dynamic filters you set.Use this so your 7.3 agents do not apply the autoupgrade to 7.4 and stay within the 7.3.x version.Use this filter so agents in the 7.4.x apply the autoupgrade for the 7.4 maintenance release versions.Hopefully this cleared up the frustration you were experiencing.,0,09-10-2021,10:45 AM
996,431660,EddieRowe,I have duplicated the issue with 7.4.1.31675 and 7.3.2.26319 as well so I can only guess this is an issue with our tenant. Opening a support ticket.,0,09-04-2021,05:03 PM
997,431660,uis,"Hi Eddie,taking into account that you haveWindows 10 x64 v2004 Pro updated and XDR Cortex agent version higher than 7.1. Bitlocker encryption should be supported and working.I believe that the correct way to handle this is what you have done, opening a support ticket.Kind Regards,Luis",0,09-06-2021,02:29 AM
998,400864,moixsante,"Hi@OrkanAlibayli,To be able to use Pathfinder, you need to first have a Cortex XDR Pro per TB license and have your PAN NGFW send logs to Cortex Data Lake. Also, Pathfinder is only able to gather information from Windows endpoints.Do you have the above requirements? Please do also follow this article for Pathfinder.Activate Pathfinder (paloaltonetworks.com)",1,04-21-2021,04:34 AM
999,400864,OrkanAlibayli,Hi@fmoixsante. Thanks for your answer.We have Cortex XDR Pro per TB license. And i also followedActivate pathfinder. But our NGFW dont send logs to Cortex Data LakeMy questions are these:Thanks!,0,04-21-2021,05:07 AM
1000,400864,moixsante,"Hi@OrkanAlibayli,You need to send your PAN NGFW logs to CDL so that whenever Analytics get trigger, Pathfinder will then try to gather information from the involved endpoint/s.",0,04-22-2021,02:54 AM
1001,400864,ESJosephPrinz,"This pathfinder thing has been a real pain. I was told via a support ticket to identify devices without XDR on it I needed to:Install Broker VMInstall Network MapperInstall PathfinderI was told when net mapper does a scan it will identify devices and then pathfinder will run its script on them.This business of NGFW logs seems irrelevant. Although, we do send all of our pan logs to the cortex lake.Since installing pathfinder, I have not seen any activity in the collection center. In fact I purposely placed a windows 10 device without XDR on it on the same network range Net Mapper scans and pathfinder isnt doing a thing. When I look at pathfinder logs all I see are my ""tests"". What is the point of network mapper if it doesnt pass on new devices to the asset manager?What is the point of pathfinder if no alerts are sent for it to interrogate.Where is the palo alto documentation on these items that we paid for? All there is is install guides less than a page long.I am tired of opening tickets and getting support people who clearly know nothing about this.Yes, I am aware the new cortex has what appears to be a peer to peer agent scan for devices process. Lets just say I dont want to use that method. For one the documentation says it will discover MAC and Platform only, I want the name of the unprotected device. Perhaps the doc is wrong but I still want to know after spending all this time setting up these services why they are not working.",0,09-03-2021,01:57 PM
1002,430917,tvilas,"Hello!I recommend looking in the bigfix documentation about the methods supported to deploy software on these Operating systems as this is more about bigfix deployment method than XDR installation coverage. . If bigfix supports msiexec for Windows deployment you should be fineusing the steps in our documentation[1], the same applies for Linux[2] with rpm/dpkg and MacOS[3] with a unified configuration profile for MDMs similar as jamf process.[1]https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-5/cortex-xdr-agent-admin/cortex-xdr-agent-for-...[2]https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-5/cortex-xdr-agent-admin/cortex-xdr-agent-for-...[3]https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-5/cortex-xdr-agent-admin/cortex-xdr-agent-for-...https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/manag...agents/create-an-agent-installation-package.html",0,09-02-2021,09:20 PM
1003,428577,tvilas,"Hello,Currently, there is no way to suppress these violations. Although you can try to hide row the hostname or GUID or type, this will only change your user view. right-click and you will see an option of ""Hide rows with..."" as shown in the example:",0,09-01-2021,03:20 PM
1004,428717,tvilas,"Hello,I would suggest speaking with your account management team to sort it out. We may add a PoC tenant if someone from your team/company requests it.",0,09-01-2021,11:01 AM
1005,429702,JEbrahimi,Hi. If you are using the latest app it work by polling the data via the api and stores in as sourcetype pan:xdr_incident. The data is normalized to be CIM compliant. You can configure you Splunk to use the API by selecting the Add On and then creating a new input. This requires setting up the API ID/Key inside XDR to be used to poll the data.,0,08-31-2021,07:12 AM
1006,429702,umbach,"I already have done this... there is too little information in the Incident to even be considered an alert.None of the API data is being tagged for an event. Take the following for example:{""incident_id"": ""6969696"", ""incident_name"": null, ""creation_time"": 1630475896376, ""modification_time"": 1630493807149, ""detection_time"": null, ""status"": ""new"", ""severity"": ""medium"", ""description"": ""4 'WildFire Malware' alerts prevented by XDR Agent on hostfoobarinvolving user foo\\bar"", ""assigned_user_mail"": null, ""assigned_user_pretty_name"": null, ""alert_count"": 4, ""low_severity_alert_count"": 0, ""med_severity_alert_count"": 4, ""high_severity_alert_count"": 0, ""user_count"": 1, ""host_count"": 1, ""notes"": null, ""resolve_comment"": null, ""manual_severity"": null, ""manual_description"": null, ""xdr_url"": ""https://foobar.xdr.us.paloaltonetworks.com, ""users"": [""foo\\bar""], ""incident_sources"": [""XDR Agent""], ""rule_based_score"": null, ""manual_score"": null, ""wildfire_hits"": 1, ""alerts_grouping_status"": ""Enabled"", ""mitre_techniques_ids_and_names"": null, ""mitre_tactics_ids_and_names"": null, ""alert_categories"": [""Malware""]}This should be tagged for Malware Data model, but since there is no action field or tags it doesn't.See attached... It flat out fails even the most basic checks.",1,09-01-2021,04:34 AM
1007,430367,KRisselada,"But when you look for the ""Endpoint ID"" field, that is unique, is it not?Perhaps I am not understanding your question?",0,08-31-2021,08:48 AM
1008,430367,ankajThakre,I can see the endpoint ID is deferent. IP address are deferent but Host name is same?It is make sense ?,0,09-01-2021,12:47 AM
1009,429647,yalonso,"Hi There,What does it mean to see Cortex status DISABLED in the VDI?Looking forward.Hello LuisEhate,Can you share a screenshot of your issue?, If you are referring to Cortex XDR agent operational status.You can find more information here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/monitoring/monitor-agent-op...For example the unprotected status could mean;Cortex XDR agent on VDI's:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-2/cortex-xdr-agent-admin/cortex-xdr-agent-for-...Endpoint details:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...The registration statuses of the Cortex XDR agent on endpoint are:• Connected—The Cortex XDR agent has checked in within 10 minutes for standard endpoints, and within 3 hours for mobile endpoints.• Connection Lost—The Cortex XDR agent has not checked in within 30 to 180 days for standard endpoints, and between 90 minutes and 6 hours for VDI and temporary sessions.• Disconnected—The Cortex XDR agent has checked in within the defined inactivity window: between 10 minutes and 30 days for standard and mobile endpoints, and between 10 minutes and 90 minutes for VDI and temporary sessions.• VDI Pending Log-on—(Windows only) Indicates a non-persistent VDI endpoint is waiting for user logon, after which the Cortex XDR agent consumes a license and starts enforcing protection.• Uninstalled—The Cortex XDR agent has been uninstalled from the endpoint.",0,08-31-2021,03:48 PM
1010,429647,Breitenberg,Just wondering if anyone else is experiencing this... We have about 600 XDR agents deployed and keep running into scenarios where the agents just seemingly randomly stop checking in. Nothing meaningful in the logs. Doing a cytool checkin does nothing. The agents disappear from the dashboard entirely making it reeeeeeallly hard to even determine that the agent has stopped communicating. If we use the XDRAgentCleaner to manually remove the agent and re-install it magically starts working just fine. We've seen it on multiple agent versions from 7.0 to 7.3. The last_checkin dates are all over the map.. It's just super odd. Palo support has been completely unhelpful.official rapidfs,2,08-31-2021,09:45 PM
1011,430359,yalonso,"Hi LuisEhate,It would be a good practice to ensure the endpoint security profiles are properly configured. For an unprotected operational status on Windows, Mac or Linux the causes could be :Cortex XDR operational statushttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/monitoring/monitor-agent-op...Endpoint Security profileshttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...",0,08-31-2021,04:09 PM
1012,428281,jrzepka,That is uninstalled and the agent is removed. Once you uninstall the agent you no longer have any remote connection to it. You will need to re-install the agent on that endpoint either utilizing a deployment utility or manual installation. Once it has been re-installed it will check in and you will regain management over that endpoint.,1,08-31-2021,01:22 PM
1013,429274,yalonso,"Hi, all. I tried using Live Terminal for the first time today, and all was going well until I got the the Command Line section. While connected to a Mac, I got this error message:Any ideas how I should proceed? I did not find any clues in the Pro Admin documentation.Hello Hannahraya,This is a notice of a change to start withmacOS Catalina which seems kind of forced. Mac will use zsh as the default login shell and interactive shell. You can make zsh the default in earlier versions of macOS as well if desired through your system preferences.By default, your Mac uses either zsh or bash as the command-line interpreter for the login shell and interactive shell:zsh is highly compatible with the Bourne shell (sh) and mostly compatible with bash, with some differences. For more about zsh and its comprehensive command-line completion system, entermanzshin Terminal.You can choose ZSH as a default through your Mac system preferences or by running the command:chsh -s /bin/zsh which will then run ZSH with an user in context and prompt for authentication.More information on setting default shells:https://support.apple.com/en-us/HT208050ZSH cheat sheet:https://github.com/ohmyzsh/ohmyzsh/wiki/Cheatsheet#helpful-aliases-for-common-git-tasksNow if there are connectivity issues or the shell dies abruptly within the Cortex XDR live terminal session could you share a screenshot of the error or provide additional details?Note: Live terminal sessions will terminate after some time with inactivity.Regards,Yalonso",0,08-28-2021,01:34 AM
1014,428480,yalonso,"Hi,I have deployed Cortex XDR in my environment and I have two queries it features.1. I have integrated the on-premises AD with the help of a DSS agent and cert. It is connected and is synced in the cloud identity engine. So what is the purpose of the AD in Cortex XDR why it is used and can we configured the user and group base policy. if yes what is the process to configure the user and group base policy?2. Previously we were using McAfee in our environment. It has a feature to prevent our block the users to download malicious files. Does this feature is also available in cortex XDR. If yes, how can we enable it? we have tested this thing in the test machine we were able to download the malicious files after running those the cortex was blocking it but it was not blocking when it was downloading.Hello OsamaKhan,1.DSS is now rebranded as the Cloud Identity Engine, It is meant for visibility into identities and user behavior. You can find documentation and information of it's features here:https://docs.paloaltonetworks.com/pan-os/10-1/pan-os-new-features/identity-features/cloud-identity-e...2. You can configure policy rules and security profiles to harden your security posture. More details on the documentation below.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/endpo...https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...",0,08-26-2021,10:22 AM
1015,427267,BigPalo,Did you have any update? its a false positive?,0,08-19-2021,02:54 AM
1016,427267,Mohammed_Yasin,"No, Still it's receiving a high number of alerts.",0,08-19-2021,02:59 AM
1017,427267,WSeldenIII,"Hi@Mohammed_Yasin,there are several variables to unpack in this scenario. I suggest to investigate if any changes were recently made to the endpoint's assigned malware profile (E.g. Portable Executable and DLL examination - action mode) or the WildFire verdict (E.g. Malware to Benign). The""Detected (Post Detected)"" alert action indicates the verdict for the process bas been changed, and the process was executed in the past but still running. It also appears the process is not signed, which may be one of reason for the initial alert. In terms of impact, wewant to ensure that we are investigating the alert/agent holistically, and the investigation of the impact will be more effective with Support. I recommend to create a support case, if you have not alreadyraised one, so we can have our engineering investigate this issue holistically. You may leverage either one of the following two workflows to retrieve support logs from the endpoint:retrieve support logsfrom an endpoint via the XDR Action Center, or you can right-click on the endpoint from the Endpoint Administration page, and navigate to theEndpoint Controlfield in order to retrieve the support file. The status of the file retrieval action will be in the Action Center in both workflows. I hope this information provides you with a path forward.",0,08-19-2021,08:48 AM
1018,427267,KRisselada,"@Mohammed_Yasinhave a client that generated a lot of Alerts for this file last week during the regular scheduled Malware scans.I take it you have Lenovo Laptops? It would appear for a bit of time, last week, Wildfire Global Verdict had it listed asMalicious, but that verdict was short time later changed to Benign as it was reflected in Cortex Hub ConsoleI had reviewed other OSINT and found this indicative that this indeed should be benign. https://www.virustotal.com/gui/file/3ae8462769a4d5012b66af226a196bb12571c72a231b66f07afcc838e878045c...",0,08-19-2021,10:14 AM
1019,427267,newman,"Hi Mohammed, I had this same alert. It was part of the Lenovo update software. We started getting blasted with alerts, ending up with over 700 alerts. I opened a case and our result was: ""On August 12th the Research team changed that verdict twice keeping it finally as Benign.Based on the last data that you provided, those alerts were Post Detected, meaning that since there was a verdict flip, all endpoints containing that hash will trigger an alert.""This is a benign file. We created an exception and an exclusion to allow the process and stop the alerting. Adding the hash did not stop the alerting. I hope that helps!",0,08-25-2021,01:33 PM
1020,429062,mrjunnu999,"Try unplugging your network cable and reinserting it. If this does not work, you may have a link issue. The Network Access Manager may not be able to determine the correct link state of your adapter. Check the Connection Properties of your Network Interface Card (NIC) driver. regards : hunktv",0,08-25-2021,05:33 AM
1021,429062,Mohammed_Yasin,"Thanks for the comments,Then how its work after uninstalling the trap.. and again if install the trap then it stops working.I suspect Trap Signature might causing the issue.",0,08-25-2021,05:38 AM
1022,326957,CraigV123,"I don't have any experience with Critical Start but we use Cortex XDR as our primary AV platform (we were a Symantec shop previously). We're a 10,000+ device organization and have been pretty pleased with it so far. It does couple with Windows Defender (since you upgraded to Win10). Pair the two if you can and you've got a pretty solid layer of defense. We've had some memory usage increase on our machines but it has had no performance impact. Follow the compatibility and system requirements docs well.Policies are pretty easy to implement and the forensics are night/day difference for us at least. We've been happy with this part of XDR. It's caught things that SEP left untouched. We also have very few security exceptions and a small whitelist which is a huge win for any security posture.Hope this helps a little. Good luck!",0,05-08-2020,12:25 PM
1023,326957,apnsettings,"If your carrier allows it, you can view your APN settings in one of the following locations: Settings > Cellular > Cellular Data Options > Cellular Network. Settings > Mobile Data > Mobile Data Options > Mobile Data NetworkBsnl Apn Settings airtel apn settings ",0,05-07-2021,01:38 AM
1024,326957,TPLINKREPEATER,"Nice article !!The TP-Link extender login process begins as soon as you install your devices and connect to the device network. You will be required to access the device network and work on configuring the network settings online. Once you have configured the same, save the settings. For help, reach out to the team at our end now.",0,08-24-2021,02:11 AM
1025,428459,yalonso,"HI EveryoneIs it possible to forward XDR Xml Queries to be notified as an email alert? IF yes kindly assist me ,Thanks and regardsHi Sravanth,You can use the widget library to create an XQL widget (Reporting > Widget library)Then you can notify via email using a report template ( Reporting > Report templates).Finally, you can then use the report builder to create a blank report template and configure a time frequency and other parameters for that notification to be sent with the results of that XQL query via email with an attached pdf report.The notification email would be similar to the example below.",2,08-23-2021,10:29 AM
1026,427905,WSeldenIII,"If there is an ongoing impact in your environment, then I suggest to document this issue within a support case in order to get the most effective response. It appears that initial investigation of issue needs to begin from the GP perspective, because XDR UI does not have a configuration option to make changes to Global Protect.",0,08-20-2021,11:39 AM
1027,427905,Anshu_Paul,There is already a case open at the Portal. -01896134I didn't get proper response or any solution yet. The Case was opened in07/21/2021.I thought I might get a solution for this. I didn't get any yet.,0,08-20-2021,01:15 PM
1028,427985,sramesh-7,"Hi,Based on the policy XDR agent blocks any file which has a verdict as Malware, When the file is blocked user should receive a message from XDR agent pop up window and the same will be reported as alert in XDR Console. You can disable blocking of a file with malware verdict by adding it to allow list or you can also set policies to stop blocking files in a location or type/extension etc based on your requirement - check out this link for allow list",0,08-20-2021,02:45 AM
1029,427985,david.hernandez,"Hi Sramesh-7,Thank you for your quick response.I added the file to the allow List, which it comes from WildFire Malware.Some days later, I get a new incident only involved with this Key artifact but fromLocal Analysis Malware (although the key artifact is in the allow list).The threat intelligencecatalog it as malware.Is that the behaviour expected? What can I do?Thank you,David.",0,08-20-2021,03:25 AM
1030,427985,WSeldenIII,"Hi@david.hernandez XDR offers a multi-layer approach to secure your environment, so it is important to understand the file analysis and protection flow (E.g. Phase 3: Hash Verdict Determination). Additional considerations are to review WildFire analysis details, and if you know the WildFire is incorrect, then you can report an incorrect verdict to Palo Alto Networks to request a verdict change.",1,08-20-2021,07:57 AM
1031,427954,WSeldenIII,"Hi@Muhammad-Rusli,XDR Indicator rules (E.g. BIOC and IOC) are detection rules; therefore, they do not include prevention functionality. These rules will create a detection alert once the criteria has been met.You could also create a BIOC rule based on specific behavior andadd that BIOC to a Restriction profile. The situation that you described sounds like a use-case to manage external dynamic lists. Please note, there are some requirements that need to be met in order to leverage this feature:",1,08-20-2021,07:41 AM
1032,426486,malalade,"The rule of thumb is to check with the business and IT operations if it is a sanctioned application. If it's allowed and you need to create an exception, there are multiple options based on the rate at which the process hash changes. An option is to add the hash to allow list -https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...",0,08-13-2021,01:26 PM
1033,425551,malalade,This page list the applicable response actions -https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...,0,08-13-2021,12:58 PM
1034,426157,malalade,"Currently, there is no option to export both on ""Device Control Violations"" and ""Disk Encryption Visibility"" pages. However, we have submitted a feature request on your behalf. Also XQL dataset currently does not include alert data. If convenient, you could adapt ""Get Violations"" XDR API -https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-api/cortex-xdr-apis/endpoint-manageme...",2,08-13-2021,12:42 PM
1035,345947,gjenkins,"Hi@Megawatt,There are package managers available for modern flavors of Linux. If you research one for your particular version, you should be able to use it to automate the dependency download and install. Is it possible for you to share the target version of Linux if this is still a concern for you?",0,08-12-2021,09:33 AM
1036,345947,Megawatt,"Yeah, but a good Linux RPM citizens takes care of this in their RPM so that the customer doesn't need to go figure those out. And this is a complete pain if those prerequisites change. Not to mention that this means you need to create a separate script for each linux (ver and/or flavor) you run. Seems lazy to not just follow RPM build capabilities like a SPEC file. Implies to a paying customer that the software isn't that much of a focus for Palo Alto.",0,08-12-2021,03:58 PM
1037,351079,gjenkins,"Hi@BenHooperIt would seem that the endpoint is not collecting the logs necessary to report powershell activity to the Cortex Data Lake. If this issue persists, did you confirm if this device is attached to a policy that enables Enhanced data (See step 10 of this link.)",0,08-12-2021,10:08 AM
1038,351154,gjenkins,"Hi@BenHooper,File reads are certainly supported. Did you confirm if EDR was enabled on your endpoint? Are you still observing this issue?",0,08-12-2021,10:04 AM
1039,351105,gjenkins,"Hi@BenHooper,You should be able to view the forensic timeline for an alert as opposed to an endpoint. That timeline can be accessed by right-clicking on an alert, hovering over ""investigate Causality Chain,"" and selecting ""open Timeline in new tab."" See the image below for a highlight.",0,08-12-2021,09:59 AM
1040,349364,gjenkins,"Hi@EddieRowe,Were you ever able to resolve this, or did you have to escalate to Support for assistance?",0,08-12-2021,09:35 AM
1041,425217,jrzepka,I think your search can be accomplished by using this filter setup:,0,08-11-2021,09:50 AM
1042,423934,Aslai,"Hi. Are you experiencing an issue after installing v7.4.1 Agent on a file server? If so, please contact Palo Alto Networks' Technical Assistance Center to open a case.",0,08-06-2021,03:18 PM
1043,423686,Aslai,"Hi. Can you elaborate on what you mean regarding ""environmental testing""? If you want a demo of Cortex XDR you should contact your Palo Alto Networks reseller and request a demo through them.",0,08-06-2021,02:52 PM
1044,422411,jcandelaria,"Hi Jason,Definitely a valid case since the issue went away if you remove 7.4.1 and put 7.4.0.Palo Alto support should be able to isolate or possibly reproduce the issue.Do you happen to remember the exact minor version number? 7.4.1.xxxx ?",0,07-27-2021,09:33 PM
1045,422411,kasak,Any updates to this issue? I think we are experiencing something very similar.,0,07-29-2021,06:33 AM
1046,422411,Shmuel,,0,07-29-2021,06:43 AM
1047,422411,mbahen,"Just put a ticket in with support. They acknowledged the bug causing DCs with the 7.4.1 client to lock up randomly. They are working to resolve. In the meantime, they recommended downgrading to 7.4.0. It is scheduled to be fixed in the 7.4.2 release",3,07-29-2021,07:59 AM
1048,422411,Jason_Castillo,"Hi,The agent version is7.4.1.31675. They are currently testing our environment and, if successful, will deploy a fix soon. Will keep everyone posted.",1,07-30-2021,12:40 PM
1049,422411,JasonPeterson,Does anyone have the process on how to downgrade?,1,07-30-2021,04:05 PM
1050,422411,kasak,"We do the uninstall from the Cortex Admin console then create an .msi package, copy it locally to the server, and install as administrator.",1,07-31-2021,04:23 AM
1051,422411,Jason_Castillo,"Hello,There are two ways to do the downgrade: 1) from the console, or 2) using MsiexecThe more direct approach is using Msiexec especially dealing with only a few endpoints. Here is the link on how to complete this process:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-4/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",0,08-02-2021,07:19 AM
1052,422411,Jason_Castillo,"8/2 Update:Thus far no issues have been reported on our DCs on the fix provided by tech support on 7/30. I Will post once the word is official.For those that are on 7.4.x, Palo Alto recommends downgrading to 7.3 (Although the 7.4.0 agent worked fine for us once we downgraded).",0,08-02-2021,07:23 AM
1053,423683,sramesh-7,"Hi @Shmuel,There is a setting under agent settings profile ""XDR agent console access"" which has to be enabled for users to view console on devices.",0,08-01-2021,09:09 PM
1054,423683,Shmuel,Hi,0,08-02-2021,09:00 AM
1055,423015,jcandelaria,"Hi Shmuel,Not sure what you mean by down?We will show the xdr agent status as below.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/investigation-and-respo...You can also create a filter from endpoint administration using Last Seen. ex. screenshot below with endpoint status disconnected and last seen 7 Days",0,07-29-2021,08:29 AM
1056,423015,Shmuel,,0,07-29-2021,09:01 AM
1057,423015,jcandelaria,"This is a little bit tricky, since the agent is disconnected for a long time probably more than 180 or either some issue with agent itself that cause it to be disconnected to the tenant. Once its past 180 days, the endpoint is gone on from the table.I believe your issue might be that most of these endpoints have older-older 🙂 version possibly 7.1A possible workaround is looking at agent audit logs then filter Sub-Type = Stop, then from there you can filter XDR Agent Version Contains contains 7.1 . That will give you the list of the agents to start with. Then you can compare the list with connected.Other option is to use a tool like sccm to check the protection status of the agent. You can submit a support case on this and ask for the registry that you can use.",0,07-29-2021,09:57 AM
1058,423015,Shmuel,,0,07-29-2021,11:24 AM
1059,423015,Shmuel,,0,08-01-2021,10:14 AM
1060,422316,jcandelaria,"Hi Eliya,first, if you can install the latest agent 7.4.1 since you already remove the 7.4.0 agent.You are correct, there are few files that supports looks and correlate together during the time of when its happeningThats why if possible, during that time, if you can submit a support case so they can look into it.Also i've seen scenario that consumes around this memory for a short period (sample) whenever they are running big office files with macros that links to multiple shared drives.So what im saying is it will happen from time to time but it should go down and also i would observe if the memory goes up and stays up even after the reboot with just user login or just typical user working email and browsing.",0,07-27-2021,07:38 AM
1061,422316,EliyaD,"Hithe memory is Permanent on 700M+.and I start with version 7.3.1 and I upgrade to 7.3.2 and then 7.4.0, so the upgrade is not the solution.I will open a case toPaloand I will update the post.",0,07-31-2021,11:59 PM
1062,423001,jcandelaria,Hi D_BBI would recommend submitting a case to our support and attach the CVE details so our support can check with our research team.,0,07-29-2021,10:03 AM
1063,421891,jcandelaria,"Hi Eliya,You can find the information in agent audit logs then filter sub-type uninstall, then you can couple of information.But we dont record the actual mac information of the endpoint in agent audit.Also another option to get information on the endpoint is do a query using Query Builder (Pro license).You can do all actions --> host --> then put the hostname of the endpoint under the host_name then change the time backtrack before the agent was uninstalled. From the result, you can get some information with regards to the endpoint.",0,07-27-2021,07:58 AM
1064,422053,jrzepka,"Under the Endpoints menu hover overEndpoint Management, then selectEndpoint Groups. Then on the upper right side of the new page select the add group button. Select create new from the menu that pops up. In the filter box search for IP Address. If you choose IP Address = then you can use CIDR notation (IE 10.0.0.1/24 or 10.0.0.1/16) or you can select IP Address Range, this will allow you to input a specific range of IP addresses.",2,07-26-2021,09:26 AM
1065,420186,tugriceri,"Hello Syed,I guess your payload is either not JSON object or has kind of escape char problem.could you share you query and also more detail about query method. (via python, curl etc)",0,07-19-2021,06:07 AM
1066,420186,gjenkins,"hi there,I'm quite new to cortex, gone through the guide available on the site but nothing related to the following error:HTTP/2 500 server: openresty/1.15.8.2 date: Sun, 18 Jul 2021 05:26:48 GMT content-type: application/json content-length: 131 strict-transport-security: max-age=15724800; includeSubDomains x-frame-options: sameorigin {""reply"": {""err_code"": 500, ""err_msg"": ""An error occurred while processing XDR public API"", ""err_extra"": ""query param is missing""}}Thats my query : { ""request_data"": { ""query_id"": ""0427e489ea6b42_2749_inv"" } }Any help/directions !! Hi@Syed-Aqeel,I agree with@etugriceriin that your inquiry is missing critical information. At a minimum, we would need to know what API call URL you are attempting to use to understand the error being presented. Sharing that, or better yet, the entire API call code excluding sensitive information would be beneficial in understanding the error and providing you with the best guidance.",0,07-19-2021,02:24 PM
1067,420186,Syed-Aqeel,"HI im using curl.here's how I am trying it.$results= '{""request_data"": {""query_id"": ""'.$check.'""}}';$gR=curl_init();curl_setopt($gR, CURLOPT_URL, 'https://api-*****.xdr.sg.paloaltonetworks.com/public_api/v1/xql/start_xql_query/');curl_setopt($gR,CURLOPT_POST,true);curl_setopt($gR, CURLOPT_POSTFIELDS, $results);curl_setopt($gR, CURLOPT_HEADER, true);curl_setopt($gR, CURLOPT_HTTPHEADER, ['x-xdr-auth-id:2','Authorization:xyzyxyzxyxyzyxyzxyzroCJWBbmlsQwqTKGDJcxgttnRWSSTd','Content-Type: application/json']);where $check is the execution id from 'Start an xql query' result.",0,07-24-2021,04:39 PM
1068,420186,Syed-Aqeel,"Hi @gjenkins& @etugriceriJust figured out, I was passing the 'start an xql query' URL instead of 'get an xql query result' request..Replaced:curl_setopt($gR, CURLOPT_URL, 'https://api-*****.xdr.sg.paloaltonetworks.com/public_api/v1/xql/start_xql_query/');to the following and it partially workedcurl_setopt($gR, CURLOPT_URL, 'https://api-****.xdr.sg.paloaltonetworks.com/public_api/v1/xql/get_query_results/');but its partially fixed it because i'm getting a new https response, i-e 200HTTP/2 200 server: openresty/1.15.8.2 date: Sun, 25 Jul 2021 21:57:48 GMT content-type: application/json content-length: 643 vary: Accept-Encoding strict-transport-security: max-age=15724800; includeSubDomains set-cookie: XSRF-TOKEN=roCJxyzxyzxzyxyzxyzyxyz",0,07-24-2021,09:00 PM
1069,420186,tugriceri,"Hello Syed,Thats right. You need to use two URL to getting results. I think you are getting result now. Your response has""content-length: 643"". You have something from API. As you can see below my result as 172 byte. This is for empty result.Could you try manually query without using it in script?here is the sample.",0,07-26-2021,01:10 AM
1070,421276,moixsante,Hi @AsifSidHave those agent re-checkin again with the XDR console.,1,07-22-2021,04:24 AM
1071,421276,gjenkins,"Hi@AsifSid,I agree with@fmoixsantein that you will want to force the device to try checking in again. My recommendation is to use ""cytool reconnect force <distribution_id>"" to have your endpoints check back in after deletion on the tenant. The <distribution_id> can be collected from the agent installation page by exposing the ""id"" column. ",0,07-22-2021,09:09 AM
1072,421276,ShortNestling,"Hi All,I have accidently deleted endpoints in cortex console. Can you please advise how to get back those deleted.RegardAsif SiddiquiYour Blog is very nice. Wish to see much more like this. Thanks for sharing your information",0,07-23-2021,01:45 AM
1073,421276,moixsante,"cytool reconnect force <distribution_id> is not really necessary when you delete an endpoint, and the endpoint is enabled as the endpoint is also less than 180 old. Just a normal checkin should suffice, which also means that as long as those machines have network access, most likely reconnected to your tenant with 5-10 minutes automatically. If those agents do not appear and normal checkin that doesn't work, you could do as@gjenkinsrecommended.",0,07-24-2021,03:15 AM
1074,419267,moixsante,"Hi@david.hernandez,When adding Hash256 values to the Hash Allow List, either via Action Center's ""Add to allow list "", or directly from the Incident's Key Artifact, or from the Casualty View, it will be added to the Hash Allow List. This list is then shared among all the XDR agents during the checkin process. If you have added a hash to the Hash Allow list, no further alerting should be generated.Are you sure that you added the hash to the correct option? Which of the above-mentioned options did you use to add the hash to the allow list?",0,07-14-2021,05:12 AM
1075,419267,david.hernandez,"Hi@fmoixsante,I added it directly from the Incident's Key Artifact, which now has a grey tick button next to it.Thank you.",0,07-14-2021,10:18 PM
1076,419267,WSeldenIII,"Hi@david.hernandez The Allow List feature is to allow execution on the endpoint. In this scenario that you described, you should review the alert source (E.g. XDR BIOC, XDR agent...etc) to determine your next steps in the investigation. If XDR BIOC rule is the alert source, and your analysis indicates the process behavior is not a threat in your environment, then you may want to consider adding the process SHA256 to a Rule Exception (XDR App > Rules > Exceptions). Please note, there are two types of exceptions (Global / Profile) that you may leverage to manage the scope.",0,07-15-2021,08:31 AM
1077,419267,david.hernandez,"The scenario is as follows: I get an incident from a key artifact from the alert Source XDR Agent. A few days later, I get another incident with the same key artifcat, which I added to the allow list. Maybe this is not the expected behaviour? Maybe I should use what you suggest, to use the Rule Exception?",0,07-20-2021,07:31 AM
1078,419267,WSeldenIII,"There are two parts to consider in your scenario. The first is file execution (is the file being block / allow on the endpoint) and the second is the cause for alert. The allow/ block list is manage file execution. XDR has multiple layers of protection. I suggest to triage the full context of the alert to understand the cause for the alert. The XDR agent has additional Alert Names associated with the XDR agent alert source. For example, in a Behavioral Threat alert you may need analyze and confirm the initiating process and observed behaviors before making the determination of which process needs to be add to an allow list. In the case of BTP Allow list. The processes on the BTP allow list will not be terminated by the agent when are part of a malicious causality chain. Alerts will be triggered regardless. Reference the Behavioral Threat Protection module within the Malware endpoint security profile: If you want to exclude alerts for the process in question within the context of BTP, then you will need to create a support ticket in order to obtain a support exception. I hope this information provides you with a path forward.",1,07-20-2021,10:36 AM
1079,419267,david.hernandez,Thank you for your help. I will try to investigate from there.,0,07-22-2021,10:20 AM
1080,407847,gjenkins,"Wondering if any one might have insight of why and what the following means in the trapsd.log for a few systems that have yet to automaticly update themselves to 7.3.2 (Also find if in console, and set the agent to upgrade, its still reflecting 7.3.1)Saw the following in the trapsd.log when generating a support file.2021/05/19T11:57:41.002-07:00 <Error> xxxxxxxxxx [19832:6520 ] {common:LibTrapsCommon:591bda4f237e4e0b872fd035e106bcee(InstallUpdate):} Failed converting JSON='null' to protobuf message with 3: : Root element must be a message.2021/05/19T11:57:41.002-07:00 <Error> xxxxxxxxxx [19832:6520 ] {trapsd:AgentAction:591bda4f237e4e0b872fd035e106bcee(InstallUpdate):} Failed to convert json = [null] to proto, error=32021/05/19T11:57:41.002-07:00 <Error> xxxxxxxxxx [19832:6520 ] {trapsd:AgentAction:591bda4f237e4e0b872fd035e106bcee(InstallUpdate):} Error downloading content, error code 3Also seeing regular repeating instances of:""XDR Agent failed to upgrade from version 7.3.1.20981 to version 7.3.2.26319 on xxxxxxxx""In Agents Audit Logs for this and 4 other systems that are currently reflected as ""Connected"" in Status, but not yet upgraded themselves and have not since yesterday when 1000+ endpoints did.Hi@KRisselada,This appears to a bug in the upgrade process, which would require analysis of a tech support file by our Support team. Did you happen to route to them via the Customer Support Portal to get details as to why this was occurring?",0,06-30-2021,08:46 AM
1081,407847,KRisselada,"thanks@gjenkinswe moved beyond 7.3.x and didn't get a case raised. But will keep in mind, if see something like this next time",1,07-22-2021,06:43 AM
1082,421111,gjenkins,"Is there a discussion area where people can share queries they have built?Hi@NathanBradley,Thank you for the question.I recommend submitting your XQL queries here so that others within the XDR community can view your thread and comment appropriately.",0,07-21-2021,10:47 AM
1083,421038,gjenkins,"we have a customer which noticed the following?is it normal to have an endpoint with multiple instances of ""Cortex xDR local Analsys worker"" running in the task manager.is this normal behavior?Thank youStephane BoudreauHi@Stephane.B,Thank you for the inquiry.It is normal for there to be one instance of the Cortex XDR Local Analysis Worker process per CPU core or logical processor on the endpoint depending upon the operating system and version.",0,07-21-2021,08:16 AM
1084,421038,Stephane.B,"Hi Gjenkins, thanks for the info. Do you have a reference which states this?",0,07-21-2021,08:22 AM
1085,421038,gjenkins,"Hi@Stephane.B,That's a great question.In all my years working with the product, I can honestly say that this has never been published in the documentation nor have steps been provided to prove such using executables such as cytool. If further verification is needed, I would recommend opening a case with Support.",0,07-21-2021,09:23 AM
1086,398365,gjenkins,"Hello,We had an issue of some computers getting disconnected status in XDR. In Lansweeper the status of XDR was disabled. After a long discussion with local support we came out with a nice procedure that allows to reconnect those client without reinstallation.Assume we have a laptop lt00666 with a XDR client installed but disconnected from XDR console.Open a command line to swclt00666 using Sysinternaltools tool psexec64Psexec64.exe \\swclt00666 cmdMove to XDR client dircd c:\Program Files\Palo Alto Networks\TrapsGet XDR client infoc:\Program Files\Palo Alto Networks\Traps>cytool.exe enumProcess ID Agent Version1072 7.2.1.2718Go to your XDR console and display Agent InstallationsMake sure you have package ID enabled in default viewCopy ID for XDR version of the disconnected station - it will be long alphanumeric string (it is good to have it prepared for most common version you use so you do not have to look up at the console)Issue a command to reconnect device to our XDR server (this is one line)c:\Program Files\Palo Alto Networks\Traps>cytool reconnect force [omitted]There will be no prompt displayed and you have to enter (paste) uninstallation password. After you enter it and press enter the device will display:Enter supervisor password:c:\Program Files\Palo Alto Networks\Traps>The laptop should already be visible in console. Upgrade to latest version and it is finished.Procedure works very nice for us and I hope that it will save some time for the community also.Hi @Miroslaw_Iwanowski,Thank you for posting your clever reconnection solution using psexec!If I were to make a recommendation, I would omit the trailing tenant ID mentioned after the ""cytool reconnect force"" command as it is sensitive information unique to your XDR tenant.",2,07-20-2021,04:08 PM
1087,333228,gjenkins,"Hello all. We are using Global Protect with HIP rules turned on to enforce valid AV, etc. After an update to 7.1.1, HIP was seeing our virus definitions were dated 1/1/1970 for at least a few hours. Had to reboot before GlobalProtect would see current definitions. Didn't have this problem with prior versions of Cortex XDR. Additionally, the HIP rules saw 7.0.1 as Traps, but see the current version as Cortex XDR, which is interesting.Has anyone seen either of these things?Hi @ChrisDow1111,Thank you for contributing to the discussion board.It would seem that GlobalProtect had some troubles getting accurate data from the Cortex XDR executables and libraries. Is this issue persisting for you on later versions of Cortex XDR? If a Support case was open with GlobalProtect engineers, were they able to guide you through tuning HIP check rules for upgrade scenarios? Or were you advised to disable HIP checks while the upgrades were scheduled?",0,07-20-2021,04:01 PM
1088,409332,gjenkins,Thank you!,0,07-20-2021,03:41 PM
1089,343847,dfalcon,Hi@tech_noob-Can you please provide a little more context? Let's start with which Cortex XDR license type(s) are you running?https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/cortex-xdr-prevent-over...,0,08-17-2020,12:12 PM
1090,343847,tech_noob,I am using XDR prevent currently. My vendor made an error we are supposed to get pro and I am waiting for the upgrade in the next week or so.,0,08-17-2020,12:38 PM
1091,343847,NathanBradley,Im curious what was detected on the endpoint for symantec to identify it as malicious behavior and stop it?My understanding is that responder is listening for those multicast queries from your endpoint and responding when received.,0,09-17-2020,04:23 PM
1092,343847,tech_noob,"Yes, Symantec detected it and stopped it on the endpoint. We upgraded our Cortex to Pro and I will test again under Cortex Pro maybe it will detect it as BIOC on the endpoint. I will post the result.",1,09-17-2020,05:32 PM
1093,343847,mansad,Please comment when you have the results we have prevent and many of the web servers will not detect attacks at the network level with this protection,0,09-28-2020,10:34 AM
1094,343847,tech_noob,"We now use Cortex XDR pro. We recently had had a pen test internal audit, XDR detected port scanning etc. but it did not detect kali linux responder/nbns spoofing. Security auditor captured hashes but luckily they were not able to crack them. I tried Kali responder running on a VM, I rebooted my endpoint with XDR pro on the same LAN, and I was able to capture some hash with responder. From the XDR logs I am having a hard time finding IOC/BIOC I can use to detect and prevent responder...any thoughts on this? Our pen tester said that since the responder is passive it will be hard to detect. - thanks",0,07-17-2021,06:43 AM
1095,343847,tech_noob,"We now use XDR Pro. We recently had an internal pen test, XDR detected port scanning, etc., but it did not detect and prevent nbns spoofing with Kali responder, some hash was captured but luckily they were not able to crack them. I ran responder on the same lan where I have a windows 10 with XDR pro. I rebooted Windows 10 and I was able to capture hashes with Kali responder.I looked a the XDR logs but I am having a hard time finding IOC/BIOC for detecting responder..any thoughts on this? Thanks.",0,07-17-2021,07:19 AM
1096,343847,tugriceri,"Hello Tech_noobCould you create a BIOC rule like below.REMOTE_PORT = 5355PROTOCOL=UDPNetwork = Incoming, outgoing5355 is LLMNR port number and as you know that, if clients cannot find/resolve a remote host in DNS, starting to LLMNR query via multicast.So, with this BIOC rule, You can detect LLMNR queried hosts and would be helpful to understand which process is responsible for the LLMNR.with XDR you can control Windows Host firewall and block that UDP packages but from the security perspective (host hardening), Im gonna advise to use GPO for disabling LLMNR and Netbios name resolution.",1,07-19-2021,05:51 AM
1097,413260,zsolomon,"HI Carracido,The answer will be two parts since i am not sure which one you meant:1. In XDR Pro you can use XQL to build queries,My advice will be to either use a specific name if there is one or search for files from a specific extension.2. Since XDR does not look into files, there is no way to know if the file is password protected.I hope this helps.",1,06-16-2021,03:50 AM
1098,413260,teJacobCF,"simply searching for the word ""password"" in the file name has really worked well for us and it is also what most of our pentest engagements use.",0,06-23-2021,06:38 AM
1099,413260,moixsante,"@PeteJacobCF, if the word passwordis not in the name, XDR/XQL will not be able to tell you that a file is not password protected.",0,06-23-2021,09:55 AM
1100,413260,teJacobCF,"yes exactly. I was simply saying that we have had some good success finding our users ""password"" files... meaning txt or .doc files users use to store passwords and usernames in. I was not saying this would find password protected files...",0,06-24-2021,09:30 AM
1101,413260,tech_noob,"This one will find password on command line argument, you will be surprised if you find a clear text password on this querydataset = xdr_data| filter actor_process_command_line = ""*pass*""",0,07-18-2021,08:50 PM
1102,416610,kcross,"Hi Remo! If it helps, take a look at our blog post on PrintNightmare for suggested XQL queries:https://www.paloaltonetworks.com/blog/security-operations/hunting-printnightmare/",1,07-01-2021,12:27 PM
1103,416610,vsys_remo,"Hi @kcrossThanks for sharing that link. This definately helps already.Even if there are already some queries shared by Paloalto, I am still interested if my initial query is possible with this combination.",0,07-01-2021,02:35 PM
1104,416610,yalonso,"Hi CommunityI need some help in creating an XQL query for a BIOC which detects exploitation attempts for CVE-2021-1675 (printnightmare). So far I have the following two queries:1. A query that detects incoming connections on port 4452. a query to view driverinstallations done by the print spooler serviceNow I'd like to combine them somehow in order so get an alert for incoming connections over SMB which result in a driverinstallation done by the print spooler service. Has anyone done something similar or is able to help me with this XQL query?Thanks in advance,RemoHello Remo,You can combine both queries with an union statement. Here is an example union statement;XQL Helper Screenshot:Also, I've taken the liberty of combining your queries using the union statementdataset = xdr_data| filter event_type = NETWORK and event_sub_type = NETWORK_STREAM_ACCEPT and (action_local_port = 139 or action_local_port = 445)| fields event_type, agent_hostname as Hostname, action_local_ip as Local_IP, action_remote_ip as Remote_IP, action_external_hostname as Remote_Host, action_local_port as Local_Port, actor_process_image_name as Process_Getting_Connection| union (dataset = xdr_data| filter causality_actor_process_image_path = ""C:\Windows\System32\spoolsv.exe"" and actor_process_image_path = ""C:\Windows\System32\drvinst.exe""| fields agent_hostname as host_name, causality_actor_process_image_name as CGO_Name, causality_actor_process_image_path as CGO_Path, causality_actor_process_command_line as CGO_CMD, causality_actor_primary_username as Username, actor_process_image_path as child_path, actor_process_command_line as child_cmd, actor_process_os_pid as child_pid, actor_process_image_sha256 as child_sha256, actor_process_execution_time as start_date, event_id)",1,07-02-2021,11:43 AM
1105,416610,vsys_remo,Hi @yalonsoThank you for your reply. I tried this command shortly but unfortunately this gives way too much results. Mainly because it simply shows all results from both queries in one resulttable. My goal still somehow is to search for driverinstallations by spoolsv.exe that are triggered from a remote host.,0,07-03-2021,05:54 AM
1106,416610,jcandelaria,"You may have to tweak your queries to combine by using ""join"". Here's a sample of join",0,07-16-2021,06:36 PM
1107,419420,moixsante,"Hi@EddieRowe,As far as I know, you would need to contact TAC support to get such a tool.",0,07-14-2021,02:35 PM
1108,419420,WSeldenIII,"Hi@EddieRowe,If you are to still able to connect to the endpoint, then you could retrieve support file in order to troubleshoot the upgrade issue with technical support. Technical support will also be to provide the agent cleaner.",0,07-14-2021,02:39 PM
1109,419420,EddieRowe,"Thanks for the responses. No, the system is alive and well, but Cortex is not. I have logged a ticket with support after I generated a log from the file uninstall attempt with MSIExec.",0,07-15-2021,07:45 AM
1110,418624,Burns,"It looks like we have ENCRYPTION STATUS in the Endpoints data set, but not VOLUME STATUS. At this point, we are not enforcing encryption by the policy. See below for a sample query provided by Palo Support:config case_sensitive = false |dataset = endpoints| filter encryption_status = NOT_CONFIGURED or encryption_status = NOT_COMPLIANT |fields endpoint_name",0,07-13-2021,09:44 AM
1111,418624,tugriceri,"Hello PBurns,Thank you very much for the XQL query about status. for the BIOC question, you may write BIOC to checking specific registry path. Below is just one sample not tested but might help you to write a query for proper path.HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\OSEncryptionType0 =Allow user to choose (default)1 =Full encryption2 =Used Space Only encryptionorHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\BitLockerValue: PreventDeviceEncryption equal to True (1).",1,07-14-2021,02:49 AM
1112,418173,zsolomon,"Our customer is requesting to see if the Cortex XDR protects against theGootLoader vulnerability. Anyone have any idea?Hi Stephane,Assuming you meant ""Boot loader"" since i am not familiar with ""GootLoader"".XDR agent will not be able to mitigate CVE-2020-10713 since it does not have Boot time protection.When thinking about it, Attacker can always replace the Boot loader with a vulnerable one so even replacing will not really be a solution.Hope that this answers your question.Best,Ziv.",0,07-11-2021,08:34 AM
1113,418117,zsolomon,"Below announcement applicable to cortex XDR/EDR ?Hi Deepak25,The announcement you shared with us is related to the CDL (Cortex Data Lake), your EDR logs from XDR endpoints are safe and stored.You should pay attention to the announcement ""Action Items"" and follow the instruction if it's applicable to you.Hope that answers your question and concern,Best,Ziv.",0,07-11-2021,04:10 AM
1114,329102,yalonso,"HiMy experimental machine was hit by BSOD by CVE-2019-0708 even though cortex agent is installedDoes anyone have such a situation?Good day,Can you detail which PoC you used forCVE-2019-0708?f.e EkulTek Bluekeep PoC",0,07-09-2021,08:46 AM
1115,389129,gjenkins,Thank you for the notice.,0,07-08-2021,08:42 AM
1116,324424,nhussaini,Thank you!,0,07-07-2021,07:44 AM
1117,198330,nhussaini,Thank you!,0,07-07-2021,07:44 AM
1118,198328,nhussaini,Thank you!,0,07-07-2021,07:43 AM
1119,331270,nhussaini,Thank you!,0,07-07-2021,07:42 AM
1120,343943,nhussaini,Thank you for posting!,0,07-07-2021,07:41 AM
1121,389943,nhussaini,Thanks!,0,07-07-2021,07:36 AM
1122,396590,nhussaini,"This is great, thank you!",0,07-07-2021,07:35 AM
1123,409372,nhussaini,"Very informative, thank you!",0,07-07-2021,07:32 AM
1124,417303,malalade,"The size of the email depends on how many alerts get grouped together, and the volume of alerts notification, which is directly related to the notification filter you set.",1,07-06-2021,02:02 PM
1125,415671,moixsante,"Hi@COGTeam,Welcome to the wonderful world of Cortex XDR.The XDR tenant already has default profiles assigned to a policy rule per platform. I would suggest reading the admin guide on how to configure your own profiles and assign them to endpoints. Please refer to this article about profilesand this other article on how to apply them.I would also recommend reading about Endpoint Groups. ",1,06-28-2021,12:25 PM
1126,415671,yalonso,"Hello@COGTeamYou can find more information about the agent settings profile in the URL below (Step 7):https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/custo...Additionally, agent settings profiles can be found under Endpoints > Policy Management > Prevention Profiles.",1,06-28-2021,02:47 PM
1127,415671,yalonso,"Hello Everyone.I just want to know where to get to the agent profile. Is that a portal? or an app? Possibly I need to contact someone?Sorry I am new on this cortex XDR app but I do really appreciate your responses.Just to provide more context. We have already installed Cortex XDR (XDR_Win_740_x64.exe) on some machines to test and now we want to uninstall it but cytool is asking for Supervisor password. We are completely lost a this point.Hi@COGTeam,Just wanted to check in, I noticed the answer got liked but not marked as a solution. I am attaching a gif detailing the steps from login into the Cortex XDR tenant console to management of the agent settings profile and how to apply it using prevention policy rules. Please let us know if you are still having issues regarding policy management.",1,06-30-2021,04:21 PM
1128,415671,COGTeam,Thank you@yalonso! That really clarifies the process. Have a nice day!.,0,07-01-2021,06:02 AM
1129,408265,gjenkins,"Hi,using Cortex since a few months, what bothers me is the Notification grouping is only done by time. That means when mutiple alerts are incoming from different client its all grouped in one huge mail which is pretty hard to grasp.I would like to make a feature request to add grouping by client. So that when mutiple alerts come in from a specific client it is grouped in one mail when it happens in the specific grouping timeframe configured. But when another client generates one or multiple alert in this time then a spererate mail is generated.What do you think about this?Is this the correct way to make a feature request?Best regards,HaraldHi @kroihara,This is indeed a feature request. Your Sales Account Team will be able to log this on your behalf and provide you with a tracking ticket. I recommend reaching out to them to submit at your earliest convenience.",0,06-30-2021,08:24 AM
1130,415332,jcandelaria,"Hi Rodrigoduarte,Are you saying that you cant create this filter? then select the syslog server you set-up?",1,06-26-2021,08:34 PM
1131,415332,drigoduarte,"Could you give me a basic procedure to apply this filter via Syslog? I'm not the tool administrator, I work with SIEM.The Cortex administrator said that it was not possible to forward the Miter ID field and I am 80% sure it is possible.",0,06-27-2021,11:59 AM
1132,415332,tugriceri,"HiRodrigoduarte,Its not possible to configure XDR syslog forwarding fields. Scope of Alerts, syslog server and log type (Alerts, Agent Audit logs, Management Audit logs) are just configurable.Below URL is about to XDR log formatsthat the Cortex Data Lake app can forward logs to external syslog server or email.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/logs/cortex-xdr-log-not...",1,06-28-2021,07:02 AM
1133,415332,drigoduarte,"In short, via Syslog then it will not be possible to obtain Miter ID information?",0,06-28-2021,07:08 AM
1134,415332,tugriceri,"thats correct. There is no field which is related with MITRE in syslog payload but still you can get that information via Email alert or via API.related fields in email =mitre_tactic_ids,mitre_technique_ids,mitre_tactic_id_and_namefor the API =mitre_tactics_ids_and_names, mitre_techniques_ids_and_namesfor the api details, you can check below.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-api/cortex-xdr-apis/incident-manageme...",0,06-28-2021,08:20 AM
1135,415332,jcandelaria,"Hi RodrigoduarteYes, if you are looking for the mitre id inside the syslog alert itself, its not included as specified by link posted by EtugriceriFeature request can be requested on this.",0,06-28-2021,02:25 PM
1136,414384,jcandelaria,"The answer is yes, they can co-exist but as general reminder, anytime there are 2 AVs, there will always be a spike in resources.From deployment overview, you can put the XDR in report while defender in blocking then do tuning and once you are ready, you can put the xdr in blocking which will be registered as your primary AV in security center and defender will be disabled but you can always configure schedule scan on defender and make sure you dont do it the same time as xdr.. As always, you can contact your account team if you want Professional services to help you on your initial deployment.",2,06-21-2021,06:35 PM
1137,414384,vsys_remo,"Hi @PraveenTYes, it is possible to have both AV software active and running on these computers. As written by @jcandelaria(with default settings) defender will be disabled as soon as cortex is configured in block mode. But if you diable the microsoft security center integration for cortex, then both softwares are actively protecting the workstations. If this is always a good, is difficult question to answer. It definately requires more ressources and there might be compatibility issues. But at least in theory this should working fine.",0,06-26-2021,04:21 AM
1138,414695,sramesh-7,"If Cortex XDR is setup on the endpoint and the process or file that performs such a scan is identified as a malicious behaviour or has a malicious file attached to it, it should flag an alert from XDR agent. However based on my understanding Data lake will be required for this.",0,06-23-2021,05:25 AM
1139,414695,tugriceri,"Dear Ruslanal,You can also add IOC for specific domain and XDR would be altered each time when your workstation reached that web server.",1,06-23-2021,06:01 AM
1140,414695,jcandelaria,"Hi Ruslanal,Do you have any information on the alert what is the suspicious communication all about? Something to start with in terms of investigating? If you have Pro license, there is analytics and analytics bioc incidents/alerts that you can check. But if you have specific information to start with, you can use query builder/xql to start your investigation/threat hunting",0,06-23-2021,09:49 AM
1141,414695,vsys_remo,"Hi @ruslanalDid I understand correctly and you don't have cortex installed on the workstation, only on the webserver? If not and you have cortex on the workstation, then as mentionned by @jcandelariayou can start searching in the logs for thw connections to your proxy at that time (requires xdr pro)",0,06-26-2021,03:26 AM
1142,414137,gjenkins,"Hi All,I have been notified that few of the users are receiving errors (attached) related to Cortex.I need to investigate this but not sure where to start and what to look for, Can anyone guide me here.RegardsAsif SiddiquiHi@AsifSid,There are no errors attached. As for troubleshooting, have you tried the troubleshooting sections in the admin guide for the particular operating system and version of Cortex XDR agent that is in use? Errors encountered during install and operation are often logged to the log files listed there.Here's the link to the 7.4 admin guide. Please let me know if links for previous versions are needed.",0,06-18-2021,01:25 PM
1143,411203,zsolomon,"Hi,I am having this problem in a host managed by Cortex XDR , whenever I execute iexplorer.exe or outlook an xdr agent alarm is triggered indicating that it's a Memory Corruption Exploit. Except creating an Exploit profile and excluding this kind of alarm , is there any other solution , has anyone the same problem?Process blocked: C:\Program Files (x86)\Internet Explorer\IEXPLORE.EXE"" SCODEF:6220 CREDAT:18363609 /prefetch:2Hi,Sounds like what you need to do is retrieve and analyze,If this doesn't work, solution will be todownload the retrieve data and submit foranalysis of the issue by the Support team.They can be reached athttps://support.paloaltonetworks.com/.I hope this helps,",0,06-16-2021,04:09 AM
1144,412403,OrkanAlibayli,Hello Adamski.You can use proxy communication for Cortex XDR agents to connecting Cortex XDR app. For that you must install Cortex Broker VM (about Broker VM). After installation enable Agent proxy settings.,1,06-12-2021,11:04 AM
1145,412403,A_Adamski,"Hello Orkan,Thank you for your input, but since the goal is offline operation, a proxy solution does not meet the customer requirements for this scenario.I assume I will need to ask Palo Alto Support to advise on that matter further.I wish you a great day!Cheers,",0,06-15-2021,05:33 AM
1146,412403,A_Adamski,"Dear all,In case if anyone will need this info in the future:We've checked this with the Palo Alto Support and it turned out that, The XDR does not support the fully offline environment.The XDR requires network communication for the agent management purpose:Cortex XDR for windows - requirementsThe Agent installation option for the Content Update package is to reduce the network bandwidth for the initial Agent installation. But the agent must be able to connect to the XDR Cloud for the registration, license allocation, Policy Rule's acquirement and etc. Therefore, the XDR does not support the fully closed network environment.But we still have some options, and might try reaching out to our SE and ask for deployment optionsor Palo Alto's account team to submit a New Feature Request (NFR).Hope this info helps those who seek an answer to the same question 😉Have a great one!",2,06-16-2021,03:03 AM
1147,412847,gjenkins,"Hi Team,We have been notified thatCortex is taking up a lot of memory on Desktops and servers, is there any performance tweaks you can make? Cortex XDR also impacting opening of files on the shares,I need to understand what all things we can check if cortex is impacting the performance of the system where it is running?RegardsAsif SiddiquiHi@AsifSid,You can disable capabilities to retrieve some resources on the system such as LiveTerminal, File Retrieval, and Script Execution. Disabling is as simple as right-clicking your endpoint, going to ""Disable Capabilities,"" and selecting the features to disable. See the following gif to learn how it is done.Any further memory-specific performance configurations that can be made on the Cortex XDR agent would occur after analysis of the issue by the Support team. They can be reached at https://support.paloaltonetworks.com/.",0,06-14-2021,11:01 AM
1148,412871,gjenkins,"Hi, I have configured gp with saml autentication; my azure ad connector is configured for hash pass synchronization.I noticed that gp always authenticates me regardless of whether the password has expired or not.there is no way to force me to change the password from the 365 screen? do i need to configure pass through autentication?Thank youHi@EleanorWyatt,I would recommend submitting your question to the GlobalProtect Discussions page.",0,06-14-2021,08:29 AM
1149,412512,gjenkins,"Dear guru,Currently testing the flexibility of the Device Control Feature under XDR.Aim:Block all the mobile phone connecting to Endpoint except some VIPs.Gone thru the Admin manual, added a Device Config policy to block all Windows Portable Devices, apply a the Device Exception for the VIPs may be the way to do so.However, when configuring the exceptions, after select the Type and Vendor, it could not locate the right product ID/code from the pull-down menu.Is it possible1) Add the Product ID/Code manually?2) Except the devices by the full Device ID?Please find the screen cap for further explanation.Any one has the same issue?Million thanks,Sean Hi@SeanDeHarris,As for question one, you must submit your product code as hex. Simply present the value in the hex format like so: 0x000. Here's an example as well: As for creating an exception for a device by ID, that is not available at this time. To create an exception the following parameters used at this time:I hope this helps!",0,06-11-2021,08:40 AM
1150,412288,WSeldenIII,"Hi Asif,In terms ofManage Cortex XDR Agents, you have manual and automatic configuration options to support your agent cleanup task. If you have an endpoint that you no longer want to track through the Cortex XDR management console, for example if the endpoint disconnected from the Cortex XDR management console, or an endpoint where the Cortex XDR agent was uninstalled, you can manuallyDelete Cortex XDR Agentsfrom the management console views.Cortex XDR also automatically deletes agents after a long period of inactivity. The period of inactivity on standard agents can be modified within theGlobal Agent Configurations- Step 6. By default standard agents are deleted after 180 days of inactivity. Virtual Desktop Infrastructure (VDI) and Temporary Sessions (TS) agents are deleted after 6 hours of inactivity.",1,06-11-2021,07:33 AM
1151,410125,moixsante,"Hi@r_buchwalder,You can use the option ""add to Allow/Block list"". You can add up to 100 hashes. But you need to add the hashes one by one to the action task.If you want to add them in a more automated way, you could use Cortex XDR API to accomplish this.Add to Allow List - APIAdd to Block List - API",0,05-31-2021,02:42 AM
1152,410125,akshayhariRajan,I have the same problem..I need to query for multiple sha256 at one go,0,06-07-2021,04:53 AM
1153,410867,vsys_remo,"Hi @CHKlompYes, this setting is available in the agent settings profile.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/custo... --> Step 13With this setting you can choose between auto update for any version or only for minor versions of the current major release. Additionally you can configurw a minimum version to which older agents will be updated. ",1,06-05-2021,07:48 AM
1154,411201,vsys_remo,Hi @amaan_mohiuddinThe reason why you cannot find a setting like this is because such a feature is not available. You could ask your SE to create a feature request for this.,1,06-05-2021,06:41 AM
1155,410227,gjenkins,"HiI am using a MAC with BigSur version 11.4 andCortex XDR for Mac version 7.4.0Suddenly I am no loger able to debug in Xcode, since the debug server i killed by Cortex.Also when I debug from VSCode in C# I get a notification, but debugging does take place.So basically my Mac is so safe that it is unusable. How can I get solve this?Error message:Dylib-hijacking attempt detectedDetailsPrevention ID: fe1bb230-9eaf-4590-ab0b-507053bc0b8aMachine name: Taken awayOS Name: macOSOS Version: OS X 11.4.0Cortex XDR version: 7.4.0.2226Dump path: N/AContent Version: 182-59165Mode: TerminateModule name: Dylib-Hijacking ProtectionDate: 31/05/2021, 23.57.34Verdict: Not AvailableSource Process ID: 2397Source Process Command-Line: N/ASource User Name: larschristoffersenHi@larsoleruben,I understand that the Dylib Hijacking Protection module is preventing you from executing sanctioned software. Have you had the opportunity to create exceptions for the process in the restrictions profile for your endpoint? It would look similar to the following images. If so, what were your results?",1,06-01-2021,09:27 AM
1156,410227,arsoleruben,"Hi, thanks for your reply. Actually Our support figured it out and did exactly that I suppose:<snip>Below has been added into allowed HASH list (as it were previously blocked by XDR/usr/local/share/dotnet/iTerm/usr/local/share/dotnet/dotnet/Library/Developer/PrivateFrameworks/CoreSimulator.framework/Versions/A/Resources/Platforms/iphoneos/usr/libexec/CoreSimulatorBridge</snip>",0,06-01-2021,09:42 AM
1157,410227,gjenkins,"HiI am using a MAC with BigSur version 11.4 andCortex XDR for Mac version 7.4.0Suddenly I am no loger able to debug in Xcode, since the debug server i killed by Cortex.Also when I debug from VSCode in C# I get a notification, but debugging does take place.So basically my Mac is so safe that it is unusable. How can I get solve this?Error message:Dylib-hijacking attempt detectedDetailsPrevention ID: fe1bb230-9eaf-4590-ab0b-507053bc0b8aMachine name: Taken awayOS Name: macOSOS Version: OS X 11.4.0Cortex XDR version: 7.4.0.2226Dump path: N/AContent Version: 182-59165Mode: TerminateModule name: Dylib-Hijacking ProtectionDate: 31/05/2021, 23.57.34Verdict: Not AvailableSource Process ID: 2397Source Process Command-Line: N/ASource User Name: larschristoffersenHi@larsoleruben,Those images are of an Exceptions Security Profile - you can create a security profile using the instructions found here.Alternatively, you can add the exceptions globally by following these instructions.To see a video regarding exception creation and management, please see this video and skip to 2:42 for an in-depth walkthrough.",3,06-01-2021,10:08 AM
1158,409346,moixsante,"Hi@Joe_Botelho,The scan will start at the endpoint's local time.",1,05-31-2021,02:46 AM
1159,409474,vsys_remo,"Hi @akshayhariRajanNo, file hashes that you use to create IOC rules are not automatically blocked.To block file hashes you need to use the block lists:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...",0,05-30-2021,03:24 PM
1160,409474,moixsante,@akshayhariRajanYou could create a BIOC for that file specifying a behavior and add that BIOC to a Restriction profile.,0,05-31-2021,02:44 AM
1161,408522,gjenkins,"Hi All,We have a new requirement where we need to integrate Cortex xdr with IBM Qradar and for this integration I have a IBM guide where it ask to download and install cortex xdr app, which we did, however from Cortex side (in Console) there are few steps which we need to follow like creating a syslog server etc,If anyone has performed this integration already or understand it more better, then please elaborate in simple language so It would be more easy for me explain it further to the relevant team.RegardsAsif SiddiquiHi @AsifSid,I understand that you want to forward logs from Cortex XDR to your IBM Qradar system. I would recommend the following instructions to set up a Syslog integration within Cortex XDR to forward to the Syslog receiver on your IBM Qradar. Please see this link to integrate a Syslog receiver and let me know what you think.",0,05-24-2021,08:22 AM
1162,407848,dfalcon,"Hi@CyberEye-Are you trying to bring in organizational data to use for management purposes -- or are you trying to bring in ""event/log"" data?",0,05-23-2021,11:40 AM
1163,407848,vsys_remo,Hi @CyberEyeSo far it is not possible to use azure AD as source of the accounts which are used to log in to the xdr console. The integration which is possible between cortex and azure AD is that cortex fetches logs from azure AD which are then used for the analytics part and BIOCs.,0,05-23-2021,03:51 PM
1164,408527,dfalcon,"First, what type of license to you own? Prevent, Pro for Endpoint, and/or Pro per TB?Second, when you look at the number of agents in endpoint administration interface, what is the count? There is also an agent dashboard that can be helpful here.",0,05-23-2021,11:38 AM
1165,408526,dfalcon,"The actual account must be created in the CSP. Go to support.paloaltonetworks.com and within the Users menu on the left, create the user there. A limited account is all that is needed. Once created in the CSP, you can go to the Hub and assign the appropriate role there.",1,05-23-2021,11:34 AM
1166,408126,RamesC,"I should add the reason I ask it because the code below seems to be exiting with a result code of ""1"" indicating an error, and Cortex does not get installed. Note: I removed the space from the package name to simplify the script.installer -pkg ""CortexXDR.pkg"" -target / ",0,05-20-2021,09:10 AM
1167,408126,RamesC,Got is sorted out. The code above does work. The issue was our current path was not correct.,0,05-20-2021,11:54 AM
1168,407623,gjenkins,"Hi Everyone,We are a new customer for Cortex XDR and the network filter seems to be killing our ability to share a connection to our Windows VM's from our macOS host while using our SonicWall VPN. If the VPN is disconnected connection works fine, when Cortex XDR is uninstalled it also works fine, as soon as Cortex is installed the shared connection dies. Any ideas?Hi @KTaig,Welcome to the community!Can you successfully establish a connection from the MacOS host to the VPN gateway in terms of the VPN? If so, are you seeing the route to the Windows VM subnet installed by the SonicWall VPN in the MacOS routing table? If those are working appropriately, meaning you have a successful VPN connection and a VPN route to your Windows VM, my recommendation would be to try disabling the Host Firewall Management on the Cortex XDR Agent for your MacOS device. Disabling the Host Firewall Management can be done in Endpoints > Policy Management > Extensions, Profiles > Editing your target MacOS Firewall profile and disabling the Host Firewall Management section. Once complete, are you able to connect to the Windows VM?If that didn't help, might you be receiving alerts on your alerts table regarding the VPN or supporting processes?",0,05-18-2021,12:28 PM
1169,407623,KTaig,"Hi Everyone,We are a new customer for Cortex XDR and the network filter seems to be killing our ability to share a connection to our Windows VM's from our macOS host while using our SonicWall VPN. If the VPN is disconnected connection works fine, when Cortex XDR is uninstalled it also works fine, as soon as Cortex is installed the shared connection dies. Any ideas?Hi @KTaig,Welcome to the community!Can you successfully establish a connection from the MacOS host to the VPN gateway in terms of the VPN? If so, are you seeing the route to the Windows VM subnet installed by the SonicWall VPN in the MacOS routing table? If those are working appropriately, meaning you have a successful VPN connection and a VPN route to your Windows VM, my recommendation would be to try disabling the Host Firewall Management on the Cortex XDR Agent for your MacOS device. Disabling the Host Firewall Management can be done in Endpoints > Policy Management > Extensions, Profiles > Editing your target MacOS Firewall profile and disabling the Host Firewall Management section. Once complete, are you able to connect to the Windows VM?If that didn't help, might you be receiving alerts on your alerts table regarding the VPN or supporting processes?Hi thanks for the response.I will answer each of those:Can you successfully establish a connection from the MacOS host to the VPN gateway in terms of the VPN?The macOS host connects to the VPN and can access things on it's end just fine.If so, are you seeing the route to the Windows VM subnet installed by the SonicWall VPN in the MacOS routing table?This im not seeing. When the VPN is on the Windows VM immediately loses network connectivity and if you run the network troubleshooter you get it's not getting a valid IP. Turn off the VPN, the VM can connect to the network again and can even run a VPN in the VM fine, but the network doesn't talk back to the macOS.If that didn't help, might you be receiving alerts on your alerts table regarding the VPN or supporting processes?No alerts or anything are being generated by Cortex, which is odd.I will copy the profile and turn off firewall management applying it only to this machine and see if it helps.Thank you",0,05-18-2021,01:31 PM
1170,407623,KTaig,Actually looks like we don't even have it enabled,0,05-18-2021,01:35 PM
1171,407623,gjenkins,"Hi Everyone,We are a new customer for Cortex XDR and the network filter seems to be killing our ability to share a connection to our Windows VM's from our macOS host while using our SonicWall VPN. If the VPN is disconnected connection works fine, when Cortex XDR is uninstalled it also works fine, as soon as Cortex is installed the shared connection dies. Any ideas?Hi @KTaig,Welcome to the community!Can you successfully establish a connection from the MacOS host to the VPN gateway in terms of the VPN? If so, are you seeing the route to the Windows VM subnet installed by the SonicWall VPN in the MacOS routing table? If those are working appropriately, meaning you have a successful VPN connection and a VPN route to your Windows VM, my recommendation would be to try disabling the Host Firewall Management on the Cortex XDR Agent for your MacOS device. Disabling the Host Firewall Management can be done in Endpoints > Policy Management > Extensions, Profiles > Editing your target MacOS Firewall profile and disabling the Host Firewall Management section. Once complete, are you able to connect to the Windows VM?If that didn't help, might you be receiving alerts on your alerts table regarding the VPN or supporting processes?Hi thanks for the response.I will answer each of those:Can you successfully establish a connection from the MacOS host to the VPN gateway in terms of the VPN?The macOS host connects to the VPN and can access things on it's end just fine.If so, are you seeing the route to the Windows VM subnet installed by the SonicWall VPN in the MacOS routing table?This im not seeing. When the VPN is on the Windows VM immediately loses network connectivity and if you run the network troubleshooter you get it's not getting a valid IP. Turn off the VPN, the VM can connect to the network again and can even run a VPN in the VM fine, but the network doesn't talk back to the macOS.If that didn't help, might you be receiving alerts on your alerts table regarding the VPN or supporting processes?No alerts or anything are being generated by Cortex, which is odd.I will copy the profile and turn off firewall management applying it only to this machine and see if it helps.Thank youHi@KTaig,Thank you for answering those questions! Is it possible for you to grab a screenshot of the routing table (in the command line, enter ""route print"") before and after connecting to the VPN, and also providing the IP addresses of the source and destination devices? Could you also provide a traceroute to the MacOS endpoint?What I'm leaning towards is that if the Cortex XDR agent prevents a route from being installed, we may be able to see it in the comparison of the two route tables. So let's see if the route is being installed, and the firewall management is disabled, and take it from there.",0,05-18-2021,02:26 PM
1172,407623,KTaig,"Hey,I didn't have time to get to this today but 1 thing I see that would be an issue getting this information is the routes with the VPN on. The VPN is on the macOS not the Windows VM, as soon as it turns on the network on the VM dies. I don't think it will see any routes because its no longer getting an internet connection at all.",0,05-19-2021,01:48 PM
1173,407623,gjenkins,"Hey,I didn't have time to get to this today but 1 thing I see that would be an issue getting this information is the routes with the VPN on. The VPN is on the macOS not the Windows VM, as soon as it turns on the network on the VM dies. I don't think it will see any routes because its no longer getting an internet connection at all.Hi@KTaig,If we don't have visibility into the device due to the Internet connection being lost, and there doesn't appear to be anything wrong with your Cortex XDR agent configuration, then I think that the next best step would be to open a ticket with Support. They will request the Support logs and be able to attempt an offline analysis given the logs that you've provided. Please open a case with them here and upload those logs whenever possible.",0,05-20-2021,10:54 AM
1174,408095,KRisselada,"I believe its mostly announcing the release of Cortex platform v2.9 (along with Agent v7.4) releases. Got this yesterday.I sorta understood that one.But then this morning....I seem to have gotten a ""marketing blast"" with the subject of ""Welcome to Cortex XDR!""But got three of them so far (0239, 0455, 0515 pacific) I assume they were for different Cortex Tenants I have an account on, but didn't include that in the content. Decent/ good links in the content....but seems odd to say ""welcome"" when any Cortex accounts I am associated with have been for 6 months or more, some a couple years.I would say its most of the time better to have too much than not enough communication, but my gut tells me just different teams processes related to notification blasts out to customers?",0,05-20-2021,08:01 AM
1175,361541,KanwarSingh01,"Hi There,We would recommend you to open up a support case with palo alto where you will have to submit the alert data for them to investigate.The rule which you have mentioned alone does not signify much as this is a friendly name to one of the rule set in EDR.",0,11-23-2020,05:03 PM
1176,361541,EricAghasian,"I have already opened the case with them and they confirmed my case as a FP but the issue is that there is no explanation about it. As long as there is no explanation, it cannot be decide whether the alert is a FP or a real threat.",0,11-23-2020,05:09 PM
1177,361541,KanwarSingh01,"Did you have an alert around the same time on the same endpoint? If yes, can you post the details on that alert?",0,11-23-2020,05:33 PM
1178,361541,KRisselada,"@KanwarSingh01my apologies if I missed it, but is there a central location or notification of what the list of BTP rules looks like? What is their contents? When were they applied, etc? Perhaps I am totally missing it, but I don't know where to find that. Weather its for this particular one or ANY BTP rule (Behavioral threat detected (rule: bioc.syscall.entrypoint_patching) ORBehavioral threat detected (rule: heuristic.agb.5637) ORBehavioral threat detected (rule: accessibility_feature_escalation), etcI mean the name has some clue to what its doing but is there insight as a Cortex XDR admin, you have of them and the BTP list looks like? What they do, when they were last changed or had updates to them?thank you",1,01-28-2021,02:24 PM
1179,361541,EricAghasian,"Hi KRisselada,You cannot find any list of BIOC rules per my knowledge and a follow up with Palo Engineers. These arepreconfigured rules from Palo Alto Networks with no intention to share (if they share, protection would go undermine).Regards",0,05-19-2021,06:18 PM
1180,377655,KRisselada,"To leverage 2FA for your Palo Alto user account, I find you can select the following if you wish to require all your Company Account users to require to use it:1. In Palo Alto CSP (Customer Support Portal, aka https://support.paloaltonetworks.com)2. Account Management > Account Details3. Select the Security Settings ""Enable 2 Factor Authentication""Or select this individually for users via Members > Manage Users",1,01-04-2021,08:53 AM
1181,377655,simoore,"Not a user at the moment, advising a potential user. Is access to Cortex XDR console through the CSP then?",0,01-05-2021,04:58 AM
1182,377655,KRisselada,"No, that access is via the Cortex XDR HUB (https://apps.paloaltonetworks.com)You apply the role access you would to a user via the Cortex Hub, but in order for a user to be visible to manage, they need their Palo Alto User Account, associated with a customer and that is in the Palo Alto CSP. At least that has been my experience.I would request others that have different experience to share here and correct as needed.",1,01-05-2021,06:13 AM
1183,377655,dfalcon,@KRisseladais correct.,0,01-05-2021,06:20 AM
1184,377655,CyberEye,"Dear Fols,Can we integrate the second factor auth us azure AD?",0,05-19-2021,12:23 AM
1185,407557,moixsante,"Hi@venkat_n7,Please refer to this article to understand how Cortex XDR does threat protection.",1,05-18-2021,08:46 AM
1186,407256,gjenkins,"Hi All,I have started facing an issue where whatever actions start via action centre, First it says ""Pending"" after that it turns to ""In progress"" status. and it stays there , It never shows status as ""Completed successfully""Just to test, I initiated the scan on my own system and for more than 1hour status is ""in progress"" (Usually the scan finishes in half an hour.Same with agent uninstallation task, Not sure what's causing this.Could anyone help here?RegardsAsif SiddiquiHi @AsifSid,The reason why a job could be stuck at ""In Progress"" could be for several reasons given the type of job performed. What do you see when you were to right-click the scan or uninstallation job and select ""Additional data?"" Is it possible to post a screenshot of that? Usually, some high-level information is available there, which could help understand why the job has not been completed. However, in other cases, I have found that the details just aren't there to make a sound determination and opened a case with Support to get assistance. I can say that the reliability of these jobs improves significantly on Cortex XDR agent version 7.2 and greater. So if your agent versions are lower than 7.2, upgrading may resolve a number of these ""In Progress"" issues.",0,05-17-2021,07:28 AM
1187,404444,Abdul_Razaq,"Hi Community,Anybody has any info on this cortexuser ? what privilege this user has and the folder owned by this user",0,05-06-2021,02:27 AM
1188,404444,Abdul_Razaq,"Hi Community,Got below informations on the cortexuser,-The user is automatically created with the new agents , earlier PA had a trapsanalyzerd1,trapsanalyzer2 etc. That has been updated with newer agent version to ‘cortexuser’.It is used to run analyserd and lted services on the XDR agent. This user has the rights to perform necessary action required on /opt/traps directory.",0,05-16-2021,03:40 AM
1189,405048,cohen,"Hi@YAlhazmiMy name is Or from the XDR product management team.It's actually available in the UI too with a lot more data.Click on the alert icon on top of the process and scroll down.The text you saw is a join of all the 'behavior description', and you also have two more useful things - MITRE tags and the actual description per behavior we saw (hover over the description field, text is a bit log there).If you have any additional questions please feel free to ping me ocohen@paloaltonetworks.comOr.",3,05-11-2021,03:15 AM
1190,405048,KRisselada,"Thanks@ocohen are there times where perhaps the section you show where MITRE items would not show for a BTP?On a Behavioral Threat I am seeing recently (Behavioral threat detected (rule: heuristic.agb.5637)) I am not seeing the ""MITRE Attack"" section of the blackbar your reflecting here. Only the first two rows. Am I just not clicking the right area perhaps?Running on Cortex XDR V2.8",0,05-11-2021,08:53 AM
1191,405048,cohen,"while not all BTP alerts have mitre tags (yet), you can check by clicking on this button on the right side",0,05-11-2021,02:26 PM
1192,403045,gjenkins,"Hi,we are about to activate Cortex XDR agent with Default Policy Rules (i.e. Default Exploit, Malware, Restrictions, Agent settings and Exceptions profiles) on some Windows servers which contain a huge amount of data (terabytes).Are there some recommended best practices to follow or some functionalities that should be disabled in order to avoid any kind of impact on these kind of servers in terms of performances?For example, we were told that ""File Search and Destroy"" feature could cause a huge overhead for some time after the agent has been activated.Furthermore, can anyone provide an estimate of how long a Cortex XDR malware scan on 1 TB of data might take?Thanks in advance.Hi @MCereda,As I understand it, you're planning to deploy the Cortex XDR to a Windows server that houses a considerable amount of data. There are some considerations to make:Note: Subsequent scans will be faster as the agent will not rescan unmodified files.As for the amount of time that a scan could take, this is variable depending upon the system resources available and the size of the file, so there's no way to provide an estimate at this time. Predicting an estimated amount to scan a target fully would be an excellent feature, which should be submitted as a feature request for future consideration.Finally, Search and Destroy performs a hash match in the cloud for all devices noted to have a file with that hash on the endpoint (Search). Then it sends a delete job to remove the target file from the filesystem on the target endpoint (Destroy). There's no major resource utilization expected on the endpoint during this process, as the endpoint will only be tasked with deleting the target file if it exists.",0,05-04-2021,11:55 AM
1193,403045,mabutbul,"Hey@MCeredaIf those are production servers I will suggest deploying the agents with a profile configured to 'Report' instead of Block, give it a week to collect alerts and activities from those servers, and monitor the triggered alerts on the hosts. in case you are seeing FP's perform the appropriate exclusions and once you feel comfortable with moving to 'Block' mode please do so.Thanks,",1,05-11-2021,02:57 AM
1194,401064,OrkanAlibayli,"Hello ,By default XDR don`t do anything malicious file ( if this file is not running). But you can quarantine this file ==> Endpoints/Policy Management/Profiles/Malware/Portable Executable and DLL Examination/QUARANTINE MALICIOUS EXECUTABLES",0,04-21-2021,11:02 PM
1195,401064,jcandelaria,"a malicious executable is found on that device, why does the alert show as ""Detected (Scanned)"" for the file?Detected (Scanned) means we detected the file as malware during the scan.Is the endpoint protected from that malicious executable? Yes, because the default policy is in block modeBased on the default setting, would that file be blocked if it attempted to execute and since it is dormant, it has only been identified during the scan but no action is necessary (other than an alert)? yes it will be blocked, there is a setting to change quarantine malicious executable where you can change it to Quarantine Wildfire Malware verdict so that way file that is scanned and if it has WF malware verdict then it will be quarantined. Step 3 --> option 2 from the link belowhttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/endpoint-...",1,04-23-2021,12:18 AM
1196,401064,Joe_Botelho,"Thank you for the responses.As a follow up, if a file is on the blocklist already but is given a WildFire verdict and ""Quarantine WildFire malware verdict"" has been enabled in the applied malware profile, why isn't the file actually quarantined? Is it due to it already being on the blocklist?",0,05-05-2021,05:30 PM
1197,401064,mabutbul,"Hey@Joe_BotelhoThe file should be moved to quarantine if the ""Quarantine WildFire malware verdict"" is flagged in the profile regardless of the fact it is in the block list.In case it doesn't please do the following:- validate the setting is enabled in the profile- validate the profile the agent is getting- open a support ticket to track the issue if none of the above works.thanks",1,05-11-2021,02:46 AM
1198,404920,mabutbul,"Hey@OrkanAlibayliIn order to query the collected event logs by the WEC capability, you can use the xdr_data dataset (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-xql-language-reference/get-started-wi...).Based on the collection profile you configured you can filter on the event IDs you are interested in.example query:dataset = xdr_data //use the xdr_data dataset which contains the WEC logs|filter event_type = EVENT_LOG // filter events to show only event_logs|fields action_evtlog_message as Message, action_evtlog_event_id as EventID // show the event log message and event_idif there any specific event you are interested in finding based on the configuration you enabled please do tellThanks,",1,05-11-2021,02:33 AM
1199,405477,mabutbul,"Hey Orkan,Not sure I completely got your question so tell if the following helps with understanding the flow:Restriction profile allows you to apply custom made BIOC's that upon detection will be prevented by the agent, in case you are using the default profiles then no prevention will take place but the detection will happen if the BIOC rule is configured in your BIOC repository (preconfigured or custom made BIOCs).BIOC's will trigger detection alerts regarding the fact that no prevention rule configured in the restriction profile, those are 2 different capabilities that can be linked in order to enhance the prevention capabilities.is that answer you question?thanks,",0,05-11-2021,02:09 AM
1200,402159,moixsante,"Hi@OrkanAlibayli,Are you using the latest version of the BrokerVM, v11.3.13? If yes, are you able to stop it and re-activate the proxy again?",0,04-27-2021,06:14 AM
1201,402159,OrkanAlibayli,"Yes, i use BrokerVM v11.3.13. I can stop proxy from BrokerVM web UI and reactivate but nothing change. Again i see ""in progress"" while hours.",0,04-27-2021,06:26 AM
1202,402159,scott,"Hello,@OrkanAlibayli.Can you check the following?:Sometimes the steps that I mentioned, do not allow successful communication with XDR Console if aren't configured properly. In my case, was the URLs.Hope it helps.Regards,",0,05-10-2021,02:17 PM
1203,385422,gjenkins,"Hi@iscott,Unfortunately, given that you don't have the admin or uninstall passwords or a valid connection to the XDR tenant from the endpoint to initiate the uninstall from there, the best next step would be a factory reset or a reimaging of the endpoint. Unlike Windows, the MacOS Cortex XDR Agent does not have a cleaner. It does have an uninstaller builtin, but you would need the uninstall password for that, so I could only offer a factory reset in this case.",1,02-12-2021,04:48 PM
1204,385422,scott,"Hello,@gjenkinsThanks for your answer. I know that has been past some months. What you said is correct. There is no cleaner for macOS. But, if you open a case, the TAC engineers will help with a script.It is important to underline, for the community, that these delete tools are not public. In order to don't allow final users to uninstall the agent, without the right company permissions.Please, do not share these Cortex XDR delete tools and scripts on public websites.",0,05-07-2021,04:04 PM
1205,405505,KRisselada,"Hi@WORRELLR just wondering what Content Version did you see the Child Process being blocked? I know for a fact that I seen a customer that just recently had a lot of processes on some build servers that were blocked as they were spawned from Java and it resulted in needing to put in a temp ""fix"" in the malware profile (in the malicious child process protection section) until later that day Cortex Operations released a ""911"" content update. This occurred with Content Update179-57885 and was ""fixed"" via content update179-57935 the same day. Support stated that a fix in Cortex XDR endpoint itself would occur likely in v7.4 (sometime June) I assume 7.3.2 is likely too far down the QA process timeline to put it there and delay that coming out (<< just my guess. I have no prior or inside info)",1,05-07-2021,09:45 AM
1206,405505,WORRELLR,,0,05-07-2021,10:53 AM
1207,405505,KRisselada,excellent! glad it was helpful,0,05-07-2021,02:04 PM
1208,404409,gjenkins,"Hello!My question is about Windows Event Collector.Why we need Windows Event Collector? Don't XDR Agents collects all needed information from Windows endpoints? Can Windows Event Collector give us useful information than Agents?Hi @OrkanAlibayli,The Windows Even Collector is used to collect Windows event logs on servers when the Cortex XDR agent would not do so. There are only a select number of Windows event logs collected by the Cortex XDR Agent, and those are critical as evidence for the malicious behaviors being reported by the agent. The Windows Event Collector can augment that that selection of event logs as a Cortex XDR administrator can specify the log IDs that should be shipped to the Cortex Data Lake (See the Windows Event Collector Document for more information.) Those logs may not necessarily deal with malicious behaviors, but they are interesting enough that a Cortex XDR user may want them brought in.",1,05-06-2021,04:08 PM
1209,404004,gjenkins,"We have some systems that are locked-down with software that prevents modifications to files/directories, and I'm wondering what are the paths that Cortex needs to be able to modify? For example, when it downloads the latest definitions, what does it need to modify? Is there any data stored in the registry as well?Hi@efasoformoso,Edit: As for the registry, here are the main locations to note:""HKLM\SOFTWARE\Palo Alto Networks\Traps""""HKLM\SOFTWARE\Cyvera""",0,05-06-2021,11:34 AM
1210,400597,nhussaini,"Hi all, the discussion forum is now open!Head over there now and ask away.",0,04-27-2021,09:33 AM
1211,400597,nhussaini,"We are excited for you to join us tomorrow, May 4 for the Cortex Customer Success AMA event. Come prepared with your questions for our experts@gjenkinsand@zsolomon! The 2-hour event starts at 8am PT. You can still ask your questions here",0,05-03-2021,12:39 PM
1212,390377,gjenkins,"Hi@Marcelo_Campos,Did you get all of the information that you needed here?",0,03-16-2021,09:23 AM
1213,390377,Abdul_Razaq,"Hi@Marcelo_Campos,Did you get any information on this.",0,05-01-2021,09:46 PM
1214,399033,jdelio,Thanks for posting this.,0,04-30-2021,09:56 AM
1215,403954,moixsante,"Hi@aliCommunity,First you would need if the Distro/Kernel of your server is supported. Please refer to this article.Afterwards, please follow the installation steps outlined on Cortex XDR admin guide for Linux.",0,04-29-2021,09:44 AM
1216,403954,aliCommunity,"Hi@fmoixsanteThe problem with elastic beanstalk is when you upload new code, the server is reset all settingsI think that I should add the command of installation onthe .ebextensions folder?Thanks",0,04-29-2021,01:31 PM
1217,402065,gjenkins,"Hi community,Does anyone know how to create dynamic group using define alphabet in the endpoint name.For example, my endpoints name is ABCP7ABC. I want to create a dynamic group just showing endpoints that have P7 after the first 3 character and not any endpoints that contain P7 (e.g ABCP8ABCP7).Thank you.Hi@BoonHwee,There's no way to specify a filter expression that indicates the start or the end of a string in Cortex XDR. So, unfortunately, any filter that you submit which contains ""P7"" will return results containingthat text no matter the position in the text being evaluated.",0,04-27-2021,08:09 AM
1218,395977,gjenkins,"Hi @RichardChou,The protection rule database is not publicly accessible at this time. To get information regarding the rules, why they were triggered, and recommendations on the next steps, please open a support case. They will likely need the Alert data to perform further analysis as well. That can be collected using the following instructions.Steps to collect Alert Data from Cortex XDR Console:1. Got to the Alerts table.2. Right-click on your target alert3. Select ""Retrieve Additional Data,"" then ""Retrieve alert data.""3. Navigate to Response > Action Center5. Locate the alert data retrieval job that you created.6. Right-click on your target job7. Select ""Additional Data.""8. Right-click on the resulting action9. Select ""Download Files.""",0,04-06-2021,09:29 AM
1219,395977,RichardChou,HiGjenkinsThanks for your reply.I understand.Richard,0,04-12-2021,06:27 PM
1220,395977,nd,@gjenkinsAny idea if the alert repo will be made public at a future state? Thinking it would save time and effort for engineers attempting to work through false positives.,0,04-23-2021,09:51 AM
1221,395977,gjenkins,"@gjenkinsAny idea if the alert repo will be made public at a future state? Thinking it would save time and effort for engineers attempting to work through false positives.Hi@efriend,At this moment in time, I'm unaware of it becoming public. As always, if you have a false positive, opening a case with our Support team is the best next step as we would likely need to refine the rules involved. Having the opportunity to do so will improve accuracy, efficiency, and ultimately the protection offered by the Cortex XDR agent.",0,04-26-2021,02:50 PM
1222,398893,gjenkins,"Hi @AsifSid,I understand that you want to exclude a number of devices from a group so that you can perform an upgrade job. This would be a use-case for filtering(Walkthrough.) Could you share the criteria by which you need to exclude? What identifiers make them unique from the devices that need to be updated? If that information can be defined, I should be able to help you create a filter in Cortex XDR.",1,04-16-2021,08:17 AM
1223,398893,AsifSid,"Higjenkins,Thank you so much for your reply, The criteria or reason for excluding those systems from upgrading is that those systems used by certain client users to connect to their network via Citrix, and there is a host checker which checks the host before allowing the connection and cortex agent version 7.3 is not on their list of supported AV (only version 7.1 is supported which is soon going to be the end of life).Since the end of life for version 7.1 is 4rth June 2021, so we want to upgrade all the systems to version 7.3 and exclude the remaining systems.Now I have created a static group for these systems to be excluded from the upgrade. I need to understand when I will create an agent policy for auto-upgrade these static groups should be excluded.One more question is if we decide to use the Bigfix tool (it's like the SCCM tool) to upgrade from 7.1 to 7.3 , any idea if we can install the new version on top of the old version? or do we have to uninstall the old version first and then install the new version?Awaiting reply. Thanks!RegardsAsif Siddiqui",0,04-16-2021,09:13 AM
1224,398893,gjenkins,"Hi@AsifSid,I'm glad to hear that you've created a static group for the endpoints that should be excluded from the upgrade. That was the hard part if you could believe it.The next steps involve creating a new cloned policy with only those endpoints in scope and making that cloned policy higher in priority than the original policy so that it takes precedence. Here are the steps to do so:   ",0,04-16-2021,03:42 PM
1225,398893,gjenkins,"PS: For your upgrade tool, you can use the standalone installer to perform the upgrade. It has the instructions needed to perform the uninstallation of the old version and installation of the new one.Reference: Source Documentation",1,04-16-2021,03:48 PM
1226,398893,AsifSid,"Hi,Could you please elaborate more on the logic?",0,04-22-2021,12:37 PM
1227,398893,AsifSid,"Hi Gjenkins,There is one more question I have that if we are upgrading the agent version via the SCCM tool (deployment tool), do we need to uninstall the old version first and then install the new version or we can upgrade on top of the old version.RegardsAsif Siddiqui",0,04-23-2021,12:39 AM
1228,398893,gjenkins,"Hi Gjenkins,There is one more question I have that if we are upgrading the agent version via the SCCM tool (deployment tool), do we need to uninstall the old version first and then install the new version or we can upgrade on top of the old version.RegardsAsif SiddiquiHi@AsifSid,An uninstall is not required to upgrade using a third-party deployment tool such as SCCM. The installation package looks for a preexisting version of the Agent and prepares to update components as required.",0,04-26-2021,02:30 PM
1229,366279,gjenkins,"Hi Besnard,There's currently no self-contained way to do so within Cortex XDR. You can export the list of endpoints as a file and use tools such as Google Sheets or Microsoft Excel to perform a duplicate lookup. Here's an example of how you can do so in Google Sheets.Best,gjenkins",2,11-30-2020,12:50 PM
1230,366279,Lopezz,Thanks for the update and quick reply. I'll be sure to keep an eye on this thread. Looking for the same issue. Bumped into your thread. Thanks for creating it. Looking forward for solution. TellPopeyes,0,12-01-2020,02:03 AM
1231,366279,mbahen,"Just FYI. I submitted a request though Support for this exact same feature. They created a Feature Request for it. You can reach out to your SE and have them also request it. FR number I was given was:FR ID:CXDR-I-246 if you need it. The more SEs request it, the faster they might actually implement it.",0,04-23-2021,08:52 AM
1232,366279,moixsante,"Hi@Besnard,Just out of curiosity, what's the reason for the regular reinstallation of your endpoints?Thanks in advance.",0,04-23-2021,11:26 AM
1233,401258,ahmadaliyev,i also can't see logs from cortex xdr in cortex data lake,1,04-22-2021,06:52 AM
1234,401258,moixsante,"Hi@OrkanAlibayliThird party vendor FW logs, like Fortigate, do only show in the XDR console. Please refer to this Admin guide article.@ahmadaliyevThe Cortex XDR Alerts do not show in the Explore app. This app is exclusively for PAN NGFW logs. If you want to view Alerts you need to go to Investigation > Incidents > Alert view.",1,04-22-2021,07:55 AM
1235,401258,OrkanAlibayli,Thank you very much,0,04-22-2021,08:02 AM
1236,400835,moixsante,"Hi@MCereda,You still have Child Process Protection, Office files with Macros and Ransomware.I need to point out that active whitelisting is NOT really recommended except for""Portable Executable and DLL Examination"" as Local Analysis could indeed block legit applications, and it could take WF up to 10-15 minutes to provide a benign verdict.The other modules have different kind of protections and I would only recommend whitelisting whenever there is a false positive alert.You need to monitor your incidents/alerts and see which modules are blocking your ""legit"" applications.",0,04-21-2021,03:08 AM
1237,400835,MCereda,"Hi@fmoixsante,thank you for the answer.As we have been asked us to temporarily disable any kind of real-time checks and analysis made by Cortex XDR on a specified folder in order to test a performance issue, do you know how to completely disable Cortex XDR features for a single folder?",0,04-21-2021,05:02 AM
1238,400835,moixsante,"Hi@MCereda,You can whitelist folders for almost every malware module, except for Ransomware andPassword Theft Protection.For the Exploit module, disabling protections for a single folder is not supported as far as I know. As of now, there is no way to do that directly from the Exploit module. I would suggest contacting TAC and ask them if a Support Exception (SUEX) would be able to achieve what you want to do.",0,04-21-2021,05:09 AM
1239,397387,hzingram,Fixed after below:,0,04-12-2021,05:38 PM
1240,391876,gjenkins,"Hi@JoeDay,It appears that you are trying to collect the local verdict for a file on an endpoint by extracting the wf_verdicts.db file. Currently, there's no public documentation available to share regarding the file. Would you like to explain that goal that you have in mind that would potentially utilize this information?",0,03-18-2021,02:12 PM
1241,391876,gjenkins,"Hi,I'd also like to point out that the local hash cache can be queried on Windows Endpoints using the following command which is more user-friendly than viewing the db file. cytool wf query [<hash>]Note: The supervisor password is required to issue this command.Source:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-0/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",0,03-25-2021,09:06 AM
1242,391876,JoeDay,"The verdicts handling was changed in version 7.2.To check (verify) the verdict on the agent.Verdicts:Invalid = 0,Benign = 1,Malware = 2,Unknown = 3,Grayware = 4,NoConnection = 5",0,04-12-2021,02:01 PM
1243,396015,Mohammed_Yasin,"same I could not able to upgrade from Traps to Cortex, during stopping servicesNew install goes through fine, but upgrade on a machine that has Traps installed gives this errorTraps ver : 4.2.5Cortex ver: 7.3.1msiexec /i \\fps01\Users\rinesh.nanu.2\Cortex\Cortex_x64.msi CLEAN_AGGRESIVLY=1 /L*v \\fps01\Users\rinesh.nanu.2\Cortex\exc02\log.txt",0,04-06-2021,06:14 AM
1244,396015,gjenkins,"Hi @Mohammed_Yasin,From the filename provided, ""Cortex_x64,"" it would seem that you've built a standalone installer for Cortex XDR. However, the version that you've referenced, Traps 4.2.5, an older ESM version, would require a package designed to perform an upgrade from ESM. Could you confirm that you built a package using the ""Upgrade from ESM"" option as displayed below?If you have selected this option for your package, the next step would require opening a case with Supportto analyze further. However, I wanted to make sure that this was covered.",0,04-06-2021,08:12 AM
1245,393308,anatgrafton,"So, PA Customer support shut this down by saying Linux Mint is an unsupported OS.Internally what we found that _may_ explain the situation is that PA have a self-signed anchor issue on the SSL certificate chain. You can see this on a Qualys SSL scan ofdistributions.traps.paloaltonetworks.comI can't prove it at this point, but the thinking internally is that either Mint or the app or a combination in some way follow the entire chain and fail validation because it sees the final certificate in the chain is self signed even though it is in the trusted root store.Given that PA won't entertain any further investigation I've had to move on, their list of supported Linux OS is very small and contains no specific desktop variants or flavours.Where Can I Install the Cortex XDR Agent? (paloaltonetworks.com)At this point I don't consider that XDR fully supports Linux and certainly not Linux for desktop\client endpoints .",0,03-26-2021,02:27 AM
1246,392681,gjenkins,"Hi@JamesPoehlman,Currently, there's no way to change your default landing page. As a workaround, you can bookmark the incidents URL for your tenant, which should take you directly to the incidents page. The URL should adhere to the following:https://[tenant_name].xdr.[region].paloaltonetworks.com/incidents.As for the filter, the last filter set should be persistent, provided you have cookies enabled on your browser. If it is not, the next step would be to open a case with support.",0,03-22-2021,08:48 AM
1247,392681,JamesPoehlman,"Thanks, I'll go ahead and make a nfr for this. Regarding the cookies, I have a support case open thanks.",0,03-24-2021,07:35 AM
1248,392309,moixsante,"Hi@JamesPoehlman,As of now, that is not an option supported in the Host Insights add-on. I would suggest you reach out to your PANW account team to raise a New Feature Request (NFR) with the dev team.Thanks.",0,03-19-2021,09:37 AM
1249,392303,moixsante,"Hi@JamesPoehlman,As of now, that is not an option supported by the Broker VM Pathfinder Applet. I would suggest you reach out to your PANW account team to raise a New Feature Request (NFR) with the dev team.",0,03-19-2021,09:31 AM
1250,391674,gjenkins,"Hi@YAlhazmi,The referenced case,CPATR-10685, does not appear to be a known issue typically published here for the server and here for the agent. The lack of inclusion indicates that the issue you're encountering is likely particular to your environment. Additionally, it appears that you have a severe issue of which is impacting your production environment. As such, the recommendation here would be to open a case with Support to inquire about the case's progress and its resolution as soon as possible. In fact, I would highly recommend giving them a call to speak with an engineer as soon as possible at one of the following numbers to discuss:",0,03-17-2021,09:09 AM
1251,391674,YAlhazmi,"Hello@gjenkins and thank you for your response!I don't think that the issue is particular to our environment. We have tried it in all sorts of machines including fresh OS installs and it can happen to anyone. The preconditions areSo, it is not particular to our environment.We communicated with support beginning February and their response was that this is a bug and they don't have a workaround for it and that there will be a fix in next release. Next release (7.3) came out and we didn't find anything regarding it. We contacted support again, and their response this time was ""[fix] is planned to be released in version 7.4 ... [but] support team does not have knowledge regarding roadmap plans"".",0,03-17-2021,10:46 AM
1252,391674,gjenkins,"Hi,I'm glad to hear that you've opened up a communication line to get more information regarding CPATR-10685. Please be sure to request updates regarding your break/fix issue via Support cases which they will hopefully resolve soon. If you find that you need general product guidance, do reach out.",0,03-18-2021,02:23 PM
1253,392012,moixsante,"Hi@Marcelo_Campos,You check the status of the XDR agent in Linux locally, you need to use the cytool utility that's already in the system after installing the XDR agent.To check the status of the XDR service you can go to this site",0,03-18-2021,08:40 AM
1254,392012,gjenkins,"Hi@Marcelo_Campos,To check the status of the agent processes, please use the following command:  sudo /opt/traps/bin/cytool runtime queryThis should yield resultssimilar to the following image indicating that the agent is running properly.You can find more informationhere regarding the use of the Cortex XDR agent.",0,03-18-2021,08:41 AM
1255,391391,gjenkins,"Hi @eproca,From what I can tell, you may be encountering an issue where Local Analysis has determined that your sanctioned software is malware and is blocking it due to policy configuration. To override the local analysis verdict and permit this software to run immediately, you can apply the hash for the file in the Allow List for Cortex XDR using the following instructions.To understand why your file was blocked, I would recommend opening the Hash View to see the information collected by Cortex XDR in terms of the threat intelligence and the incidents related to the hash. You can access the Hash View by clicking the circle icon () on the top-right of your screen, pasting the hash into the search bar, and clicking, ""Open Hash View of..."" There you will find more information regarding the hash and the verdict provided.Please let me know how this goes when you have the opportunity.",0,03-16-2021,08:10 AM
1256,391391,proca,"hi @gjenkins ,Thanks for your feedback. I am the application developer but not the Cortex XDR user. I dont have any direct access to the Action Center of Cortex XDR or possibility to check the Hash View. Anyway I will pass the information to the actual Cortex XDR users.Is there any way to ""white list"" a file globally for Cortex XDR? I mean without having to be an actual user of Cortex XDR. Some antivirus have proccedures and protocols for this kind of situations.Many thanks in advance for your support",0,03-16-2021,08:25 AM
1257,391391,moixsante,"Hi@eproca,As you mention, I would get in touch with your XDR admin and refer him to the following links.You also mentioned that the application you want to allow is also digitally signed. You can also add the signature to the Allow List Signer in the Malware Profile,",0,03-16-2021,09:05 AM
1258,391391,gjenkins,"Hi,Passing the information along to the Cortex XDR administrators for your instance is the best next step in this case. Thank you for forwarding it. Once they have applied the hash to the allow list, it will apply to all endpoints within your environment.You can add to the allow list for your environment globally by using the instructions above or watching the following video.XDR Pro + Prevent Managed File ExecutionAs for a true global verdict via Wildfire submission, the best way to submit is by executing the file on a device with Cortex XDR. Once executed, Wildfire will receive a copy submitted from that endpoint and provide its verdict within 24 hours. That verdict is distributed globally across all tenants.",0,03-16-2021,09:12 AM
1259,391391,proca,"Thanks@fmoixsante for the possible solutions and thanks again@gjenkins for the support.One question: the application is signed with an EV code certificate. @fmoixsante explains that it can be added to an Allow List Signer in the Malware Profile. Will this help to avoid false positives in future files signed with the same certificate? Honestly, I am not so amused with the idea that each new future installer will need some kind of special managment by the Cortex XDR administrators.Thanks in advence for the support.",0,03-16-2021,09:24 AM
1260,391391,gjenkins,"That's a great question, @eproca.Adding your signers to your allow list will exclude signed ""executable files, macros, or DLL files on Windows endpoints, Mach-O files or DMG files on Mac endpoints, ELF files on Linux endpoints, or APK files on Android endpoints"" from the malware examination. It will still be subject to scrutiny by other protective modules such as Behavior Threat Protection, Child Process Protection, and any other applicable module given the activities observed.We are here to support if a false-positive is found. If it does happen, please feel free to have the XDR administrators submit a verdict change request or open a case with Support to investigate further.",0,03-16-2021,11:43 AM
1261,391391,JHugget,"Hi, I have an application that keeps getting blocked because the hash keeps changing each time it is downloaded. It is digitally signed by the publisher and I was wondering if you had instructions on allowing the program based off the signature instead of the installation path.",0,03-17-2021,08:26 AM
1262,391391,gjenkins,"Hi@JHugget,The instructions you're asking for are here, as referenced by @fmoixsanteearlier in the thread. This will help exempt your file from scanning due to the changing hash.",0,03-17-2021,08:53 AM
1263,391391,proca,Thanks again for the support @gjenkins.I have been told that after one day the same installer file did not trigger any warning from Cortex XDR any more. And without any action from the administrators of Cortex XDR. Maybe some action in the paloaltoN side?. Anyway thanks again for the support.,0,03-18-2021,05:29 AM
1264,390669,jcandelaria,@iscottDo you have mixed of Pro vs Prevent license?Around 300mb is the average memory with most of the features turn on with EDR enabled.Can you check if endpoint with 180mb have pro license enabled and EDR or just prevent?,1,03-11-2021,10:15 AM
1265,390669,YAlhazmi,We only see high memory consumption during file scans.Maybe you could generate a support file and take a look at it?,0,03-17-2021,05:08 AM
1266,391472,gjenkins,"Hi@KRisselada,Thank you for submitting your feedback. I'll forward this internally and request that they provide you with more specific information regarding the affected tenant.",1,03-16-2021,07:42 AM
1267,389356,jcandelaria,@tfoleythe endpoint group is not yet available/expose in our XQL xdr data fields,0,03-15-2021,11:20 AM
1268,335238,dfalcon,Hi@Marsooq-Akkaradathil-Yes. Go to Response > Action Center > Blacklist > New Action. From there either enter the MD5 entry or import a list of them.,1,07-15-2020,07:29 AM
1269,335238,KRisselada,"Hi @dfalconStill looking for this but I wanted to ask here also. Is it then possible to change the Alert Severity of the Alert Name = ""Administrative Hash Exception"" from LOW (which it appears to default to now) to Medium, so that an INCIDENT is created. Right now it will BLOCK but no Incident is created, as its LOW Severity alert.",0,03-04-2021,07:47 PM
1270,335238,dfalcon,"Hi @KRisselada-From the alert, what is listed as the source?",0,03-09-2021,01:44 PM
1271,335238,KRisselada,"@dfalconits Alert Source = XDR Agent, Alert Name = Administrative Hash ExceptionIts set as Low, with regard to Severity, I wondered if I could adjust the Sev from the default Low, to say Medium. I wondered if Scoring Rules (within Incident Management) might do that, but does not seem to be, or I am not doing it correctly.",0,03-09-2021,01:51 PM
1272,335238,QDSupportUser,"actually SHA256 only. there is no provision for providing and MD5 hash that we can see. And even if we try to add an MD5, the system doesn't accept any MD5 hashes",0,03-11-2021,12:46 AM
1273,335238,KRisselada,"Thanks@QDSupportUseractually I didn't come up with the subject line that indicated MD5. But the goal (via SHA256) was close. Essentially was looking to have an Incident created from an alert namedAdministrative Hash Exception, which seems to be by default set to LOW. I was looking to make that an Incident.So to restate here was looking to:Hope that helps.",0,03-11-2021,04:51 PM
1274,385267,gjenkins,"Hi@Brett_Hobbs,This is possible by applying ""Endpoint Aliases"" to your endpoints. Once configured, you can group dynamically by the alias, focus dashboards, and reports based upon that group and apply policies based upon either the group or the alias.Click herefor more information on Endpoint Aliases.",0,03-11-2021,10:59 AM
1275,385267,Brett_Hobbs,,0,03-11-2021,02:10 PM
1276,385267,gjenkins,"That's completely understandable,@Brett_Hobbs. In this case, I would recommend opening a feature request with your Account team so that the Cortex XDR Product team can consider the feedback provided.",0,03-11-2021,04:02 PM
1277,387794,gjenkins,"Hi @afonsecacr,There are third-party tools that could be used to gather this data for you. A quick Google search yielded the following for HTTPS monitoring:If you are looking for something that is self-contained within the product, this would be a feature request which should be registered with your Account team at Palo Alto Networks.",0,03-11-2021,10:45 AM
1278,389096,gjenkins,"Hi@Abdul_Razaq,After creating the snapshot from the golden image, did you run the following command? msiexec /i c:\install\cortexxdr.msi /l*v C:\temp\cortexxdrinstall.log /qn TS_ENABLED=1This is the command that instructs the agent to establish a temporary session.Source:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-0/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",0,03-11-2021,10:35 AM
1279,390004,JohnSmith7732,I was able to make most of mine work with just two. i got them through help desk inquiry and imported with certificates add-in mmc and they worked fine. Not sure what they google one is for. What i did note though was on about 3 of 20 servers they connected and showed in management but they remained red on endpoint. Looking at traps log though they appeared to be working anyway.,0,03-09-2021,10:00 AM
1280,390004,jcandelaria,"Hi Grenzi,On your machine or other machine that is working, you can do mmc-->add or remove snap-ins and select Certificates then select computer account.Once loaded, you can go to Trusted Root Certification Authorities-->Certificates then try to find the GlobalSign cert with the correct thumbprint per step 3, then you can export it and import it to the server where its missing this certificate.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...",0,03-09-2021,01:07 PM
1281,390004,jcandelaria,@JohnSmith7732Have you tried restarting the cortex xdr service? or is it still red even after the server reboot/restart?,0,03-09-2021,01:09 PM
1282,390004,grenzi,"Thank you. I had to import all the CA certificate using the MMC as well. Now the agent seems to work, but with the strange behavior as described by@JohnSmith7732: on the host, the agent shows that is not connected, but in the Endpoint Administration page on Cortex XDR the client shows as connected.",0,03-10-2021,01:48 AM
1283,390004,grenzi,"I was able to make most of mine work with just two. i got them through help desk inquiry and imported with certificates add-in mmc and they worked fine. Not sure what they google one is for. What i did note though was on about 3 of 20 servers they connected and showed in management but they remained red on endpoint. Looking at traps log though they appeared to be working anyway.Hi@JohnSmith7732, the support confirmed that all three certificates are required (I exported them from another machine, as suggested by@jcandelaria), as well as the patchKB2868626 for the operating system to support SHA256. Now my agents are connected successfully.",0,03-10-2021,07:11 AM
1284,390004,jcandelaria,@grenziHave you tried restarting the xdr service? or is it the same even after you restarted the server itself?,0,03-10-2021,08:34 AM
1285,390004,grenzi,@grenziHave you tried restarting the xdr service? or is it the same even after you restarted the server itself?No need to restart the server or the service itself after installing the patch and the CA certificates.,1,03-10-2021,08:47 AM
1286,390004,JohnSmith7732,I have to go back and visit the 3 again. Thanks for the suggestion,0,03-10-2021,09:09 AM
1287,390004,jcandelaria,@grenzigood to know that the agent is working and connected..,0,03-10-2021,12:59 PM
1288,383630,gjenkins,"Hi@John_Lodge,It would appear that the value ""IRAN_,ISLAMIC REPUBLIC OF,""which is a string, is not being parsed properly by XQL. Have you had the opportunity to report this to Support for review?",0,02-09-2021,08:34 AM
1289,383630,gjenkins,"For anyone looking to know how this was resolved, a bug was registered for this problem which should be resolved in Cortex XDR version 2.8. As a workaround, you can use the two-letter country code to yield the same result. For example:For ""IRAN_,ISLAMIC REPUBLIC OF"":  dataset = xdr_data | fields action_country | dedup action_country | filter (action_country = ""IR"")Or ""VIRGIN_ISLANDS,_BRITISH"":  dataset = xdr_data | fields action_country | dedup action_country | filter (action_country = ""VG"")A list of two-letter country codes can be found here.",1,03-04-2021,01:00 PM
1290,389091,gjenkins,,0,03-04-2021,07:36 AM
1291,387259,gjenkins,"Hi@Marcelo_Campos,You should be able to accomplish both using Cortex XDR using the following instructions. On Windows devices, you can prevent the execution of a process by name or path by creating a rule in a restrictions profile and applying that to a policy.To enable, do the following:For endpoints that do not have Windows as an operating system, you can enable detection of a process using BIOC. Create a BIOC to monitor for a process with a specific name:As for your second request, you can create a BIOC and convert it into an XDR Agent prevention rule for compatible endpoints by doing the following:",0,02-23-2021,03:44 PM
1292,387259,calroy,Hello @Marcelo_CamposCortex XDR™ Pro Administrator’s Guide - https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...,0,03-03-2021,09:56 PM
1293,346080,DKasabji,"This does not seem to be issue with the Agent. I would investigate what's going on on those specific endpoints.1. Were you able to see any alerts / logs on Cortex XDR interface when this issues occurred?2. Are these endpoints running the same Windows version (KB) as all other Windows machines?3. Maybe there are some drivers installed on those two machines that intervene with Cortex XDR Agent?4. Did you try to reboot the machines once you installed the Agent?5. I am sure you checked, but I'll ask, have you checked whether there is any incompatible software installed on the machines?6. You could also create a special policy, where profiles would be very mild towards Blocking the processes. Be sure to apply the policy only to the two endpoints and put the priority over other policies, by re-ordering it. If this eliminates the problem, we'd know that some protection module is intervening. You could start then detecting which one (1-by-1 elimination) and once you know which one it is, you could find out which file, driver, etc. caused it.Finally, by now you perhaps already know, there agent version 7.2. available, which you can try as last result.",0,09-13-2020,09:41 AM
1294,346080,jamesjackson,So this is happening to me too and it has to be XDR related as it stops happening once the agent is removed.Will report as a bug,0,03-03-2021,09:49 AM
1295,387390,gjenkins,"Hi@Paul.Mathews,I would recommend reviewing the following document for guidance on installing Cortex XDR in virtual environments. There are quite a few considerations to be made here, and this document does a great job at detailing those for Cortex XDR users.Cortex XDR Agent for Virtual Environments and DesktopsAs for Citrix AV exclusions, there are no known issues requiring optimizations at this time. If you encounter and performance issues with Citrix caused by Cortex XDR, our recommendation is to open a case with Support at https://support.paloaltonetworks.com/. For reference, the following link shows all of the known issues with Cortex XDR.Cortex XDR Known Issues",0,02-23-2021,09:27 AM
1296,387390,aul.Mathews,thanks GjenkinsI have enabled the switches vdi enabled and ts enabled. The part I missed is the cytool VDI update. Do you know what the implications are by not setting this ?,1,02-24-2021,02:38 AM
1297,387390,gjenkins,"Hi@Paul.Mathews,I'm checking to see if there's anything more here, but according to the documentation for this optional step, it is only used to update the name in the Cortex XDR database if changed.",0,02-25-2021,05:02 PM
1298,382558,JohnSmith7732,"Im not sure without research of a kali flavor limitation.. I do not see it on the compatibility matrix but that doesn't mean it wont run. That usually means not supported. You found another issue though maybe!Broker VM / Activate the Agent Proxy for Closed Networks: <Link saysRun the installation package on each endpoint according to the endpoint OS. During installation you must configure the IP address of the broker VM and a port number. You can use the default 8888 port or set a custom port. See the Cortex XDR Agent Administrator’s Guide< Link for installation instructions.When you page down to Linux Configure proxy communication in the second link the example shows:If defined, the agent uses the proxy settings defined in the system environment in/etc/environment. blah blah blah... For example: https_proxy=""https://10.196.20.244:8080""I noted the use of 8080 in your statement. You are probably not using 8080 for the broker VM. Try 8888. Mostly seek consistency of the two (broker and client) ports in your environment with whatever ports you used.I can see a potential problem in messaging across the documentation as they are usually created in separate efforts. Examples should define default variable throughout but tech writing doesn't require tech comprehension. If it proves to be true just ask Palo Alto to modify the Cortex Docs for consistency in messaging in those locations at the links above. Documentation is a tough job. I'm sure it will be well received suggestion and they will fix.Good Luck!",0,01-28-2021,06:45 AM
1299,382558,dfalcon,"Hi there,The problem may be the Linux machine itself. Kali is ran on a CentOS workstation. The Cortex XDR Linux agent is only supported on Linux servers. What OS flavor are you using?Second question, what types of machines will be leveraging the broker?",1,01-28-2021,07:27 AM
1300,382558,mansad,"Dear thank you very much for your answer, but by default I used port 8888 in the broker, but from the support of palo alto they made me change it to 8080 since I am in an environment under proxy ... The reason for such change, I do not know in absolute.However, the Broker is configured to listen on port 8080 from the cloud console, and the terminals have the proxy configured forport 8080.....I did not test the proxy configuration of the operating system I will try that part in advance thank you very much",0,01-28-2021,11:02 AM
1301,382558,mansad,"Dear kali, it is a debian based distro, I use it simply not to work directly with productive servers and not have any unknown problems. I observe that the EDR has the services active in the kali, and I have no errors in the logs, I only observe the timeout against the broker. However, if you assure me that Cortex does not work with Kali, I will have to perform tests on productive Debian systems and verify that everything works correctly.Going to the second question, the intention is to use the broker in environments that do not have direct access to the internet. I appreciate your help in advance.",0,01-28-2021,11:15 AM
1302,382558,mansad,"With version Broker 11.1.1 WOrks fine with alll agents, except with kali!!!",0,02-17-2021,06:31 AM
1303,382558,gjenkins,"Hi@romansad,Kali Linux is not on the supported list of Linux Operating systems. Perhaps you could attempt on a flavor listed here:https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...?",0,02-22-2021,01:30 PM
1304,385713,blebail,"Hi,Can you check the destination IP? It is unlikely to be Google. I have seen that multiple times where there was proxy in the middle. The reason is that the certificate claims to go to Google but the connection is between client and proxy. As the analytics module will learn, this alert involving proxy might eventually disappear.Regards,Bertrand",0,02-15-2021,12:36 AM
1305,385713,DanBrook,"The IP address is indeed Google. However, I wonder if there is an issue because of SSL inspection that is causing the issue?",0,02-16-2021,12:36 AM
1306,385738,gjenkins,"Hi@Daniel_RuizPadilla,Here's what I've been able to dig up from Support cases:@echo offecho Password123|""%ProgramFiles%\Palo Alto Networks\Traps\cytool.exe"" protect disablexdragentcleaner.exe --silent --password Password123 --log c:\remove.logshutdown.exe /r /t 00Note 1: On Windows 10, I had to suppress change notifications to ""never notify"" here: Security and Maintenance > Change User Account Control Settings > Reduce to ""Never notify.""Note 2: I had to put the bat file in the folder with all of the decompressed XDR agent cleaner files.I would suggest trying it on a few machines before attempting large numbers of endpoints.",0,02-12-2021,04:22 PM
1307,350463,Burns,"One option would be to request the XDR Cleaner Tool from support and use:REM to disable agent protect and remove agent with XDRAgentcleaner@echo offecho Password123|""%ProgramFiles%\Palo Alto Networks\Traps\cytool.exe"" protect disableREM use xdrcleaner note the password is in clear txtxdragentcleaner.exe --silient --password Password123 --log c:\remove.log",3,09-22-2020,08:45 PM
1308,350463,Antonetta,Most Anti virus has an anti tamper password. Call the vendor if it's not working. There's probably registry keys and possibly other system files to hook the kernel.,0,11-19-2020,03:09 AM
1309,350463,Daniel_RuizPadiaria-labellla,"Hi folks,Could you help me plaease to know how can i create a bat script to execute Cortex Agent cleaner with anti tampering password to remove cortex agents?I have to use bat because powershell is prohibited",0,02-12-2021,11:27 AM
1310,363930,gjenkins,"Hi AsifSid,Here's a good document on investigating and managing incidents within Cortex XDR.It provides an in-depth walkthrough around incidents, including taking ownership, adjusting the status, reviewing details, gathering more information from external integrations, and taking action. There's even a video that you could watch to understand more about incident management here.Finally, Cortex XDR recently rolled out a new feature called Remediation Suggestions. I'd recommend reviewing this video to understand its capabilities and how it can help you better-manage your incidents.Please give these materials a look and let me know if you are looking for something else in particular.",1,12-03-2020,01:30 PM
1311,363930,AsifSid,Thank you so much GjenkinsRegardsAsif Siddiqui,0,02-10-2021,09:45 AM
1312,363930,gjenkins,"No problem,@AsifSid! Glad to help.",0,02-11-2021,08:23 AM
1313,385092,gjenkins,"Hi@RNance,My recommendation would be to create an exception for this activity. The exception would only allow the custom script to get past only the referenced exploit protection rule while still applying other exploit protection rules as desired. You can create an exception for this exploit rule by right-clicking the alert, going to ""manage alert,"" and then selecting ""create alert exception."" This exception can be applied globally or to a specific profile that would only affect a set of devices, whichever is more appropriate for your environment. Given that your description only mentions one terminal server, I would recommend creating a unique exceptions profile and applying it only to that endpoint. Instructions on how to create an exceptions profile can be found here.",0,02-10-2021,08:00 AM
1314,385092,RNance,"Yes, however when creating an exception in that manner, all it really does (or at least says) is that will create a Generic alert based on the process name powershell.exe. However, I need it to go beyond just powershell.exe and to include the cmdlet. Essentially, I need to create an exception based more on the ""Initiator Cmd"" as opposed to just the ""Initiated By"". The way the exception is perceived is that you are providing an exception just to powershell.exe, which is too broad.I was envisioning something akin toMalicious Child Process Protection where you can define a child process command line param. The difference here is that powershell is the parent process and there is no child process in this example. Thanks.",0,02-10-2021,10:33 AM
1315,385092,gjenkins,"Hi@RNance,Creating an exception would prevent the rule from executing, allowing the PowerShell script to run. The alert, on the other hand, may well be generated in a generic format, which can be suppressed via exclusion. However, permitting the script to run is a use-case for the exploit rule exception. Furthermore, exploit protection exceptions do not support target scripts as a parameter at this moment in time. That would be a feature request at this point, which your account team should be able to report on.",0,02-10-2021,10:42 AM
1316,383565,dfalcon,Hi@asiddiquie-I have not heard of any reports. Are you experiencing any issues?,0,02-04-2021,06:27 AM
1317,383565,asiddiquie,thanks@dfalconI have started the deployment on test machine just to check the response.,0,02-09-2021,10:53 PM
1318,384599,jcandelaria,"Hi Nathan,If you are looking for the actual xdr reference, below is the link where you can see the training period, learning period and description.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...ThanksJomar Candelaria",0,02-08-2021,12:57 PM
1319,384599,NathanBradley,"That is a good resource but not exactly what im looking forWhen clicking rules>bioc. When right clicking a rule, for example ""Powershell reverse shell"", and open in query builder.  In query builder I can see its looking for remote port 4444 and cmd=*web*downloadstring*.ps1*|*web*downloadstring*.exe*   However when rules>bioc>analytic bioc rules. right clicking any rule and there is not an option to open in query builder ",0,02-09-2021,06:22 AM
1320,384599,jcandelaria,"Hi Nathan,No that is possible to open in query builder as this is analytics rules, the reference that I posted is what explains that analytics rules.ThanksJomar Candelaria",0,02-09-2021,09:58 AM
1321,384520,jcandelaria,"Hi Ignacio Medina,There are different behaviors when executing ransomware and to which folders and drives it tries to manipulate.Check your default configuration under malware profile --> ransomware protection --> default should be blockPlease contact your local account se team to discuss with regards to this ransomware test result",0,02-08-2021,10:23 PM
1322,384520,Ignacio_Medina,"Hi. thank you very much for your response. In theory, I have it as directed. Attached capture. Yes, it will be best to open a case with support and see what the solution is.",0,02-09-2021,01:34 AM
1323,384172,gjenkins,"Hi@EddieRowe,Have you had the opportunity to work with our Support engineers to gather evidence that the Cortex XDR agent is truly impacting your backup software's performance? I would highly suggest doing so to avoid disabling protection where it is likely needed most. They can be reached at https://support.paloaltonetworks.com/.",0,02-05-2021,09:50 AM
1324,344032,KRisselada,"Hello@thejackalwere you not able to get a reply when submitting it as a WildFire Verdict review? I normally find this process works pretty well, if the item in question created a Incident in Cortex. The process I normally am able to use is mentioned in this thread:  https://live.paloaltonetworks.com/t5/cortex-xdr-discussions/submit-a-revision-about-false-positive-m...Apologies if done this already or this is not relevant to the issue your posting on.",0,08-16-2020,03:00 PM
1325,344032,KRisselada,"if I can add my other 2cents to this, what I have found is that when app has not been signed by the vendor (which this one is not), its very much likely that WildFire is going to default to considering it Malware, unless a Verdict review is submitted. I have been told by PA TAC/Support folks that the best way to ensure WF has better results, is to ensure and we all request our software vendors to ensure they sign their files.",0,08-16-2020,03:11 PM
1326,344032,dfalcon,"Hi@thejackal,@KRisseladais correct. You have two options here. You can whitelist the file within your own environment or you can report the verdict as incorrect to WildFire. If you report it as incorrect, members of our Unit42 team will examine the file in more depth to possibly update the verdict.You mentioned that you did not have issues with Traps and they the problem occurred with the current iteration of the product. I think this is because Cortex XDR has more methods to detect threats such as the Behavioral Indicator of Compromise (BIOC). When a certain behavior matches these rulesets, you may have additional alerts that were not there in Traps.In any case, it is worth submitting the app for additional review since it is a needed application.",0,08-17-2020,11:47 AM
1327,344032,thejackal,"Palo Alto,it seems after some recent updates/changes the file is again being flagged as a false positive. I suspect as the hash has changed somewhat since last update of your system.Would you please assist me in having this rectified as it is indeed being flagged as a false positive and is a required application to undertake my job function. I have included the 2 most up to date versions inclusive of beta of the Shut.tools app. Hopefully this should clear both versions of this from being flagged as a false positive. Your assistance is greatly appreciated.",0,01-31-2021,09:58 AM
1328,344032,thejackal,Since rectifying a previous issue with your system identifying shut tools app as a false positive. It has again popped up as a false positive. I suspect this has been re-triggered as the original hash has possibly changed somewhat since it has been updated slightly with new functionality. Or for some reason you have removed exclusion from your latest update.As I require this tool to undertake my job function. Would you please take a look at the 2 zipped versions of the tools inclusive of the latest beta version. Once you are satisfied it does not indeed contain any malicious code would you please update your wildfire engine to not flag it as a false positive.Your assistance is greatly appreciated. I am unable to add an exclusion directly in our environment.Thank you,0,01-31-2021,10:19 AM
1329,344032,dfalcon,Hi@thejackal-Have you submitted an incorrect verdict submission for this? You can do this from the WildFire interface in the incident.,0,01-31-2021,02:32 PM
1330,344032,thejackal,"David,I do not have access to the Cortex XDR or wildfire interface. As such I require this to be cleared at a product/signature level. This has been performed in past by your team however I suspect with some evolution of code it has changed the hash.Would you please assist me in having it cleared by your team. Kaspersky has already indicated last night it would be cleared in there latest update. Feel free to peruse the code within.CheersMatt",0,01-31-2021,09:05 PM
1331,344032,jcandelaria,Your SOC admin who have access to Cortex XDR can definitely override the verdict or report as incorrect and or whitelist the file.Below is how to report WF verdict as incorrect.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/investigation-and-respo...,0,01-31-2021,10:12 PM
1332,382881,gjenkins,"Hi@YifanZhan,The sudo password is not public at this time. However, when executing the commands via Live Terminal, ""sudo"" does not need to be prepended to execute the command. Please note that you will need to change the directory to the location where the scripts are located to execute. See the following instructions on how to do so: Other commands work in the same fashion without ""sudo."" Give it a try and let me know if this helps or not.",1,01-29-2021,10:42 AM
1333,382449,JohnSmith7732,"BTP is for actions involving a PE/Macro/DLL and a windows process. I believe that is a simple explanation I can offer.The detection of an action would involve ""real time"" scan analysis and be behavioral.The scanned alerts are specific to ""periodic"" scanning of a file at rest. That's what you are doing now.You'll need to set the quarantine on ""Portable exe and DLL examination"" in the ""Malware Analysis Profile"" to achieve what you are asking. Its set to disabled by default.i dont know PA best practice but... Id run the periodic scan at least once before i enabled the quarantine for file types. Let it run across your enterprise and fill your screen with incidents/alerts. You are going to find tons of stuff you probably didnt know existed just laying around. You will see multiple instances of things which can help you isolate spread or unauthorized usage. Remediate them first. What that will do is populate your verdicts in the Wildfire database and enhance your local analysis. Nobody will know you did it and you wont piss off your sysadmins when the quarantine siezes all of their crazy tools. Give em a chance to explain first and you'll make friends 🙂The existence of BTP and file block options in Cortex is already protecting you in real time. Take your time.",0,01-28-2021,01:45 AM
1334,382449,dfalcon,"Hi there-The quarantine function is limited to PE's and DLL's and can be set in the malware profile.Macros are different in that you would not want to quarantine the actual executable, which would be Word, Excel, etc. For that reason, the specific file is what is terminated, while the Office application remains open. Your option for a macro is simply to block.BTP is also different. When events occur on the endpoint, they are loaded into BTP memory. From there, the event is compared to a list of built-in BTP rules and if one is triggered, it is terminated. This cycle is repeated based on what is occurring. For example, someone may be running Outlook. That person receives and opens an email, then opens a Word attachment. After the Word attachment is open, a macro is executed which is doing something it shouldn't. BTP looks at each stage in this process and terminates once something matches a built-in BTP rule. You cannot check BTP at rest since it is based on behavior in motion.",2,01-28-2021,07:02 AM
1335,382335,gjenkins,"Hi@DKasabjiThe Broker VM would need the public key, not the private key, for SSH authentication. No password would be expected when submitting the public key.See step four of this document to get more details behind the configuration.",0,01-27-2021,03:37 PM
1336,382335,gjenkins,"Hi@DKasabji,Please disregard my previous message as your inquiry is regarding SSL certificates. Your observations are correct as the current version of the Broker VM does not support password-encrypted certificates. Please upload a server certificate that does not have a password in order to use the feature appropriately.",0,01-27-2021,03:50 PM
1337,352777,MartinCimone,"'Connection Lost' means that your endpoint has not communicated with Cortex Console for more than 30 days.You should investigate locally the machine to find out what's the problem. Probably a network issue or some kind of block (firewall, app, ETC) preventing the Agent from communicating with Cortex Servers.This has nothing to do with the number of IP address you can see in Cortex Console.btw, you can disable the Anti Tempering with the command: cytool.exe protect disable",0,09-30-2020,06:54 AM
1338,352777,TimGowen,"Thanks. I have got advice to remove the client and re-install and there is a utility for doing this for Windows... is there a Mac utility too, as one of these is a Mac.One of the disconnected Windows agents, on a server, couldn't have been due to a network issue - or if it was the connection was not re-made when whatever happened was over. So I had to remove the agent and reinstall.Tim",0,10-07-2020,06:20 AM
1339,352777,vargas,"we have the same problem but in my case have a many of agent whit ""Connection Lost""i try to unistall the agent but the ""Agent Tampering Protection"" block the process. i try too resolve this desible protection whit the command ""cytool protect disable file"" but it asks me for supervisor password and i dont know what it is becasue i try whit my user pass",0,01-27-2021,11:34 AM
1340,352777,dfalcon,"The supervisor password is actually the uninstall password that is defined within your agent profile. If you do not know the password, please reach out to Support. They can assist you with removing the agent.",1,01-27-2021,11:57 AM
1341,352777,MartinCimone,"Also, if your supervisor password does not work, just try to hit ""ENTER"" on the password prompt.If your policies were never applied correctly, the supervisor password is probably empty.",0,01-27-2021,12:09 PM
1342,352777,vargas,i tried that but it didn´t work,0,01-27-2021,12:22 PM
1343,352777,dfalcon,I've never heard of a blank password. You are prompted to set an uninstall password during initial configuration. There is a default password in the event you never establish connectivity that may be helpful.Check step 2 in this link:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/custo...,0,01-27-2021,01:46 PM
1344,352777,gjenkins,"Hi@TimGowenThere are scenarios when the XDR agent installation package gets deleted by mistake from the Cortex tenant resulting in agents going into the ""Connection Lost"" status. Have you tried reaching out to Support to see if they could confirm if this is causing your problem? If they can determine that this is the case, there is a chance that they will be able to restore the installation package, and ultimately, the connectivity to your endpoints.",0,01-27-2021,02:40 PM
1345,382035,gjenkins,"Hi @NathanBradley,Exporting Host Insight data to file is supported starting in Cortex XDR version 2.7 which has a planned release date of February 1, 2021. Please see this link for more information regarding feature releases. You can view the version of your tenant by clicking your username in the top-right of your screen and then clicking ""about."" ",1,01-25-2021,12:58 PM
1346,381690,JohnSmith7732,"thats interesting. I wish i could see it but we havent engaged it yet unfortunately so i will learn from you. I think SEP like many other vendors actually completely disables the windows firewall? You may have in fact been vulnerable. I think the cortex only engages the rules you choose. Can you put some context on things it might block? This one would seem to explain a little possibly?By default, host firewall profile rules are based on the current location of your device. Configure two sets of rules: a set ofExternal Rulesthat apply when the device is located outside the internal organization network, and a set ofInternal Rulesthat apply when the device is located within the internal organization network. If you disable theLocation Basedoption, your policy will apply the internal set of rules only, and that will be applied to the device regardless of its location",0,01-22-2021,01:51 PM
1347,381454,dfalcon,Hi@Edmund66-Please let me know if your approach does not work at which time I'd like to gather a little more info to take to Product Management.,0,01-22-2021,05:54 AM
1348,378726,dfalcon,"Hi@efasoformoso-The device control feature is designed to enforce USB-connected devices. If the device is connected via an external SD reader, you may be able to block - I would need to test to verify. You can also block execution from an SD-card by leveraging a restriction profile regardless if the reader is embedded or external.You should be able to block the printer. Here is a list of Windows portable device classes (provided by Microsoft) that Cortex XDR can block.https://docs.microsoft.com/en-us/windows-hardware/drivers/install/system-defined-device-setup-classe...Additionally, you are able to create custom device classes.Hope this helps.",0,01-11-2021,11:19 AM
1349,378726,asoformoso,Thank you for the response!Can printers be disallowed on macOS too?,0,01-15-2021,03:58 PM
1350,378726,dfalcon,"Hi@efasoformoso-At the current time, this is a Windows-only feature. It is based on the device class for Windows. macOS is limited to drives. See doc here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/hardened-...",1,01-20-2021,12:25 PM
1351,380736,gjenkins,"Hi @mdsgn1,If I understand correctly, you want a way to mark tunneled VPN traffic as ""external"" so that the Cortex XDR-Managed Windows Firewall can scrutinize the traffic. If that is accurate, I would recommend disabling the Network Location Configuration setting in the Agent Settings Profile for your target endpoint(s). You can do this by going to Endpoints > Profiles, Editing your target profile, and then disabling the Network Location Configuration item as shown below. Once completed, all traffic will be considered External as there will no longer be tests to evaluate positioning. Please let me know how this works for you.PS: As an alternative, you can also configure the Network Location Configuration to test for an IP or Domain that you know will fail over the VPN tunnel. However, this would require more advanced knowledge of the network configuration.",1,01-19-2021,11:17 AM
1352,380736,mdsgn1,"Thank you for the reply!Then it is as I understood it from the start, I guess there are workarounds, but no simple and direct way of keeping the automated detection and switching.",0,01-20-2021,08:46 AM
1353,380708,jcandelaria,"Once you create the Profile under Endpoint Management > Policy Management > Extentions Profile then you can now attach the profile to the policies in Extentionguide: https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/apply-sec...In step 6:You can use the Active Directory filter column to select target endpoints (assuming your directory sync is setup and working properly).guide:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...If you are using the Active Directory column when filtering a target and its not detecting the right endpoints, you can submit a case so we can further investigate it.",0,01-19-2021,06:56 AM
1354,380708,HafisM,"Thanks for reply jcandelaria,It seems we have some issue within the directory syncWill raise this issue with PaloAlto.Thanks",0,01-20-2021,12:37 AM
1355,380061,dfalcon,Hi@Elroykhlo-I have seen Cortex XDR installed alongside Carbon Black during evaluations with no issues.Third party products with known compatibility issues can be found here:https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/cortex-xdr-compatibility-with-thir...Hope this helps - please let me know if you have any questions.,0,01-15-2021,06:57 AM
1356,380061,jcandelaria,"Here is the exclusion that you can use.Also during the deployment, test them side by side first in report mode then switch to block mode after testing.https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-2/cortex-xdr-agent-admin/cortex-xdr-agent-for-...",0,01-15-2021,08:29 AM
1357,380061,Elroykhlo,"Hi David, Thanks for your reply. it doesn't seem to have carbon black on the list of third party support. ThanksBest Regards,Elroy",0,01-17-2021,04:55 PM
1358,379321,dfalcon,Hi@RomainCouvreur-I'm not sure I understand the ask. Are you looking for a report that shows you malware events (to include the host) that need your attention? Or do you want to see all hosts that had malware events that also may have had preventions?,0,01-12-2021,08:13 AM
1359,379321,RomainCouvreur,"Hello David,Thank you for your prompt reply.We are looking for a report that shows us malware events (to include the host) that need our attention.Best regards.",0,01-12-2021,08:47 AM
1360,379321,dfalcon,"Hi@RomainCouvreur-The XQL xdr_data dataaset does not include alert data. Until that dataset is exposed, the easiest way to look for the rare cases that need your attention is to filter for XDR agent and post detections in the alert table as shown below.",0,01-12-2021,07:15 PM
1361,374472,gjenkins,"Hi@aborgoENGIE,Given the information provided, it would seem that you have an inquiry for XSOAR, not XDR. I recommend posting your inquiry on the XSOAR Discussion board for assistance.",0,12-15-2020,08:47 AM
1362,374472,Kennedy,"ype of incident (injury, near miss, property damage, or theft) Address. Date of incident. Time of incident. Name of affected individual. A narrative description of the incident, including the sequence of events and results of the incident.",0,12-15-2020,10:56 PM
1363,374472,aborgoENGIE,"Hi gjenkins,You're rightSorry for the inconvenience.Best regards,Alexandre",0,12-17-2020,06:58 AM
1364,374472,WhitneyBenson,Thank you for posting something like thistellpizzahut,0,01-12-2021,01:53 AM
1365,378601,gjenkins,"Hi @nikoo,Everything that you're doing sounds correct to me. And the fact that you were successful using the absolute path on one occasion indicates that you indeed have an environment variable issue. One question, however, on the target endpoint, if you enter ""echo %USERPROFILE%"" does it return ""C:\Users\<username>?"" If they match, then you have a bug with Cortex XDR agent, which should go to Support. If not, your variable has to be adjusted.",0,01-08-2021,02:32 PM
1366,378205,dfalcon,"Hi@KRisselada-I will share this feedback with the appropriate Product Managers today. As an FYI, this update will apply to all tenants.",2,01-06-2021,11:39 AM
1367,378205,KRisselada,Outstanding@dfalconThanks so much.,0,01-06-2021,11:42 AM
1368,378205,dfalcon,"Hi@KRisselada-I spoke with one of the Product Managers. For these types of emails, the changes will apply to all tenants across the board. All maintenance is conducted outside of what is considered normal working hours for the given region. Unless otherwise specified in the communication, there should be no outage.",1,01-06-2021,11:50 AM
1369,376055,dfalcon,"Hi@CraigV123-While I'm not an end-user / admin, I can speak to its functionality. For Cortex XDR Prevent environments, Directory Sync allows the ability to leverage AD OU's and groups to assign policy. This may or may not help much depending on the use of different policy rules for groups. For Cortex XDR Pro -- Directory Sync serves a much deeper role. In addition to the policy benefits, Directory Sync provides the data needed for event context enrichment.",1,01-05-2021,07:49 AM
1370,376055,FirewallGuyTwo,"For Cortex XDR, can AD sync help with detecting unprotected/not checking-in endpoints? E.g. point AD sync to a specific computer OU and get alerts if endpoint list does not match the OU list?Thanks!",0,01-05-2021,08:07 AM
1371,376055,CraigV123,Thank you for the additional insight!,0,01-05-2021,08:14 AM
1372,376055,CraigV123,I'd be really curious on the answer to that as well. I'm not sure but it'd be nice to do that in order to find unprotected endpoints out there! Thank you.,0,01-05-2021,08:15 AM
1373,376055,WSeldenIII,"In terms of network asset visibility, if you have a Cortex XDR Pro per TB or Cortex XDR Pro per Endpoint license, then you may leverage Asset Managementdistinguish between assets managed and unmanaged by an XDR agent. You may view details about an endpoint to determine the operational status (E.g. protected vs. unprotected) of the endpoint.",2,01-05-2021,09:24 AM
1374,376055,dfalcon,@WSeldenIIIis correct. You would just need to use the Agent Installed = Nofilter under Assets > Asset Management.,0,01-05-2021,10:43 AM
1375,377947,dfalcon,Hi@Marcelo_Campos-The amount of space used varies. There are no signature files which take up space. The agent setting sets the maximum amount allowed -- then it is first in first out. Most of the consumption will be found in c:\programdata\cyvera,2,01-05-2021,06:24 AM
1376,374729,gjenkins,"Hi @A_Adamski,Correct, a Wildfire verdict should be available after several minutes on average. However, some considerations could delay or prevent an expedient verdict delivery, such as network issues, queuing, file size, and sample upload limit. To pinpoint exactly where the issue may lie, engaging Palo Alto Support and providing them with the alert data and potentially the tech support data from the endpoint would help them determine exactly why an endpoint or a set of them are not receiving the verdict.As for files being blocked due to a verdict of ""malware"" and then changed to ""unknown"" or ""benign,"" it is an infrequent occurrence called verdict flipping. Cortex XDR synchronizes verdicts received from Wildfire every thirty to sixty minutes to ensure that it has the latest information and then delivers that to the agents when they check-in during its five-minute heartbeat. This verdict change is often the result of further analysis being performed on a file due to internal WildFire processes or a Cortex XDR user submitting an ""Incorrect Verdict"" request from the Cortex XDR Console. More information can be found here:Report an incorrect verdictVerdictsPlease let me know if you have any other questions.",1,12-16-2020,05:18 PM
1377,374729,A_Adamski,"HeyGjenkins,Thank you for your help.Let me check the links you've supplied, butas I assume if I'll see this happening again the best thing to do is to collect the logs and involve the PA TAC.Let's say the file has been successfully uploaded to WildFilre, the Endpoint does not have any network-related issues, and the file does not exceed 100 MB, so in such a case I should expect the WF verdict and the report within 15-30 min, is that right?I'm wondering how long the detailed analysis and report generation in WF can take time and if there are any other cases when it takes longer to finish after uploading the file to the WF cloud of course (without the things you've already mentionedas network issues, queuing, file size, and sample upload limit).Best Regards.",0,12-18-2020,03:48 AM
1378,374729,gjenkins,"Hi@A_Adamski,In my experience, the average verdict delivery time is seven minutes after WildFire produces the verdict. The detailed analysis report usually arrives with the verdict in the same timeframe. If it takes longer than an hour to receive the verdict and/or report, that would be something to escalate to Support as well.Note: There aren't any official times offered in Palo Alto Networks documentation in terms of the verdict or report delivery, and these times are only my observations.Please let me know your thoughts.",1,12-18-2020,10:55 AM
1379,374729,A_Adamski,"Dear Gjenkins,My best wishes in the New Year.Thank you very much for your help and the knowledge you've shared as you've clarified all my doubts.I don't face this issue anymore, but if it will happen again in the future, I'll be reaching out to the PA TAC Support.Thank you and my best regards,Arek",1,01-05-2021,03:17 AM
1380,377671,KRisselada,"I find that as of 17 Dec, there was at least two different BIOC Rules that were added. Are you seeing those in your instances?SunBurst domain accessSunBurst Module loaded",0,01-04-2021,08:49 AM
1381,377671,gjenkins,"HI@OsamaKhan,Palo Alto Networks' Unit 42 published a blog about this recently where it was stated that the Cortex XDR agent offers protection using several modules. From Unit42:""Cortex XDR customers are protected using the product’s WildFire integration, as well as through the Local Analysis, the Password Theft Protection module, and the Behavioral Threat Protection (BTP) engine. Protections are continually being evaluated, developed, and deployed for Cortex XDR.""Read more here: https://unit42.paloaltonetworks.com/fireeye-solarstorm-sunburst/?utm_source=bambu&medium=social&camp...",1,01-04-2021,11:03 AM
1382,377671,kcross,"In addition to the Unit 42 blog, please see the latest information about new agent protection mechanisms, new XQL queries and detection rules at:https://blog.paloaltonetworks.com/2020/12/cortex-solarstorm-variants-imitators/",1,01-04-2021,12:38 PM
1383,376867,KRisselada,"also I should note that this LIVEcommunity discussion area seems to create a new avatar for discussions, if you happen to use a different browser, (but the same Palo Alto CSP account)",0,12-31-2020,03:44 PM
1384,376867,gjenkins,"Hi @KRisselada,The referenced alert's alert source is ""PAN NGFW,"" indicating that it was sourced directly from a PAN firewall, not Analytics. With that said, Cortex XDR logic dictates that all PAN NGFW alerts resting in your CDLs should have a corresponding alert in their respective Cortex XDR tenant unless an alert exclusion was created to suppress that alert type. As such, I think that you may have identified a bug as you have verifiable alerts from the NGFWs of which are not shown in Cortex XDR as expected, which should be investigated by Support. If you are confident that no alert exclusion was created to suppress, please escalate to them at http://support.paloaltonetworks.comto investigate.",1,01-04-2021,12:03 PM
1385,376613,gjenkins,"Hi@AlCurran,That is a great suggestion, indeed.For an immediate solution, you can add a comment after performing the bulk upload by selecting the checkbox next to the target IOCs, right-clicking, and then selecting ""edit selected."" The comment field will be editable from there. To make the selection easier, you can filter by modification date to find the IOCs created only when uploaded. As for submitting a feature request to submit a comment at upload, I recommend submitting that to your Account team directly as I do not believe that they monitor this discussion board.",1,12-29-2020,02:24 PM
1386,376613,AlCurran,"Great work around, thanks!Yeah I’ve suggested it via our account team but haven’t heard back. Just wanted to know if this was something others would be interested in. It’s a small addition but would really help our manual IOC process.Thanks for your reply!",0,12-29-2020,03:48 PM
1387,375757,gjenkins,"Hi @mkakara,The jobs may well still be in progress. However, given that you've probably encountered a bug requiring a detailed investigation, I recommend creating a case with Support at https://support.paloaltonetworks.com/. The Support engineers will verify if or not the jobs are truly still in progress or if a bug has been encountered.Please let us know the results of the case when you have the opportunity.",0,12-23-2020,09:33 AM
1388,373986,gjenkins,"Hi @KanwarSingh01,I think that you will find what you need at a Palo Alto Networks Fuel User Group. While they don't have a user group dedicated to threat hunting just yet, you can petition to have a special interest group created.https://www.fuelusergroup.org/Let me know what you think.",1,12-16-2020,10:20 AM
1389,365033,gjenkins,"Hi @KanwarSingh01,The Cortex XDR Agent is capable of collecting the contents of memory, and the instructions to do so are at the following link, on Step 9: Add a New Agent Settings Profile.Please give it a shot and let me know if that worked for you.",0,12-11-2020,11:26 AM
1390,365033,KanwarSingh01,"Hi,We already do the full dump of process but when we launch the dump in volatility to analysis the headers, Dump is not able to match any profile in volatility due to which we cannot analysis the dump file.If there is a way we can analysis these dump files with volatility that will be nice.RegardsKanwar",0,12-11-2020,03:42 PM
1391,355745,gjenkins,"Hi@Poobes,With Cortex XDR Version 2.5, the Data Ingestion Dashboard was introduced to show the logs being ingested from external sources. In particular, you can hone in on the vendor, product, or device as would be needed to identify your Fortigate. Please see this link regarding the Data Ingestion Dashboard and view it in your own XDR tenant by going to Reporting > Dashboards and selecting the ""Data Ingestion Dashboard"" on the top-left of your screen.Sample Screenshot ",1,12-11-2020,12:13 PM
1392,351121,gjenkins,"Hi @BenHooper,I hope that all is well.Your Account team handles roadmap inquiries. Please reach out to them directly as those plans are not discussed on this platform.",0,12-11-2020,11:53 AM
1393,363431,gjenkins,"Hi @lmschander,It's unfortunate to hear about the troubles encountered while collecting a memory dump.XDR Version 2.1, released in February 2020, implemented the capability to collect the contents of memory. You can read about that release here, and the instructions to enable it are here.As for downloading files greater than 500MB in size, I'd recommend using a file splitting tool like 7Zip to get the job done. Once split (how to split a file using 7zip,) you can use the File Retrieval feature in the Action Center. You can select up to twenty at a time, which, I hope, is helpful to you.Finally, as for submitting feature requests, your Palo Alto Networks Account or Customer Success teams are waiting to receive that feedback. Please do not delay in getting your suggestions to them!",0,12-11-2020,11:48 AM
1394,365349,KanwarSingh01,"Can you please post the alert details?You can actually make an exception based on the filename, signer or various other methods etc.. under the Invetigation tab > Exclusions.",0,11-24-2020,01:25 PM
1395,365349,gjenkins,"Hi BillStrahan,It would be beneficial to post the ""alert source"" and ""alert name"" values observed when executing the GoToMeeting file. Adding to the allow list, as instructed here, would only work if the ""Alert Source = 'XDR Agent'"" and the ""Alert Name contained 'malware.'"" Other alert sources and names have different instructions for creating exceptions to permit a file to run. For example, an alert with ""Alert Source = 'XDR Agent'""and the ""Alert Name = 'Behavioral Threat,'"" would need a BTP exception rather than a whitelist to permit execution.More information about the different ways to make exceptions can be found here: Add a New Exceptions Security Profile.Please let us know your findings.PS. Given that the hash changes frequently, there are two other ways to permit the GoToMeeting file to run if it is being categorized as malware, and that is by adding the signer to the Allow List Signers ('Malware Security Profile' > 'Allow List Signers,') or to a Files/Folders allow list ( 'Malware Security Profile' > 'Files/Folders in Allow List.')",1,12-04-2020,10:14 AM
1396,365349,dfalcon,"Hi@BillStrahan-For this very ""installer,"" the Trusted Publisher feature was introduced over 4 years ago. The Trusted Publisher feature should allow the installer to run. I recommend contacting Support if you are seeing blocks tied to the GTM installer.",0,12-06-2020,10:47 AM
1397,365349,EddieRowe,Our prior AV solution began having fits with Goto products about a year ago. As paying customers we begged the LogMeIn vendor to stop changing the hash of the file each time it was downloaded to no avail. We were forced to place the vendors certificate on the allow list since this crippled the organization. We have not run into any issues with the Goto products with Cortex XDR Prevent 7.1.3 on Windows (don't do Mac/Linux).,0,12-08-2020,08:54 AM
1398,365349,gjenkins,"Hi@BillStrahan,Were you able to successfully add the GoToMeeting executable to the allow list using any previous suggestions?",0,12-11-2020,09:19 AM
1399,373556,gjenkins,"Hi@EddieRowe,I'd recommend trying the following:""Content Version != 15*-*""Please let me know how it works out.",0,12-10-2020,08:36 AM
1400,373556,EddieRowe,"Excellent suggestion, but it does not return any results when I know I have some. I also tried ""!= 15*"" without any matches.",0,12-10-2020,02:45 PM
1401,373556,gjenkins,"Hi@EddieRowe,Did you clear out your filter before doing so? Here are screenshots of the filter working perfectly on a lab tenant. Could you post screenshots of yours perhaps?",0,12-10-2020,02:58 PM
1402,370994,gjenkins,"Hi@Sergio_Gonzalez,I recommend posting your inquiry to the XSOAR LiveCommunity pageas its members are well-experienced in the XSOAR platform.",0,12-09-2020,01:40 PM
1403,343002,dfalcon,"Hi@Bruno_Alipio-There are several pre-reqs that must be checked off before enabling an encryption policy. They can be found here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/harde...Since you are having issues with decryption, it is best to contact Support for assistance.",0,08-10-2020,06:58 PM
1404,343002,Bruno_Alipio,,0,08-11-2020,01:52 AM
1405,343002,gbagita,"Hi Dfalcon,Is there a tool or some some log which can show, what prerequisites are not met? I have some PC's I think are compliant, but the Disk Encryption Visibility portal doesn't share my opinion. And I don't know what is the problem.",0,12-09-2020,05:29 AM
1406,366835,gjenkins,"Hi Samuraihack,While traditional anti-virus software may have locked files during its scanning, it would be more accurate to say that there are multiple components within the Cortex XDR's multi-method protection approach, preventing a process from running or functioning successfully if the proper exceptions have not been made. Information about the file analysis and protection flow can be found here.Creating rule exceptions would be the next step to permit your software to run after determining through your investigations which Cortex XDR Agent module is preventing the software from executing successfully. I will note that this investigation may require advanced knowledge of the environment and an intermediate understanding of the architecture for the Cortex XDR Agent.Please have a look at the following video to learn more.Exceptions in TMS and Cortex XDRNote: The Cortex XDR portion begins at 2:41.",1,12-02-2020,02:59 PM
1407,366835,samuraihack,Thanks for the reply! This certainly clarifies my doubt. We offered our customer the option to reschedule the scans to a more convenient time or to configure the required exceptions.,0,12-08-2020,12:42 PM
1408,350693,dfalcon,Hi@chetan85-Sorry no one has gotten back to you in a more timely manner. Yes it can. Do you have specific questions?,0,12-06-2020,10:41 AM
1409,351057,dfalcon,"Hi@BenHooper-I will look into thee authentication option, although I won't be able to post roadmap information in the forums. In the interim, have you tried leveraging an XQL with a BIOC based on those results?",0,12-06-2020,10:38 AM
1410,351389,dfalcon,Hi@BenHooper-Please check in with your Cortex account team for info on this functionality. We are not authorized to give roadmap info over public forums.,0,12-06-2020,10:31 AM
1411,358194,gjenkins,"Hi JSannake,It looks like you have a query for the XSOAR community. I would recommend posting this inquiry in their Live Community section.",0,12-03-2020,01:10 PM
1412,363535,gjenkins,"Hi AsifSid,I'd recommend starting by gathering more information about the alert by viewing the Causality Chain, which details the activities involved in suspicious behavior. This can be accessed by right-clicking on an alert, hovering over ""Investigate Causality Chain,"" and choosing a resulting option.After determining whether the alert is a true- or false-positive, you can take your next steps:In general, creating rule exceptions is discussed here (Skip to 2:41 of the video.) However, given the information you've provided, you'll likely create a Java Deserialization exception as documented here.",0,12-02-2020,05:19 PM
1413,352738,gjenkins,"Hi Marcelocampos,Currently, the Cortex XDR Agent does not support .zip files for analysis regardless of the delivery method. More information about supported file types can be found here.",0,12-02-2020,04:29 PM
1414,351138,gjenkins,"Hi BenHooper,The Cortex XDR console should include those MITRE ATT&CK technique numbers as of version 2.6.5. Could you confirm?",1,12-02-2020,04:22 PM
1415,363396,gjenkins,"Hi RPassos123,Mitre Technique and Tactic information can be conveyed to your Syslog server using an Alert Notification. In order to send Alert Notifications, you'll want to follow these directions:1. Integrate a Syslog Receiver2. Configure an Alert Notification Using a Syslog Server3. Refer to the Alert Notification Format document to find the Mitre fields.Once complete, the Mitre fields will appear in the Syslogs as shown in the following image:",1,12-02-2020,03:39 PM
1416,325350,dfalcon,"Your best bet is to use verbose logging and check the log.msiexec.exe /i YouPackageName.msi /L*V Agent.logAfter it fails, open the agent.log file and search near the bottom for the error.Also, you will want to confirm that there are no conflicts from this matrix.https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/cortex-xdr-compatibility-with-thir...",1,04-29-2020,08:14 AM
1417,325350,CraigV123,I'll give it a shot. Thanks for the update!,0,04-29-2020,08:49 AM
1418,325350,RaviOne,Hello Everybody.I have similar problem like CraigV123. I'm trying to install the Agent on a Win 10 machine and every time it rolls back. I even got the log but I cant really figure out the problem. Can someone can help me?,0,12-02-2020,01:49 AM
1419,325350,gjenkins,"Hi RaviOne,I'd recommend opening a support ticket in the Customer Support Portal to help resolve your issue and avoid exposing your endpoints' sensitive information.Best,Gjenkins",0,12-02-2020,01:47 PM
1420,365158,gjenkins,"Hi DJohnson84,Okta Log ingestion, and Saas Log Collection as a whole, is only available with the Pro-Per-TB license. If you visit the following link, it will fall under the section titled “Other logs (From Palo Alto Networks and third-party sources).”Features by Cortex XDR License Type",0,11-25-2020,07:28 AM
1421,357938,KanwarSingh01,"Hi There,Cortex is not meant to do web filtering. You can enable host firewall which will do only layer4-layer3 level filtering but not layer 7 filtering.Cheers",0,11-24-2020,01:41 PM
1422,364537,KanwarSingh01,You can create groups based on Linux and Windows OS or whatever way you would like to create your group differentiater as. Under Endpoints > Endpoints Groups > Add Groups.Once you have done this create a new agent profile where you enable auto upgrade based on your preference thereafter create a policy where you attach the newly created agent profile for upgrade and only attach the policy to specific endpoint groups.Step: 1> Setup global Agent Auto Upgrade settings (Be careful of your internet link saturation.)Step: 2> Setup Endpoint Groups as per requirement.Step: 3> Create Agent Profile. Enable auto-upgrade in profile.Step: 4> Apply profile to endpoint policy based on groups.Step: 5> Test before production.,0,11-23-2020,04:51 PM
1423,350908,KRisselada,Would also love to hear or see more about this question.Responding to it in hopes it will pop on the top of the queue for more folks to see and perhaps share info or resources,0,10-21-2020,01:38 PM
1424,350908,cohen,"XDR Analytics BIOC - These are analytics alerts based (mainly) on single events. They are similar to BIOCs, except they also account for a profile of how common or rare something is. Examples are ""Uncommon local scheduled task creation via schtasks.exe"", ""Microsoft Office Process Spawning a Suspicious One-Liner"" and ""Uncommon user management via net.exe"". They are single event (execution of something) that is rarely seen in the environment.XDR BIOC - These are behavioral IOCs, looking for abnormalbehavior but not with specific hashes, IPs or domains. An example is""Binary file being created to disk with a double extension"" - this rule is not looking at who created the file or what the file is, it's looking for the fact that a file was created with this attribute. Another example is ""PowerShell runs base64-encoded commands"", ""Windows certificate management tool makes a network connection"" and ""Script file added to startup-related Registry keys"".NGFW - These are alerts generated by Palo Alto Network Next Gen Firewall as traffic is going through it.XDR IOC - These are simple IOC matches, including hashes, IPs, domains, files, etc.XDR Analytics - There alerts are similar to Analytics BIOCs, however they are multi-event. An example can be ""Random-Looking Domain Names"" - this alert groups multiple DNS queries that seem random and alerts when it sees several of them. Additional examples are""Recurring Rare Domain Access"", ""Failed Connections"" and ""DNS Tunneling"".XDR Managed Threat Hunting - These are alert generated by our Managed Service.XDR Agent - These are alerts generated by the agent itself on the machines. All other alert type above (expect the FW) are generated using the telemetry XDR collects in the cloud, but this one is done by the agent locally when it sees suspicious behavior in real time. Alerts can be malware related, restrictions, exploits and more.",0,11-20-2020,01:29 AM
1425,363195,dfalcon,"Hi@Tommy_Hsu-Yes. For the specific agent versions, you can get the most up to date information here:https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...",0,11-19-2020,07:33 PM
1426,363195,Tommy_Hsu,"Thanks, It help alot",0,11-19-2020,07:40 PM
1427,361894,dfalcon,Hi@Abdul_Razaq-Do you see any specific messages in Response > Action Center > All Actions pertaining to the upgrade attempt?,0,11-19-2020,07:30 PM
1428,356488,JohnSmith7732,well thats not as bad as 130% and we know thats possible. Its probably 100% of allocated space but there are plenty of other reasons for it to appear consumed. Most security products rely on some kind of certificate recognition to ignore apps. Wouldn't think you'd need to whitelist or exclude anything from scan.,0,11-13-2020,10:52 AM
1429,352376,Coldfirex,Did you open a case on this? We would be curious.,0,10-27-2020,12:35 PM
1430,324361,dfalcon,"Hi there-I haven't tested this, so I'm going to reach out to the Product Manager of this feature to inquire. In the meantime, here is the published process:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/harde...I expect to have a direct answer to your question within the next 24 hours.",0,04-22-2020,01:42 PM
1431,324361,hhiggins,"Thanks@dfalcon.I have been through that document prior to posting. I wasn't clear what, if anything, I needed to do for my use case. I will wait to hear back from you if this is even possible.Thanks",0,04-22-2020,01:51 PM
1432,324361,dfalcon,"Hi there-I inquired about configuring Bitlocker outside of Cortex XDR, but viewing the encryption status inside of Cortex XDR. To quote the Product Manager responsible for this feature: ""Yes, that is correct... we will show each drive and its encryption status.""That being said, I'm going to try to and configure this in my lab today or tomorrow (depending on work schedule) to take a look.",0,04-23-2020,05:38 AM
1433,324361,hhiggins,Thanks@dfalcon! Looking forward to your update.,0,04-23-2020,08:14 AM
1434,324361,dfalcon,Hi @hhiggins -Can you please browse to Endpoints > Disk Encryption Visibility and let me know what shows up for you.,0,04-23-2020,07:30 PM
1435,324361,hhiggins,I see bitlocker information as you do in your screenshot! When I looked before posting it was empty I swear 🙂Thanks,1,04-24-2020,05:50 AM
1436,324361,dfalcon,That's great to hear!,0,04-24-2020,05:55 AM
1437,324361,nobrega,Hi@dfalcon In this scenario would Cortex have access to the backup recovery keys and would we have the ability to retrieve them and use them?,0,10-20-2020,02:27 PM
1438,355657,suna,"It's formatted using CEF. Logstash has a CEF codec plugin but it mostly just rewrites the keys or field names. Any items withe the string ""Label"" in the key are in fact providing the key name for the related non-label key=valueSo:cs6Label=Pantscs6=TrueCan actually be consolidated toPants: TrueI recommend checking out nxlog as it has a very straight forward CEF->JSON conversion that would allow you to feed in json to logstash and hit the ground running.Then you could construct a bunch of mutate filters like below to consolidate those fields.....# Match labels to values and remove other fieldsif([deviceCustomString1] and [deviceCustomString1Label]) {mutate {add_field => [ ""%{deviceCustomString1Label}"",""%{deviceCustomString1}""]remove_field => [""deviceCustomString1Label""]remove_field => [""deviceCustomString1""]}}if([deviceCustomString2] and [deviceCustomString2Label]) {mutate {add_field => [ ""%{deviceCustomString2Label}"",""%{deviceCustomString2}""]remove_field => [""deviceCustomString2Label""]remove_field => [""deviceCustomString2""]}}if([deviceCustomString3] and [deviceCustomString3Label]) {mutate {add_field => [ ""%{deviceCustomString3Label}"",""%{deviceCustomString3}""]remove_field => [""deviceCustomString3Label""]remove_field => [""deviceCustomString3""]}}if([deviceCustomString4] and [deviceCustomString4Label]) {mutate {add_field => [ ""%{deviceCustomString4Label}"",""%{deviceCustomString4}""]remove_field => [""deviceCustomString4Label""]remove_field => [""deviceCustomString4""]}}if([deviceCustomString5] and [deviceCustomString5Label]) {mutate {add_field => [ ""%{deviceCustomString5Label}"",""%{deviceCustomString5}""]remove_field => [""deviceCustomString5Label""]remove_field => [""deviceCustomString5""]}}if([deviceCustomString6] and [deviceCustomString6Label]) {mutate {add_field => [ ""%{deviceCustomString6Label}"",""%{deviceCustomString6}""]remove_field => [""deviceCustomString6Label""]remove_field => [""deviceCustomString6""]}}if([deviceCustomNumber1Label] and [deviceCustomNumber1]) {mutate {add_field => [ ""%{deviceCustomNumber1Label}"",""%{deviceCustomNumber1}""]remove_field => [""deviceCustomNumber1Label""]remove_field => [""deviceCustomNumber1""]}}if([deviceCustomNumber2Label] and [deviceCustomNumber2]) {mutate {add_field => [ ""%{deviceCustomNumber2Label}"",""%{deviceCustomNumber2}""]remove_field => [""deviceCustomNumber2Label""]remove_field => [""deviceCustomNumber2""]}}if([deviceCustomNumber3Label] and [deviceCustomNumber3]) {mutate {add_field => [ ""%{deviceCustomNumber3Label}"",""%{deviceCustomNumber3}""]remove_field => [""deviceCustomNumber3Label""]remove_field => [""deviceCustomNumber3""]}}if([deviceCustomNumber4Label] and [deviceCustomNumber4]) {mutate {add_field => [ ""%{deviceCustomNumber4Label}"",""%{deviceCustomNumber4}""]remove_field => [""deviceCustomNumber4Label""]remove_field => [""deviceCustomNumber4""]}}if([deviceCustomNumber5Label] and [deviceCustomNumber5]) {mutate {add_field => [ ""%{deviceCustomNumber5Label}"",""%{deviceCustomNumber5}""]remove_field => [""deviceCustomNumber5Label""]remove_field => [""deviceCustomNumber5""]}}if([deviceCustomNumber6Label] and [deviceCustomNumber6]) {mutate {add_field => [ ""%{deviceCustomNumber6Label}"",""%{deviceCustomNumber6}""]remove_field => [""deviceCustomNumber6Label""]remove_field => [""deviceCustomNumber6""]}}if([flexNumber1Label] and [flexNumber1]) {mutate {add_field => [ ""%{flexNumber1Label}"",""%{flexNumber1}""]remove_field => [""flexNumber1Label""]remove_field => [""flexNumber1""]}}if([flexNumber2Label] and [flexNumber2]) {mutate {add_field => [ ""%{flexNumber2Label}"",""%{flexNumber2}""]remove_field => [""flexNumber2Label""]remove_field => [""flexNumber2""]}}if([flexNumber3Label] and [flexNumber3]) {mutate {add_field => [ ""%{flexNumber3Label}"",""%{flexNumber3}""]remove_field => [""flexNumber3Label""]remove_field => [""flexNumber3""]}}if([flexNumber4Label] and [flexNumber4]) {mutate {add_field => [ ""%{flexNumber4Label}"",""%{flexNumber4}""]remove_field => [""flexNumber4Label""]remove_field => [""flexNumber4""]}}if([flexNumber5Label] and [flexNumber5]) {mutate {add_field => [ ""%{flexNumber5Label}"",""%{flexNumber5}""]remove_field => [""flexNumber5Label""]remove_field => [""flexNumber5""]}}",0,10-15-2020,03:03 AM
1439,355657,suna,"Here is an example nxlog excerpt to convert cef to json.<Input xdr_cef>Module im_fileFile ""/var/log/xdr*log*""Exclude ""/var/log/xdr*bz2""Exec parse_syslog(); parse_cef($Message);</Input><Output xdr_json>Module om_fileFile '/var/log/xdr' + strftime($EventTime, '%Y-%m-%d') + '.json'Exec to_json();</Output><Route main>Path xdr_cef => xdr_json</Route>",0,10-15-2020,03:07 AM
1440,355657,sam_miller,"Thanks, that's useful infoMy actual issue was that the log message seemed to have multiple formats;- First some content that was space-delimited;- Then some content that was pipe-delimited;- Then some key-value contentMaybe that's standard for CEF?In any case, this is the Logstash filter I used which seems to have done a good job of pulling it all apart;filter {grok {match => { ""message"" => ""<%{NUMBER:xdr.system}>%{NUMBER:xdr.event} %{TIMESTAMP_ISO8601:xdr.timestamp} %{DATA:xdr.source} %{DATA:xdr.e1} %{DATA:xdr.e2} %{DATA:xdr.e3} %{DATA:xdr.e4} %{DATA:xdr.format}\|%{DATA:xdr.company}\|%{DATA:xdr.platform}\|%{DATA:client.version}\|%{DATA:client.system}\|%{DATA:alert.title}\|%{INT:xdr.unknown}\|%{GREEDYDATA:alert.message}"" }}kv {source => ""alert.message""target => ""data""}}",0,10-15-2020,07:16 PM
1441,355657,suna,"You are correct in that everything starting with and after the string CEF is the Arcsight CEF format. The portion prior to that is a syslog header. If you use the current stable filebeat it includes native CEF parsing to ECS.I have to say I was quite surprised at PAN's selection of CEF for the syslog messages but JSON for the email alerts. It also surprised me that their were far fewer fields provided in the CEF messages than the JSON emails (albeit a ton of fields are null),",1,10-17-2020,04:19 AM
1442,355657,sam_miller,"I suspect the JSON format was chosen for it's flexibility, as Cortex alerts come in multiple types (Malware [both Local and Wildfire], Firewall/Strata, Analytics (e.g. Recurring Rare IP Address or Large Upload). Each type has it's own unique set of fields - you get source & dest port in Firewall log alerts, but not in Local Malware, for exampleKeeping the CEF format makes sense as I'm sure PANW has many 'Enterprise' customers running centralised logging servers that incorporate logs from multiple vendors. To cover that situation they'd want to be able to 'fall back' to something standardised such as CEF. There are also multiple logging formats available for syslog servers, although I haven't tested out the 'legacy' format yet to see how different it is",1,10-17-2020,11:26 PM
1443,353572,dfalcon,"Hi@DJohnson84-I'm assuming you created the install package prior to initiating the upgrade request. Second, I'm assuming the machines show online.How fast is the failure message returning? Is it instantaneous or does it take a few minutes? I'm trying to determine if the issue is originating from client side or server side.",0,10-05-2020,06:13 PM
1444,353572,DJohnson84,"Dfalcon,Thanks for replying.I did create the install package prior, and the machines are showing as connected.The failure message was being received roughly 5-10 minutes after kicking it off.So after reviewing the logs the client side was resetting the connection which was causing the install to fail, but it happened intermittently. So a machine could fail and I could push it back to the same machine and succeed. I would look at the logs and you could see the machine reset the connection the first time and then would allow it.I was able to successfully update all of our physical machines (windows and mac) so it's on to our VM machines :).Again thanks for the reply but this issue has been resolved.",0,10-12-2020,07:42 AM
1445,345089,DKasabji,"Consider two things:1. Windows Defender should be disabled on PC that runs Cortex XDR. If this does not occur automatically, disable it manually as it could intervene with Cortex XDR.2. In case Cortex XDR does not indeed prevent it by default, you can always create a BIOC rule to detect NCAT and then set it as prevention rule inside the Restrictions Profile -> Custom Prevention Rules.Best,David",1,09-13-2020,11:27 AM
1446,345089,EddieRowe,"@DKasabji, I am seeing some devices where Windows Defender Antivirus still have the service running. I disable it via GPO and surprised to see it running on my system. With the new tamper protections I have yet to figure out how to disable the service so it is like it is ""off"" but still running the app behind the scenes. We are not Intune subscribers so there does not appear to be a way to turn it off if Cortex fails to do so.",0,09-15-2020,07:37 AM
1447,345089,EddieRowe,"@tech_noob, doesn't ncat have legtimate uses so in and of itself it is not evil? Do you have the grayware protection enabled? (Just thinking out loud...I am not experienced with Kali or ncat.",0,09-15-2020,07:42 AM
1448,345089,DKasabji,@EddieRoweAren't you able to disable Tamper protection on Windows? That way you can disable Defender via GPO.,0,09-15-2020,02:12 PM
1449,345089,tech_noob,ncat is a legitmate software but it can be used maliciouisly by bad guys. Kali is a network penetration software that is used by white and black hat hackers. I ran ncat on my windows machine and I connected with ncat from my Kali machine. I used ncat (without e) by nmap because the actual netcat (with e) is blocked by windows defender and cortex. We upgraded to Cortex XDR pro and I should be able to create BIOC rules to give me alert when ncat is used in my network.,0,09-15-2020,02:28 PM
1450,345089,tech_noob,I run windows defender along with cortex xdr. I have tamper protection on cortex xdr.,0,09-15-2020,02:29 PM
1451,345089,EddieRowe,"@DKasabji, No it cannot be disabled any longer unless you have an Intune subscription per MS documentation (link below). Our GPO has had Windows Defender turned off for many years now going back to before we added Cortex XDR Prevent to our environment. (The prior solution did not disable automatically so we have always used the GPO setting.) The GPO setting is active and Defender has never been observed doing anything on our systems to my knowledge. But for some reason some systems, all running Win10 v1903, some systems have the Windows Defender Antivirus Service running and others do not. I am going to guess that this was an issue before Cortex XDR Prevent and it was just not noticed. We have an application misbehaving and the vendor claims Windows Defender is the cause so as part of my info gathering I noticed the service running on the system.https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-antivirus/pre...",1,09-15-2020,03:09 PM
1452,345089,tech_noob,I created IOC using ncat.exe and I get an alert from XDR when I tried to use ncat. I will decide later if I should to ahead and block it.I also created IOC tor nmap.exe and tor.exe.,0,10-10-2020,06:08 PM
1453,345185,Ryan_Saulsbury,"You are able to define specific files and folders to exclude from examination and allow for execution.In the Policy you want this to apply to, it's under 'Malware Security Profile' > 'Files/Folders in Allow List'.Here is the link to the documentation that explains the process:https://docs.paloaltonetworks.com/content/dam/techdocs/en_US/pdf/cortex/cortex-xdr/cortex-xdr-pro-ad...",2,09-08-2020,08:26 AM
1454,345185,dfalcon,"Hi@DanieleGerola-@Ryan_Saulsburyis correct. You can allow exclusions in the malware profile. You may have to do this for each component -- portable executables, office docs, scans. I've included a few screenshots where you would do this. The screenshots also have examples of the formatting.PE's and DLLScans",3,09-14-2020,06:30 AM
1455,345185,EddieRowe,My interpretation of the setting for exclusion for files in the Malware profile is only for dormant files when you use the weekly/monthly scan. How do you exclude an entire folder completely?,0,09-25-2020,03:15 PM
1456,345185,EddieRowe,"Ah, I see now... I overlooked the first picture! Thanks! I was not the original poster, but we appear to have a conflict with an encryption product.",0,09-25-2020,03:17 PM
1457,346385,DKasabji,"I see two ways of accomplishing this.1. You can configure your restriction policy by specifying something like *\<name_of_file> in the Executable Files section -> Files / Folders in Block List.2. You can create a BIOC Rule that targets that process and apply it to Restriction policy:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...Best,D",0,09-13-2020,10:46 AM
1458,346385,EddieRowe,"I was hoping to do this with Cortex-XDR Prevent by blocking programs from running from the user profile, but the hashes change too often. I was hoping we could block everything from running and then allow some signed applications to run from the user profile. I have had AppLocker on the list for some time to learn about.",0,09-15-2020,07:52 AM
1459,346385,DKasabji,"For what you just described, I indeed would favor AppLocked approach, since it is designed to perform this.I am not sure about specifics of XDR Prevent, probably does not have all the capabilities that Pro Per Endpoint or Pro Per TB editions, but don't you have in your XDR Interface the option to configure 'Restrictions Profile'? It is in Endpoints -> Policy Management -> Profiles. You locate the Restrictions profile and Edit it.There you will find Executable Files paragraph where it asks you to input Files / FOLDERS in BLOCK LIST or in ALLOW LIST. So perhaps you could leverage this to specify that any executable within %USERPROFILE% is on BLOCK LIST.Is that not possible in XDR Prevent?Best,D",0,09-15-2020,08:15 AM
1460,346385,DKasabji,"Forgot to add before:I think the Block-listing approach is probably not the best, because I haven't tested the combination of Blocking everything in a specified folder, but then allowing a specific .EXE to run in that same folder. Not sure what takes precedence: does XDR first check the allowed list and then moves on to check the block list or vice versa.However, maybe you could configure it in a Allow-list approach by defining a Folder where you would allow the executables to run and everything else is blocked. But probably that is a bit to cumbersome to manage for end-users. Or even specific Files, which is (I think) similar to AppLocker approach.",0,09-15-2020,08:19 AM
1461,346385,EddieRowe,"Yes, Cortex XDR Prevent's Restrictions profile works as you described -- I tested the setup last week. The issue is that it is a maintenance nightmare...it was not really designed with this in mind. You can stop all .EXE files from running from the user profile, but to allow some to run is based on the filename/hash. AppLocker should allow me to setup things so that .EXE files signed by GotoMeeting are allowed, but not others. Oh, and Microsoft keeps stuffing Office 365 stuff under the user profile like Teams, OneDrive, etc.",0,09-15-2020,02:24 PM
1462,346385,DKasabji,"@EddieRoweHm. Then the last thing that comes to mind is to create a Prevention BIOC rule which you can apply to Restriction Profile.You'd create a BIOC something like:Process name: *.exePath: %USERPROFILE% (and any other path you want to prevent EXEs to not run)Signature: SIGNEDSigner: NOT 'GoToMeetings' (etc.)Then you set it in Restriction Profile as the Prevention Rule. This means that everytime an EXE process will execute that is in %USERPROFILE% and it is NOT signed by GoToMettings --> block the execution.Maybe this could help you. But if you already decided on AppLocker, then never mind.Best,D",0,09-15-2020,11:25 PM
1463,346385,DKasabji,"OH crap! I forgot. The 'Prevent' license probably does not have the option to create BIOCs? Have no experience with Prevent license type, my bad.",0,09-15-2020,11:27 PM
1464,346385,EddieRowe,I appreciate the info - Pro was way outside of our budget. I thought for a moment I had overlooked something (and the Palo Alto person who helped with the PoC didn't share this) so it nice to get confirmation I should not see the BIOC options on the web console.,0,09-17-2020,12:45 PM
1465,346385,JosephNil,Thanks for the update and quick reply. I'll be sure to keep an eye on this thread dqfansurvey.,0,09-24-2020,04:48 AM
1466,347323,Ryan_Saulsbury,I believe this is what you are looking for:https://live.paloaltonetworks.com/t5/cortex-xdr-articles/content-release-notes/ta-p/257570,0,09-08-2020,08:13 AM
1467,347323,Marsooq_A,"@Ryan_SaulsburyWhat you provide is informative, But this is not showing the content version, how do i match this with our agents?",0,09-08-2020,09:33 PM
1468,347323,MartinCimone,"Have you tried to ""Subscribe to Content Update Emails"" in Palo Alto Support Account Preferences?https://support.paloaltonetworks.com/SupportAccount/PreferencesMaybe that will be what you are looking for.Have a great day.",0,09-17-2020,05:02 AM
1469,347323,Marsooq_A,I was not subscribed.,0,09-19-2020,09:48 PM
1470,347886,DKasabji,"What do you mean with 'computers does not seem to receive policy' ?Whenever there is some file execution, Cortex XDR will initiate its soo called File Analysis and Protection Flow, which evaluates it's decision based on the defined profiles within the policies applied to the given endpoint.Best,D",0,09-13-2020,09:00 AM
1471,347886,MartinCimone,"A ticket is open with PaloAlto support.Whenever I create a new set of policies, it does not apply to any endpoints. NEVER!Seems to be a ""bug"" within PaloAlto.",0,09-14-2020,04:46 AM
1472,347886,DKasabji,"Hmm. I am sure PA will be able to help you as they can see more details. I know that in our case it is working normally.Have you checked that the policy is correctly applied to the endpoints?Best,D",0,09-14-2020,04:55 AM
1473,347886,dfalcon,"Hi@MartinCimoneYou should be able to force a policy check-in using by leveraging the script execution abilities of the agent. You can initiate a cytool checkin command. More info can be found at:https://docs.paloaltonetworks.com/cortex/cortex-xdr/5-0/cortex-xdr-agent-admin/traps-agent-for-windo...On your underlying issue, have you verified that the affected endpoints fall into the collection/group where the policy rule is applied. If you look at the agent details:1. Do the endpoints show as online?2. Does it show the policy applied ?3. If you initiate a check-in from the endpoint itself, do you see successful communication?",0,09-14-2020,06:04 AM
1474,347886,MartinCimone,"Hi@dfalcon.1. Do the endpoints show as online?YES they are.2. Does it show the policy applied ?Nope. That's my whole problem ...3. If you initiate a check-in from the endpoint itself, do you see successful communication?Absolutely. Targetted endpoints are even receiving content update but are not updating the policy assigned to it.A support case has been opened with PaloAlto and they are still investigating the issue.Thanks for your time 😉",0,09-14-2020,06:08 AM
1475,347886,DKasabji,"Will be interesting to see what the root cause was.Sounds like there is no transmission between Endpoints and Console for only just policies, which is weird.Have you tried accessing the Endpoint via Console through Live Terminal? Or run any script from Action Center? Just to see if you are able to interact with them.",0,09-14-2020,06:11 AM
1476,347886,dfalcon,"Hi@MartinCimone-Can you go to one of the affected machines and make note of the time and click check-in now from the agent interface? Once you have initiated the request, give it a few seconds. Next, open the log file from the same agent interface. Scroll to the bottom and work your way back up. Look for the time you click check in now. Do you see any errors or communication failure messages during that time? This may give us a good starting point to isolate the issue.",1,09-14-2020,06:20 AM
1477,347886,MartinCimone,"Hi@DKasabjiYES, Live Action Terminal, and Script are working perfectly on the targetted endpoint.The problem seems only related to Policy.I'll keep you informed as soon as I got some news from the Palo Alto Support investigation.",0,09-14-2020,07:01 AM
1478,347886,EddieRowe,"Isn't a ""Perform Heartbeat "" under right-click Endpoint Control the way to ask the endpoint to check-in before the 5 minute interval?While I have not had this issue with 7.1.3 Prevent, the first thing I would check is to ensure there are no blocks on your firewall to ensure there is not some odd communication issue.",0,09-15-2020,07:33 AM
1479,348002,dfalcon,"Hi@CChampagne1,I reached out to one of our Cortex XDR Product Managers on this to verify. If the ability to include the hostname is a not available via configuration, I will submit a feature request. I will keep you posted.",0,09-14-2020,06:14 AM
1480,343616,DKasabji,"Hello,Do you need explicit alert?Because there is a Menu where you can see Device Control Violations in Cortex XDR console.Best,D",0,09-13-2020,11:41 AM
1481,345590,DKasabji,"Hello,1. Yes, this will work as you expect it, it will whitelist the child process based on the parent process + child process parameters that you provide. If such behavior is detected by Cortex XDR Agent it will allow to run through.2. As far as I know, there is no way to create exceptions only for a single host other than creating a policy for that specific use case. I would say that this is nothing bad to create such policy, because in your case, this is a very specific exception you want to do. Just remember to re-order it in Policy Management, so that it gets checked first.Best,D",1,09-13-2020,11:20 AM
1482,346834,DKasabji,"In order to get Cisco ASA logs, you would need to spin up a Syslog Collector Applet on your Broker VM. And then you would configure that Syslog Collector to send logs to Cortex XDR.See more:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...",1,09-13-2020,08:01 AM
1483,347666,DKasabji,"Hello,It depends on what you want to do. If the verdict from WF / Local Analysis was benign, the file should've been allowed to run on the endpoint. Please verify that first - was the file allowed to run, or did Cortex prevent it?1. If the file was allowed to run it means that some BIOC rule probably triggered the detection due to Macro-enabled Excel document. In this case what you want to do is create an Exclusion. Exclusions basically hide the alerts that contain such criteria that you define in Exclusion.2. If the file was actually prevented, then you would need to find out which Security profile caused the prevention (Ransomware protection, Malware Protection,..). In this case, it is is probably Anti-Malware protection profile. Edit it and locate the section with Office Files with Macros Examination. In this section you are able to add Files / Folders to Allow List, where you would add this file.Hope this helps.Best,D",2,09-13-2020,07:56 AM
1484,347489,kcross,"Hello Graeme,Please see:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-2/cortex-xdr-agent-release-notes/cortex-xdr-ag...Best regards,Kasey",0,09-08-2020,06:54 AM
1485,347489,Graeme_Riddell,Thanks very much Kasey.,0,09-10-2020,02:39 AM
1486,347633,EddieRowe,"The admin guide was updated for this setting, even though the release notes were not updated.",0,09-09-2020,07:43 AM
1487,332825,Graeme_Riddell,"Hello,I recently had an engagement with the Paloalto Cortex XDR Customer success team and previous to that TAC about Windows Firewall.Cortex XDR pro agent DOES NOT disable the Windows Firewall it actually uses the Windows Framework and both rules In Cortex Host firewall and Windows Firewall are utilised.I have raised a Feature Request to question this design to have either Windows Firewall disabled if using Cortex Host Firewall, or at least a central place to administer overall rules that are taking precedent.As yet I have had no feedback.Kind regards,Graeme",2,07-15-2020,06:13 AM
1488,332825,EddieRowe,"On some Win10 v1903 (x64) systems running 7.1.3 the Windows Defender Antivirus service is set to ""manual"" and others it is set to ""automatic"". I cannot make heads or tails of it. We setup our GPO way before Cortex XDR to turn off Windows Defender Antivirus.GPO Setting:Location: Computer Configuration - Administative Templates - Windows Components - Windows Defender AntivirusSetting: Turn off Windows Defender Antivirus - Set to Enabled (Enabled = it is not supposed to run or scan)",1,09-04-2020,10:41 AM
1489,343862,dfalcon,"Hi@DmitriPoberejnii-The Cortex XDR host-based firewall is IP/port/protocol based as you would find in Windows Firewall. You would have to create entries for the IP's (IPv4 or IPv6) along with the port/protocol information to create the restrictions or allow lists. You would do this under Endpoints > Policy Management > Extensions > Profiles > New Profile > Host Firewall. Once created and saved, you would then apply the entries in your Host Firewall extension profile to an extension policy rule. https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/harde...",0,08-17-2020,12:08 PM
1490,343862,DmitriPoberejniaria-labeli,"Thank you for trying to help here, unfortunately I cant call it a solution for a few reasons: 1) this document was reviewed prior to posting the question here and it is not complete for many reasons 2) It is not apples to apples comparison with Windows firewall. One example of that would be inability to list IP's in the rules using comma, only ranges or individual IP's. I hope Engineering would change that at some point soon.",0,08-17-2020,12:35 PM
1491,344208,dfalcon,Hi@jchurch-The installer should have no bearing on the policy applied. Please check your policy rules to ensure that machines are in the correct filter -- or that they are included.,0,08-17-2020,10:14 AM
1492,344208,jchurch,they all have the same policy applied. see the screenshots below. some just don't have exploit protection  ,0,08-17-2020,10:55 AM
1493,344208,dfalcon,"Hi@jchurch,Okay, thank you. This may require a little more examination. Are the macOS versions all the same? Second, do you know if full disk access (version macOS 10.15 and later) was granted on all clients as per the document below?https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-0/cortex-xdr-agent-admin/cortex-xdr-agent-for-...If these boxes have been checked, we are likely going to need to gather a tech support file (TSF) and reach out to support. The TSF can captured by going to your endpoint list > Endpoint Control > Retrieve Support File.",0,08-17-2020,11:58 AM
1494,339965,dfalcon,"Hi there-For malware, exploits, and most threats - those are blocked immediately based on your malware / exploit profile settings under the endpoint management section.The profiling you are referencing refers to the analytics component. That feature is essentially learning the behavior of the environment based on the computer and user entity. It is learning who is supposed to be doing what — it raises an alert when suspicious behavior is detected based on the behavior not matching that entity. The profiling ranges anywhere from a few days to 4 weeks based on the collector type.",0,07-21-2020,04:36 PM
1495,339965,TonyTovar,"Thanks, David! So, in general, the agent is 'active' and protected the server immediately -- but with some delay for the ""analytics"" portion?Also, I have now learned that there are 3 Cortex XDR licenses and we probably have just the base license (not ""Pro""). So we are not getting EUBA or Network-Traffic Analytics. Was one of those the 'analytics' module to which you were referring? Or, is there also such a module in the base license?",0,08-14-2020,01:48 PM
1496,339965,dfalcon,"HI@TonyTovar,Yes, that is correct. If you are using Prevent, the profiling component is not part of that offering. You have all included protections available immediately.",0,08-17-2020,10:20 AM
1497,339965,TonyTovar,Is 'Prevent' the base-level license?,0,08-17-2020,10:27 AM
1498,339965,dfalcon,"Hi@TonyTovar,Yes. Prevent protects from malware, exploits, advanced threats. It does not include the analytics and some of the other EDR features.",0,08-17-2020,11:40 AM
1499,343130,dfalcon,"Hi@marcelocamposCortex XDR is going to calculate the hash of the file and check with WildFire if a verdict is known. If it is not known, the file (depending on config) will be uploaded for several checks: static analysis, dynamic analysis, and possible bare metal analysis. Once it has been analyzed, that verdict will be retained by WildFire. From that point on, if the file is deemed malware -- your option is to whitelist the file. If you believe that the file verdict is incorrect and you want another check, you can can submit it as an incorrect verdict. At that point, a member of our Unit 42 team, will check even deeper.Regardless of the verdict, if you're trying to investigate what is going on -- I would locate any alerts that are raised -- right click and analyze them. From there, you can get a great deal of information on what was / is going on.Hope this helps.",1,08-10-2020,06:54 PM
1500,342239,ajrechk,"Hi, I believe this may be what you are looking for:You will then find a whitelist option to do a combo of the parent and child process along with any specific parameters",0,08-05-2020,03:38 PM
1501,341628,KRisselada,I should also note I find this in the Cortex XDR Pro Administrators Guide:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...Which doesn't seem to entirely mesh with what have been seeing. Is the Guide correct or is the Production environment of Cortex correct?,0,07-31-2020,10:46 AM
1502,341628,dfalcon,"Hi @KRisselada-There very well may be adjustments to rules (analytics, bioc, etc) with each release. For the behavior you are describing, this should not be typical. In this instance, I recommend reaching out to support/TAC to allow our engineers to take a look.",0,08-05-2020,07:20 AM
1503,341628,KRisselada,"thanks so much@dfalconI did indeed create a request within the Support team and currently its been escalated to Engineering.For those that might have / want a reference of this, its PAN Support Case 01544546. I will share here updates if applicable.",0,08-05-2020,07:46 AM
1504,341628,dfalcon,Hi@KRisselada-I can see that Jacqueline escalated the case to engineering. I will subscribe to the case as well.,0,08-05-2020,08:00 AM
1505,342197,dfalcon,"Hi @BizBo -From a roadmap perspective, we aren't allowed to comment publicly in forums like this. Please reach out to your Palo Alto Networks contact and ask for a roadmap session. You can also ask to sign up for the latest beta. Your Palo Alto Networks can share the answers you are requesting.",0,08-05-2020,07:17 AM
1506,339035,dfalcon,"Hi@leonabarratt-I pulled this from the admin guide - hope it helps.Due to changes in the security settings of macOS 10.15, you must allow Cortex XDR full disk access on your endpoint to enable full protection. If you do not authorize Cortex XDR full disk access on your endpoint, the agent provides only partial protection of files in the/Applicationsdirectory. The first time the Cortex XDR agent detects an attempt to run an executable file located in another protected location on the endpoint as part of the anti-malware flow, macOS will deny the agent access and prompts the user to grant full disk access.",1,07-23-2020,07:27 AM
1507,339290,KRisselada,"just a quick update to this discussion. I spoke with support and this bounced a bit around support but ended up in "" Endpoint Security Support"" team. They setup a quick zoom call to confirm (and also record what was being seen)And have since escalated the question and discussion to Engineering, via a Engineering Escalation.Will update once haveadditional info.Interested if others within the LIVEcommunity also see this behavior in their Cortex instance",0,07-21-2020,03:24 PM
1508,339290,KRisselada,"Received update on the Support case I opened and Support team had escalated to Engineering, the answer back was:Per Engineering - The reason why the customer does not see the incident in Hash, because we are filtering and show only open incident (new/under investigation).It is expected behavior.So at least this is now answered.I also asked to have a Enduser Enhancement request put in that would more clearly indicate that this Filtering is taking place on this Hash View page and if possible, even expose the ability to apply a DIFFERENT filter than the one that is being ""invisibly"" applied currently.",1,07-22-2020,11:35 AM
1509,332170,dfalcon,Hi@LokeshKumar-I'm happy to raise a feature request. How would you envision the status for an incident with multiple alerts with different actions?,0,07-15-2020,07:34 AM
1510,332170,LokeshKumar,"Hi David,Thanks for the reply. PA support team did help me in raising a feature request.Regards,Lokesh Kumar",0,07-21-2020,09:45 PM
1511,332170,dfalcon,Sounds good. I will try to find it and up-vote it.,0,07-22-2020,11:13 AM
1512,336609,dfalcon,"Hi@Mostafa.Elsayed-You will do this at the profile level. Go to Endpoints > Policy Management and select the Profiles option. From there, select the malware profile and add the exceptions as whitelist entries.For the exploit side, go to Endpoints > Policy Management > Global Exceptions and enter the process information there. You can then select the Exploit Prevention Modules that you wish to disable.",0,07-15-2020,07:14 AM
1513,336609,Mostafa.Elsayed,"Hi @dfalconHow you make exception for file extension? also if you have only the process name, how you would fill the parent process box?",0,07-16-2020,12:00 PM
1514,336609,James.Harrison,I am seeing high memory usage on a database server with XDR being the offender. I need to exclude all scanning/ monitoring from the directories where my data and log files live on that drive. Please provide the detail of what and how to accomplish that task.,0,07-16-2020,03:53 PM
1515,338821,dfalcon,"Hi@nnEiji-The agent protection password can be set in the agent settings profile for each specific OS type. To set the password, go to Endpoints > Policy Management > Profiles and either modify an existing profile or create a new one. Ensure you select the correct OS that you want to set -- in this case macOS. Next locate uninstall password, set it, and save it. Make sure that the profile is applied to the correct policy rule that includes the machine you wish to set.",0,07-15-2020,08:59 PM
1516,338821,nnEiji,Thank you for your reply!This problem is solved. I appreciate you!,0,07-16-2020,01:22 AM
1517,338646,dfalcon,Hi@Graeme_Riddell-You can find the release notes here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-1/cortex-xdr-agent-release-notes/cortex-xdr-ag...It looks there was a gap from the time the PM team submitted the documentation vs. the timepublished. Sorry for the delay.,0,07-15-2020,09:11 PM
1518,338646,Graeme_Riddell,Thanks very much David.,0,07-16-2020,01:04 AM
1519,336404,dfalcon,"Hi @Abdul_Razaq,The test PE should not create an incident, but it should create an alert even though it is prevented. I have tested and verified this in the past. For the policy rule applied to the machine what does the malware profile specify instruction-wise?",0,07-15-2020,07:25 AM
1520,337358,Graeme_Riddell,"Hello,The Cortex Host Firewall integrates with Windows Firewall and therefore it is the Windows Firewall logs at the moment you would need to check.Kind regards,Graeme",0,07-15-2020,06:16 AM
1521,334295,KRisselada,"Hello@CJP-PALOALTOI find that if you open up the specific Incident, in the Key Artifacts area, there should be the file itself and then under the Threat Intelligence there is ""WF Benign"" or ""WF Malicious"" (for example) and near it an icon that allows you to click and present the Wildfire Report. From there select the icon on the top right corner of the WF Analysis Report screen and should present workflow to ""Report Verdict as Incorrect"". (see screenshot for details)Hope this helps and I didn't misunderstand what you are requesting.",1,07-02-2020,10:11 AM
1522,333744,dfalcon,There is no migration necessary. The licensing team can make the change on the back-end.,1,06-16-2020,06:57 PM
1523,329046,dfalcon,"Hi @Uriel_Reyes -I have not seen this issue before. The best course of action would be to gather a TSF (tech support file) from the endpoint, then reach out to Support (support.paloaltonetworks.com) so an engineer can dive deeper. To get a TSF, locate an endpoint with the issue from your endpoint list, Right-Click > Endpoint Control > Retrieve Support File.This will take a little while to run. Once it is complete, download the file by going to the Action Center under the Response menu item. Next, select All Actions, then locate the Support File Retrieval entry. Right-click on that entry, then select Additional Data.Now right-click on the entry and download the file.Once you have the file in hand. Log a support case and upload the file to the case. This will speed up the investigation and resolution time.",0,05-21-2020,08:12 AM
1524,329046,timross,This happened to me to. Do not install 7.1. Its not ready for production.,0,05-26-2020,02:32 PM
1525,329046,Uriel_Reyes,"Hello, you have tried the new version of CORTEX7.1.1.49751 do you know if it is more stable and if they corrected this problem that we have in common?regards",0,06-10-2020,11:19 AM
1526,329046,timross,My issue has been resolved with 7.1.1. I am waiting on 7.1.2 before doing a mass roll out.,0,06-10-2020,12:13 PM
1527,331399,BPry,"@Carracido,By memory, that seems about right for the latest agents. If you go into your settings on your XDR instance, there is an option for content bandwidth management that you can enable and set a max allocation for, along with an auto upgrade schedule and agent amount that are customizable that can help you save bandwidth however if that's needed.I believe that this is the limit of managing bandwidth usage by the agents however.",0,06-03-2020,02:41 PM
1528,331399,Carracido,@BPryThank you for your answer.Now the traffic got stable but the day EDR data collection was enabled there was a high increase in received traffic.Do you know if it´s normal that the very first time that EDR data collection is enable this causes high bandwidth consumption to stabilize after some hours?Thank you!,0,06-08-2020,01:21 PM
1529,331399,BPry,"@Carracido,That's an important piece of the puzzle, but yes that's expected as your clients were doing the initial data upload with all of the additional EDR collection records.https://docs.paloaltonetworks.com/traps/tms/traps-management-service-admin/manage-endpoint-policy/tr...",0,06-08-2020,02:08 PM
1530,330411,dfalcon,"Your best bet is to use the WildFire portal to do a hash lookup.https://wildfire.paloaltonetworks.com/wildfire/reportlist/ManualKeep in mind, this only shows results for files known by WildFire. If it is as unknown file, Local Analysis can still provide a verdict. The only downside is, there is no way to know what scoring Local Analysis will give a file until the agent has a chance to see the actual file.",0,06-02-2020,09:26 PM
1531,330411,Marsooq_A,wildfire only showing the result of files were forwarded from our security devices.its not showing the global database over there.for eg:7e27e33ec3df0ea9e89d32b050f1f0a211e3764818b9cad19308b8c954a02f03,0,06-02-2020,10:58 PM
1532,330411,Marsooq_A,,0,06-02-2020,10:59 PM
1533,330411,LokeshKumar,"Hello @Marsooq_A,You can check the coverage of the hashes from threatvault.paloaltonetworks.comIf the hashes show up as malicious in VT and other trusted resources, do go ahead and blacklist the files.If you raise a case for hash coverage check, the sample/file will be asked of you by the team; for the hashes which don't show up in wildfire db or threatvault.",0,06-07-2020,05:42 AM
1534,331598,dfalcon,"The tenant name is in the following format:https://subdomain.xdr.region.paloaltonetworks.comExamples:https://mycompany.xdr.us.paloaltonetworks.com/or https://bobsfishingandbait.xdr.eu.paloaltonetworks.com/Another way to provide instructions is to simply give those folks to access to Cortex XDR only within the Hub. With that, they can simply log into apps.paloaltonetworks.com and click on the tenant.",0,06-04-2020,07:16 AM
1535,327902,dkapadia,"Hi Marsooq,You can limit permissions for Live Terminal via the apps hub using RBAC and assign to specific users.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...Regards,DilanSystems Engineer Specialist, Cortex",1,05-14-2020,11:21 AM
1536,327902,Jan_Linhart,"Hi@Marsooq_Aif you install it using MSI, there is parameter:More info here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-1/cortex-xdr-agent-admin/cortex-xdr-agent-for-...Jan",0,06-04-2020,06:58 AM
1537,329065,dfalcon,"Hi @joffrin.alexander-You are correct, the max file size is 200 MB. (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/investigation-and-response/...)Please give me a day or so. I will check with Product Management to see if they have any suggestions.",0,06-02-2020,10:11 PM
1538,329065,dfalcon,"Hi @joffrin.alexander-After some checking, the limit for scripts is higher than 200 MB. The PM I spoke to believes it is 500 MB.",0,06-03-2020,09:26 AM
1539,327002,dfalcon,"Hi @Marsooq-Akkaradathil-You can view the results of the scan report in the Action Center. Begin by going to Response > Action Center.Within the All Actions list, locate your malware scan, right-click and select Additional Data.If there were malicious files, they will show up here. You can right-click and select View related alerts to see the malicious files and investigate deeper.(Actual alerts below)As far as the scan duration, I didn't see the full run time in the console. You can, however, view this information from the agent by clicking on the scan tab. I will check if a feature request has already been submitted for scan duration to be included from the console. One more note on this -- the scans are not super fast by design. The decision was made to allow the scans to run longer so that less system resources would be consumed.Hope this helps.",0,06-02-2020,11:33 PM
1540,328733,dfalcon,"Hi @Mike_Hammonds -Sorry, I haven't seen this before. Can you please log a case at https://support.paloaltonetworks.com?",0,06-02-2020,10:28 PM
1541,330987,dmichelucc,,0,06-02-2020,05:23 PM
1542,329961,dfalcon,"Hi @timross-I do not believe that such a page exists; however, the release notes document addresses both known issues as well as remediation of those known issues.Known Issues:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-1/cortex-xdr-agent-release-notes/cortex-xdr-ag...Addressed:https://docs.paloaltonetworks.com/cortex/cortex-xdr/7-1/cortex-xdr-agent-release-notes/cortex-xdr-ag...Hope this helps.",0,05-28-2020,05:40 AM
1543,329961,GlennSJ,"Calling a couple weeks ago about this, support said 7.0.2 is recommended over 7.1.xat that time. YMMV",0,05-28-2020,06:45 AM
1544,327084,GlennSJ,"My 2 cents, based on view 7.4 then 7.10, persistent clones, now non-persistent linked clones, Win 7 now Win 10.Test in a Test pool6.1.3 works6.1.4 doesn't work it comes up unlicensed7.0.2 appears to workFollow the instructionsVDI_ENABLED=1do imageprep everytime you change imageIssues for us were less around resource consumption and more around conflicts with drivers, or with software that is restoring the profiles (we use Profile Unity). Some of this was resolved with whitelisting, but since moving to the TRAPs in the cloud we haven't had to whitelist much. The most frequent problem is with other IT folks saying ""it's TRAPS!"" for any problem that happens.",1,05-20-2020,08:31 AM
1545,327084,hhiggins,I don't see anything specifically listed for VMware View on the compatibility matrix.https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...,1,05-21-2020,07:48 AM
1546,327084,GlennSJ,"Interesting point on the support matrix. We've called support numerous times (we've used TRAPS for years) and never caught any blowback about running it in View. The agent instructions still have the blurb about installing in a non-persistent VDI environment. I see Citrix listed on the compatibility matrix but wonder if that is actually compatibility for using app virtualization to package/deploy the Cortex agent (which is supported) vs support for Windows 10 running on those platforms. We've found it to be lighter on the endpoints than any of the signature based AV we used in the past, admittedly we haven't used that stuff for some years now, and appreciate that it uses some intelligence to weed out bad software without relying on signatures which are bound to be out of date.",1,05-21-2020,12:11 PM
1547,327084,CraigV123,Thank you for the replies. I have the agent installed to a test machine and the agent (v7.1.0) will not connect with the tenant. Is not seen at all. Any suggestions? Thanks again in advance.,0,05-27-2020,08:09 AM
1548,327084,GlennSJ,Does that same install work on another machine in your environment? It wasn't clear to me if you're already using Cortex XDR and just adding it to VDI or if Cortex XDR is new to your environment.,0,05-27-2020,08:29 AM
1549,327084,CraigV123,"Sorry about that... the agent install works already within our environment. We're just now adding it to our VM environment.The machine that looked OK in the console yesterday is now in a Disconnected state but I'm also logged into that device now and I can see the agent installed, however it is in a Disabled state. I'm not sure where the problem lies but it seems like there's a communication issue at some point.Thanks again for the assistance.",0,05-28-2020,05:45 AM
1550,327084,GlennSJ,"I'd open a ticket, to at least get that process started.We found with non-persistent VDI they are only licensed when a user is logged into the vm. Once they log out it releases the license until another user logs into that machine (this is with floating user assignment not dedicated). If you are using Palo Alto NGFW at the perimeter, something we found that wasn't in the documentation is that it needs ""google-base"" in addition to ""cortex-xdr"" in the outbound security policy. If you think it is a communication issue check your traffic logs on the firewall to see if you are seeing any ""deny"" actions from that machine.edit: FYI - cortex-xdr depends on ssl, web-browsing",0,05-28-2020,06:18 AM
1551,329194,dfalcon,Hi @philliproh -I've never seen this behavior before. Your best bet is to gather a tech support file (TSF) from the machine with the issue then open a case with Support.,0,05-28-2020,05:22 AM
1552,329645,dfalcon,Can you post a screenshot of the Portable Executable and DLL Examination portion of your malware profile?,0,05-26-2020,10:27 AM
1553,329645,Marsooq_A,,0,05-26-2020,10:41 AM
1554,329645,dfalcon,"Hi@Marsooq_A-Just to confirm. When you go to Endpoint Management > Endpoint Administration, select an endpoint that is failing, right-clickand select View Endpoint Policy -- can you see the profile with quarantine enabled applied to the specific machine?",0,05-26-2020,10:55 AM
1555,329645,Marsooq_A,"Yes , I could see the same profile in the policy and this has been confirmed several times.",0,05-26-2020,11:02 AM
1556,329645,dfalcon,"Next thing I would check is the agent logs after a quarantine attempt.https://docs.paloaltonetworks.com/wildfire/8-1/wildfire-admin/submit-files-for-wildfire-analysis/ver...You can use this test PE to trigger a quarantine event. After the event is complete, open the log file, scroll to the bottom and look for any messages associated with the quarantine attempt.",0,05-26-2020,11:05 AM
1557,329645,Marsooq_A,well its works with other endpoints,0,05-28-2020,12:33 AM
1558,327881,dfalcon,"Hi@amar.nath-What type of alert is it? Meaning, what is the source?",0,05-18-2020,09:10 PM
1559,327881,p1-pr,"Hi,Not sure if this was ever answered, but it's a new Analytics alert within Cortex XDR.The documentation for it is here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...Peter",1,05-26-2020,10:40 AM
1560,327617,dfalcon,"I haven't done QRadar yet, but I will ask around. For now, do you have a preference on the log format? Syslog, CEF, etc?",0,05-18-2020,08:43 PM
1561,327617,Graeme_Riddell,"Hello David,I would prefer LEEF as I am trying to also get the Paloalto Networks App working in QRadar and that stipulates that it requires LEEF. Although I am failing miserably on that front aslo, but I dont appear to be alone on that front according to what I have read.Thanks<Graeme",0,05-19-2020,01:13 AM
1562,327617,hhiggins,@Graeme_Riddellwe are having issues getting Cortex XDR syslog data into our Rapid7 IDR SIEM as well. It looks like it can be configured at the Cortex XDR layer or at the Data Lake layer using the forwarding app.Where are you configuring syslog?,0,05-21-2020,08:00 AM
1563,327617,Graeme_Riddell,"Thanks for the reply, we are also using the Log Forwarding App from the Hub Portal.Also got it configured in Cortex XDR console also.Thanks,Graeme",0,05-21-2020,08:13 AM
1564,325052,dfalcon,"Hi there-Yes, you can enable this through Cortex XDR. You could also use GPO - Either method will work.",0,04-27-2020,12:15 PM
1565,325052,pkawula,"Hmmm, That is what I thought, but even with the policy set to encrypt the disk, bitlocker still reports it is off.TPM is enabled.Is there any thing else I need to do to get Cortex to turn on Bitlocker?",0,04-27-2020,12:18 PM
1566,325052,dfalcon,"Hi@pkawula-Before digging deeper, just want to confirm that you have gone through the steps on page 156 of the admin guide (linked below) and that all pre-requisites have been met. Admin Guide - https://docs.paloaltonetworks.com/content/dam/techdocs/en_US/pdf/cortex/cortex-xdr/cor...",0,04-27-2020,12:46 PM
1567,325052,pkawula,@dfalconWIndows 10 1909TPM enabled.It is an AD connected endpoint. But the ADDS role is not installed there on the endpoint directly. I've never heard of ADDS being run on a workstation...,0,04-27-2020,01:04 PM
1568,325052,dfalcon,"Hi@pkawula-I have not tried to enable this yet. I will try to get access to a lab to verify; however, it is my understanding that this is needed toallow the agent to access the encryption recovery key backup. Please give me through the end of the week to secure an environment to test.",0,04-29-2020,08:18 AM
1569,325052,dfalcon,"Hi @pkawula-I spoke with the Product Manager responsible for the Bitlocker feature this morning. The prerequisite list is accurate and anything listed must be set up / enabled before taking advantage of the feature. The PM also recommended that two profiles (as well as two policy rules) be created to use this feature. The first one is an encrypt profile to encrypt the drive(s). The second profile should be a decrypt profile to decrypt the drives. If you need to decrypt an encrypted drive, you would then add that machine to a policy with decrypt profile.In the policy list (under extensions), you would place the decrypt policy above the encrypt policy since the rule set is a top-down match.",0,05-04-2020,07:43 AM
1570,325052,pkawula,"Thanks @dfalconI will likely just manage Bitlocker with Intune then and just use Cortex as a monitoring dashboard. I am not sure why Cortex needs that feature turned on when GPO and/or Intune can manage Bitlocker without it. Seems odd. Maybe I am missing something? Or maybe just because it is a third party software. Not a huge deal as we weren't expecting to control encryption from Cortex when we purchased anyway.If I just wanted to test, I am assuming adding the RSAT ADDS and Lightweight Directory Tools feature in Win10 1909 will fulfill the requirements?",0,05-04-2020,07:50 AM
1571,325052,hhiggins,@pkawulathat is what we do. We implement Bitlocker via GPO and monitor through the Cortex XDR console. Using the Cortex XDR console alerted us to the fact that we were only using 128-bit encryption. We have since used GPO to enable 256-bit encryption going forward. Prior to Cortex XDR we had no visibility into this.,1,05-21-2020,07:56 AM
1572,324100,hhiggins,"Yes lots of goodies in this release. I was reading the release notes this morning. We have bitlocker already deployed in the organization. If I reading correctly, it sounds like I would be able to display the status of bitlocker in the Cortex XDR console even though we use GPO's for enablement and control.",0,04-21-2020,10:41 AM
1573,324100,KRisselada,"Any way a feature like ""Export"" would be available to ""Disk Encryption Visibility"" output??",0,05-20-2020,11:48 AM
1574,326605,GlennSJ,"Yes Cortex XDR is supported. Use the VDI_ENABLED=1 switch when installing in the base image. There is also an imageprep process to go through when creating the image, and when adding files to the image later. All this is documented in the Admin guide. I don't know about the licensing question.",0,05-20-2020,08:11 AM
1575,327759,dfalcon,"Hi@RichardChou-Are you still having this issue? Did you try to run the install with verbose logging to get a better idea of the root cause?Example:msiexec.exe /i YourCortexPkg.msi /L*V Install.logIf it fails again, you can then open the log and search for the error.",0,05-18-2020,09:07 PM
1576,327759,RichardChou,"The customer did not have time to wait, so he chose to reinstall the windows system.",0,05-19-2020,06:19 AM
1577,327764,dfalcon,Hi@Marsooq-Akkaradathil-I believe the files remain in quarantine until the disk quota specified in the agent profile is reached. Then it becomes first in first out.,0,05-18-2020,09:02 PM
1578,328009,dfalcon,Hi@bartek-Scheduled scans are not available in the Linux malware profile with the current version. Where are you located? It may be beneficial to set up a discussion with your local Cortex XDR account team - they can provide more info for you.,0,05-18-2020,08:55 PM
1579,328011,dfalcon,"Hi@bartek-I believe the shortest duration is weekly. The scan is designed to look for dormant malware and the feature is there to satisfy audit requirements. By design, the agent examines a file on execution. It queries WildFire in real time (same feature you get in your scan) to look for a verdict. For WildFire unknown files, it then executes local analysis, at the same time it uploads the file for execution. Once uploaded, WildFire will perform Dynamic Analysis, and other interrogations if necessary, and will update the local verdict.",0,05-18-2020,08:53 PM
1580,327263,dfalcon,"Hi@Marsooq-Akkaradathil-I have not seen this issue. To troubleshoot, have you tried modifying your agent profile to hide the agent icon. Then, after checking in, modify the profile to show the icon again followed by one more check-in. I'm just curious if this is a profile issue or agent issue.",0,05-18-2020,08:41 PM
1581,327740,dfalcon,"Hi@Marsooq-Akkaradathil-You should be able to do this. Go to your hub portal (apps.paloaltonetworks.com) then click on the settings icon next your name and select Access Management.From there, click on Manage Roles then Create Role.Name your role, then select the actions you would like this role to be able to perform. Screenshot below.",0,05-13-2020,07:17 AM
1582,326238,Sailesh_Aryal,"I noticed that on the new version. Unless you disable the anti-tamper, you can't uninstall it.The only solution I found was to use Traps Cleaner which works on Cortex too. You can get it from support if you don't have it already.",0,05-12-2020,12:54 PM
1583,326238,dfalcon,Hi@Maxstr-Quick question - how are you doing the uninstall?a.) Add remove programs (with the password)b.) From the tenant consolec.) Command line / script,0,05-13-2020,07:12 AM
1584,324065,dfalcon,HI there-Go to Investigation > Incidents - then click on Alerts Table over to the right of the screen.,1,04-21-2020,09:23 AM
1585,324065,hhiggins,Thank you@dfalcon!Feels like it is hidden away. They should be making this a submenu directly off of the Investigation menu.,3,04-21-2020,10:38 AM
1586,324065,dfalcon,I will share that feedback with the Product Team.,1,04-21-2020,10:45 AM
1587,324078,dfalcon,Hi there-The 7.02 agent will not install on Server 2003. You will have to use a 5.x agent on Server 2003 -- and this covers Prevent only.https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...,1,04-21-2020,09:31 AM
1588,323038,dfalcon,"Hi there,The current version of Cortex XDR does not have vulnerability scanning. You do have defensive measures against vulnerabilities/exploits via the built in Exploit Prevention Modules (EPMs). On the technique-based exploit side, the EPMs focus on three areas: memory corruption, logic flaws, and malicious code execution. There are several other methods as well. Please check your exploit profile for more info.The blocks you are seeing in the firewall are derived from signatures. You can view threat details athttps://threatvault.paloaltonetworks.com/.It may also be worth exploring the newly released Threat Intel Management (TIM) via Cortex XSOAR. You can expand your protections and leverage the threat intel data to proactively block malicious IOCs.https://www.paloaltonetworks.com/company/press/2020/palo-alto-networks-introduces-cortex-xsoar--rede...",0,04-16-2020,08:29 AM
1589,318989,kcross,"Hello Hodor,We are looking into our schedule to create a ""Cortex-management-service"". In the meantime, please review the instructions to enable access from agents to the cloud-based Cortex XDR application at:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...You can also consider deploying the Broker VM to route communications from endpoints to the Cortex XDR application. See:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...Best regards,Kasey",0,03-31-2020,09:07 AM
1590,318989,dfalcon,"Hi there - are you referencing ESM (on-premise) or Traps Management Service, which is cloud-based? I'm not 100% that I understand the question, but would like to help you find the answer.",0,03-31-2020,06:42 PM
1591,318989,Hodor,"Hi,we`re using 100% Traps Management Service (Cloudservice).",0,04-01-2020,01:13 AM
1592,318989,dfalcon,"Hi there - the equivalent of Traps Management Services is available within Cortex XDR. The features previously available in TMS are now under Endpoints dropdown menu in Cortex XDR. You will also find additional features not available in TMS under the Security dropdown menu, such as device control.",0,04-01-2020,06:35 AM
1593,318989,kcross,"Hello! The FAQ addresses questions asked by customers during our Cortex XDR 2.0 Upgrade webinar. It does not provide detailed instructions on the Cortex migration. If you are looking for instructions to enable your endpoint agents to access the cloud-based Cortex XDR application, please see:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...",1,04-01-2020,08:45 AM
1594,318989,Hodor,"Hey, thanks for the tip.With the manual I created a rule for the devices that are not allowed to be on the internet.I don't understand why there is no equivalent development of the traps management service for Cortex-XDR by PaloAlto. I just had to add another app without having to build a new set of rules..Our Cloud Traps Management Service will be migrated to Cortex 2.0 this weekend. I hope that my clients will work after the migration using the new rule..",1,04-02-2020,02:18 AM
1595,318989,dfalcon,"Sounds good. Since you have devices that cannot be on the internet, I would look into standing up an on-prem broker after you are migrated. You can find the instructions on page 50 of the admin guide here: https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-adminAfter you are migrated, you can download the broker VM by clicking on the settings icon at the top right of the screen, select Settings > Broker VM.",0,04-02-2020,06:51 AM
1596,318989,Hodor,"So folks thank you for your support - especially KcrossIt took me some time to build my ruleset using the instructions (only for access for Cortex). But it works for computers that have an internet regulation!I have therefore marked the article as a suggested workaround.It's a pity that I have the feeling to be the only one who notices / disturbs this in the form.An explanation of Palo Alto why there is no new development of a Cortex-Service-Application exactly like the Traps-Management-Service is missing ...Well, thank you so far.",0,04-11-2020,01:22 AM
1597,319496,dfalcon,"Hi there. The version of the broker available for download is dependent on your environment. If you are using TMS or Cortex 1.0, the version exposed is different than the version in Cortex XDR 2.0. In my 2.0 tenant, I am seeing broker version 7.1.13 for both OVA and VMDK. That being said, you will likely have to wait until you are upgraded.Please reply to this thread if you have issues after you are upgraded.",0,03-31-2020,06:52 PM
1598,319496,btenberge,"Thanks for your reply David.After this weekend's migration I was still only able to download Broker VM 6.1.4 from the support page.Only after reading the newer article ""Configure Your Broker VM"" I noticed that there's a download option from the Settings -> Broker VMs page on our new Cortex XDR page.It seems like the old Broker VM won't proxy new Cortex XDR agents, so I'll have to deploy this new 7.1.13 VM alongside.Anyway, problem solved!",0,04-06-2020,06:10 AM
1599,318305,kcross,"Hi Rclifford! All of the agents on all of your systems, including Windows, will be upgraded to Cortex XDR management. I recommend that you allow all of your agents to be migrated to Cortex XDR at the same time. You can take advantage of many new features available with Cortex XDR.The TMS console will eventually be decommissioned. Otherwise, you can uninstall the agents on your Windows hosts.Note that you do not need to upgrade your Traps endpoint agents to take advantage of the new, unified Cortex XDR management console. If you do optionally upgrade your endpoint agents, then you can benefit from new capabilities such as a fully-rebuilt, AI-based local analysis engine and USB Device Control. Contact your Palo Alto Networks account team to learn more.",1,03-24-2020,12:28 PM
1600,307035,mperlman,"There are many ways we can detect C2 (beaconing) activities using the Cortex XDR, we can do it by looking on the endpoint and or the network data, take a look here for a few examples of the detections we have in the producthttps://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-...In addition for that we have many more ways to detect using C2 as an example protecting the endpoint.Menachem.",0,01-19-2020,12:25 PM
1601,307035,christowner,"Thanks,Menachem.I can see there are several built in detections. What I was looking for was a way to use the Investigation > Query Builder (or NGFW logs) to detect beaconing where the built in detectors haven't identified the events. The kind of traffic I was hoping to detect was regular connections to the same IP address/domain where that domain wasn't necessarily malicious (or randomly generated).",0,01-20-2020,12:42 AM
1602,307035,mperlman,"Hi Christowner,You can leverage the existing pre-built in query builder to query and do threat hunting for different C2 activities like attackers leveraging regular connections to hide their channels or attackers using benign domains or files, Cortex XDR have multiple methods to detect attackers from pre-built in ML algorithms to rules or signatures and you can also create your own different queries for detection.If you have a specific type of attack you would like to know feel free to send me PM or post it here.Menachem. ",0,01-20-2020,06:01 AM
1603,307035,christowner,"HiMenachem,Thanks again. The exact attack is where C&C beaconing occurs using HTTPS to a domain at 10 second intervals. I have the domain details now, so I can query the NGFW and XDR logs for the data. What I am trying to do is work out how I would be able to find this traffic if I didn't already know the domain. The XDR logs do not show network beaconing at 10 second intervals as the same source process made repeated HTTPS requests (so it only shows the requests at 5-20 minute intervals as associatedwith a process). The NGFW does show the exact traffic, but I don't see a way to create a query that shows any domain access that repeats at regular intervals (or to query the NGFW at all in XDR, outside of Explore).Thanks for your continued help,Chris.",0,01-20-2020,07:19 AM
1604,307035,mperlman,"Thank you for elaborating more,Behind the scenes we look on connection to domains in order to detect abnormal activities, in the Cortex XDR UI we display the information rounded to minutes or hours depends on the type of the detection.You are correct that using the Explore app you can see the actual data once you have the URL you are looking for.I opened feature request to allow user to query for URLs on specific intervals.Menachem.",0,01-20-2020,08:07 AM
1605,,BizBo,When is 2.0 being rolled out in Europe (UK)?,0,12-12-2019,03:48 AM
1606,,mperlman,Cortex XDR 2.0 is already available at the same regions US and EMEA like we had before for Cortex 1.0.Menachem.,0,12-30-2019,08:18 AM
1607,285489,FrankBussink,"Hi,if you are running a 8.x version, I think then to onboard the LS (logging service) on those Firewall, you HAVE to go through Panorama.In Panorama, deploy the plugin Cloud_Services. (bear in mind the version of Panorama, I think you need at least a 9.x but that doesn't mean you have to run your Firewalls at version 9.x)Create a profile to log to Logging Serviceand then deploy this profile to the Firewall.Fairly straight forwardRegardsFrank",1,10-14-2019,03:14 AM
1608,287605,FrankBussink,"Unfortunatly, the list goes on.Bug No 3:After pairing and being authorize in the portail UI, the service restart itself, and then you might get an error message of something likeConfiguration file corrupted.Looking at the logs inthe agent.log file. I saw an error :InvalidURL: Failed to parse: myuser:p0This is due to a wrong parsing a password which is encoded in base64 and containing a slash character. '/'2 workarounds :1) given a statistics of 344 characters with a probability of 1/64 to be a slash. This give a chance of 5:1. So if you try 10 times, you probably have a working installation.2) second workaround. Edit /etc/conf/lc.conf and replace the slash character by another characters and restart the service.RegardsFrank",0,09-12-2019,08:37 AM
1609,287605,FrankBussink,Support has announced resolution of those 3 bugs for next release of Pathfinder.Let's cross fingersRegardsFrank,0,10-14-2019,02:57 AM
1610,211678,mperlman,"Hi Jdemery,Thank you for your question, today with PAN-OS 8.1 the Next Generation Firewall is able to extract from the network traffic DHCP and DNS logs if Enhanced Application Logging is enabled with the Logging Service.For more information about how Cortex XDR will utilize the logs, please reach out to your Palo Alto Networks SE who will be able to arrange a roadmap session.Menachem Perlman.",2,04-25-2018,05:47 AM
1611,211678,jdemery,Thanks Menachem.,0,04-26-2018,04:56 AM
1612,198341,milling,Can you post a picture of what those alerts look like?,0,04-09-2018,05:12 PM
1613,198341,moverholser,"The Cortex XDR datasheet (https://www.paloaltonetworks.com/resources/datasheets/magnifier) has a screenshot of an alert to demonstrate the user interface. If you're interested in the types of alerts that Cortex XDR can generate, the list of possible alerts is in the Cortex XDR documentation (https://www.paloaltonetworks.com/documentation/cloud-services/magnifier/magnifier-getting-started/ge...).",2,04-09-2018,08:20 PM
1614,198332,Fahadvu,so could we use this solution via internet edge ?,0,03-09-2018,02:24 AM
1615,198332,blebail,"Hi,Cortex XDR is a security application cloud based solution relying on Palo Alto Application Frameworks which leveragesPalo Alto Networks Logging Service.Logging Service receives data from Palo Alto Networks devices whether they are on premise or in the cloud as well as from Global Protect Cloud Service.To get the best out of it, Cortex XDR must see traffic between users and servers and traffic going from internal networks to Internet. Other traffic logs area nice to have to collect as well but not mandatory.To answer your question, traffic generated at internet edge, which logs aresent to Logging Service, is one of the must-have traffic we recommend but not the only one as described above.I hope this answers your question.Regards,Bertrand",2,03-09-2018,08:57 AM
