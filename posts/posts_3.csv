,Post ID,Discussion Group,Author,Author Label,Topic,Body,Likes,Replies,Tags,Labels,Solution Link,Date,Time
0,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
1,507954,Custom Signatures,mcannady,L0 Member,Has anyone done a custom APP to block recursive DNS queries?," I've built two signatures for DNS.  One to indicate recursive lookup and not recursive lookup.   When I test,  the app that is evaluated first is triggered.  reverse the order and the formerly 2nd app triggers.   It is like the expressions are not evaluated. Has anyone done this before? I have a case open with paloalto about this, but it has been open for almost a year.",0,"
		1 REPLY 1
",,,,07-05-2022,06:16 AM
2,192889,Custom Signatures,benparker,L1 Bithead,Detecting TLS 1.0 and TLS 1.1 Protocol,"Hi,I working with a customer that needs to detect the usage of SSLv3(already done with ID 36815), TLS 1.0 and TLS 1.1, at some point they may move to blocking this on certain traffic. They don't particularly want decrypt the traffic for this due to complaince and organizational policies, and they want to be able to run reports so doing a No decrypt with a profile isn't exactly helpful either. It seems like the best way to accomplish this is through a threat signature that would have either the SSL Client or the Server Hello context which contains the protocal version is 0x030#. This is only 2 of the 7 required bytes so I am not positive what else to match on. Alternatively, with TLS can you still do an equal to match on SSL-rsp-version and if so what values to the TLS versions much against? Would it be 4,5,6? Thank you,",2,"
		3 REPLIES 3
",", custom Signatures, threat, tls",,,12-22-2017,08:04 AM
3,477341,Custom Signatures,JimmyChernega,L0 Member,Minimal configuration for  Custom Apps,"Our programmer wrote an app that uses TCP/9901 and 9902 to transfer data between the East and West buildings.  Let's call it JC-App.   What is the minimum configuration on both the East and West Firewalls?  Also, what would need to be added to require the use of Application Override ??   Thanks.  jc",0,"
		0 REPLIES 0
",,,,03-31-2022,11:13 AM
4,300532,Custom Signatures,Gianpiero,L1 Bithead,Convert ScreenOS Multicast static route to PaloAlto,"Hi all,i'm finally converting an old Juniper ScreenOS firewall to a PaloAlto firewall (5020). I have some problem to understand how to convert some Multicast static Routes.On screen os i have this specific entry for ex: GUI:Type: Static, ForwardingSource IP: 192.168.100.126Mgroup: 239.0.0.2Incoming Interface: eth3/6.3Outgoing interface: eth3/6.2 cli:set mroute mgroup 239.0.0.2 source 192.168.100.126 iif ethernet3/6.3 oif ethernet3/6.2Multicast policy:Source:12Destination: emptyMessages: IGMPBidirectional: yes set access-list 12set access-list 12 permit ip 239.0.0.2/32 10set access-list 12 permit ip 239.0.0.3/32 20  Can you help me how to configure this on PaloAlto? Thnxxx a lotGianpiero",0,"
		1 REPLY 1
",,,,11-25-2019,01:25 AM
5,469555,Custom Signatures,LCMember3265,L0 Member,Anyone know how to compare two headers in custom spyware signature?,"Anyone know how to compare two headers in custom spyware signature?ie ""http-req-host-header"" == ssl-req-client-hello   ",0,"
		1 REPLY 1
",,,,03-01-2022,10:57 AM
6,211714,Custom Signatures,SethArnoff,L1 Bithead,Allow iOS Ring doorbell,"Hello,I'm looking for a proper way to allow the iOS Ring app to connect back to the video feed from an iOS device. Android phones work with no issue. The problem is that it reports the web URL category as ""unknown"" which I am currently blocking.I wrote my policy (below) to allow ssl traffic for all unauthenticated users (mobile devices) to connect to the Ring IP address range, and assigned a new URL filtering policy that mirrors our current URL filtering policy, with the exception that ""unknown"" category is set to Alert instead of block.  Is there a more proper way to do this?The Ring ports are here: https://support.ring.com/hc/en-us/articles/205385394-What-Ports-Do-I-Need-to-Open-in-My-Firewall-for...Specifically the iOS ports TCP out 80, 443, 5223, 15064 and UDP out 53, 123, 18306 - 63919Ring IP range: 35.174.122.0-35.174.123.255",0,"
		8 REPLIES 8
",,,,04-25-2018,08:02 AM
7,462772,Custom Signatures,OyvindM,L0 Member,Custom App for unknown SIP traffic,"Hi. I need to create a Custom App for SIP traffic that is not identified by the firewall. I see that you can match on the sip headers but not sure how to write the pattern.  Have done capture of the traffic and this is what I got...What can be used here and how do I write the pattern? INVITE sip:2574@10.100.118.40 SIP/2.0Min-SE: 300Date: Wed, 02 Feb 2022 11:11:28 GMTCSeq: 1 INVITEVia: SIP/2.0/UDP 10.100.254.103:5060;branch=z9hG4bK1b1aeaa5-f022-1910-8d14-00d8614b2eed;rportSession-Expires: 3600;refresher=uasUser-Agent: NVTVoIP/8.3.0.1765From: ""Seng 2128"" <sip:nvm@10.100.254.103>;tag=1b1aeaa5-f022-1910-8d11-00d8614b2eedCall-ID: 1b1aeaa5-f022-1910-8d12-00d8614b2eed@FANTOFTMBBSupported: timer, x-siemens-sipqv2Organization: New VoiceTo: <sip:2574@10.100.118.40>P-Asserted-Identity: ""Seng 2128"" <sip:nvm@10.100.254.103>Contact: <sip:nvm@10.100.254.103>Allow: INVITE,ACK,OPTIONS,BYE,CANCEL,SUBSCRIBE,NOTIFY,REFER,MESSAGE,INFO,PINGContent-Type: application/sdpContent-Length: 308Max-Forwards: 70 v=0o=- 1643800288 1 IN IP4 10.100.254.103s=Opal SIP Sessionc=IN IP4 10.100.254.103t=0 0m=audio 5144 RTP/AVP 8 0 101 100a=sendrecva=rtpmap:8 PCMA/8000/1a=rtpmap:0 PCMU/8000/1a=rtpmap:101 telephone-event/8000a=fmtp:101 0-16,32,36a=rtpmap:100 NSE/8000a=fmtp:100 192-193a=maxptime:240SIP/2.0 100 TryingTo: <sip:2574@10.100.118.40>From: ""Seng 2128"" <sip:nvm@10.100.254.103>;tag=1b1aeaa5-f022-1910-8d11-00d8614b2eedCall-ID: 1b1aeaa5-f022-1910-8d12-00d8614b2eed@FANTOFTMBBCSeq: 1 INVITEVia: SIP/2.0/UDP 10.100.254.103:5060;received=10.100.254.103;branch=z9hG4bK1b1aeaa5-f022-1910-8d14-00d8614b2eed;rport=5060Content-Length: 0 SIP/2.0 180 RingingAllow: INVITE, ACK, CANCEL, BYE, PRACK, NOTIFY, REFER, SUBSCRIBE, OPTIONS, UPDATEContact: sip:10.100.118.40User-Agent: OmniPCX Enterprise R11.2.2 l2.300.31.bP-Asserted-Identity: ""Gruppe 7-1 Oster"" <sip:2574@nordhord;user=phone>To: <sip:2574@10.100.118.40>;tag=b2de9e36b543975d4ff88de7dec5e216From: ""Seng 2128"" <sip:nvm@10.100.254.103>;tag=1b1aeaa5-f022-1910-8d11-00d8614b2eedCall-ID: 1b1aeaa5-f022-1910-8d12-00d8614b2eed@FANTOFTMBBCSeq: 1 INVITEVia: SIP/2.0/UDP 10.100.254.103:5060;received=10.100.254.103;branch=z9hG4bK1b1aeaa5-f022-1910-8d14-00d8614b2eed;rport=5060Content-Length: 0",0,"
		0 REPLIES 0
",,,,02-02-2022,03:51 AM
8,441544,Custom Signatures,Daniel_Itenberg,L2 Linker,Cortex XDR block file execution based on ico\file name,"Hi,I've been wondering - Is it possible to block the execution of a file by file name or ioc in the xdr?It sounds like a rather basic feature yet i can't seem to find anything about it in the docs - only thing i found is block file execution based on hash ",0,"
		1 REPLY 1
",", Cortex XDR, i",,,10-18-2021,04:09 AM
9,413613,Custom Signatures,SergiyL,L1 Bithead,"""email-headers"" and ""smtp-email-headers"" context in customer application definition","Hello,Is there any difference between ""email-headers"" and ""smtp-email-headers"" context in the customer application definition?I didn't find description of the ""smtp-email-headers"" context in ""Custom Application IDs and Signatures"" guide.Maybe ""email-headers"" can be used for any email protocol and ""smtp-email-headers"" only for SMTP?Thanks",0,"
		2 REPLIES 2
",", custom app IDs, email header, smtp-email-headers",,,06-16-2021,09:28 AM
10,400172,Custom Signatures,Alejandro_Grijaaria-labellba,L0 Member,Letsencrypt (acme) challenge URL,"I created this pattern to recognize Letsencrypt (acme-protocol) challenge. You need to create a custom application with these fields:Typo: Transaction Context: http-req-uri-path Pattern: That's the best I could bet. Btw, I did not know before that ""http-req-uri-path"" had to include the method (GET), so I had a hard time using the regex anchor ""^"".",1,"
		1 REPLY 1
",,,,04-19-2021,10:09 AM
11,452166,Custom Signatures,jsv93,L0 Member,Custom signature for catch specific query,"Hello all I'm trying to catch suspicious ldap queries (recon activity).For the example I want catch this kind of querie : (primaryGroupID=512)I tried to make a custom rule. However for ldap, there are only 2 possibilities:- ldap-req-searchrequest-baseobject- ldap-rsp-searchresentry-objectnameboth of them don't fit my needs cause they don't match the filter field.I tried with unknown-req-tcp-payload but it did not work. Reading the forum I understood that I can't use this context since ldap is seen as a known application.https://live.paloaltonetworks.com/t5/custom-signatures/custom-threat-signature-search-full-tcp-paylo...So I'm running out of ideas to catch this kind of request.If somebody have a tips Thank's",0,"
		1 REPLY 1
",,,,12-08-2021,10:45 AM
12,436096,Custom Signatures,NoamRotter,L0 Member,Allow or drop traffic based on headers,"Hi,I need to allow/drop traffic based on headers.I need a custom signature to make sure the HOST is one of:1. abc.com (or)2. xyz.comANDThe XFF header is one of:1. 1.1.1.1 (or)2. 2.2.2.2 (or)3. 3.3.3.3ANDA header name ""X-MyHeader"" has the value: ""123""If one of the above condition is false, drop the traffic. I will appreciate any help. Noam.",0,"
		1 REPLY 1
",,,,09-23-2021,01:00 AM
13,430873,Custom Signatures,Chris_Johnston,L2 Linker,Threat signature for ICMP type,"Has anyone had success in creation of threat signatures for ICMP type?  I've seen (and tested) the Palo Alto guide on creation of an app to block/allow specific ICMP types and was trying to log a threat event for potential use and visibility versus creation of a new application (and needing to create a new app-id group to accommodate all ICMP types) https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClFZCA0 Working app-id CLI:set application icmp-type8 default ident-by-icmp-type type 8set application icmp-type8 subcategory ip-protocolset application icmp-type8 category networkingset application icmp-type8 technology network-protocolset application icmp-type8 risk 1Non working threat CLI:set threats vulnerability 44008 signature standard icmp-req-data and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match pattern 8set threats vulnerability 44008 signature standard icmp-req-data and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match context icmp-req-dataset threats vulnerability 44008 signature standard icmp-req-data and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match negate noset threats vulnerability 44008 signature standard icmp-req-data order-free noset threats vulnerability 44008 signature standard icmp-req-data scope protocol-data-unitset threats vulnerability 44008 default-action alert set threats vulnerability 44008 threatname chrisvuln-icmp-type8set threats vulnerability 44008 severity informationalset threats vulnerability 44008 direction bothset threats vulnerability 44008 comment ""ICMP type 8""set threats vulnerability 44008 affected-host client yes",0,"
		4 REPLIES 4
",", signatures, threat intelligence, threat log, threat logging, threat signatures",,https://live.paloaltonetworks.com//t5/custom-signatures/threat-signature-for-icmp-type/m-p/446603#M411,09-01-2021,12:05 PM
14,252502,Custom Signatures,dparris,L5 Sessionator,Custom Signature to detect a PDF file,"DISCLAIMER: As with all custom signatures on this forum, this signature is being provided by the author as a result of enthusiasm for the product and to share ideas with the Palo Alto Networks security community.   It is: - Not recommended for deployment in a production network of any kind without internal testing.- Not a solution to any vulnerability.- Not an official supported Palo Alto Networks signature  This write up is to help the Palo Alto Networks community with detecting a specific PDF file.  The sample signature was created on PAN OS Version 8.1.x :  SHA256: cbdf842fba661b85090e7e31fe9ed6b069a01fd82d5bd563a462185b53ab38e3 Go to custom signatures under objects, select custom vulnerability signature. Click addFill out the appropriate field under the configuration tab  Open the Signature TabSelect add at the bottom left Since we only have one condition it doesn’t matter if we choose the ‘and’/’or’ condition  To determine a unique string the *NIX utility xxd was used in this case, however any hex editor will work for this purpose.  The string was then converted to hex and used in a pattern match to detect the file. In this case the author of the file put what we believe to be their name in the file and that was used as a unique identifier.  5220 3120 2038 2030 5d52 432f 6e6f 6574Once this custom signature is applied and a web browser is used to attempt to download the file the firewall will either block or alert on detection depending on the action you set. **Warning** any custom signature should be fully tested to see if it works correctly, and for false positives.",3,"
		4 REPLIES 4
",", custom Signatures, signatures",,,03-06-2019,06:13 AM
15,412522,Custom Signatures,IamJoeG,L0 Member,Limiting http methods to specific URLs,"Has anyone had luck limiting http methods like PUT to limited URLs? For example, limiting a PUT to https://www.foo.com/ but not to https://www.foo.com/folder1 ? I've created a custom vulnerability that allows the http-method (http-req-header length > 0 which http-method=PUT) in a custom vulnerability but I am having trouble limiting it to the host only portion or the URL/URI. Not sure if this should be further defined in the custom vulnerability, URL category, or just as an fqdn address object? I am trying to think that if I have a use case in the future to allow to https://www.foo.com/folder2 but not https://www.foo.com/folder2/uploads would it be the same solution?",0,"
		3 REPLIES 3
",", http-method, limited URLS, URL filtering",,,06-11-2021,05:58 AM
16,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
17,407224,Custom Signatures,nikoolayy1,Cyber Elite,"DDOS, Brute force and referer header match options with custom signatures for app-id and vulnerability.","Hello to All,  I have made a post with examples in an another part of this forum but now I see that there is a seperate discussion for custom signatures, so I am posting it here. Now with version 10 as there is no 7 byte limit it is much more easier to do such things with application or Spyware/Vulnerability combination signature:  https://live.paloaltonetworks.com/t5/automation-api-discussions/version-10-no-7-byte-limit-for-sinat...",0,"
		0 REPLIES 0
",,,,05-17-2021,04:22 AM
18,254483,Custom Signatures,Tim_Bielders,L0 Member,Custom objects signature - DNS query length,HelloI am trying to create a custom object / custom spyware signature based on dns-req-section that would alert when the requested domain via dns is longer than x amount of characters.Currently I am stuck at the pattern requirement to have 7 fixed bytes. Any ideas?  (We are not using dns proxying)(I'm trying to detect this: https://blog.talosintelligence.com/2016/06/detecting-dns-data-exfiltration.html) Thank you in advanceKind regardsTim,0,"
		1 REPLY 1
",,,,03-21-2019,02:28 AM
19,387628,Custom Signatures,brian.saloum,L2 Linker,Application ID for MS-Edge,"Due to the constraints placed on us by management, we don't support Chrome, and early on, I created a custom app ID specifically for Chrome and was able to block it fairly effectively.  Then MS released Edge, which fouled everything up.  So all of the chrome blocks had to be changed allows, so edge would work.  So, like an idiot, I thought I could simply follow the same process, by creating an edge specific custom app ID and went through the entire process, only to be told that my match criteria is invalid.  Tried a couple of different ways, to be honest, but either the pattern was too short, as it requires a minimum of 7 characters (seriously?), which sucks for edg/whatever version #, or it complains about an invalid pattern, when I include Edg/88., which meets the bare minimum 7 character limit.  It also complains when I insert the entire string for Edge (Edg/88.0.705.63).  I really need to find a solution for this.  Has anybody else run into a situation like this?",0,"
		4 REPLIES 4
",,,,02-24-2021,11:21 AM
20,387045,Custom Signatures,Noam.Rotter,L1 Bithead,Pattern regex less then 7 bytes,"Hi all,I have been asked to create a new Application signature to block any access to /abc/*But when adding the pattern /abc/* in context http-req-uri-pathI get an error: ""pattern must be at least 7 bytes [/abc/*]"" How can I block any access to /abc/* ? Regards,Noam.",0,"
		4 REPLIES 4
",", pattern",,https://live.paloaltonetworks.com//t5/custom-signatures/pattern-regex-less-then-7-bytes/m-p/387131#M382,02-21-2021,07:43 AM
21,354727,Custom Signatures,Mohammed_Yasin,L4 Transporter,Custom Snort Signature context operator not found,"creating a custom snort signature on Palo alto Firewall but didn’t found the concern context operator for match pattern.Shall we create a context operator or how it can add the pattern if the context operator is not available? For example:alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:""[CIS] Emotet C2 Traffic Using Form Data to Send Passwords""; content:""POST""; http_method; content:""Content-Type|3a 20|multipart/form-data|3b 20|boundary=""; http_header; fast_pattern; content:""Content-Disposition|3a 20|form-data|3b 20|name=|22|""; http_client_body; content:!""------WebKitFormBoundary""; http_client_body; content:!""Cookie|3a|""; pcre:""/:?(chrome|firefox|safari|opera|ie|edge) passwords/i""; reference:url,cofense.com/flash-bulletin-emotet-epoch-1-changes-c2-communication/; sid:1; rev:2;) Not availablehttp_methodhttp_client_body     ",0,"
		1 REPLY 1
",,,,10-07-2020,12:16 AM
22,385836,Custom Signatures,MCervenka,L1 Bithead,vulnerability signature with payload and negate,"Hello.I'm trying to write a custom app and vulnerability signature. Signatures are based on UDP-payload.When I use the custom app signature, vulnerability detection does not work. Can I somehow turn on CTD for the custom app?The other problem is that what I ideally need to do in the vulnerability is to check for the other than mine UDP-payload. So I was thinking about matching ""\xaabbccddee\x"" with negating turned on and ""\xaabbccdd\x"" in the payload in one vulnerability signature. But this does not work either. Any suggestions?Thank you.",0,"
		5 REPLIES 5
",,,,02-14-2021,03:17 PM
23,260010,Custom Signatures,DonJarmon,L1 Bithead,Windows Update Delivery Optimization (WUDO) Custom App-ID,Just seeking a Custom App-ID for Windows Update Delivery Optimization (WUDO).,7,"
		4 REPLIES 4
",,,,05-06-2019,10:07 AM
24,358774,Custom Signatures,asifkhandimensiaria-labelondata,L0 Member,Block Pubg and Fortnite,"Hi, Is anyone tried to block PUBG and Fortnite? I tried everything its not able to, please suggest the step would be helpful.  RegardsAsif",0,"
		0 REPLIES 0
",,,,10-26-2020,06:44 AM
25,349114,Custom Signatures,Mohammed_Yasin,L4 Transporter,It's possible to block custom file hash-256 in Palo alto.,"It's possible to block custom file hash-256It's possible to block custom file hash-256 in Palo alto.Please let me know how I can check the respective file hashes disposition at a wildfire, either it is in block or not. Here is below the file hashes need to know for disposition. f743c0849d69b5ea2f7eaf28831c86c1536cc27ae470f20e49223cbdba9c677ce56d45628f0c2bda30ab235657704aac50a8433bdb4215c77a2e0f52f0f31a49ae431797c551c20fe2f3fe1adc08a566edfabf45abbd924f0c8da06381ab6e484f7dd00a005caf046dd7e494fea25be2264974264d567edfc89122242b7c41bc5ae06a8d117e876476832245039715825fbfbefc0d2463ab6c30295dd1d4afa636be48e4eac81ad77aeade20b28ff8b72275832e6833f5e1b692eb99f312fd13",0,"
		4 REPLIES 4
",,,,09-14-2020,06:59 AM
26,349450,Custom Signatures,John.Petrucci,L2 Linker,Custom threat signature- search full TCP payload of any AppId,"I'm trying to write a custom threat signature.  The pattern matches just fine if I send it using netcat, but it does not match the actual application traffic.  I believe that this is because the actual traffic is processed and detected as a known application, whereas the signature Context is ""unknown-req-tcp-payload"". Is this context only for traffic that is application = unknown-tcp?  If a known application is detected, does ""unknown-req-tcp-payload"" not apply? ",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/custom-threat-signature-search-full-tcp-payload-of-any-appid/m-p/349467#M362,09-15-2020,11:30 AM
27,340192,Custom Signatures,pshah1,L1 Bithead,control URL Filtering bypass by IP,"Any way we can achieve this by creating custom signature that allows only valid http requests to URLs and not to IP addresses?As currently Blocked domain or URL not HTTPS or protected by cloud-fare can easily get passed URL filtering blockUnderstanding that IP is not a url filtering problem, so looking for ways to prevent that.",0,"
		1 REPLY 1
",,,,07-22-2020,06:18 PM
28,338467,Custom Signatures,saprakash,L0 Member,create a custom url/custom application matching the below string,"I have a requirement, where the customer wants to allow only  the below url:https://chrome.google.com/webstore/detail/zotero-connector/ekhagklcjbdpajgpjgmbionohlpdbjgc Basically the above is the url for a chrome addon : zotero-connectorHe wants to allow only the above addon and block rest of the addon to get downloaded. I tried to use url filtering for which i narrowed to: Allow:ssl.google-analytics.com/chrome.google.com/webstore/detail/zotero-connector/nullchrome.google.com/webstore/detail/zotero-connector/ekhagklcjbdpajgpjgmbionohlpdbjgcBut the twist comes when the above url opens and the customer click on the extentions.Then he can download the other addons. If i can create a custom url for the below url:ssl.google-analytics.com/__utm.gif?utmwv=5.7.2&utms=44&utmn=2033888992&utmhn=chrome.google.com&utmt=event&utme=5(webstore.StructuredWallLayout*SectionDropped*featured)&utmcs=UTF-8&utmsr=1920x1080&utmvp=1904x920&utmsc=24-bit&utmul=en-us&utmje=0&utmfl=-&utmdt=Zotero%20Connector%20-%20Chrome%20Web%20Store&utmhid=2021578656&utmr=-&utmp=/webstore/detail/zotero-connector/ekhagklcjbdpajgpjgmbionohlpdbjgc&utmht=1593708411054&utmac=UA-4436568-7&utmni=1&utmcc=__utma=73091649.1855174488.1592486775.1593704416.1593707975.12;+__utmz=73091649.1592486775.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none);&utmjid=&utmu=6QCAAgAAAAAAAAAAAgAAgAAE~Which is a redirect for the zotero-connector, my issue will be resolved. But i dont know think, i can create a custom url using any regex to match the above or create a custom app. ",0,"
		0 REPLIES 0
",,,,07-14-2020,10:18 AM
29,336446,Custom Signatures,tbrockmeye,L0 Member,Custom AppID for NAT-T traffic,I am looking for a way to identify NAT-T traffic on an IPSEC connection and define a custom app for it. To identify the IKE control plane traffic we would be looking for a 4 zero-valued bytes pattern at IP offset 28 on UDP 4500 traffic. It seems the 00 00 00 00 is the only consistent pattern in the traffic stream. Can RegEx be used to create a 7 byte pattern match? The reason for the custom app is to limit NAT-T traffic to a VPN termination point that is being overrun with requests when there is client side misconfiguration. thanks! ,0,"
		1 REPLY 1
",,,,07-02-2020,06:55 AM
30,328044,Custom Signatures,ndra,L0 Member,Virus/Win32.WGeneric.ajbecg(340897548) Need assistance,"Hi Team,These are the below sign identified in our network and want to know the reason for this trigger.Please provide the related application effected?Any additional information will be appreciated. Virus/Win32.WGeneric.ajbsuc(341044866) Virus/Win32.WGeneric.ajbecg(340897548) Virus/Win32.WGeneric.aeqdlm(295866360)",0,"
		0 REPLIES 0
",", threat",,,05-14-2020,12:55 PM
31,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
32,326590,Custom Signatures,Mohammed_Yasin,L4 Transporter,How to stop MortiAgent Malware using the snort rule ?,"I want to stop the MortiAgent malware by applying /using snort rule & also using yara rule? How to configure this in Palo alto ? Below are snort & Yara Rules: 1. The below SNORT rule can be used to detect the MoriAgent Beacon.alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"" MoriAgent BeaconHTTP Request""; content:""/Index.php?i=""; depth:200; content:""&t=""; within:64;content:""HTTP/1.1""; within:64; content:""Content-Type: application/json""; within:32;content:""Content-Length: 0""; within:90; threshold:type limit,track by_src,count1,seconds 120; sid:1000001; rev:001;)2. Below are YARA rules to detect POWERSTATS.YARA rule to detect the substitution table used in PowerShell code.rule SubstitutionTable_in_PowerShell {meta:description = ""Detect the substitution table used in PowerShell code (2019-2020)""hash = ""A18016AF1E9ACDA5963112EE8BEEB28B""strings:$a1 = ""Replace('(','a'""$a2 = ""Replace(')','b'""$a3 = ""Replace('{','c'""$a4 = ""Replace('}','d'""$a5 = ""Replace('[','e'""$a6 = ""Replace(']','f'""condition:$a1 and$a2 in (@a1..@a1+200) and$a3 in (@a1..@a1+200) and$a4 in (@a1..@a1+200) and$a5 in (@a1..@a1+200) and$a6 in (@a1..@a1+200) andfilesize < 100000}YARA rule to detect PowerStats backdoor.rule POWERSTATS_JscriptLauncher {meta:description = ""POWERSTATS Jscript Launcher""hash = ""6C97A39A7FFC292BAF8BE1391FCE7DA0""strings:$a1 = ""$s=(get-content""$a2 = ""Get('Win32_Process').Create(cm""$a3 = ""var cm=""condition:all of them and filesize < 600}YARA rule to detect PowerStats de-obfuscatedrule POWERSTATSLite {meta:hash = ""A18016AF1E9ACDA5963112EE8BEEB28B""strings:$a1 = ""$global:key""$a2 = ""$global:time""$a3 = ""webreq = [System.Net.WebRequest]::Create($url)""condition:all of them and filesize < 3000}YARA rule to detect MoriAgent implantrule MoriAgent {meta:description = ""C++ MuddyWater implant""hash = ""12755B210EC1171045144480ACD05AA8""strings:$f1 = ""|x7d873iqq"" ascii fullword$f2 = ""ljyfiiwnskt"" ascii fullword$f3 = ""htssjhy"" ascii fullword$f4 = ""kwjjfiiwnskt"" ascii fullword$f5 = ""hqtxjxthpjy"" ascii fullword$f6 = ""\\XFXyfwyzu"" ascii fullword$f7 = ""\\XFHqjfszu"" ascii fullword$f8 = ""ZmilXzwkm{{Umuwz"" ascii fullword$f9 = ""^qz|}itXzw|mk|"" ascii fullword$f10 = ""_zq|mXzwkm{{Umuwz"" ascii fullword$content = ""Content-Type: application/json"" ascii fullwordcondition:uint16(0) == 0x5A4D and filesize < 2MB and$content and 5 of ($f*)}YARA rule to detect PowerStats Implantsrule POWERSTATS_Implants{ meta:description = ""Detects all POWERSTATS implants""hash = ""A18016AF1E9ACDA5963112EE8BEEB28B""hash = ""409558610BE62655FBA0B1F93F2D9596"" hash =""DD32B95F865374C31A1377E31FA79E87"" strings:$a1 = ""if ($resp -ne $null){""$a2 = ""out = $_.Exception.Message""$a3 = ""IEX $cmd -ErrorAction SilentlyContinue""condition:all of them and filesize < 50000}",0,"
		0 REPLIES 0
",,,,05-07-2020,01:04 AM
33,319324,Custom Signatures,Jayanth_Lakshmiaria-labelpathy,L0 Member,Need guidance to block download/upload  of any file types,"Hi,In my environment, we have a requirement to block download/upload any types of files between two machines.I had deployed ""File Blocking"" profile and added the profile in the policy. Its served the purpose only for the known files types available in palo-alto, example:.exe,.pdf,.zip etc are getting blocked.txt, .log, .dat are getting blocked. User needs a solution as in similar to other firewalls, like, if we blocking download, Then firewall has to block all the file types Is there any solution available with Palo-Alto? in-other words, when trying FTP. I need to drop all ""ftp-get"" commands or ""ftp-put"" commands.Thank you",0,"
		4 REPLIES 4
",,,,03-30-2020,01:19 AM
34,315373,Custom Signatures,tkumbhakar01,L0 Member,Create Custom Application with pattern for XMPP (Jabber),Could anyone help me to build a custom application with a pattern. Application: JabberPort: TCP/5222 I want to use this URL as a pattern xyz.ab.example.com. I have followed some kb and created a custom app but the app did not match in the security policy. I need assistance with this to work.  ,0,"
		0 REPLIES 0
",,,,03-09-2020,04:14 PM
35,310628,Custom Signatures,palmanza,L0 Member,Custom Signature to allow LDAPS as SSL port 636,"Hello Everyone, Has anyone created a custom signature to create a custom APP-ID to allow SSL over port 636? I have read that decryption needs to be implemented for the Palo to identify the traffic to the right application but if decryption can not be completed how can this be done. Thanks in advance.",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/custom-signature-to-allow-ldaps-as-ssl-port-636/m-p/310866#M339,02-11-2020,08:56 AM
36,306778,Custom Signatures,alal,L2 Linker,re: 01339413,"Hi Team  One of my Customer has configured a custom signature to block the windows 7 machine based on Http request headers. This signature is working but hitting a lot of false positives as well. For example, he can see that window 8 and windows 10 also detected by this signature. The customer has followed this KB article: https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClHeCAK Can you please advise what next can be one  ",0,"
		1 REPLY 1
",,,,01-15-2020,12:58 AM
37,304109,Custom Signatures,MCabe,L0 Member,Safari Montage YouTube,"We have a school system that is want to utilize Safari Montage to filter video that an administrator whitelisted. These whitelisted video adds a referrer (somesite.someschool.org) to the http request that will go to that specific video hosted at YouTube. With SSL Decrypt enable and quic being block, the firewall will inspect the outbound traffic for the referrer, pattern matching based on this referrer with http-req-params on both GET and POST, and identify the traffic as a custom application called Safari-Youtube. The end goal is to have separate security policies for teacher and students based on User-ID. Teachers will be able to go to youtube-base and youtube-streaming, but students will only be able to go to video with the custom application Safari-Youtube. We have been able to created the custom application and applied it to only a test workstation. This first work without issue. However, as time went on testing with other videos, this started not to consistently work. According to the logs, the traffic is being decrypted, but the application is no longer being constantly identify as the custom app and is blocked by the firewall. Sometimes it flips between Safari-Youtube and youtube-base. Sometimes youtube-base only. We tried different iteration of troubleshooting, but still are not able to replicate the success when the custom application was first tested. There were not any changes done on the firewall or Safari Montage after the first successful test. Requesting any insight to an issue similar to this one. ",0,"
		0 REPLIES 0
",,,,12-17-2019,11:32 AM
38,290529,Custom Signatures,MP18,Cyber Elite,Need to Create custom signature for the nxdomain,I need to create custom signature for the dns traffic.what is want is if dns query is about nxdomain then PA should drop it. Is this possible to config in PA?,0,"
		4 REPLIES 4
",,,https://live.paloaltonetworks.com//t5/custom-signatures/need-to-create-custom-signature-for-the-nxdomain/m-p/290721#M327,09-29-2019,09:44 PM
39,297134,Custom Signatures,summers,L0 Member,Context for Custom AppID,"I’m looking to create a custom AppID for our Softphones by PureCloud. In short, we are attempting to block the chat feature within the application. The application is web-browser based and encrypted, so we setup decryption for the traffic in the hopes we could enforce security policies on the decrypted traffic. The decryption is working fine and I’ve been able to get some basic AppID’s created to recognize the traffic based on the FQDN. My goal is to create a custom AppID that goes deeper into the packet and matches on a pattern. So far, I’ve been unsuccessful. I’ve validated the parent app is “websocket” but have not been able to hit on a pattern match. I believe the issue I’m having is with the Context choice. I opened a PAN support case and worked with a tech who was helpful but limited in support he could provide (best effort only.) I’ve searched through the Live Community Discussions related to AppID’s and didn’t hit on anything helpful so far. I’ve read pretty much anything and everything I could find online and in PAN’s knowledge base articles but have not found a solution. I setup a decryption mirror port and captured some PureCloud traffic. I can provide a packet capture of the decrypted traffic for a short chat conversation. I was hoping someone could help me figure out the right Context to match patterns against or an alternative approach. Any help you could extend to me would be greatly appreciated. I found both of these resources very helpful. I list them for others who might benefit from them. Video - How To Configure A Custom App-Idhttps://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClmGCASPDF - Creating Custom Application And Threat Signatureshttps://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClOFCA0 Regards,Rob",0,"
		0 REPLIES 0
",,,,11-07-2019,03:13 PM
40,293735,Custom Signatures,s_quasar,L3 Networker,Vulnerability Custom signature not detected,"Hi,I have configured this signature:Operator: Pattern MatchContext: http-req-paramsPattern: WAITFOR\%20DELAY When I digit for example http://www.mysite.com/index.php?WAITFOR%20DELAY the signature is not matched.Can someone help me about this?  ",0,"
		1 REPLY 1
",,,https://live.paloaltonetworks.com//t5/custom-signatures/vulnerability-custom-signature-not-detected/m-p/294132#M329,10-22-2019,08:42 AM
41,289077,Custom Signatures,thomasnilsen,L0 Member,KNX/IP custom APP-ID signatures,"Hi, I have created a APP-ID signature set for detecting KNX.If you have a KNX smarthouse or industrial system this could be helpful. I will try to implement decrypt and detection of KNX in Gira S1 traffic as well in the future. Wikipedia - KNX best regardsThomas ",0,"
		0 REPLIES 0
",", app-id, knx",,,09-19-2019,02:43 AM
42,288813,Custom Signatures,tom.mccomb,L1 Bithead,"Custom Threat is being identified, but not taking the correct action.","We have a custom vulnerability for Datanyze Scraping that is being idenfied but only alerting.  This signature looks for http-req-headers and dns-req-headers for the value of Datanyze.  This is working great, I can see the traffic in the threat log so I know it is being properly identified. The configuration of the signature has it set as Severity: Medium, Default Action: Reset Both, Direction: Both and Affected System:  Client-and-server. I checked the policies where the traffic is coming in on and it has the correct vulnerability profile.  Note that on the profile we have criticals - mediums set to do a reset-both.  We also are not using app-id on this policy but traditional 80/443 service ports. Any idea why this would be happening?  My next step is a support ticket but would like to figure this one out on my own.",0,"
		0 REPLIES 0
",,,,09-17-2019,08:55 AM
43,283010,Custom Signatures,sayed_shubbar,L0 Member,pattern match for less than 7 byte application,"Hello all, we are trying to implement user-Agent feature that's exist in MWG proxy. on attched wireshark capture screen shot ""wget"" user agent has only 4 bytes. do you have work around to make signature equal to 7 bytes. I also attached screen shot erro from Palo",0,"
		3 REPLIES 3
",,,,08-15-2019,01:32 PM
44,257011,Custom Signatures,Danimal,L0 Member,IPv4 flags as App-ID Signatures?,"Hello,  Is it possible to use simple IPv4 flag info as match criteria for App-ID signatures? I'm looking for something simple such as matching source IP, destination IP and destination port. I'm not having any luck finding patterns in the data to use and I really need an App-ID to adjust TCP time out values.  This is to accomidate poorly designed medical equipment that needs to be protected but does not function correctly behind my firewall.  Any advice is much appreciated.  Sincerely,-Dan ",0,"
		1 REPLY 1
",", app-id, signature",,,04-10-2019,08:54 AM
45,259735,Custom Signatures,bt.guvenlik,L0 Member,There is no CVE-2019-9082 signature,"Hi, Nowadays some attackers attack our web site relevant code injection. Perimeter firewall is Palo Alto and seperator firewall is Fortinet. This attack type is below that's not keeping by PA but it's keeping FG so prevent.I obsevered this signature but I couldn't find on the PA database.This type of attack are increase last a few mounth. please help, you sign that signature by PA and update.  ",0,"
		2 REPLIES 2
",,,,05-03-2019,06:58 AM
46,275351,Custom Signatures,apik0088,L0 Member,custom web ssl based application,hello guyes.what will be the right way to describe the custom application for the pcap in the attach?the unique id is the fqdn site1.qwe.loc ,0,"
		0 REPLIES 0
",,,,07-08-2019,07:28 AM
47,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
48,258964,Custom Signatures,nkatesan_radharia-labelakrishnan,L4 Transporter,how to get vulnerability signature pattern,HI @reaper  Palo alto is releasing content update every week and changes in default action will be changed periodically. Recenty in Content version 8146 vulnerability 55570  Oracle WebLogic wls9-async Remote Code Execution Vulnerability  action is set to resert-server.  How can i get the signature pattern used by this vulnerability to confirm the incoming data is vulnerable. When palo alto confirm incoming data is vulnerable by matching with this vulnerability id then how can i get that vulnerable data payload. RegardsVenky,0,"
		3 REPLIES 3
",,,,04-28-2019,06:03 AM
49,258949,Custom Signatures,vsys_remo,Cyber Elite,Block access to websites available over their IP (and not a FQDN),"Hi community Does anyone already managed to block access to websites available directly with their IP? Actually with regex this would be an easy task, but I have some difficulties creating a custom application signature as there isn't the full regex available and there is also the limitation that the first 7 bytes of the signature need to be a static value. So with a signature for http host header there is no chance to create a pattern for IP addresses.Does anyone already managed to create such a signature or could point me to the right direction to create one? Thanks,Remo",0,"
		0 REPLIES 0
",,,,04-27-2019,12:39 PM
50,256260,Custom Signatures,ukacko,L0 Member,Unable to negate Signature pattern-match. Why Custom Vulnerability has Negate option but Apps NOT?,"I created custom app for ldaps tcp/636 based on signature (ssl-rsp-certificate) which contains text from certificateThis caused https - tcp/443 (ssl based) traffic to match this new custom app.After some investigation I realised that https context ssl-req-client-hello contains http/version (i.e. http/1.1) and wanted to filter out this in my custom app so it will not match https any more.Unfortunately I run into limitation where I am not able to Negate my pattern-match. Something that is possible in Custom vulnerability is not possible in Custom App, unfortunately and sadly.Proposal to specify port 636 under Advanced/Defaults is not a solution. Reason: Custom application signature behaves similar way as pre-defined. App-ID does not work merely on default port information but also other conditions.For example, if you have web-application running on custom port, it will be identify as web-browsing as soon as it matches to web-browsing signatures.",0,"
		0 REPLIES 0
",,,,04-05-2019,02:14 AM
51,254632,Custom Signatures,JackField,L0 Member,Blocking web content with custom data patterns,"Hi all, I'm trying to use custom data patterns to block all content related to the 'Momo' hoax.  I'm having issues getting around the fact that 'momo' is smaller than 7 bytes. Do you have any recommendations on how to use an anchor 7 bytes or longer that would block momo Google, Image and Youtube searches? So far I can only stop searches from the address bar using:  http-re-params: search\?q=(.*momo.*).{1,1000}rlz=1C1GCEA_enGB Would really appreciate any help. Thanks,Jack",0,"
		0 REPLIES 0
",,,,03-22-2019,02:56 AM
52,248893,Custom Signatures,ckyboone,L1 Bithead,Office XML with Macros,"This is a custom vulnerability signature I created based on what I was seeing come through to our users.  Usually, the malicious Office files with macros were in either the binary Office 2003 format or the newer Office 2007+ format.  What I was seeing were Office XML (2003 era) files. Note, this signature includes a specific string match for Word (since that was the only sample I had at the time), however it should be pretty simple to adjust for other patterns (Excel, etc.).  I based the signature on the sample I had, plus a few resources online such as the following YARA rule:  https://github.com/Neo23x0/signature-base/blob/master/yara/crime_dridex_xml.yar ",0,"
		0 REPLIES 0
",,,,02-05-2019,08:34 AM
53,178320,Custom Signatures,Anon1,L4 Transporter,Custom Antivirus Signatures,"Is it possible to create custom antivirus signatures?Goal is to block files with certain hashes. The original file is not available, only the hash.Is there any way to submit hashes to PANW so that they create signatures? (Something similar like for URLs)",3,"
		4 REPLIES 4
",,,,09-22-2017,12:12 PM
54,245165,Custom Signatures,mojunhwan,L0 Member,Webmail Control via URL,"Can paloalto control the sending of web mail? i want to make it impossible to send out from the webmail.There is a service called Naver that provides web mail like Google.for example, The URL for sending is as follows.mail.naver.com/n=111113333&v=f#%7B""fClass""%3A""write""%2C""oParameter""%3A%7B""orderType""%3A""new""%2C""sMailList""%3A""""%7D%7D I created a policy using the URL category.mail.naver.com/^=f#%7B""fClass""%3A""write""%2C""oParameter""%3A%7B""orderType""%3A""new""%2C""sMailList""%3A""""%7D%7Dmail.naver.com/*=f#%7B""fClass""%3A""write""%2C""oParameter""%3A%7B""orderType""%3A""new""%2C""sMailList""%3A""""%7D%7D I would like to set a policy that is impossible to send through the URL.   The results of the URL test were not blocked. Using the http protocol and using 80 ports. Is it possible to implement it? If there's anything I missed, give me some advice I also wonder if the gmail can also be controlled.It was not long after I started the Palo Alto firewall. I hope you understand.",0,"
		1 REPLY 1
",,,,01-07-2019,11:08 PM
55,244046,Custom Signatures,Rigbyj06,L0 Member,Threat ID for CVE-2018-8653 Internet Explorer,"I'm not seeing a threat ID for the new IE vulnerability (https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8653#ID0EN). Has anyone been able to create a custom ID for it, or know if Palo is working on one? Thank you",1,"
		3 REPLIES 3
",,,https://live.paloaltonetworks.com//t5/custom-signatures/threat-id-for-cve-2018-8653-internet-explorer/m-p/244155#M286,12-20-2018,08:07 AM
56,241141,Custom Signatures,gheorghe.ms,L1 Bithead,Custom signature not working as expected,Hi GuysI have the follwoing issue:I have a policy rule where I allow  smtp flow! On this rule I have a vulnerability protection profile. In this pofile I have 2 rules:- one rule which is supposed to allow emails with bb.com in the subject-the second one is the one which is denying emails from aa.com Both rules have custom vulnerability objects:test_aa.com test_bb.com.com The idea is to block emails with aa.com in the subject but allow emails wich have aaa.com and bb.com in the subject.I'm trying since some time and I think now is the momment to ask for help as I don't uderstand what is happening!When I send emails with only aa.com they are dropped correctly but alos when I send with aa.com and bb.com in the subject. As you can see I used the order and the one with allow bb.com is before the one denying the aa.com.Is my understanding about the vulnerability profiles not correct or is just a regex issue?Thanks for the help!Marius,0,"
		0 REPLIES 0
",,,,11-26-2018,01:24 AM
57,237202,Custom Signatures,svintinner,L1 Bithead,Creating a custom app signature to block by URL path,"I'm hoping to get some help with a custom signature that I've created.  We're trying to block users from playing flash games on facebook, but still allow them to get to everything else.  For example:  https://apps.facebook.com/candycrush.  The URL category is social-networking and the application is facebook-apps. I've created a signature to detect the app as follows:   Picture of the GUI config:   I'm missing something with the AND syntax.  It works fine if I only look for the http-req-host-header or if I only look for the http-req-uri-path, but when I add both, it doesn't work. Any help would be appreciated.",0,"
		5 REPLIES 5
",,,https://live.paloaltonetworks.com//t5/custom-signatures/creating-a-custom-app-signature-to-block-by-url-path/m-p/237295#M278,10-25-2018,03:40 PM
58,236434,Custom Signatures,Rajeshshah,L0 Member,Identifying Mobile no  - Data Pattern,"Dear All,Please find bellow our requirement: 1) We would like to restrict document going out from their network which has more than 5 mobile numbers.Thus would require a regex of mobile no to be configured in Data Pattern. We configure regex  -((.*09([0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]))|(.*([0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]))|(dummystring)) Below Mobile No should ideally get detected -098765432109876543210 ""Dummystring"" is just a workaround for 7byte limitations. We also tested ""https://regexr.com/""on website recommended by Palo and it is working fine. However when deployed on Palo, mobile no is not getting detected. ""dummystring' is getting detected which means configuration of policies is correct. It would be great if someone can help. RegardsMitul   ",0,"
		1 REPLY 1
",", custom signature, Data Pattern, regex",,,10-21-2018,11:24 PM
59,236160,Custom Signatures,Emanuele,L0 Member,Application  with Custom Signature & Layer 7 Processing,"Hello All,I have a PaloAlto PA-500 firewall on which I created my custom application based on custom signature. During the custom application creation on the Characterestics section I checked the ""Continue scanning for other application"" flag (refer to attached file -> CustomApplication-Characteristics.png).I've configured a policy that allow the traffic that match my custom application and all the remaining traffic goes to default interzone policy (thus it is blocked).As you can see from attached screenshot (refer to ShowSessionIdCommand.png) the firewall correctly identify the traffic and match my custom application (called Brass_FAB-TCP-2505-CMP).Anyhow, I noticed that, as soon as the firewall identifies the traffic as Brass_FAB-TCP-2505-CMP, the ""layer 7 processing"" switch to ""completed"" (as shown on ShowSessionIdCommand.png) and from this moment on, within this session, any traffic flowing through the firewall will pass without any inspection.Can you please clarify if this is the normal behaviour for the equipment or not? If yes, what is the purpose of the ""Continue scanning for other application"" flag?What is the way to have the firewall continuously inspecting/analyzing the traffic that match my custom application? Thanks all. CustomApplication-CharacteristicsShowSessionIdCommand",0,"
		2 REPLIES 2
",,,,10-19-2018,05:59 AM
60,233527,Custom Signatures,s_quasar,L3 Networker,custom signature to reset php pages,"Hi,I have only CFM pages so I want to reset/block all traffic about PHP extension in my pages.How can I implement this? Greetings",0,"
		0 REPLIES 0
",,,,10-03-2018,01:42 AM
61,233287,Custom Signatures,Alex_Samad,L4 Transporter,To customize app-id or no,"Hi Newish user to PA's 1 year now I think. I came from cisco - ip / port acl's I am trying to move to app-id nicer easier policies.So for office traffic I use app-id for my prod platform I use applicaiton overide to custom applications, so that I can by pass any inspection . I care more about speed and latency. For example my developer use artifcatory - http access. with inspection on compilation time could be 5-6 min. with it off might be 60-90sec.  Thats just cause some much traffic is sent. << Actually did this with a custom app-id so our platfrom is typical  Internet -> fw -> reverse proxy -> app ... I don't want to inspect the traffic. but I am also happy to relook at stuff.  how much extra processing does app-id custom signatures take..  how do you create custom id's for developer written protocols ? does it just look at the first x bytes / packets ?? A",0,"
		0 REPLIES 0
",,,,10-01-2018,09:13 PM
62,233084,Custom Signatures,AFY-admin,L0 Member,How to customize a special Cross-Site Scripting blocking signature?,"How to customize a special Cross-Site Scripting blocking signature? Cross-Site Scripting:http://xxx.xxx.xxx/search~S5*cht/?searchtype=X&searcharg=1234&searchscope=5&sortdropdown=-&SORT=DZ&extended=0&SUBMIT=%E6%9F%A5%E8%A9%A2&searchlimits=%22%20oNmOuSeOvEr%3dalert(%2720180305_XSS_VUL_DETECTED%27)%20%22%EF%BB%BF&searchorigarg=X1234  This is F5 ASM customize signature:paloalto how to customize????=========================profile:CUS_oNmOuSeOvErSignature Type:RequestSystems:Unix/Linux、Apache、Apache Struts、Apache TomcatAttack Type:information LeakageRule:Advanced edit modepcre:""/[oO][\+]{0,5}[nN][\+]{0,5}[mM][\+]{0,5}[oO][\+]{0,5}[uU][\+]{0,5}[sS][\+]{0,5}[eE][\+]{0,5}[oO][\+]{0,5}[vV][\+]{0,5}[eE][\+]{0,5}[rR]/"";",0,"
		0 REPLIES 0
",,,,09-29-2018,07:42 PM
63,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
64,232897,Custom Signatures,HemanthV,L2 Linker,custom option for Email alert notification,"Hi  we have a PA 220 firewall configured with multiple ISP's, how to get an email alert if any ISP link up or down is it possible to configure ",0,"
		0 REPLIES 0
",,,,09-28-2018,12:07 AM
65,231180,Custom Signatures,StevePerich,L0 Member,Custom signature for IMAP,"Hey there! I need to create a custom application based on the LOGIN string sent to an IMAP server (Office 365) via port 993 (TLS/SSL encrypted) to differentiate it from other O365 traffic. Tech_Note-Creating_Custom_Signatures-RevE.pdf I should be able to match on the imap-req-first-param context but the fw is detecting the traffic as imap.  I have configured and tested SSL decryption okay and am outputting to a SSL decryption mirror to confirm the unencrypted data being sent. The custom application is a child of the imap application (I've tried it as no parent app as well, didn't work), and has default port tcp/993 set. I've got one signature:Scope: session (I tried transaction, didn't work either)Ordered condition match is offOR condition - Operator Pattern MatchContext - imap-req-first-paramPattern is part of our domain name, as is (no \'s or brackets)No qualifiers, tho I've tried with imap-req-cmd = LOGIN but it didn't help. Any ideas?  Thanks in advance 🙂",0,"
		0 REPLIES 0
",,,,09-17-2018,08:48 PM
66,230922,Custom Signatures,AdrianoWit,L0 Member,Lets Encrypt,"Our customer is implementing the Lets Encrypt (https://letsencrypt.org/) in the whole his infrastructure. This way, every certificates SSL expired in 90 days.The Palo Alto use certificate SSL to VPN, Captive Portal, and others services.Is there an automatic procedure of how to change these certificates? Has the Palo Alto API support for this kind of implementation?If it is not possible via API, is there another way to do it? By script, for example.Does any other customer already implement the Lets Encrypt with PA? Do you have any recommendation or best practices for use Lets Encrypt with Palo Alto?The goal to avoid the manual process.Tks.",4,"
		0 REPLIES 0
",,,,09-14-2018,01:16 PM
67,229784,Custom Signatures,vsys_remo,Cyber Elite,Custom App-ID for DNS-over-https,"Hi community As you may have noticed DNSSec is extremely slowly getting attention and it even does not improve the users privacy because the dns request are only signed but not encrypted. So other people and companies are searching alternatives to secure DNS requests. One of these alternatives which could already be approved by the IETF in octobet 2018 is DNS-over-HTTPS (DoH). Mozilla already plans to enable DoH by default in the near future with the DoH server of cloudflare. In current versions it is already possible to enable DoH manually in the firefox browser (in about:config you will find the correspondig config entries with the searchstring ""trr"" (trusted recoursive resolver)),While DoH is great mainly because of privacy reasons, it might be a risk in companies where the DNS requests are monitored, controlled and with firewalls restricted to the corporate DNS servers. With DoH all existing protections are mostly useless - and also the DNS-proxy and DNS-sinkhole feature in Paloaltofirewalls so far does not know about this new DNS method. Because of that probably the only option is to block DoH on the firewall to retain existing protections. So I created a custom App-ID with which it is possible to block the existing DoH implementation in Firefox 61, the methods that cloudflare DoH DNS server offers and the DoH IETF draft.TLS Decryption is (obviously) required to make it work. This App-ID probably needs some changes and additional signatures in the future, but so far it works do block these requests to force a fallback to traditional DNS requests over an unencrypted UDP connection. Feel free to improve this App-ID, but if you do so I kindly ask you to post it again here so other can also benefit. Regards,Remo ",7,"
		1 REPLY 1
",", dns, DoH",,,09-06-2018,10:32 AM
68,209663,Custom Signatures,ktague,L2 Linker,Custom Signature to Detect Weak Cipher Negotiation in Phase 1 ISAKMP Negotiation,"Good Afternoon,    Is it possible to create a custom threat signature or APP-ID to match various strings of data inside of the ISAKMP initial payload during the IPSec phase 1 negotiation. The first packets are sent in plaintext during the negotiation. This would be done in order to determine if a weak cipher is being used during tunnel initiation. Example:ISAKMP Packet:Payload: Proposal -> Payload: Transform -> IKE Attribute -> :Hash-Algorithm: SHA IKE Attribute -> :Group-Description Pattern Match on Hash-Algorith and Group-Description specification..*(Group-Description:).*((group 1)|.*(1024-bit)).*(Hash-Algorithm:).*((SHA)|.*(3DES))The first expression looks for 'Group-Description:' followed by the word 'group 1' or '1024-bit' for example. The second expression looks for 'Hash-Algorithm:' followed by the word 'SHA' or '3DES'.Screenshot example attached. Any guidance would be appreciated, Thanks!",0,"
		1 REPLY 1
",,,,04-11-2018,02:37 PM
69,212358,Custom Signatures,vkovyrshin,L0 Member,How to submit changes to existing Add-id?,"Hello. We're noticed that webex app uses SIP connection over port 5061. I don't see it's listed in App-ID database and I believe it should be there. Please correct me if I'm wrong.How do I submit App-ID change request? Since it's related to webex in geneal, I believe it should be done at global level, rather then custom AppID. Thanks,Victor Related docs:https://collaborationhelp.cisco.com/article/en-us/WBX264https://go.custhelp.com/app/answers/answer_view/a_id/1000625/loc/en_US/s/16777220_127137b26f0449-d30...  ",0,"
		2 REPLIES 2
",,,,04-30-2018,01:49 PM
70,216732,Custom Signatures,jsalmans,L4 Transporter,A few questions about signatures and custom apps,"So I've had some issues with the most recent custom app I'm attempting to make.  Our server team is implementing Papercut on campus and there doesn't seem to be a pre-built app for it.  I submitted a request for it but figured I'd try to take a crack at it myself. It's turned out to be fairly interesting... Windows and Apple iOS devices ended up being pretty easy to identify but Android lacked any of the custom signaturese I was looking at in Windows.  I ended up just basing it on the SSL cert for now. ChromeOS has been the latest pain.  I found something in the pcap that looks promising... basically a Chrome extension ID that, I believe, should be static and unique (you can see the Origin line is highlighted):  Next, I started a custom app using tcp/9163.   With the signature, I started including the chrome-extension but ended up doing just the ID after many attempts to get it to identify it with no luck.  The traffic is still just identified as web-browsing... any idea what I might be doing wrong here? Also, on the page:  What happens if I add more signatures here?  There doesn't seem to be a way to move them around for order of precidence... is this considered an OR list or an AND list? Thanks!  ",0,"
		4 REPLIES 4
",,,,06-05-2018,01:51 PM
71,213897,Custom Signatures,Khandesha,L0 Member,Office 365 Vulnerability of HTML  “baseStriker attack” and Mitigation by PAN Firewall,"Hi Team,recently there is one vulnerability found in office 365 vulnerability has been identified in Microsoft Office 365, a remote user can exploit this vulnerability to trigger Security Restriction Bypass on the targeted system. Is there any way to block the office split HTML in PAN firewall.  Vulnerability Types and Methods: Found using in the wild to bypass a security feature of Microsoft Office 365, which is originally designed to protect users from malware and phishing attacks called “baseStriker attack” “.Dubbed Safe Links, the feature has been included in Office 365 software as part of Microsoft's Advanced Threat Protection (ATP) solution that works by replacing all URLs in an incoming email with Microsoft-owned secure URLs. So, every time a user clicks on a link provided in an email, it first sends the user to a Microsoft owned domain, where the company immediately checks the original URL for anything suspicious. If Microsoft's scanners detect any malicious element, it then warns users about it, and if not, it redirects the user to the original link. Thanks  Khandesha Kothale",0,"
		0 REPLIES 0
",,,,05-10-2018,05:47 AM
72,213639,Custom Signatures,kemble,L1 Bithead,Regex for User Agent for ASA Anyconnect syslog," We have stale userID/IPaddr entries in PA from our AD servers.We implemented regex and syslog feed for the campus ASA so solve the issue, but need it also for Anyconnect user traffic. Found what appears to be the regex for anyconnect syslog feed.https://live.paloaltonetworks.com/t5/Automation-API-Discussions/Cisco-Anyconnect-Regex-for-User-ID/m... Is there something more recent or an alternative? ",0,"
		4 REPLIES 4
",,,,05-08-2018,04:20 PM
73,212953,Custom Signatures,dberber1,L2 Linker,Quick Question - escaping parentheses?,"So, none of the docs I can find show parentheses as a reserved character, but when I put in a regex of 'sample(_POST' it is rejected, but when I do 'sample\(POST' it is taken - in these samples the '' are not there.   But, I'm not sure if the REXEX is matching on the \( or just (  <edit> here is an error example: pattern '=@eval(base64_decode($_POST' is invalid. syntax error at end of input 42100 -> signature -> standard -> dummyRule -> and-condition -> And Condition 1 -> or-condition -> Or Condition 3 -> operator -> pattern-match -> pattern is invalid Any ideas?",0,"
		0 REPLIES 0
",,,,05-03-2018,06:26 AM
74,211688,Custom Signatures,dkramer,L0 Member,Regex Issue," Hey Everyone, I am having an issue that I can't explain.  I am building a signature to match on IP addresses in the X-Forwarded-For Http header.  what I have come up with is this: ""For: 1\.2\.[3-4]\..*""  This is working well, but I am having an issue with certain ranges I have one that is ""For: x\.x\.[176-179]\..*""  this throws an invalid pattern error and I have it narrowed down to the actual range of 176-179.  If I switch that to be [170-179] it accepts the pattern fine.  Has anyone seen this issue before?  If so how did you fix it? Thanks,Dave",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/regex-issue/m-p/212708#M243,04-25-2018,07:12 AM
75,208797,Custom Signatures,tmagdziasz,L0 Member,Fortnite,Is anyone successfully blocking fortnite?  I'm also looking to block PUBG Mobile,0,"
		1 REPLY 1
",,,,04-04-2018,12:41 PM
76,206382,Custom Signatures,kstiver,L0 Member,Custom APP-ID for more granular access to MS Office online components,"I would like to have more granular control over access to Microsoft online resources, specifically Visual Studio tools. Access to the site currently is identified as 'ms-office365-base' but I would like to specifically identify the logon page and resources under 'visualstudio,com' as a separate app from 'ms-office365-base' so that I can allow access to this resource only. I have created a custom APP id and specified pattern matches 'http-req-host-header' as 'login\.microsoftonline\.com' AND 'http-req-message-body' as 'visualstudio\.com', which was captured in the Firefox request for URL: https://login.microsoftonline.com/common/oauth2/authorize?client_id=499b84ac-1321-427f-aa17-267ca697... The access is still being identified as 'ms-office365-base', and I would like access to this page be identified as my custom app 'ms-visualstudio-online' Can you help?",0,"
		0 REPLIES 0
",,,,03-19-2018,09:08 AM
77,132930,Custom Signatures,_gine,L1 Bithead,Basic Rule to Detect/Alert on OvenVas Scanners,"So I'm surprised that the Palo Alto doesn't have a signature to detect OpenVAS scanners. I would like to create a simple rule that detects ""User-Agent: OpenVAS"" (Ultimately I would like to just block these entirely. Is something that can be easily built?",0,"
		2 REPLIES 2
",,,,12-14-2016,05:23 PM
78,196253,Custom Signatures,mprice1,L0 Member,Create custom threat signature using the API,"Is it possible to use the API to create a custom threat or vulnerability signature ?  Plenty of examples showing how to do this using the WebUI, but customer is looking for automated ability. thanks, michael",0,"
		1 REPLY 1
",,,https://live.paloaltonetworks.com//t5/custom-signatures/create-custom-threat-signature-using-the-api/m-p/196410#M234,01-22-2018,11:13 AM
79,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
80,194003,Custom Signatures,Daniel_Li,L2 Linker,How to create new APP ID or signature to block VPN360 App,Hi ! I was refered by TAC support to post requst here. we want to block VPN360 Apps on Iphone. It uses proxy IP to access internet bypassing URL filtering. IP is hopping and changing everytime you disconnected and reconnected App and it is standard SSL. Following is App in App store  https://itunes.apple.com/us/app/vpn-360-unlimited-vpn-proxy/id1193154948?mt=8 PLease see if you provide some suggestion to block this and refer to the tac ticket 00802751  if required Daniel ,1,"
		0 REPLIES 0
",,,,01-05-2018,06:45 AM
81,192911,Custom Signatures,jjurdi,L1 Bithead,Custom Signature for Dahua NVR,"Hello All, I am working on creating a custome signature for a Dahua NVR that we would like to allow remote access to.  It operates on port 37777 which has been allowed, but traffic still shows up as unknown-tcp and is subsiquently blocked.  Does anyone have experience working with one of these devices or creating a signature for it?   We opened up the rules to allow any application and was able to capture some traffic while using it.  Would this be enough to create a signature? Thank you all in advance!Jon  ",0,"
		6 REPLIES 6
",,,,12-22-2017,09:04 AM
82,118951,Custom Signatures,aulBrock,L2 Linker,Help with creating a custom App,"Hi Everyone,I have a application that is currently being detected as unknown-tcp and would love to be able to create a custom app to allow it rather than having to allow uknown-tcp.I have attached a capture from the Firewall, i am just uncertain as to what data to pull out of this and what fields to fill in in relation to signature (actually uncertain about it all..lol)If anyone could help that would be fantastic.   ",0,"
		8 REPLIES 8
",,,,10-11-2016,03:33 PM
83,135488,Custom Signatures,KiCheon.Lee,L4 Transporter,What purpose is 'parent app' when to create custom app?,"Hello, I don't understand why 'parent app' is.What is it used for? and When is it used?if I choose 'facebook-base' in parent app when I create 'ABC' of custom application, the 'ABC' application is inherited the signature from 'facebook-base'? Honestly, I don't think it as above. I thought this setting is just information showed. I hope to get advice from you.    ",0,"
		1 REPLY 1
",,,,01-03-2017,01:11 AM
84,186632,Custom Signatures,smalayappan,L2 Linker,Customer signature to Block C & C++ Programes,"Hi Team, One of the customer is looking to block files based on data filtering and he wanted to block any text that contains C programs, he wants to block based on the keywords used in the program. Sample Regex used by customer. .*(.*(\#include).*((cout)|(cin)|(return)|(main)|(iostream)))  Can anyone be of some assistance to us on this query.",0,"
		0 REPLIES 0
",,,,11-13-2017,01:49 AM
85,78827,Custom Signatures,david3,L4 Transporter,Signature for Clash of Clans game,"I built the attached custom application signature for the Clash of Clans game (previously identified as unknown-tcp) based on taking multiple pcaps and finding the first 7 bytes of the first 4 data packets appear to be constant across sessions. However, I have a rather limited test bed of one iPad accessing one clan at this time. Comments and refinements welcome.",1,"
		4 REPLIES 4
",,,,05-31-2016,08:49 AM
86,179758,Custom Signatures,Gianpiero,L1 Bithead,Email body signature,"Hi allI have a question about the possibility to create a specific custom signature to block some mail.I need to block email that contantains:1- specific email address(it is easy i did it)2- email with some specific word contained in the email body(for exemple ""i wont you"")3- email with specific URL in the body(ex. ""www.link.com"") Is it possible?Can you help me to create it?Thanks a lotBye Gianpiero",0,"
		0 REPLIES 0
",,,,10-03-2017,12:49 AM
87,176575,Custom Signatures,Rameshwar,L3 Networker,zenmate application,"hi  zenmate application is available in PA app but it is not blocking the traffic , tried using the URL based but pcap doesnt show any URLtried to block through client hello SNI but no lcuk ....please advise how i can block this on PA  app name - zenmate - browser based proxy ",0,"
		10 REPLIES 10
",,,,09-14-2017,09:35 AM
88,178625,Custom Signatures,scottoliver,L2 Linker,Custom Data Patterns,I am trying to create some data patterns for credit card numbers. I cannot get it to take any of my regex statements. below is one of them the error is saying its invalid. Does anyone have any good solid Credit Card Number and Social Security Number Data Patterns? \b(?:3[47]\d|(?:4\d|5[1-5]|65)\d{2}|6011)\d{12}\b,0,"
		1 REPLY 1
",,,,09-25-2017,05:42 PM
89,173910,Custom Signatures,markibr,L0 Member,Custom App for SIP,"As a SIP provider, looking for to create a custom signature that matches a SUBSCRIBE message from the packet payload w/ 10 or 11 digits. We first tried this w/ Data Patterns under the Custom Objects but that didn't solve/address our issues.We then created a custom app (SIP-SUBSCRIBE) to match the sip application already available in the DB, and then created a new signature called 'Subscribe' with a 'Session' Scope type. Furthermore, we selected the ""Ordered Condition Match"" in order to actually be able to match a regex string against the packet.  The regex in question was written as follows: .*(SUBSCRIBE sip:[0-9]\{10-11}@) and is to match any sip packet w/ a Subscribe message containing a string of 10 or 11 digits. (At least, that was our intention) We then created a security rule where we matched the custom application called SIP_SUBSCRIBE and set it to Allow at first so we could see that it was actually matching what we were looking for but unfortunately didn't see any matches. (Even though the attack was still ongoing)",0,"
		2 REPLIES 2
",,,,08-30-2017,10:36 AM
90,173695,Custom Signatures,cstarks2,L1 Bithead,Block Macro-enabled Word documents,"I am trying to create a custom signature to block macro-enabled word documents. I can't use the ""39154"" signature for blocking, because it also blocks other office documents, such as .xlsx. I am in the testing phase, and I have created a custom signature to detect and alert on just word documents with macros enabled, but so far I have been unable to get the alert to actually trigger. I'm using the ""file-office-content"" context to find the below pattern matches. I found the strings in various macro-enabled word documents using a hex viewing tool.One of these four patterns must match:word/_rels/document.xml.relsMicrosoft.Office.Word\x776F72642F5F72656C732F646F63756D656E742E786D6C2E72656C73\x\x4D6963726F736F6674204F666669636520576F7264\xANDOne of these patterns must match:vba.*versioncompatible32vba.*VersionCompatible32VBA.*versioncompatible32VBA.*VersionCompatible32x\-vba\-macrosVbaProject\.binvbaproject\.binvbaProject\.bin",0,"
		4 REPLIES 4
",,,https://live.paloaltonetworks.com//t5/custom-signatures/block-macro-enabled-word-documents/m-p/173899#M194,08-29-2017,10:26 AM
91,170394,Custom Signatures,Nicka,L1 Bithead,SMTP Signature Help,"We have been slammed with random Chinese IP addresses attemping to brute-force accounts via SMTP.  Amusingly enough, our gateway doesn't even support that feature but the amount of traffic attempting it is consuming all available ports. I was able to make a signature to catch it when the server responds back with a ""502 Unsupported"" command but the problem is this alone makes Palo Alto think the attacker is always the server and not the client.  So I need to add something to detect the client's traffic first... The clients are sending an ""AUTH LOGIN"" command.  I can create a rule to detect the AUTH part but the string for ""LOGIN"" has to be at least 7 characters, which is impossible to meet those requirements.  I then tried to create a negate rule but that didn't work and it wouldn't detect the rule at all.  So any ideas how to get this to work? For the time being I just created a DOS resource policy to only allow 5 concurrent source-IP connections.  It works but I'd rather have a rule to actually block-IP the attacker for 30 minutes then just let them continue attacking us. I contacted support and they redirected my case to the threat team.  The threat team then sent me here saying they do not offer help on custom signatures and to post any questions in the forums... ",0,"
		5 REPLIES 5
",,,,08-07-2017,01:34 PM
92,170445,Custom Signatures,ajatmaka,L1 Bithead,InfluxDB Application Traffic,"Hi Everyone I have a problem, in monitoring traffic, connection influxdb with port 8086 did not work. traffic status is incomplete.I was trying setup manually application for influxdb but did not work.    Could you give me a explanation?",0,"
		1 REPLY 1
",,,,08-08-2017,12:23 AM
93,170244,Custom Signatures,Rameshwar,L3 Networker,Block Turbo VPN 1.8.1,"please advise how can i block the mentioned vpn on FW i have blocked all the URLS using URL filtering which was hiting the firewall showing under URL filtering after enabling alert on all catagory blocked unknown - tcp and unknown - udp traffic SSL decryption  is enabled  please advise , i have a packet capture , can i block the URLS which i see in pcap or i should do the smae using signature but how can i track the sig in pcap ",0,"
		0 REPLIES 0
",,,,08-06-2017,10:18 PM
94,78973,Custom Signatures,cole,L4 Transporter,Example Signature for WPAD.DAT Exploitation (TA16-144A),"One attack avenue for an organization that the US-CERT is currently alerting on is the abuse of Web Proxy Auto-Discovery in order to hijack traffic by directing a web browser to a proxy they own. The technical details are available at: https://www.us-cert.gov/ncas/alerts/TA16-144A There are three avenues of detection I am aware of: 1) Detecting a DNS query with ""wpad."" in the content. This does not appear possible with the current custom signature engine, as there is not a 7 byte static anchor to signature off of. 2) Detecting an HTTP transaction in which the content of the ""Host"" header starts with ""wpad."" 3) Detecting an HTTP transaction in which the URI contains ""wpad.dat"" I've written a custom signature that covers points 2 and 3 to illustrate what is possible. This signature was written as an example to illustrate what the custom signature engine can do. It has minimal testing in a production environment, and is meant as a pivot point for creating your own custom protections. It's also imperative to remember that this signature will be very noisy if it is applied to internal environments, and makes the most sense only applied to traffic destined for the untrust zone. Have fun, signature enthusiasts!",1,"
		1 REPLY 1
",,,,06-01-2016,01:28 PM
95,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
96,166396,Custom Signatures,phi1771,L0 Member,Custom Signature Help,"Hi,  I'm attempting to create an application signature to detect Amazon AWS backups. I captured SSL client hello packets to get the the below hex for the pattern match, but signature is not fireing.  Packet,  Hex value,/x 3531333438623763302d646432372d313164662d393337622d3038303032303063396136362e73332e616d617a6f6e6177732e636f6d /x Signature condition match,",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/custom-signature-help/m-p/166634#M182,07-13-2017,12:40 PM
97,96642,Custom Signatures,aelmore,L0 Member,Pokemon GO,"With the rise in popularity of the new Pokemon GO app, has anyone had the opportunity to build a signature or possibly even gather a pcap of the traffic that could be shared (the site is not allowing signups right now so I am unable to produce my own test traffic to collect). I have received complaints from as high as our CIO, that too many people are walking around playing this game and we need to report on it and block is ASAP. Any help is appreciated,-adam",0,"
		4 REPLIES 4
",", app-id, pokemon, pokemon go, sni",,https://live.paloaltonetworks.com//t5/custom-signatures/pokemon-go/m-p/97217#M111,07-11-2016,09:04 PM
98,150650,Custom Signatures,LCMember25117,L0 Member,APPID signature  for Zebra Printers showing unknown-tcp or insufficient data,"I am seeing that traffic that goes to an specific vendor/model (Zebra LP 2844-z) of labeling printers is being categorized as APPid unknown-tcp or insufficient data on port 2001 TCP. I would like to know if there is a way to get this added to your APPID database so when traffic matching this signature is automatically tagged. Regards,M",1,"
		3 REPLIES 3
",,,,03-31-2017,12:25 PM
99,161268,Custom Signatures,Andy.Lim,L0 Member,support NATO STANAG 4609,I am looking for the APP-ID based on the signatures  that support NATO STANAG 4609 (Motion Imagery Standards Profile),0,"
		1 REPLY 1
",,,,06-14-2017,01:21 PM
100,153846,Custom Signatures,ansharma,L4 Transporter,Regex for syslog User-ID not working,"Hi team, We have the (Cisco & Ruckus) Wireless controllers forwarding SYSLOGS to the User-ID agent running on Windows 2012 server. We want to use these syslog messages to create user-ip mappings. We tried with several different regex patterns but not having any luck. The UIA keeps showing the log as “- is not a valid IP”. I checked the regex matching at regex101.com as well and it seems to match there. Sample logs: *Dot1x_NW_MsgTask_6: Apr 20 14:08:01.947: #APF-3-AUTHENTICATION_TRAP: apf_80211.c:15520 Client Authenticated: MACAddress:28:5a:eb:44:d3:7e Base Radio MAC:58:97:bd:07:ca:30 Slot:0 User Name:jsimonson Ip Address:10.12.26.42 SSID:PSL-Main*Dot1x_NW_MsgTask_2: Apr 20 14:08:01.855: #APF-3-AUTHENTICATION_TRAP: apf_80211.c:15520 Client Authenticated: MACAddress:bc:54:36:e8:76:c2 Base Radio MAC:18:8b:9d:c6:2e:d0 Slot:0 User Name:cmercer Ip Address:10.8.26.57 SSID:PSL-Main*Dot1x_NW_MsgTask_2: Apr 20 14:08:01.855: #APF-3-AUTHENTICATION_TRAP: apf_80211.c:15520 Client Authenticated: MACAddress:bc:54:36:e8:76:c2 Base Radio MAC:18:8b:9d:c6:2e:d0 Slot:0 User Name:cmercer Ip Address:10.8.26.57 SSID:PSL-Main*Dot1x_NW_MsgTask_7: Apr 18 09:29:15.861: #APF-3-AUTHENTICATION_TRAP: apf_80211.c:15520 Client Authenticated: MACAddress:c8:1e:e7:8b:d5:8f Base Radio MAC:18:8b:9d:f5:08:40 Slot:1 User Name:deanl Ip Address:10.8.26.55 SSID:PSL-Main Regex filters we tried: Event Regex: (Client\ Authenticated):{1} Username Regex: User\ Name:([a-zA-Z0-9.:]+|.+?(@)) Address Regex: Ip\ Address:([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})  Any advice/suggestion would be highly appreciated.  Thanks and Regards,Anurag",0,"
		2 REPLIES 2
",,,,04-24-2017,07:33 AM
101,155794,Custom Signatures,agawade,L1 Bithead,Custom data pattern,"Hi Team  I have a user who has a requirement to add a custom Data Pattern to identify a specific string  Example: 1234/09/4578  (Note the second identifier is a numeric value between [1-9]) I set up the data pattern under "" Custom Objects --->Data Pattern ---> Add "" in the following format to achieve this  ""(/d/d/d/d)/-(/d[1-9])/-(/d/d/d/d)"" , but this fails with the following error messge  test123 -> pattern -> numbers -> regex '(/d/d/d/d)/-(/d[1-9])/-(/d/d/d/d)' is invalid. can't handle two dfas next to each other in pattern '(/d/d/d/d)/-(/d[1-9])/-(/d/d/d/d)'test123 -> pattern -> numbers -> regex is invalid But it works without any issues when we put it as  ""(/d/d/d/d)/-(/d/d)/-(/d/d/d/d)"" Is this an expected behavior? Regards Amogh Gawade        ",0,"
		2 REPLIES 2
",,,,05-09-2017,12:43 PM
102,145982,Custom Signatures,dlevenden,L0 Member,Submitting DNS block without blocking the IP,"I'm looking to submit a FQDN block where I don't ever block the IP. I've reviewed this article on blocking FQDN's but can't seem to figure out how to ignore the IP. We assign fake ip addresses to known malicius sites, and need the HTTP, HTTPS, SSH, etc traffic to route back to us, but the block on the FQDN is also blocking the IP once the lookup is processed. https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-and-Test-FQDN-Objects/t... Any suggestions? Thanks.",0,"
		3 REPLIES 3
",,,https://live.paloaltonetworks.com//t5/custom-signatures/submitting-dns-block-without-blocking-the-ip/m-p/154471#M170,03-03-2017,10:11 AM
103,154120,Custom Signatures,tsIT,L0 Member,Wordpress wp-login.php flood,Today we built a custom vulnerability signature to block excessive request from one IP to wp-login.php.   wp-login.php thread-id 42106wp-login.php thread-id 42106wp-login.php thread-id 42106wp-login.php flood threat-id 42107wp-login.php flood threat-id 42107wp-login.php flood threat-id 42107Blocked by rule,2,"
		0 REPLIES 0
",", flood, wordpress, wp-login.php",,,04-25-2017,10:26 AM
104,148276,Custom Signatures,Evan.Sink,L1 Bithead,Signature for HULK attack?,"Hi Everyone, We are in the process of migrating from Cisco ASA firewalls on our Edge to PA 5020. Recently one of our websites was hit with a DDoS attack. After analysis, we determined that it was the HULK attack.  I got my hands on the HULK python script https://packetstormsecurity.com/files/112856/HULK-Http-Unbearable-Load-King.html and I'm currently testing it against a server behind my PAN. I have DoS Zon protection turned on and I verified that SYN floods and UDP floods are blocked like nobodies business, but when I run this script it takes the server down to it's knees and the PAN sees nothing wrong. Can anyone help me figure out how to prevent this attack?",0,"
		1 REPLY 1
",,,,03-17-2017,01:22 PM
105,146156,Custom Signatures,Ivory.Desper,L0 Member,Creating a Custom Application using a VLAN tag as the signature,"All, I am trying to create a custom application that will be used for a rule instead of having to use standard ports.  All traffic for this application is being tagged  with a 802.1Q virtual Lan , PRI: 0, CFI 0, ID: XXX.  I have tried creating a signature to trigger on this vlan ID with no success. Every signature type i use has not worked to this point.   Has anyone ran into this problem and came up with a solution for this.  Any help would be appriciated.  Thanks.",0,"
		3 REPLIES 3
",,,,03-06-2017,06:59 AM
106,101267,Custom Signatures,stephengun,L1 Bithead,Detect any ELF executable,"I would like to block any ELF executable, but this is not support in file blocking. I have tried to achieve this using two methods: Create a custom data pattern. This didn't really work out, as the minimum string length is 7 bytes, but the file identifier is only four, plus it needs to be in the start of the file rather than anywhere in the file. Create a custom vulnerability. This is ok, but not ideal. I created a pattern-match condition, with a context of file-elf-body. Unfortunately, I then need to add a 7 byte value to match against. I have put \x00000000000000\x, which catches any file I can find, but it is concievable that there are files with no such string. Can anyone else suggest a better solution to this? You may have guessed, I'm a complete novice at this. ",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/detect-any-elf-executable/m-p/101327#M118,08-04-2016,06:18 PM
107,145256,Custom Signatures,chinitsara,L1 Bithead,How to create RegEx Custom Vulnerability Object for detection FTP  injection,"Hi   I try to create Custom Object to detect FTP injection. I wrote pattern "" .*(\%0d\%0a) "" but it show operation fail pattern must be at least 7 bytes. How i create RegEx pattern to match ""%0d%0a"" in below command. ",0,"
		0 REPLIES 0
",,,,02-28-2017,02:12 AM
108,144361,Custom Signatures,pwebber,L2 Linker,Possible To Block HTTP/1.0 Requests?,"Can't seem to find a way to do it. I don't see a built-in signature, and was going to make a custom one, but the patern match context doesn't seem to cover the HTTP version for some odd reason. Maybe I'm missing something?",0,"
		3 REPLIES 3
",,,,02-22-2017,08:18 AM
109,144566,Custom Signatures,BruceL,L0 Member,PAN-SA Signatures,"Good day, Seeing as security device targetted attacks a re increasing, I'd like to know if PANW releases the PAN-SA advisories as actual signatures. I can filter and analyse the CVE's disclosed for each PAN-SA, when available, but therse are general signatures. Is there a way to have an actual, or custom, signature matching for attacks on the PANW device? Having visibility into these events is an indicator that someone serious is targeting your organisation. Thanks for feedback.",0,"
		0 REPLIES 0
",,,,02-23-2017,07:12 AM
110,125185,Custom Signatures,kowu,L1 Bithead,help on Custom  signature base on the return traffic,Dear Bros      Anyone has the experience of create custom signature base on the return traffic? attached please find the PCAP file      This is JBoss attack while custom want us to alert base on the server return traffic content pattern which means attack most likely successful      Attacker:10.63.212.201 server:10.10.228.94,0,"
		5 REPLIES 5
",,,,11-09-2016,12:58 AM
111,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
112,117383,Custom Signatures,Ntrust,L0 Member,Custom Application Signatures,Hi I have created custom Application id for one of my web application server hosted in Amazon cloud. but its not working. can anyone help against this.  Here with i have attached xml file for your reference.,0,"
		2 REPLIES 2
",,,,10-03-2016,09:47 PM
113,116639,Custom Signatures,Maheshwar210,L0 Member,Signatures (Custom /Default ) Signature,"Hi Team,  Need some info on Signature. My question here is  Can We able to see the Default Signature or the customized Signature  with the read only access. If yes then can any body help me out to know the process.  Thanks in advance.Uma.",0,"
		2 REPLIES 2
",,,,09-29-2016,04:54 AM
114,112437,Custom Signatures,jamessong,L1 Bithead,Import Snort signature and MD5 hash into either custom application/threat signature,I would like to import my existing Snort custom signatures and MD5 hash into the PA FW. Dore it requires any tools? I couldn't find any documentation.  Thanks ,1,"
		4 REPLIES 4
",,,,09-12-2016,04:29 AM
115,101435,Custom Signatures,gtomte,L3 Networker,Custom App-ID for 2016 International Games in Rio de Janeiro,https://live.paloaltonetworks.com/t5/Configuration-Articles/Custom-App-ID-for-2016-International-Gam...,0,"
		0 REPLIES 0
",,,,08-08-2016,10:03 PM
116,88888,Custom Signatures,nsheikh,L1 Bithead,Detecting a specific Linux binary(ELF) file using a custom signature,"DISCLAIMER:As with all custom signatures on this forum, this signature is being provided by the author as a result of enthusiasm for the product and to share ideas with the Palo Alto Networks security community. It is: - Not recommended for deployment in a production network of any kind without internal testing.- Not a solution to any vulnerability.- Not an official supported Palo Alto Networks signature  This write up is to help the Palo Alto Networks community with detecting a specific linux ELF sample in this example.   The sample signature was created on PAN OS Version 7.0.x : Hash256: 92fd1971f7ac512d096821a4bf8553bc13d1c478680999dd2e15400fe8973793 Fill out the appropriate field under the configuration tab Choose the standard option from the radio button and click on add to create a signature Since we only have one condition it doesn’t matter if we choose the ‘and’/’or’ condition Within the ELF file we are looking for a particular pattern on hex values.  Make sure to choose the context type as: file-elf-body Below is a threat log that is being triggered on this signature Sample xml signature attached to this document.",0,"
		2 REPLIES 2
",,,,06-17-2016,12:43 PM
117,94332,Custom Signatures,tboire,L3 Networker,Custom Threat Signature for unique EXE files,"DISCLAIMER:As with all custom signatures on this forum, this signature is being provided by the author as a result of enthusiasm for the product and to share ideas with the Palo Alto Networks security community. It is: - Not recommended for deployment in a production network of any kind without internal testing.- Not a solution to any vulnerability.- Not an official supported Palo Alto Networks signature  This write up is to help the Palo Alto Networks community with detecting a specific PE file. The sample signature was created on PAN OS Version 7.0.x : SHA256: 92914013abfd071b0513d366bcaead978dce2f552c9d2853f4ce775604fb841f Fill out the appropriate field under the configuration tabChoose the standard option from the radio button and click on add to create a signature  Since we only have one condition it doesn’t matter if we choose the ‘and’/’or’ condition   To determine a unique string the *NIX utility xxd was used in this case, however any hex editor will work for this purpose.  The string was then converted to hex and used in a pattern match to detect the file. In this case the author of the file put what we believe to be their name in the file and that was used as a unique identifier.   Once this custom signature is applied and a web browser is used to attempt to download the file the firewall will either block or alert on detection depending on the action you set. ",1,"
		0 REPLIES 0
",,,,07-05-2016,09:43 AM
118,92514,Custom Signatures,aelatmani,L0 Member,Cannot Match an business usage application  using 4first digit palyload for an unknown-tcp.,"Hi Team, Can you please help me define a custom App-ID using the attached PCAP.the application is a client-server application that uses dynamic range of TCP port. from 30000 to 35000. Thanks in advance.  ",0,"
		1 REPLY 1
",,,,06-27-2016,07:58 AM
119,78952,Custom Signatures,clewis1,L2 Linker,Custom Signature for Email Headers,"I am trying  to create a custom signature with the purpose of preventing malicious/phishing/spam emails with the firewall before it hits our mail gateway. For the most part we have been successful with this technique but I am struggling with creating a signature to essentially work as a wildcard. If anyone could take a look at my scenario and provide any feedback it would be much appreciated. Below is my example: Scenairo: we are receiveing unwanted emais from the following email addressscanner@abc.domain.comscanner@abcd.domain.comscanner@abcde.domain.comscanner@aaa.domain.comscanner@bbb.domain.comscanner@ccc.domain.com As you can see the consistent parts of this type email campaign is the scanner@abc.domain.com. I am hoping to come up with a signature using email headers to wildcard the 'abc, abcd,abcda, etc'  as I dont want to be writing individual signatures for each sub domain as this could include upto 15 different representations of 'abc'.  I thought this would work scanner@(.*)(\.domain\.com) but does not appear to be the case.",0,"
		6 REPLIES 6
",,,,06-01-2016,10:29 AM
120,78223,Custom Signatures,RepartoSistemi,L1 Bithead,Singature for Jabber tcp/2748,"Hi, I try to create a custom signature for Jabber CTI (http://www.cisco.com/c/en/us/td/docs/voice_ip_comm/cucm/port/9_0_1/CUCM_BK_T98E8963_00_tcp-port-usag... running on port 2748. The packet dump give me this result for the client request: 5e 00 00 00 00 00 00 00 dd dd ff ff 00 00 0f 00 ^....... ........36 01 00 00 20 00 00 00 24 00 00 00 22 00 00 00 6... ... $...""...01 00 00 00 44 00 00 00 0b 00 00 00 4f 00 00 00 ....D... ....O...04 00 00 00 53 00 00 00 07 00 00 00 5a 00 00 00 ....S... ....Z...0c 00 00 00 55 43 50 72 6f 76 69 64 65 72 00 31 ....UCPr ovider.12e 30 00 53 68 69 62 75 69 00 43 69 73 63 6f 20 .0.Shibu i.Cisco 4a 54 41 50 49 00 JTAPI.and I want to intercept the string ""UCProvider 1.0"" I tried with a signatures with:parent App: jabberport: tcp/2748Signature: Pattern MatchScope: Session (also I tried with Transaction )Context: unknown-req-tcp-payload (also I tried with unknown-rsp-tcp-payload )Pattern: follow all the patterns that I've tried, one for a time...UCProvider 1.0\x 55 43 50 72 6f 76 69 64 65 72 20 31 2e 30 \x BUT NOT WORK everytime unknown-tcp or insufficent-data result on traffic monitor How can resolve this problem without write a policies with any in application and a custom service (tcp/2748) ??? thank you    ",0,"
		11 REPLIES 11
",,,https://live.paloaltonetworks.com//t5/custom-signatures/singature-for-jabber-tcp-2748/m-p/78515#M83,05-17-2016,07:12 AM
121,78524,Custom Signatures,JuanB,L1 Bithead,Signature by hostname,"Hello guys, We recently discover that sometimes, ramdonly, host called ""Windows7"" trays to mount a shared folder from our fileserver/DC. We discover this because our SIEM correlated some events from de DCserver. Sadly this SIEM do not show us the Source IP Address so,  we add a PAN  in SPAM port mode to the switch to tray to capture the ms-smb fail logons.We started by adding the default custome signature and setting up to triggers with 5 events in 120 seconds (just like the SIEM's alert) but that do not work. Now we are traying to make a custome signatere that triggers when any package with the string ""jbonaldo"" goes through the PAN (jbonaldo is the host name). I already read the ""creating customg signature rev b"" and I can not find any reference to SMB2 for the context field, so i try to use the ""unknown-req-tcp-payload"". I also tray setting up the string in clear text and/or hexadecimal. BTW, I already create a vulnerability profile and append that to the security rule (just to be clear 🙂 ) what i am doing wrong?",0,"
		7 REPLIES 7
",,,https://live.paloaltonetworks.com//t5/custom-signatures/signature-by-hostname/m-p/78530#M87,05-23-2016,12:36 PM
122,78351,Custom Signatures,siganteng,L1 Bithead,batch input,"Hi,i was wondering if I can input multiple inputs to create custom signature.For example, one of our clients received a long list of files regarded as threat but not listed in threat vault. Because the list is long they would like a simpler method rather than just typing one by one. Regards,Zaki",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/batch-input/m-p/78368#M77,05-18-2016,08:27 PM
123,74746,Custom Signatures,ttanzi,L2 Linker,Case insensitive Regex expression,"I am creating a regex to capture on the expression ""Bank of America"". I am having trouble getting case insensitivity to work so that I can capture on ""Bank of America, bank of america or any other variation.  What is the format of this expression to account for case insensitivity?  thanks all",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/case-insensitive-regex-expression/m-p/76176#M64,03-15-2016,11:30 AM
124,74853,Custom Signatures,jpeters,L3 Networker,Regex Not matching when ? is in the URL.,"I am trying to setup a custom application to match based on URL request which contains: search= This is the only consistent 7 byte string in the URL. This works fine unless the request contains a preceeding '?' in the URL.  For example the following URL would not match/some.php?af=352485245&search=blahblah While this URL would match:/some.php&af=352485245&search=blahblah I am assuming this is because we are hitting the ? and stopping there. How would I write this pattern so that if there is a preceeding ? anywhere in the URL, it is ignored or treated as a literal '?'.",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/regex-not-matching-when-is-in-the-url/m-p/74858#M62,03-16-2016,10:29 PM
125,74254,Custom Signatures,assepartout,L1 Bithead,RegEx - Pattern for strange string not work,"Someone can help me for this pattern? PATTERN: +-----------------------------------------------------------------------+ PATTERN in Hex: 2b 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2b QUESTION : the following RegEx not work, why?\x2b(\x2d)*\x2b ",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/regex-pattern-for-strange-string-not-work/m-p/74271#M51,03-07-2016,12:37 AM
126,74173,Custom Signatures,apike,L1 Bithead,Need help with creating signature for pop3,"I would need some assistance with setting up a custom signature for pop3. I need to make a signature for the USER  command returning ""-ERR "" currently the Pan vuln signature only triggers on the Pass command in vuln id 31709. I run into a fundamental issue which is the 7 bytes. pop3 does not have 7 bites min on return codes. I'm suspecting I will need to do something like the following but this is not triggering.  'Server Ackcontext unknown-rsp-tcp-payloadpattern ""\+OK.{0,70}(POP3 MDaemon).{0,70}""negate no 'User passes usernamecontext unknown-req-tcp-payloadpattern ""/user/i .{0,100}""negate no  context unknown-rsp-tcp-payloadpattern ""/\-ERR/i.{0,70}""negate no any idea on how I can get this done would be appreciated. ",0,"
		6 REPLIES 6
",,,,03-04-2016,12:42 PM
127,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
128,74029,Custom Signatures,cole,L4 Transporter,Detecting an SSLv2 Server Response with a Custom Signature,"DISCLAIMER:As with all custom signatures on this forum, this signature is being provided by the author as a result of enthusiasm for the product and to share ideas with the Palo Alto Networks security community. It is:- Not recommended for deployment in a production network of any kind.- Not a solution to any vulnerability.- Not an official supported Palo Alto Networks signature. That said, I do hope it will illustrate to interested community members what can be done with the strength of the Palo Alto Networks custom signature engine.  With SSLv2 vulnerabilities continuing to present themselves, customers may find themselves interested in knowing when a session established with a server in their environment is leveraging this cryptographic protocol. Palo Alto Network's custom signature engine can help you accomplish exactly this. While the pattern matching contexts we expose are incredibly useful for looking for specific types of data, integer contexts are equally strong if you are looking to see whether or not an exposed context contains a specific value. Given the pattern matching contexts limitation of requiring seven static bytes as an anchor for detection, this makes more surgical tasks where you only want to evaluate a single field more difficult. For our example, the SSL version present in a Server Hello response is two bytes; this means it is not a candidate for a pattern matching signature. However, we expose ssl-rsp-version in the integer contexts, making the below possible:  In the signature I will attach to this thread, we are inspecting the ""SSL-RSP-VERSION"" integer context to see if it contains a value of 2. This signature is an informational level that will alert when SSLv2 server responses are detected, allowing any network administrator who wants to be aware of this to take appropriate action. As always, any feedback or corrections from the community is absolutely welcome.",2,"
		0 REPLIES 0
",,,,03-02-2016,02:40 PM
129,73523,Custom Signatures,yarijanto,L1 Bithead,Detect random sub-domain DNS query,"Hello, I would like know if anyone has succesfull creating a custom signature either Custom spyware object or custom vulnerability signature to detect random sub-domain in DNS query.For example:We don't want to block www.yahoo.com or yahoo.com domain query.But if there are query something like abcd1234.yahoo.com, we should detect and alert using Anti-spyware profile. Can you recommend any solutions on how to solve this issue ?This is particularly happened in ISP where they need to block this kind of sub-domain query which is not exist actually and consume DNS resources. Regards,yarijanto ",0,"
		1 REPLY 1
",,,,02-25-2016,12:34 AM
130,73538,Custom Signatures,yarijanto,L1 Bithead,Limiting File Size Upload using Custom Signature,"Users in enterprise often use web based file hosting to upload big files. This creates concerns in the usage of networks bandwidth and server storage capacity, as the file can be bigger than 1GB. Below steps are usefull to control file size uploaded to a web server using HTTP Request Content-Length parameter. PAN-OS version: 6.1.0-b43   Go to Objects Tab > Custom Objects > Vulnerability, then click “Add”,Fill-in required fields as shown below: Click “Signatures” Tab, then click “Add”. In Standard window, type in the Signature Name:  At the bottom of “Standard” window, click “Add And Condition”:  Inside “Or Condition” window, choose Operator to “Greater Than”, choose Context to “http-req-content-length”. To limit file size up to 10 MB, we need to fill-in the Value in bytes, 10MB equals to “10485760”  Then click “OK”, click “OK” again. Or, you can just save below text as BLOCK-FILE-10MB.xml file and click “Import” in Objects Tab > Custom Objects > Vulnerability. <vulnerability-threat version=""6.1.0""><entry name=""41001"">   <signature>     <standard>       <entry name=""BLOCK-FILE-10MB"">         <and-condition>           <entry name=""And Condition 1"">             <or-condition>               <entry name=""Or Condition 1"">                 <operator>                   <greater-than>                     <value>10485760</value>                     <context>http-req-content-length</context>                   </greater-than>                 </operator>               </entry>             </or-condition>           </entry>         </and-condition>         <order-free>no</order-free>         <scope>protocol-data-unit</scope>       </entry>     </standard>   </signature>   <default-action>     <reset-client/>   </default-action>   <threatname>BLOCK-FILE-UPLOAD</threatname>   <severity>critical</severity>   <direction>client2server</direction>  Go to Objects Tab > Security Profiles > Vulnerability Protection, then click “Add”,You can name the profile as “VP-FILE-UPLOAD”: Then click “Add”, and fill-in Rule Name, Theat Name, and others similarly as below picture:  After finish, then click “OK”, click “OK”.  Go to Policies Tab > Security, then create security policy similarly as below:  Don’t forget to assign vulnerability protection profile “VP-FILE-UPLOAD” under “Actions” tab:  Click “OK”, then click “Commit”.  Open the browser, and type www.filehosting.orgClick “Choose File”, then find any file larger than 10MB: When uploading a file with size more than 10MB (10485760 bytes), the firewall block and reset the connection. Below is the capture of the packet that show “Content-Length” value is more than 10MB: And the browser shows blank page:    Threat Logs shows the firewall catch “Content-Length” parameter which is greater than allowable size.  ",3,"
		0 REPLIES 0
",,,,02-25-2016,12:55 AM
131,73045,Custom Signatures,mgentile,L2 Linker,Detecting overly long DNS Responses for CVE-2015-7547  glibc getaddrinfo() stack-based buffer over..,"Objective: I'm trying to write a custom vuln for detecting DNS responses with payloads greater than 512 bytes.  This is one of the recommended mitigations for CVE-2015-7547.  Editorial:  I know that there are better places to apply mitigations, such as the clients themselves, caching nameservers, etc, but please for the sake of defense-in-depth and the academic discussion, please let's assume I want to do this mitigation on the PAN firewalls. Problem:  I can't seem to find enough bytes in a standard DNS response that are static and will meet the 7-byte minimum matching requirement.  I'm finding the dns-rsp-* contexts to be extremely limiting in this exercise because the response packets (at least the ones I'm looking at) arevery compact and have a lot of information crammed into a small number of bytes.  Would it be better to try something using the unknown-rsp-udp context and try to start matching there?  Has anyone else tried matching on payload lengths?",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/detecting-overly-long-dns-responses-for-cve-2015-7547-glibc/m-p/73051#M40,02-18-2016,06:44 AM
132,71971,Custom Signatures,KiCheon.Lee,L4 Transporter,Can I make custom application signature for using referer of http header?,"Hello, I would like to make custom application signature for using refer of http header. Can I ???? I made the follwoing signature. but PA is not detecting.  I would like to hear any your opinion and assistance. Thanks,KC Lee ",0,"
		2 REPLIES 2
",,,https://live.paloaltonetworks.com//t5/custom-signatures/can-i-make-custom-application-signature-for-using-referer-of/m-p/71975#M37,02-02-2016,02:18 AM
133,71050,Custom Signatures,klokholm,L1 Bithead,custom mail app-id,"hi. I'am trying to create a custom mail app-id filter, for matching; to whom mail is gonging to and from what domain.I have add smtp as a parent application in the app-id. My app-id is matching the helo, mail from, rcp, data. from the mail. The policy with this custom app-id is partial match, if I only has this, the data is dropt.  If I add a new policy row with application smtp below my custom app-id, the first package that came in match smtp, and all blowing data is matching my custom app-id. the row application smtp, is becuse to make this policy working i hade to add smtp in the rule, the problem to do so is that it also match evry smtp packaged that comes in to the firewall. Have i missed somthing? or how can I solve this?  /Kristofer",0,"
		0 REPLIES 0
",", custom app-id, smtp",,,01-17-2016,02:27 AM
134,69551,Custom Signatures,kalakai,L2 Linker,Joomla Remote Code Execution - CVE-2015-8562,"Hello, I created a custom vulnerability signature that helps to detect and block the recently discovered Joomla RCE zero day which has since been patched by the vendor. I've opened a case with an engineer and he suggesed some additional protections until an official signature is released. The engineer suggested I post it here so that other people may benefit.  It checks for the following http headers in a GET request:JDatabaseDriverMysqliJSimplepieFactorydisconnectHandlerseval(base64_decode($_POST[111])) I don't see an option to upload the .xml so here is the full xml code, sorry for the length:  ",3,"
		1 REPLY 1
",,,https://live.paloaltonetworks.com//t5/custom-signatures/joomla-remote-code-execution-cve-2015-8562/m-p/69823#M34,12-16-2015,10:21 AM
135,68977,Custom Signatures,bkluth,L0 Member,Submit a New Threat,"Hello, My IDS has detected a new Angler signature on my network and it was allowed by my PA firewall. The traffic was allowed being the IDS is not inline. How do I submit packets for a threat update/addition?",0,"
		4 REPLIES 4
",,,,12-03-2015,10:46 AM
136,68834,Custom Signatures,bkim,L0 Member,How to make custom signature with segment field?,"Recently, URL filter evasion application often use tcp segment field.How to make custom application with tcp segment field? Protocol sequence.1. SYN 2. SYN,ACK3. ACK4. PSH,ACK : TCP segment data has GET / HTTP/1.1   It can bypass our URL filtering.You can download and reproduce using below link.http://1bil.net/DodgeChrome-31.zip Thanks. ",0,"
		2 REPLIES 2
",,", dodge chrome",,11-30-2015,11:14 PM
137,68892,Custom Signatures,mike_melo,L0 Member,PAN-OS 7.0.3 bug with Cloning of Profiles,,0,"
		0 REPLIES 0
",,,,12-01-2015,03:50 PM
138,68702,Custom Signatures,Froning,L1 Bithead,h323-message-body values,"We seem to have a new h.225/h.323 scanning campaign going on that disturbs meetings. The strings that seem to be the same throughout are ""productId: MERA RTU"" and ""versionId: 4.4.0-06a"". So I've tried two different methods of catching this traffic. Custom threat signatures and custom apps with the same pattern matched, but neither work. Here's a sample custom threat signature: I've also tried matching with the versionId pattern (\x342e342e302d303661\x) or the word ""MERA"", both fail. Any idea how to catch this with a signature? Here are the relevant parts of the pcap: I've a case open with support, but our partner support can be slow... Thanks,Will",0,"
		6 REPLIES 6
",,,,11-26-2015,05:25 AM
139,68567,Custom Signatures,cole,L4 Transporter,"Dell Root Certificate ""eDellRoot""","Good afternoon, all! Researchers have discovered a trusted root certificate being deployed by Dell on some newer laptops. For reference, see here. While an official signature from Palo Alto Networks is likely not forthcoming due to legitimate usage of the certificate, customers who do wish to alert when this certificate is detected by their PAN-OS appliance can use the exposed custom signature context ""SSL-RSP-CERTIFICATE"" to check for it. The attached signature, exported from a 7.0.3 PAN-OS device, does just that. Please note that this signature is:A) Not supported by Palo Alto NetworksB) Just an example to show what can be done with our exposed custom signature contexts, and can definitely be improved upon.C) This signature was tested by visiting the site researcher Kenn White stood up to show what kind of security concerns may arise by this certificate being trusted. I will not provide the URL here, but it can quickly be found in Google, and is referenced in the Ars Technica article written about the issue.  Additionally, and I cannot stress this enough, it is not a solution for the security vulnerability exposed by the presence of this certificate. Please follow Dell's guidance on the issue.",3,"
		0 REPLIES 0
",,,,11-24-2015,10:25 AM
140,68276,Custom Signatures,murphyj,L2 Linker,Block External to internal when not using FQDN,I have tried to create a Custom threat a number of times that blocks people from accessing our site via IP address as the url. I have tried setting it up as so Operator: Pattern-MatchContext: http-req-host-headerPattern: 111\.2\.3\.4Qualifer: req-hdr-typeValue: HOST Or Operator: Pattern-MatchContext: http-req-host-headerPattern: 111\.2\.3\.\d+[:](80|443)Qualifer: req-hdr-typeValue: HOST Or Operator: Pattern-MatchContext: http-req-host-headerPattern: 111\.2\.3\.4Qualifer: rhttp-methodValue: HOST I was going to try the following next: Operator: Pattern-MatchContext: http-req-uri-pathPattern: 111\.2\.3\.4Qualifer: http-methodValue: Get Any example or advice on this would be appreciated. ,1,"
		6 REPLIES 6
",", custom_threat",,https://live.paloaltonetworks.com//t5/custom-signatures/block-external-to-internal-when-not-using-fqdn/m-p/68292#M9,11-17-2015,07:59 AM
141,67908,Custom Signatures,cole,L4 Transporter,Example to Detect Malicious ELF Binaries (Linux Encoder Ransomware),"Good afternoon!We've got another sample of what can be accomplished using our custom signature engine today. Please note before continuing that:A) This signature exists as a sample to show what is possible, and has not been properly QA'd/soak tested to ensure no false positives. The hex values from the binaries were arbitrarily chosen simply to show how the process works, and were not analyzed against known legitimate ELF binaries for collision testing.B) Please read A! Please. 🙂 The purpose of this signature is to detect malicious ELF binaries that belong to a family of ransomware dubbed ""Linux Encoder,"" which is targeting web servers, encrypting their files, and shaking down the owners for money. Intelligence showed five known samples of the malware in the wild, with SHA1 hashes of: a5054babc853ec280f70a06cb090e05259ca1aa7 98e057a4755e89fbfda043eaca1ab072674a3154 810806c3967e03f2fa2b9223d24ee0e3d42209d3 12df5d886d43236582b57d036f84f078c15a14b05bd6b41aa29bd5ea1424a31dadd7c1cfb3e09616 Grabbing these samples and doing a hex dump, we look for (what we hope) are unique values in the hex dump. We grab those values, and we head into our lab firewall to make a signature. A single AND condition with five nested OR conditions, using pattern matching within the file-elf-body context, and a pattern containig \x(hexhere)\x. We set the action to reset-both, and we commit the signature. We attempt to transfer the files, and watch the signature trigger, denying the transfer. I've attached the sample signature for review. To be more accurate in the future, one thing that could be done would be ensure that the values pulled from the hex dumps are unique to the samples, and don't contain values that may be shared with other ELF binaries that are not malicious. This requires a bit more finesse and a good understanding of the ELF file structure/unique qualities of the malicious samples. Those who would like to enjoy a journey into RFCs/Wiki articles to ensure their signature is fail proof are welcomed to do so! I will attempt to get more detailed in my next description, but the above should suffice as a simple framework for how signatures can be created to stop transfer of file types over the wire. Note that we also have file contexts for (not all inclusive, see the document in the sticky): FLV, HTML, Java, MOV, Office, PDF, RIFF, SWF, TIFF, and ""unknown."" The signature has been attached for your perusal.",0,"
		0 REPLIES 0
",,,,11-10-2015,10:49 AM
142,67525,Custom Signatures,goku123,L7 Applicator,Example to detect SMTP 550 (destination email address does not exist),"Here is an example to alert when a server responds with SMTP 550 (mailbox does not exist). The context used is 'smtp-rsp-content' and the pattern to be matched is '550\ 5\.1\.1'.<pattern>550\ 5\.1\.1</pattern><context>smtp-rsp-content</context> Full example signature(7.0) attached 'sample_smtp_vulnerability_41002.xml' Next, assume we would like to detect 10 triggers for this in a 60 second interval, we can create a combination brute force signature that looks for the signature created earlier:<combination><time-attribute><interval>60</interval><threshold>10</threshold></time-attribute><and-condition><entry name=""And Condition 1""><or-condition><entry name=""Or Condition 1""><threat-id>41002</threat-id> Full signature attached as 'sample_brute_vulnerability_41003.xml'. For further information on custom signatures, please refer to the document at: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5...",4,"
		0 REPLIES 0
",,,,10-30-2015,04:20 PM
143,66860,Custom Signatures,cole,L4 Transporter,Welcome to the Palo Alto Networks Custom Signature discussion board!,"The purpose of this board is to discuss everything related to custom signature creation in PAN-OS devices. Palo Alto Networks delivers a large quantity of coverage in our weekly content updates; however, we know that our customers are staffed by dedicated security professionals as well, and we would like to provide an environment in which to foster discussion of their ideas for coverage that may not currently exist, or may be particularly applicable to their unique environment. Customers may find traffic within their network in packet captures, web server logs, SIEM queries, firewall logs, etc. that a custom signature would be useful to alert on, or prevent. This forum exists as a place to work through this process in a community that can assist you, and get your creative minds inspiring one another.When creating a discussion, try to provide as much detail as possible to better assist your peers in understanding what exactly you need. Additionally, this link is a fantastic resource for understanding custom signature creation: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5... The above document will assist with explaining each custom signature context and what is contained within them. Additionally, it contains some examples of custom signature creation, common RegEx mistakes, error troubleshooting, and a significant amount of other detail that anyone seriously interested in pursuing custom signature creation should read.  Questions that foster good discussion: Are you asking for assistance in finding a unique pattern within data you’ve already gathered to trigger off of? Do you have an idea for a signature based off of traffic you have identified, and need to discern which custom signature context Palo Alto Networks exposes can best be used to detect the traffic? Do you have a recommendation for improving a current signature?  Posts that do not foster good discussion: A request for CVE coverage in which no data is provided, or no exploit data has been revealed for. A request for detecting traffic in which no packet capture data can be provided, or no research has been completed to first identify data that can be used during the creation process.  Recommended detail to include: Use justification! What does the signature detect, and why? Upload of any existing XML export of a custom signature you have created, and are troubleshooting. Data gathered during research to help identify unique patterns to detect on. Links to research or resources to support the signature creation.  Common Errors in Custom Signature Creation:   To get the ball rolling, let’s try a few examples! Example 1: Use of system.multicall method in XMLRPC calls.Justification: Brute force attacks are occurring against Wordpress instances with XMLRPC enabled, where many username login attempts can be nested in a single system.multicall method and evade traditional brute force detection.Research: https://blog.sucuri.net/2015/10/brute-force-amplification-attacks-against-wordpress-xmlrpc.htmlSignature Example:  See attachment System Multicall Use.xmlDescription: Signature evaluates http-req-message-body context in the directionality of client to server, for the hex values “3c6d6574686f6443616c6c3e3c6d6574686f644e616d653e73797374656d2e6d756c746963616c6c” which translates to “<methodCall><methodName>system.multicall” indicating that an HTTP request message body was sent with a system.multicall method embedded in it.Potential for improvement: Additional signature to operate as parent to indicate the child signature has been executed X amount in Y seconds.  Example 2: Detecting Nikto Scans through User Agent.Justification: Palo Alto Networks extensive coverage looks to make signatures based on unchanging exploitation, where there is little to no variation in the data being evaluated. Detecting tools based on user agent strings that are easily modified by users is not the most effective way to do this. However, many customers have use cases in which reporting on basic usage of certain tools by detecting user agent strings may be valuable. This can be done through a very basic custom signature, and can catch penetration testers who opt for the easy way out and don’t attempt to evade detection effectively.Research: Download Kali Linux, where Nikto Scan comes embedded, and you will see default scans have an easily identifiable user agent string.Signature Example: See attachment “Nikto User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.00 (Nikto”, indicating default user-agent string for Nikto scan has been detected.Potential for improvement: Our built in coverage for the vulnerabilities Nikto scan actually exploits will cover Nikto scans that seek to hide by changing their user agent, which will evade this signature.  Example 3: Detecting NMAP Scripting Engine use through User AgentJustification: See justification for Nikto; this is identical!Research: Download Kali Linux, and run any of NMAPs NSE scripts, and you will see web based scans have an easily identifiable user agent string.Signature Example: See attachment “NMAP NSE User Agent.xml”Description: Signature evaluates http-req-headers for the string “User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine” indicating default user-agent string for NMAP NSE usage has been detectedPotential for improvement: Our built in coverage for NMAP NSE scripts will cover some common NSE usage, which may evade this signature if user agent is altered. ",4,"
		4 REPLIES 4
",", custom signature",,,10-19-2015,05:04 PM
144,67282,Custom Signatures,viren.parasram,L0 Member,Honey pot signature,"Hi,    I have certain subnets that are currently not in use in our domain, I wanted to ip-block for 30 minutes all ips that access any of these subnets. Is it possible to creat a threat signature for this? Thanks,             VIREN",0,"
		3 REPLIES 3
",", honey pot",,,10-26-2015,10:19 AM
