,Discussion ID,Author,Body,Likes,Date,Time
0,500206,Mandanajan,"Check the route table that is GWLB endpoint is located, and make sure you have a route back to your internal resources (your VPCs CIDRs)",1,06-15-2022,10:44 AM
1,500206,Astardzhiev,"Hi @Mandanajan,Thank you for the suggestion, but I doubted the problem is in GWLBe route table. The reason for that is exact same setup (same GWLBe, same route table, everything works for East-West traffic the moment we have disabled route overlay. Also the outbound traffic works over the same GWLBe when overlay is enabled and I believe it wouldn't work if I was missing route for the VPC, right?",1,06-16-2022,01:28 AM
2,500206,justin.stone,"Hi @AstardzhievI have the same problem, if I disabled Overlay then my east/west traffic worked fine, but outbound did not. With overlay on, it's the reverse. I tried 2.1.4, 2.1.6 and 2.1.7 plugins no change. I am also running 10.1.6. I just downgraded to 10.1.5h1 and now it all works, maybe give that a shot.",1,07-06-2022,11:40 AM
3,500206,Astardzhiev,"Hi @justin.stone ,That is intersting. At least I know I am not insane...I think I had tried with 10.1.5...but can't remember if it was .5 or .5h1. Thanks I will give it a try.",1,07-07-2022,02:06 AM
4,500206,Centogene,"We also: we have tried version 10.2.1 and downgraded to10.1.6-h3 on AWS support advise, none work so far in.We have not disable overlay routing yet. But will first try10.1.5h1 as a suggestion and take a look.BW",0,07-12-2022,09:13 AM
5,470642,Rodgerfoster,"Hello,In the plan details on Azure, it mentions that PAYG usually have a 30 day free trial, my question is if in these 30 days, would I be charged for usage in any case, in other words, is there certain level of usage that I should stay under before being charged hourly.Thanks.Azure Firewall will not impose any compute charges. How does billing for this service work?",0,07-07-2022,12:12 AM
6,470642,Rodgerfoster,"Hello,In the plan details on Azure, it mentions that PAYG usually have a 30 day free trial, my question is if in these 30 days, would I be charged for usage in any case, in other words, is there certain level of usage that I should stay under before being charged hourly.official site Thanks.Azure Firewall will not impose any compute charges. How does billing for this service work?",0,07-07-2022,12:12 AM
7,472938,karlgillego,"I want to preface this by saying that after completing the below in a DEV environment, we ended up completely swapping out with new VMs built directly on 9.1.x in PROD. It just didn't seem like this was going to be supported by TAC.IMO, Palo's KB (link #1) on this topic is unfortunately rather vague. The only thing the article offers after cloning the osDisk is",0,07-06-2022,10:44 AM
8,482441,avelK,"Hello@Sephora_ITfrom your post it is not clear how this is related to Palo Alto, however Wireshark is supporting GENEVE ever since version 2.0.0. The dissector is using default port UDP 6081. If you expand packet details, you should see details of encapsulated frame/packet.Kind RegardsPavel",0,05-01-2022,05:56 AM
9,482441,Astardzhiev,"Hi @PavelKI am guessing @Sephora_IT question is related to the GENEVE encapsulation between GWLBe (endpoint) in AWS and VM-Series firewall.Unfortunately I don't believe it is possible to capture GENEVE encapsulation with packet capture on the firewall...Not sure if enabling ""pre-parse match"" could help, but it should be used only with low volume of traffic",1,06-16-2022,04:45 AM
10,482441,avelK,Hello@AstardzhievI see. Thank you for input.Kind RegardsPavel,0,06-17-2022,02:55 AM
11,482441,bartpmika,you can enable capturing the GENEVE encapsulated traffic by running the following command in CLI:debug dataplane packet-diag set capture encapsulation yes,1,06-30-2022,10:29 AM
12,505891,Astardzhiev,"Hi @ScottShorkey ,Not able to reach firewall management in most case could be due to misconfigured Network Security Group on the mgmt interface.However the message for ""machine agent status not ready"" is strange...Are you sure you have sufficient permissions in the Azure console?Have you tried to use ARM template? For example this one - https://github.com/PaloAltoNetworks/azure/tree/master/vmseries-simple-template",0,06-27-2022,08:09 AM
13,502945,Astardzhiev,"Hi @MikeC ,Unfortunately this is not the way that GWLB works...When you enable GWLB inspection on the firewall it will always use the GENEVE protocol information to send the traffic back to the GWLBe it received the traffic and will never make route lookup to route traffic to different interface.In addition the sub interfaces are not even used for routing, they are only used for zone mapping.So if you associate VPCs with different GWLBe and have those mapped with different zones, traffic will still be intra-zone from firewall point of view. Because with GENEVE encapsulation inspection firewall will always return the packet to the GWLBe it received it.I also don't think that in this case you will have inter-vpc traffic working... Because the return traffic will go to the second GWLBe, which is associated with different zone and probably FW will not match this traffic as return traffic for the original request.",1,06-16-2022,01:36 AM
14,502945,MikeC,"Hi@AstardzhievThank you for the reply, I get what you're saying but I have some questions. I understood that GWLB will send data back to the endpoint it came from and that the sub-interfaces are not used for routing. 100% agree there. The routing is all handled through the AWS subnet route tables and TGW route tables.However, you mentioned ""In addition the sub interfaces are not even used for routing, they are only used for zone mapping"" This is exactly what I need it for. I was only trying to use the sub-interfaces to help create firewall policy rules.In this Palo Alto doc, shows exactly what I'm trying to do. It does mention east/west. So in this design, I'd like to create specific fw rules for traffic between APP VPC 1 and APP VPC 2. I'm not trying to make routing decisions, I'm only trying to make policies based on this traffic. How would I accomplish this?https://docs.paloaltonetworks.com/vm-series/10-1/vm-series-deployment/set-up-the-vm-series-firewall-...",0,06-16-2022,06:10 AM
15,502945,Astardzhiev,"Hey @MikeC ,Document explain that you can have different GWLBe for Outbound and East-West traffic, for the same reason - more control over the rules and easier to create different rules for outbound and east-west. But this is only to differenciated between outbound and east-west (any east-west).They key element is that both (outbound and east-west) are stil intra-zone traffic, once the firewall receive packet from one of the GWLBe it will return it back to the exact same GWLBe it came from. But in this case both VPC are associated with same East-West GWLBe, which means the rule for traffic between the two VPC will still be intra-zone traffic with source and destination the east-west zone (associated with east-west GWLBe).Lets breakdown the architecture from the document:- The decision which GWLBe to be used is dictated by the routing table of the TGW attachment in the security hub vpc. Based on the destination IP address traffic will be routed to one of the GWLBe, let say VPC-Prod GWLBe (if we use your idea).- Once the traffic is forwarded to that specific GWLBe it encapsulate the packet with GENEVE protocol and send it to the firewall. There FW will decapsulate it and use that information to map the traffic with given zone. Let say it will use zone ""VPC-Prod"" for source zone- Because traffic is received by GENEVE protocol FW will not perform route lookup to determine the destination zone, but instead will automatically use the source zone for destination as well. After it inspect the packet it will encapsulate it again and return it to the exact same GWLBe in this case VPC-Prod- Once the GWLBe ""VPC-Prod"" receive the traffic back it will remove the GENEVE again and use its own routing tabel to further forward the traffic.- Traffic will be forwarded to TGW and more specifically the TGW route table associated with the attachment in security hub vpc. From there it should be clear how the traffic will reach the target.Let say the traffic have reached the destination and it has generated reply- This reply will be forwarded to TGW and using the TGW route table will be forwarded to that attachment in the security hub vpc- There it again will look the routing table to decide which GWLBe to use. And if you decide to point it to different endpoint, let say VPC-Shared, as you can imagine this will be forwarded to the firewall under different source zone, which will not match the session created by the original request and it will treat it as new session.- But even if somehow the firewall to allow this traffic (if it is TCP will drop it, but probably ICMP and UDP may still pass through as those are stateless protocols), this traffic will still be treated as intra-zone traffic and destination zone will be the same as the source.I hope this make it more clear...You can separate East-West from Outbound traffic, following the design from the link, but you still need to create intra-zone rules for allowing this traffic. And in addition it is hard for me to imagine a way you can further separate east-west traffic based on the VPCs. All VPCs (and vpn to on-prem) needs to be routed/associated with the same GWLBe in order to have symmetric routing.",1,06-16-2022,07:14 AM
16,502945,MikeC,"@AstardzhievThank you again for response. It's getting clearer. If I'm understanding correctly, if I have 5 VPCs (workloads) + 1 Security VPC(FWs), each of the 5 VPCs will have their own GWLBe, and the security VPC will have two GWLBe (one for outbound and one for east/west).All 5 VPCs should map to the same sub-interface and I should probably call that firewall zone ""east-west""For firewall policy rule creation for things I need to limit/inspect, I should do source zone east-west, source address x.x.x.x, destination zone east-west, destination address x.x.x.xContinuing with that logic, if I understand correct, then I should assume if an EC2 instance in VPC-A is going to the internet, I should expect to see on the firewall logs source zone outbound, destination zone outbound?I just want to mention that in my security VPC, I was not creating multiple GWLBe, for each zone. In case that wasn't clear.",0,06-16-2022,07:34 AM
17,502945,Astardzhiev,"Hi @MikeCAs you can see from the document earlier one design it to use TGW for sending traffic between VPCs. In this case outbound and east-west traffic will require GWLBe (east-west and outbound) only in the Security VPC. GWLBe in each workload VPC is required only for inbound traffic (which I think we don't discuss at the moment). The GWLBe in the workload VPCs are used only for inbound traffic and if you want you can associate each one with different zone. Those zones you will use for intra-zone rules for inbound traffic (or you can associated all inbound GWLBe with single zone)About the rule examples you are absolutely right:- Any traffic between VPCs should be intra-zone rule with ""east-west"" zone specifing source and destination addresses- Any Outbound traffic to internet should be intra-zone rule with ""outbound"" zone and specifing source and destination addresses. In this case you also don't configure NAT on the firewall, it is done by AWS with NAT GW.Not sure if you already have check this, but I would suggest you to go over these documents - https://www.paloaltonetworks.com/resources/reference-architectures/awsCheck first AWS Reference Architecture Guide - Palo Alto Networks which describe the possible architectures based on your requirementsAfter that you can check the specific deployment guide which again give some explanation about the design and then give detailed deployment steps.",1,06-16-2022,07:56 AM
18,502945,MikeC,"@AstardzhievAppreciate your help on this. This makes a lot more sense now. I'm clear on the east/west functionality.I did go through the architecture guide but I suppose I missed some details. I will revisit, as one item still doesn't make sense. If I have a workload in VPC-A that has a public elastic IP assigned to it, I'm not seeing how I can inspect it with the firewalls in the security VPC before it goes outbound to internet. I'm thinking outbound would only work if all instances are private and rely on NAT-GW in security VPC to go to internet",0,06-16-2022,08:40 AM
19,502945,Astardzhiev,"Hi @MikeC ,I am fairly new to the public cloud world and still learning. I can only share my personal experiance from the proof of concept that we currently deployed.Hm it is interesting use case that you mentioned, I haven't though about that...But one way I could imagine (I could be missing something), is to move the public elastic IP away from the EC2 instance and probably associate it with dedicated GWLBe.- Move the EC2 instance to dedicated subnet.- Create GWLBe in the VPC-A which will be dedicated outbound for this EC2- Create route table with default route poining to the GWLBe and associate the EC2 subnet with it- Create route table with default route pointing to IGW and associate the GWLBe subnet with it- Associate the public Elastic IP with the GWLBe interface -----> I am not 100% if this step is possible as I haven't try it yet.In the EC2 instance route table you can still put route for intrer-VPC traffic pointing to TGW attachment and have East-West traffic inspected as well. But if you need to use dedicated public IP for that instance I believe you need to at least put it in separate subnet.",0,06-20-2022,12:45 AM
20,128555,bmorris1,"Hi Pdj,I believe there are some limitations in Azure with IPv6, for instance you have to deploy the VM with IPv6 already enabled, you can't add an address on. Additionally only load balancers at the moment support IPv6 'public' addresses.https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-ipv6-overviewhope this helps,Ben",0,12-02-2016,02:24 AM
21,128555,pshingavi,"It's been six or seven years, and still no ipv6 support for the palo altos in aws.",0,06-17-2022,11:30 PM
22,491631,Astardzhiev,"Hi @estoltz ,I don' think there is a way to assign the public IP directly to the firewall (in fw configuration). You need to put the private IP address (or enable DHCP) that Azure will generate and use that for any NAT rule. Azure will automatically translate that private IP to the public one that is allocated.",0,06-16-2022,01:46 AM
23,491631,stoltz,Correct. The problem I'm running into is that some VMs have Standard SKU public IPs but it seems Palo Alto only supports Basic public IPs to be assigned to the private IP assigned to the untrusted interface. I'm trying to determine if there is a way to support standard public IPs instead of just basic.,0,06-16-2022,05:39 AM
24,486034,thomas8927eva,"Hello everybody,I see that You will also need to configure the same on the firewall interface in order to start receiving traffic for the new Elastic IP Address.",0,05-10-2022,01:41 AM
25,486034,MinSeob-KWON,"helloThanks for the comment.I see what you said ""I see that You will also need to configure the same on the firewall interface in order to start receiving traffic for the new Elastic IP Address."" are looking for a way to Where can I find the relevant documentation? I also searched KB, Techdocs, but couldn't find anything related to it.If that's ok, can you give me the address of a document with relevant content or how to set up the interface?",0,05-11-2022,01:31 AM
26,486034,sthornton,What is the customer trying to do or what is the use case for having multiple Public IP Addresses? Do you have a diagram? I'd suggest taking a look at the Palo Alto Networks AWS Reference Architecture guide as well as the deployment guides.,0,05-23-2022,10:22 AM
27,486034,Astardzhiev,Hi @MinSeob-KWONWhat the KB wants to say is the AWS (and Azure in this matter of fact) will assign only the first IP address over DHCP. If you assign multiple IP addresses to the interfaces in AWS console you must login to FW and configure all of these IPs as static entries - because DHCP will assign only the first one and FW will not be able to use the rest.,0,06-16-2022,05:05 AM
28,471991,nelsonc0,"Bumping this up, can't believe nobody else has this issue?",0,03-11-2022,08:15 AM
29,471991,Astardzhiev,"Hi @nelsonc0 ,Hope you have managed to solve your problem if not, please check which version of AWS plugin for Panorama are you using.According to the documentations version 3.0.0 have introduced the support for ALB, NLB and ENI monitoring - https://docs.paloaltonetworks.com/plugins/vm-series-and-panorama-plugins-release-notes/panorama-plug...",0,06-16-2022,04:55 AM
30,485525,Astardzhiev,"Hi @PaulZharyuk ,You need to put the private IP addresses as IKE peer ID when defining the IKE Gateway.If you don't define anything (leave the default of none), firewalls will use IP addresses as peer identifiers. But when behind NAT device will send the private address as local peer (because that is assigned on its interface), while the remote peer will expect to see the public IP (because you have defind the public IP as remote peer).For that reason when behind NAT, in addition to NAT-T you need to change IKE peer identification to use the private addresses.P.S. I hope you have upgraded your firewall as 9.0 is out of support since March.",0,06-16-2022,01:53 AM
31,500573,sthornton,"Thanks for finding this. Please test again, we updated the repo.",0,06-06-2022,08:51 PM
32,500573,jrosenberg3377,"Thanks for that. Do you know where I can find documentation on what the ""Custom Data"" field does/accepts? It's not in the deployment guide or readme on Github",0,06-07-2022,09:10 AM
33,500573,sthornton,I don’t know of any official documents but there is a section about halfway down in the readme that has an example.,0,06-07-2022,10:20 AM
34,500573,Astardzhiev,"Hi @sthornton ,ReNot sure if you already have did that, but it is probably good idea to add to the templates the option to enable Accelerated Networking on all dataplane interfaces. Last time used the templates in the Reference Architecture repo it was not defined in the template.",0,06-16-2022,01:40 AM
35,479200,Astardzhiev,"Hi @sthornton73 ,Hope you have found solution for your problem if not or for anyone else that is interested:GWLB always use the first interface if the associated instance when targte group is defined to use target type of instance. While PAN firewall NVA (network virtual appliance) is aways using the first interface for management and the rest for dataplane. You have two ways to solve this:- In PanOS 10.0 (if I am not wrong) was intruduced command that can swap mgmt and first dataplane interface under PanOS. That way you need to attach the dataplane interface first to the instance the mgmt network as second ENI. Detailed information could be found here - https://docs.paloaltonetworks.com/vm-series/9-1/vm-series-deployment/set-up-the-vm-series-firewall-o...- Second solution is to use ""IP"" as target type for the target group and reference the firewalls by the IP address of the dataplane interface. This way you can keep the mgmt as first interface and dataplane as second.Either way you still need to configure GWLB health check for HTTPS over port 443 and on the firewall to attach interface management profile allowing HTTPS to the dateplane interface",0,06-16-2022,01:22 AM
36,451187,mtsang,Hi@JoeKwokPlease check thethroughput with different number of CPU in Palo altoproduct-selection table and select the VM model.It will show the throughput of the VM Serieswith different number of CPUHave a nice dayhttps://www.paloaltonetworks.com/products/product-selection,1,06-01-2022,12:45 AM
37,488868,sthornton,How many vNICs are on the VM instance you are running? What does the interface on the firewall show?,0,05-23-2022,10:12 AM
38,488868,Astardzhiev,"Hi @IT.OPS ,When attaching new ENI you need to reboot the VM. Have you done that? What instance type have you used?",0,05-30-2022,01:28 PM
39,487666,sthornton,"Hi Jim. You should not need to be using source NAT to maintain session symmetry in Azure. Which load balancer are you using on the inside? Basic, Standard SKU?",0,05-23-2022,10:16 AM
40,487666,JimMcGrady,"Hi Scott. Traffic initiated from internet passes through the outside load balancer (standard public SKU) to the Palo pair, and then straight to the backend servers. I am using port Natting between the outside LB and the Palo pair to allow traffic differentiation. Without a source NAT, the reply traffic uses the user defined route which sets the inside load balancer (standard sku internal) as its next hop. a traffic capture sees this delivered to either Palo, not necessarily to the one the original traffic came through.",0,05-23-2022,06:38 PM
41,340782,RG_Cyber,"Hi,Just wondering how did you action this? In place upgrade or did you spin a new VM and changed routing?",1,02-23-2022,03:12 AM
42,340782,2048tm,"After connecting the NICs to the Palo Alto, you must reboot.cupcake 2048",0,05-17-2022,09:17 AM
43,484030,W_Rafalski,"Hello,I guess you've deployed PA-VM on VirtualBox ? By default MGMT interface of VM gets IP address from DHCP. 192.168.1.1 is for hardware only. I would open console of VM through VirtualBox - in the end of booting process there is info about what IP VM got.Did I understand your problem correctly ?",0,05-04-2022,12:58 AM
44,484030,Dilton111,HiYes I did deployed PA-VM on VirtualBox. I did check my default gateway is 192.168.1.254. but when I entered the ip address is bringing me to my hub manager page and not to palo alto login page. Hub manager page(My ISP webpage) it is showing all devices that are connected to the hub include PA-VM. But I don't how to access palo alto login page.,0,05-04-2022,04:11 AM
45,484030,W_Rafalski,"Hello,you shouldn't use defaut gateway address, but PA-VM address. It's not the same. On VirtualBox your PA is normal VM, like Windows Server or Centos. You don't go to the Internet through PA.1) Just reboot your PA-VM, click twice on it in VirtualBox-> you will get console and after booting there will be info about leased IP address. IP address you should use in web browser (always with https://)Second option:2) Click twice on you running PA-VM in VirtualBox, log in using admin/admin credentials and then use command ""show system info"". Here is example:",0,05-04-2022,04:48 AM
46,484030,sthornton,"Try using the IP Address picked up by the VM, not the default gateway.",0,05-04-2022,08:48 AM
47,484030,Dilton111,I did that. this is the IP address 192.168.1.78 But I am getting this message below:192.168.1.78refused to connect.Try:,0,05-04-2022,10:28 AM
48,484030,W_Rafalski,"So you need to do basic troubleshooting:1. Be sure your PA-VM is running and finished booting process.2. Try to ping PA-VM from host.3. Try to log into PA-VM, then ping your host from CLI:> ping host <your host IP address>4. Check if you don't block untrusted certificates ? New PA uses self-sign cert. By default you have to use https://",0,05-04-2022,12:16 PM
49,484030,Dilton111,"2- it is ok. ping was successful3. Trying to ping . I am getting this message ""invalid syntax"".",0,05-04-2022,04:31 PM
50,484030,W_Rafalski,"""Invalid syntax"" means you have a ""typo"", use ""TAB"" to complete command.Properly used command example:> ping host 1.2.3.4you will ""ping"" address 1.2.3.4 from your management interface. You can try as well:> ping source <address of one of PA-VM interfaces> host <your host IP address>Did you check you accept untrasted certs in your web browser ?",0,05-04-2022,11:49 PM
51,484030,Dilton111,"Yes. Ping successful to the host.Untrusted certs. I deleted from mac ""my certificates"". But I still getting the same message from browser.I am using google chrome. I went to settings and security and added https with ip address. but still isn't working.",0,05-05-2022,03:15 AM
52,484492,sthornton,"Hi Fatih. Yes, it's possible to upgrade the VM-Series in a VMSS. You will need to update the template that builds the FW/VM-Series for your scale out events. Once that is updated, you can remove one old FW at a time and let the template build out the new. If you don't update the template, your old version of PAN-OS would get deployed on the next scale out event.",0,05-04-2022,08:37 AM
53,484492,FatihT,"Hello@sthorntonThanks for feedback. I forgot to mention that the deployment is done through Panorama Orchestration.So, if I change the version on the deployment configuration on Panorama,I'll test it in my lab environment. If you have information during this time, I'lll be glad🙂Fatih",0,05-05-2022,02:41 AM
54,484492,FatihT,Hello@sthorntonTried to make the update from Panorama by changing the version in Azure plugin deployment settings.Failed with the error below:,0,05-05-2022,09:56 AM
55,479866,Y-alwaysMe,"Hi,Yes, but the device needs to be accessible somehow for you to collect log files. if you manage to access you can look at the system logs for critical and high severity events around the time issue occurred.or alternative you can collect Tech Support files and send it to Palo Support. but you need access to device for both scenerios.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClRlCAK",0,05-04-2022,03:43 PM
56,185988,Warby,"Hi Greg,This should work and is supported. I've done this myself with no issues. Here are some things to try:HTH,Warby",0,11-08-2017,10:39 AM
57,185988,Gregman380,Thank you for the feedback. Yes the ping is being denied according to the intrazone rule. I have a management rule that allows ping set up and applied to that interface. It should accept ping...Thank you again!,0,11-08-2017,11:04 AM
58,185988,Gregman380,"Ok, well based on what you told me I think I may have been blocking myself!! It is working now and I thank you for your response. I learned some good troubleshooting along the way!!Best Regards,Greg",0,11-08-2017,11:16 AM
59,185988,p.manojkumar,"Hi Warby,I have this similar issue with Paloalto external interface elastic ip not reachable from internetbut mgmt EIP is reachableVerified security group allow all traffic & enabled httpsAny idea?ThanksManoj",0,04-26-2022,10:51 AM
60,471276,ajworks,cft_simplifiedASG_with_warm_poolsassumes the 2 NIC what is coded is from the same subnet. Additionally AWS ASG + LaunchTemplate based ENI provisioning will support only the subnets that was configured in ASG resource. You will not be able to do the splitting via CloudFormation. But you could achieve what you want by keeping the eth0 in the LaunchTemplate and other 2 (eth1 and eth2) by updating the Lifecycle Hook Lambda code.,0,04-09-2022,04:44 PM
61,477048,dmaynard,Not at this time but is on roadmap and can consult SE for more info.,0,04-05-2022,03:56 PM
62,476694,avelK,"Thank you for the post@BabajideMcould you check below points:1.) Make sure that Log Collector's serial number and password in Panorama under Managed Log Collectors are correct.2.) Make sure that PAN-OS of Log Collector is the same or lower than the one running on Panorama.3.) I would also make sure that log collector is configured to use the same time zone as Panorama and that DNS server is configured:  set deviceconfig system timezone <Time Zone>  set deviceconfig system dns-setting servers primary <IP address> secondary <IP address>4.) Make sure log collector is added to log collector group and push the configuration to log collector group by: Commit > Push to Devices > Collector Groups > [Log Collector name].5.) Make sure that App content version installed on Log Collector is the same as the one on Panorama.6.) On Panorama side, I would check the output from:show netstat numeric yes | match 3978  Could you also take packet capture on Panorama side? You can use Log Collector's IP address as a filter. Make sure that TCP3978 between Panorama and Log Collector are open.Kind RegardsPavel",0,03-30-2022,03:49 PM
63,257247,Danielma911,"You can refer to this Github architecture, which utilizes AliCloud Function Compute to do the active/standby switchover. All through API interaction, which is much better than HAVIP approach.https://github.com/PaloAltoNetworks/Alicloud_VM_HAPls. let me know if you have any questions.",1,01-14-2021,07:25 AM
64,257247,Danielma911,The tech link for your reference:https://theloop.paloaltonetworks.com/loop/vm-series-with-alibaba-cloud-havip,0,09-05-2021,07:54 PM
65,257247,DejiOdusanya,This Repo is simply for 2 AZ. I can't seem to find script for Single Zone Failover with FSS. Any guidance will help.,0,03-26-2022,07:26 PM
66,474462,WayneEvans,"Turns out we can't do this as the check happens on the management plane not the data plane.If anyone replies, I am still curious about header injection though",0,03-21-2022,10:16 AM
67,474156,SutareMayur,"Hi@Martin_Kurniawan,You can refer below existing articles for Licensing Considerations on Cloud.VM-Series for AWS and Azure Licensing ConsiderationsVM-Series Firewall Licenses for Public CloudsHope it helps!",0,03-21-2022,07:42 AM
68,472887,FatihT,Additional information: I've set Panorama Public IP in the configuration of the Azure plugin 'Deployment' section.,0,03-14-2022,08:47 AM
69,472887,FatihT,"The issue resolved. Contrary to the example provided by the webinar (see URL), I've set the private IP of Panorama and establish the peering between firewall's VNet.In my environment I cannot access to Panorama with public IP.",0,03-17-2022,04:26 PM
70,473644,dmaynard,A return route in the FW virtual router for the peered vnet.Security rule allowing trafficNAT if required,1,03-16-2022,08:00 AM
71,473644,msazure,"Appreciated the quick response.By the return route - is it a static route to the peered VNET added to the trusted Virtual Router? Like below:Peered VNet space (10.2.0.0/24) : Interface Ethernet 1/2 (trusted) -> Next Hop : IP Address Of the Default Gateway of the Trusted Subnet.Security rule - since this is non prod, we have Allowed All from trusted zone to untrusted zone - anything more specific to peered?NAT Rule - anything specific for peering?Thanks in advance!",0,03-16-2022,08:37 AM
72,473126,dmaynard,Sure not using a deployment profile for 10.0.4 or higher and using auth for older PAN-OS?What version of PAN-OS are your deploying on?Where are you deploying PAVM?,0,03-15-2022,01:21 AM
73,473126,CHOE-KyungJun,"@dmaynardThe OS version is 9.1.0-h3.I've searched related known issues, but couldn't find a match.And the firewall is installed in azure.",0,03-15-2022,02:01 AM
74,473126,dmaynard,Deploying from custom image or marketplace?May have old product code if using custom image and needs to be updated.,0,03-15-2022,02:30 AM
75,473126,CHOE-KyungJun,"@dmaynard1. Deploying from custom image or marketplace?> My client used the azure template, not the marketplace.2. May have old product code if using custom image and needs to be updated.> Are you saying the template could have old product code?> The code information is as follows.{""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",""contentVersion"": ""1.0.0.13"",""parameters"": {""vmName"": {""defaultValue"": ""VM-FW2"",""type"": ""String"",""metadata"": {""description"": ""Name of VM-Series FW in the Azure portal""}},""fwAvSet"": {""defaultValue"": ""AS-FW"",""type"": ""String"",""metadata"": {""description"": ""EXISTING Availability Set name for Firewalls""}},""customData"": {""defaultValue"": ""storage-account=None,access-key=None,file-share=None,share-directory=None"",""type"": ""String"",""metadata"": {""description"": ""String passed down to the Virtual Machine.""}},""vmSize"": {""defaultValue"": ""Standard_DS5_v2"",""allowedValues"": [""Standard_D3"",""Standard_D4"",""Standard_D3_v2"",""Standard_D4_v2"",""Standard_A4"",""Standard_DS3_v2"",""Standard_DS4_v2"",""Standard_DS3_v2""],""type"": ""String"",""metadata"": {""description"": ""Azure VM size for VM-Series""}},""imageVersion"": {""defaultValue"": ""latest"",""allowedValues"": [""latest"",""9.1.4"",""9.1.2"",""9.1.0""],""type"": ""String"",""metadata"": {""description"": ""Version number of VM-Series VM in the Azure portal""}},""imageSku"": {""defaultValue"": ""byol"",""allowedValues"": [""byol"",""bundle1"",""bundle2""],""type"": ""String"",""metadata"": {""description"": ""Firewall License Model""}},""virtualNetworkName"": {""defaultValue"": ""V-NET"",""type"": ""String"",""metadata"": {""description"": ""Name of the EXISTING Virtual Network (VNET)""}},""virtualNetworkAddressPrefix"": {""defaultValue"": ""192.168.0.0/16"",""type"": ""String"",""metadata"": {""description"": ""EXISTING Virtual network address CIDR""}},""virtualNetworkExistingRGName"": {""defaultValue"": """",""type"": ""String"",""metadata"": {""description"": ""Name of resource group of EXISTING VNET""}},""subnet0Name"": {""defaultValue"": ""Mgmt"",""type"": ""String"",""metadata"": {""description"": ""EXISTING Subnet for Management""}},""subnet1Name"": {""defaultValue"": ""Untrust"",""type"": ""String"",""metadata"": {""description"": ""EXISTING Subnet for Untrust""}},""subnet2Name"": {""defaultValue"": ""Trust"",""type"": ""String"",""metadata"": {""description"": ""EXISTING Subnet for Trust""}},""authenticationType"": {""defaultValue"": ""password"",""allowedValues"": [""sshPublicKey"",""password""],""type"": ""String"",""metadata"": {""description"": ""Type of administrator user authentication ""}},""subnet0Prefix"": {""defaultValue"": ""192.168.0.0/24"",""type"": ""String"",""metadata"": {""description"": ""EXISTING Mgmt subnet CIDR""}},""subnet1Prefix"": {""defaultValue"": ""192.168.1.0/24"",""type"": ""String"",""metadata"": {""description"": ""EXISTING Untrust subnet CIDR""}},""subnet2Prefix"": {""defaultValue"": ""192.168.2.0/24"",""type"": ""String"",""metadata"": {""description"": ""EXISTING Trust subnet CIDR""}},""subnet0Address"": {""defaultValue"": ""192.168.0.4"",""type"": ""String"",""metadata"": {""description"": ""Mgmt subnet static address""}},""subnet1Address"": {""defaultValue"": ""192.168.1.4"",""type"": ""String"",""metadata"": {""description"": ""Untrust subnet static address""}},""subnet2Address"": {""defaultValue"": ""192.168.2.4"",""type"": ""String"",""metadata"": {""description"": ""Trust subnet static address""}},""adminUsername"": {""type"": ""String"",""metadata"": {""description"": ""Username of the administrator account of VM-Series""}},""adminPassword"": {""defaultValue"": """",""type"": ""SecureString"",""metadata"": {""description"": ""Password for the administrator account of VM-Series""}},""publicIPAddressName"": {""type"": ""String"",""metadata"": {""description"": ""Name of FW1 MGMT Public Address""}},""bootstrap"": {""type"": ""string"",""defaultValue"": ""no"",""allowedValues"": [""yes"",""no""],""metadata"": {""description"": ""Pass bootstrap data to VM""}},""zone"": {""type"": ""string"",""defaultValue"": ""None"",""metadata"": {""description"": ""Availability Zone for VM-Series""}},""nsgName"": {""defaultValue"": ""DefaultNSG"",""type"": ""String"",""metadata"": {""description"": ""Name of existing Network Security Group for MGMT FW interface""}}},""variables"": {""apiVersion"": ""2015-06-15"",""imagePublisher"": ""paloaltonetworks"",""imageOffer"": ""vmseries1"",""nicName"": ""[concat(parameters('vmName'), '-eth')]"",""vnetID"": ""[resourceId(parameters('virtualNetworkExistingRGName'),concat('Microsoft.Network','/','virtualNetworks'),parameters('virtualNetworkName'))]"",""subnet0Ref"": ""[concat(variables('vnetID'),'/subnets/',parameters('subnet0Name'))]"",""subnet1Ref"": ""[concat(variables('vnetID'),'/subnets/',parameters('subnet1Name'))]"",""subnet2Ref"": ""[concat(variables('vnetID'),'/subnets/',parameters('subnet2Name'))]"",""publicIPAddressType"": ""Dynamic"",""zones"": [""[parameters('zone')]""],""subnets"": [{""name"": ""[parameters('subnet0Name')]"",""properties"": {""addressPrefix"": ""[parameters('subnet0Prefix')]"",""networkSecurityGroup"": {""id"": ""[resourceId('Microsoft.Network/networkSecurityGroups', parameters('nsgName'))]""}}},{""name"": ""[parameters('subnet1Name')]"",""properties"": {""addressPrefix"": ""[parameters('subnet1Prefix')]""}},{""name"": ""[parameters('subnet2Name')]"",""properties"": {""addressPrefix"": ""[parameters('subnet2Prefix')]""}}]},""resources"": [{""type"": ""Microsoft.Resources/deployments"",""apiVersion"": ""2017-05-10"",""name"": ""pid-6DBAAFA1-69B7-48FC-8ECC-B6B3D2664FCD"",""properties"": {""mode"": ""Incremental"",""template"": {""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",""contentVersion"": ""1.0.0.0"",""resources"": []}}},{""type"": ""Microsoft.Network/publicIPAddresses"",""apiVersion"": ""2019-04-01"",""name"": ""[parameters('publicIPAddressName')]"",""location"": ""[resourceGroup().location]"",""properties"": {""publicIPAllocationMethod"": ""[variables('publicIPAddressType')]"",""dnsSettings"": {""domainNameLabel"": ""[parameters('publicIPAddressName')]""}}},{""type"": ""Microsoft.Network/networkInterfaces"",""apiVersion"": ""2017-10-01"",""name"": ""[concat(variables('nicName'), '0')]"",""location"": ""[resourceGroup().location]"",""dependsOn"": [""[concat('Microsoft.Network/publicIPAddresses/', parameters('publicIPAddressName'))]""],""properties"": {""ipConfigurations"": [{""name"": ""ipconfig-mgmt"",""properties"": {""privateIPAllocationMethod"": ""Static"",""privateIPAddress"": ""[parameters('subnet0Address')]"",""publicIPAddress"": {""id"": ""[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddressName'))]""},""subnet"": {""id"": ""[variables('subnet0Ref')]""}}}]}},{""type"": ""Microsoft.Network/networkInterfaces"",""apiVersion"": ""2017-10-01"",""name"": ""[concat(variables('nicName'), '1')]"",""location"": ""[resourceGroup().location]"",""dependsOn"": [],""properties"": {""enableIPForwarding"": true,""ipConfigurations"": [{""name"": ""ipconfig-untrust"",""properties"": {""privateIPAllocationMethod"": ""Static"",""privateIPAddress"": ""[parameters('subnet1Address')]"",""subnet"": {""id"": ""[variables('subnet1Ref')]""}}}]}},{""type"": ""Microsoft.Network/networkInterfaces"",""apiVersion"": ""2017-10-01"",""name"": ""[concat(variables('nicName'), '2')]"",""location"": ""[resourceGroup().location]"",""properties"": {""enableIPForwarding"": true,""ipConfigurations"": [{""name"": ""ipconfig-trust"",""properties"": {""privateIPAllocationMethod"": ""Static"",""privateIPAddress"": ""[parameters('subnet2Address')]"",""subnet"": {""id"": ""[variables('subnet2Ref')]""}}}]}},{""type"": ""Microsoft.Compute/virtualMachines"",""apiVersion"": ""2018-06-01"",""name"": ""[parameters('vmName')]"",""location"": ""[resourceGroup().location]"",""dependsOn"": [""[concat('Microsoft.Network/networkInterfaces/', variables('nicName'), '0')]"",""[concat('Microsoft.Network/networkInterfaces/', variables('nicName'), '1')]"",""[concat('Microsoft.Network/networkInterfaces/', variables('nicName'), '2')]""],""plan"": {""name"": ""[parameters('imageSku')]"",""product"": ""[variables('imageOffer')]"",""publisher"": ""[variables('imagePublisher')]""},""properties"": {""availabilitySet"": {""id"": ""[resourceId('Microsoft.Compute/availabilitySets', parameters('fwAvSet'))]""},""hardwareProfile"": {""vmSize"": ""[parameters('vmSize')]""},""osProfile"": {""computerName"": ""[parameters('vmName')]"",""adminUsername"": ""[parameters('adminUsername')]"",""adminPassword"": ""[parameters('adminPassword')]"",""linuxConfiguration"": ""[if(equals(parameters('authenticationType'), 'password'), json('null'), variables('linuxConfiguration'))]"",""customData"": ""[if(equals(parameters('bootstrap'), 'no'), json('null'), base64(parameters('customData')))]""},""storageProfile"": {""imageReference"": {""publisher"": ""[variables('imagePublisher')]"",""offer"": ""[variables('imageOffer')]"",""sku"": ""[parameters('imageSku')]"",""version"": ""[parameters('imageVersion')]""},""osDisk"": {""createOption"": ""FromImage""}},""networkProfile"": {""networkInterfaces"": [{""id"": ""[resourceId('Microsoft.Network/networkInterfaces', concat(variables('nicName'),'0'))]"",""properties"": {""primary"": true}},{""id"": ""[resourceId('Microsoft.Network/networkInterfaces', concat(variables('nicName'),'1'))]"",""properties"": {""primary"": false}},{""id"": ""[resourceId('Microsoft.Network/networkInterfaces', concat(variables('nicName'),'2'))]"",""properties"": {""primary"": false}}]}},""zones"": ""[if(equals(parameters('zone'), 'None'), json('null'), variables('zones'))]""}]}",0,03-15-2022,09:55 PM
76,473126,dmaynard,"""imageOffer"": ""vmseries1"",That is an older offering, discontinued updates but still available.az vm image list --publisher paloaltonetworks --offer vmseries-flex --all --output table",0,03-15-2022,10:08 PM
77,473126,CHOE-KyungJun,"@dmaynardThank you for your commnetAccording to your comments, that model seems to be still supported as well. But can you tell me why this error is occurring?",0,03-15-2022,10:37 PM
78,470540,FatihT,"Hi,I've been in touch with a PaloAlto engineer who confirm that additional Azure App GW and Standard LB can be added to the existing one.Regards.",0,03-14-2022,08:45 AM
79,304392,OtakarKlier,"Hello,Is this what you are looking for?https://www.paloaltonetworks.com/resources/videos/vm-series-integration-with-aws-auto-scalingPlease advise,",0,12-31-2019,02:27 PM
80,304392,nelsonc0,"Justin,Did you ever find a solution to this?",0,03-10-2022,06:19 AM
81,464735,DanaHawkins,"Yes and no. Remember GWLBs and TGWs serve specific purposes. If you just want VPC to VPC connectivity you can use VPC Peering. If you want to inspect traffic VPC to VPC using a pair of PAN FWs, you would use GWLB. If you want to perform dynamic routing with BGP over IPSec to on-prem with AZ redundancy, the TGW is still a good option.With the GWLB architecture, the firewall takes over the routing that would normally be done by the TGW (Hub and Spoke RT). That is because each GWLBe is mapped to an interface and zone on the FW and native routing is used. It's also much faster. In the old architecture, the Palo's had to have an IPSEC tunnel to the TGW which was limited to 1.25Gbps.",0,03-02-2022,07:41 AM
82,464735,davidcompos96,"GWLBs and TGWs serve specific purposes, the TGW is still a good option.",0,03-03-2022,11:00 AM
83,465652,sudha346,,0,02-14-2022,12:55 PM
84,465652,DanaHawkins,"Best practice is to setup an inbound NAT on a port other than TCP/80 or TCP/443. For instance, use an inbound nat on port TCP/8888 that NATs to 443 with a destination of your back-end server. You can also check the reference architecture guide well.https://www.paloaltonetworks.com/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resour...",0,03-01-2022,12:58 PM
85,468432,DanaHawkins,"I would take a look at the Palo Alto Azure Reference Architecture Guide.https://www.paloaltonetworks.com/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resour.... In short, you have to configure UDRs to get traffic over to the Palo Alto for inspection.",0,03-01-2022,12:48 PM
86,467791,sthornton,,0,02-23-2022,05:56 AM
87,467791,crypto,"Hi@sthornton,Sorry for misunderstanding. I want to go VPC1 to VPC2 passthrough VPC3 PA firewall without using transit gateway and VPN.",0,02-24-2022,08:10 AM
88,467791,DanaHawkins,"This is a very odd setup. Why do you have a firewall in every VPC? By default subnet-2-subnet traffic within a VPC is not going to be inspected by the PA. it would be more practical to use VPC3 as the primary ""Security VPC"" inspecting traffic passing between VPCs.With that said, your design CAN work but you would need a RouteTable in every subnet, please see below. I only included VPC1 and VPC3, you can duplicate the configuration for VPC2.",1,02-24-2022,11:25 AM
89,467791,DanaHawkins,Another thing to keep in mind is that if you added more subnets within the VPCs you would need to consider the PA VM instance size. I believe you need a C4xLarge just to have the proper number of interfaces to place in each subnet. With more than 4 interfaces you would need to go to bigger instance size and it will start getting pricey.,0,02-24-2022,11:29 AM
90,467791,crypto,"Hi@DanaHawkins,When i read Doc, all are said need Transitgateway. I want to do VPC3 as security VPC and traffic VPC1 to VPC2 pass through VPC3 for inspection. is it possible without using Transit gateway ?",0,02-24-2022,06:25 PM
91,467791,DanaHawkins,You achieve what you want with VPC peering using a design similar to the picture I posted above. Transit Gateways give you the benefit of Availability Zone redundancy and using BGP for route propagation between the firewalls and AWS. Using VPC peering all route table configurations are manual for both the firewall and AWS.,0,02-25-2022,06:15 AM
92,467791,sthornton,I do not believe this is possible. This would be transitive routing and would require an intermediary to accomplish.,0,02-25-2022,09:48 AM
93,467791,DanaHawkins,"The firewall is acting as the intermediary. VPC peer allows for connecting of resources between VPCs.@sthorntonYou are right that, if there was no firewall, or another intermediary, within the VPC then you would not be able to communicate from VPC1 to VPC2 via VPC3.",0,02-25-2022,02:22 PM
94,467791,dmaynard,https://docs.aws.amazon.com/vpc/latest/peering/invalid-peering-configurations.html#transitive-peerin...,0,02-25-2022,02:31 PM
95,468705,sthornton,,1,02-25-2022,08:44 AM
96,467655,DanaHawkins,You will need to associate an AWS EIP (External IP) to the interface on that PAN that the GPGateway lives on. External users will connect to the EIP and be Nat'd to the DHCP address on the firewall. Even though the IP is DHCP it won't change as long as you don't terminate or detach the interface from the firewall.,1,02-24-2022,11:38 AM
97,467655,sherls,Thank you! as you said I configure it anyways as it said None in the IPs but it worked.,0,02-24-2022,01:58 PM
98,464334,DanaHawkins,After you attach the NICs to the Palo Alto you will need to reboot.,0,02-24-2022,11:42 AM
99,448226,DelvinC,"Were you able to get it moved? The last time I had to do this, I learned it the hard way that MarketPlace VMs do not like to be moved and need to be redeployed. You can at the most clonethe OS disk or movethe original disk after deleting the virtual machine from source subscription. I would be interested to learn more about your experience or if you had a different approach.",0,01-20-2022,04:54 PM
100,448226,JackTrainor,"Hi Delvin, I created a new VM with the same base config, imported a backup of the existing VM and then transferred the license. I'm guessing that's probably the easiest way to do it.",0,02-21-2022,06:57 AM
101,373760,apatil,"Hi Craig,Thanks for your feedback.How are you deploying the GWLB with VM-Series? Are you using any of the templates provided on our Github repo?https://github.com/PaloAltoNetworks/AWS-GWLB-VMSeriesIf you are using a CFT with an autoscale template, then it will create a NAT GW along with other components. The template also takes care of the automatic route population for any new APP VPCs.Thanks,Raj",0,12-10-2020,11:27 PM
102,373760,jmeurer,"As of this time, break out routing is not supported. The traffic must stay in the Geneve tunnel. In reading this, it appears you are addressing the outbound use case. In that traffic flow, the NatGW must be used as the next hop beyond the GWLBe as depicted in this flow.",0,12-11-2020,04:57 AM
103,373760,craig.beamish,"We are using a nat gateway. outbound works just fine until you apply NAT of any sort. just trying to apply any sort of NAT to change the direction of the traffic breaks it.so if i put a nat rule that traffic to 1.1.1.1 gets d-nat to 8.8.8.8, the traffic never exits the firewall.key use for this was for inbound traffic, redirecting inbound traffic to the correct ALB that lives in another vpc, the traffic seems to get dropped at the firewall, even though pcaps show it *thinks* it is being forwarded on, its not.",0,12-16-2020,08:18 PM
104,373760,jmeurer,"Inbound requires ingress routing to use the GWLB without SNAT. You can do that within the application vpc using a public-facing LB in front of the application.Or if you want to have a dedicated inbound VPC, you use the same design as above but move your pool members across the TGW.If you prefer the traditional Load Balancer sandwich design where the firewalls are pool members of the front door LB and you are going to SNAT/DNAT to the application, you would either use a dedicated set of firewalls or add new Untrust and Trust interfaces to the firewall as ETH3/4 and use those for ingress outside of the GWLB. This is necessary as the GWLB traffic must hairpin inside of the Geneve tunnel, you cannot insert flows into the tunnel from another interface.",0,12-17-2020,09:52 AM
105,373760,craig.beamish,"neither of those suit the application Im doing.We have multiple inbound services that sit behind the firewall.the current layout is the trust/untrust sandwich but we would prefer to move away from the NLB design as they have a capacity limitation in regards to autoscale groups.the design plan is that we have 'anchor' network addresses for each inbound service, the traffic comes in via the IGW, steered through the geneve tunnel to the palo, at which point we apply a destination NAT to the actual application load balancer of that service (which is in a different vpc), the traffic is still supposed to egress the geneve tunnel just with a different destination address, but the palo seems to drop it (even though the palo pcap believes it is forwarded on (seen in transmit stage with correct destination IP)on your comment re: overlay routing, why did they put the feature command in there if they havent got it working yet? /logic 😕",0,12-17-2020,02:05 PM
106,373760,jmeurer,"At this point, I would suggest you reach out to your Account Team to engage with one of the Consulting Engineers to discuss over zoom and whiteboard. There is only so much we can accomplish in the message board and a further understanding of your flows is warranted.",0,12-17-2020,02:13 PM
107,373760,craig.beamish,"For those playing at home,In further discussions with@jmeurer, AWS apply a 5 tuple hash on the traffic to ensure return path, so applying a NAT breaks the traffic flow and AWS drops the traffic.Overlay routing is not yet functional, hopefully it will be in 10.0.4 or 10.0.5 and I can test if I can get the NAT to work for me in that aspect. I am curious if the return traffic would exit via the same geneve tunnel given theres no routes through it in that situation, only time will tell.",0,01-14-2021,01:45 PM
108,373760,Sandeep_Darak,Did this issue Fixed.I am also facing challenges with AWS GWLB.Traffic is Sourced from Outside towards inside.Traffic monitor is showing traffic from Outside to Outside.Not sure why.....,0,02-05-2021,04:10 AM
109,373760,tostern,Hi@Sandeep_Darakthat in depends how you setup your interfaces. when you have only one interface then is of course your traffic recognized als interzone fraffic to Outside -> Outside. when you want to split it then you have to create sub interfaces and map them to a another zone and adopt your FW VR routing.,0,02-05-2021,04:37 AM
110,380983,nurulams0,Hi. May I know if you still face this issue? I also have similar issue with this. Any reponse from TAC?,0,02-10-2022,06:09 AM
111,464555,steve.delve,"I've deployed this, which deployment guide did you follow? It was a pain initially but then made sense.Have you got each interface separated with Virtual routers and static routes for the load balancers in each route table routing traffic for the load balancers back to the subnet gateway?If you look at the metrics of the load balancer then you will see if the availability of the Interfaces the load balancers are talking to is working.Azure Transit VNet Design Model Deployment Guide (paloaltonetworks.com)is an extensive guide pick what you need, sounds like its the virtual routers and the Load balancer availability checking tripping you up.",0,02-10-2022,02:30 AM
112,463354,sthornton,,0,02-04-2022,11:52 AM
113,463354,manavalan,,0,02-04-2022,02:06 PM
114,288473,BatD,"To clarify, persistence is not related to symmetry of the return traffic, but determines which firewall packets will be sent to. In theory the return packets can bypass the firewall regardless of the persistence setting. You are asking a valid question though and this is how it was previously with the “basic” Azure load balancer. There used to be a requirement to always configure source NAT behind the firewall’s internal interface for East-West traffic, otherwise the return packets were sent directly to the originating server, bypassing the firewall and creating asymmetric traffic flow.However sometime last year Azure introduced the “Standard” Load Balancer SKU, which fixed a lot of the issues with the basic SKU. One of them is that you no longer need to configure souce NAT and the load balancer takes care of the correct routing of packets, so they are sent to the correct firewall.Also previously we had to configure “session perssistance” on the LB, otherwise different packets of the same session could have been sent to different firewalls, which would have broken the session. Then again in the Standard SKU, they introduce a concept of “HA Ports”, desinged exactly for high availability. One of its attributes is that load balancing is done per flow and not per packet, ensuring that all packets for a session will be sent to a single firewall.""The load-balancing decision is made per flow. This action is based on the following five-tuple connection: source IP address, source port, destination IP address, destination port, and protocol. ""https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-ha-ports-overviewHope it makes sense. I did not explain it very well, but these are the reasons for no longer configuring persistence and source NAT.",3,09-16-2019,01:06 AM
115,288473,MalakIbrahim,Thank you for your reply and sorry for my late reaction.Two more question in regard-If so why persistence still exist in standard LB?-What about the internal traffic (inside zone) going to on-premise (vpn zone) and there's internal LB for every zone? i see in the article that there's no coordination between the two LB and they are working independently hence no guarantee that the traffic will traverse the same firewall back and forth.,0,10-01-2019,01:16 PM
116,288473,BatD,"@MalakIbrahimPersitance is not required only when you use the ""HA ports"" function.If you don't have HA Ports (which areonly for internal LB anyway), then you can balancing with or witout session persistance.You second question is regarding a different case: ""Backhaul and Management Traffic"" and works differently to the ""East-West Traffic"".As described in the guide you menitioned (p.13, p162), you will need to configure two way NAT to ensure the return traffic is sent to the correct firewall:"" Because you configure the load balancer with two front-end IPs and two backend pools for backhaultraffic, the firewall applies source NAT in both directions—from backhaul to private subnets and from private subnets tobackhaul. """,0,10-02-2019,12:13 AM
117,288473,HarcharanSingh,"Hi, we have deployed Palo-alto firewalls on Azure and a Standard Internal Load Balancer with single front-end IP and single backend pool, does LB maintain session state if -(1) communication is sourced from Azure VNET destined to On-premise ?(2) communication is sourced from On-premise destined to Azure VNET ?We don't have a Virtual Network Gateway deployed instead we have a Cisco vRouter in Azure VNET that has GRE tunnel to on-premise, so for on-premise communication we are routing all traffic (after firewall inspection) to Cisco vRouter which further forwards the traffic to on-premise.I have read in guide (page 56, Securing Application in Azure Reference Architeccture Guide (paloaltonetworks.com))""If thedestination traffic is within the Azure VNet, then the load balancer maintains session state to ensure thatreturn traffic to the resource enters through the firewall that processed the outgoing traffic. If the samefront end and back-end pool of the load balancer see both directions of the traffic flow, the load balancermaintains the session state. For destinations outside the VNet, the firewall must translate the source IPaddress to the IP address of the egress interface. Without this source NAT, routing might send the returntraffic to a different firewall.""Request guidance if source NAT is needed or not.",0,02-02-2022,05:46 AM
118,198801,johnson267,1) installing the modules dynamically2) AWS batch1) installing the modules dynamicallyor vice versa depends on your code2) using Aws batchThis is the best way where you don't have any limitation regarding Memory space. just you need to build aDocker (AWS Training)image and need to write an all required packages and libraries inside therequirement.txtfile.,0,02-02-2022,04:00 AM
119,177256,johnson267,"This is roughly just a simple way to deploy a container without the burden of Kubernetes.ACSmight be best if you really want a dedicated container solution (there is several orchestrators).For the authentication part, htaccess file with basic authentication is supported by pip. This allow to do something likeextra-index-url = https://login:password@pypi.myserver.com/simple/. I don't have a prefered tutorial, but google/bing something like ""pip private repository"" you will have no issue to find answers.(full disclosure, I work at MS in the Azure Python SDK team)",0,02-02-2022,03:57 AM
120,462052,OtakarKlier,"Hello,While not in Azure, I have had multiple VPN's with PAN's and Cisco ASA in the past. Here is the document that helped me.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClJ3CAKRegards,",0,01-31-2022,01:25 PM
121,462052,MDWaqas,"Thank you@OtakarKlierfor your feedback. There is no issue to configure site to site VPN as long as the both nodes are on premise. I just wanted to know the challenge in order to Configure Site-to-Site IPsec VPN b/w Palo Alto Device ""hosted in Azure cloud"" and Cisco Router/Cisco ASA on Premises",0,02-01-2022,05:14 AM
122,462052,OtakarKlier,"Hello,Honestly, have not done it. But as long as the public IP of the cloud hosted device doesnt change. It should be a similar process for the VPN. Obviously you'll need to allow the traffic on both firewalls as well as the cloud provided one.Regards,",0,02-01-2022,10:44 AM
123,461746,avelK,"Thank you for the post@RamakrishnanThere is no license required to get LDAP working. The pad lock icon is just graphical symbol and it has no relation to license.What is your use case for LDAP? Are you setting this up against AD Domain Controller? To start with, I would recommend to have a look below KBs and logs:https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClpoCAChttps://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000CluWCASKind RegardsPavel",0,01-28-2022,03:51 PM
124,459446,93bcd9caab,"Additional info:No bootstrapD3_v2""latest"" version - just occurred to me to try an older version which I'm doing now.",0,01-18-2022,10:23 PM
125,459446,93bcd9caab,Running the older release of v10 didn't seem to make a difference. If I start a ping to the mgmt interface sometimes it comes up for a bit and then goes away again.,0,01-18-2022,10:45 PM
126,459446,93bcd9caab,"I really hope this helps someone but the fix was a shorter password. By default, I use complex 32 character passwords. The hardware and virtual appliances only accept 31 chars. The Azure setup wizard does not limit passwords to 31 characters so I had no idea. What was happening was the management service was failing to start. After two or three failed attempts at starting, the box goes into maint mode where you can analyze the logs.After some begging with support to let me open a case on a device that had not been registered (but I had output from the serial console with the serial number), I was put in touch with an APAC engineer who had the issue sorted pretty quickly.I suppose this was an edge case and it would seem nobody uses long passwords except me (or they're aware of the 31 char limit which I was not)Cheers.",0,01-23-2022,11:30 PM
127,459114,sthornton,,0,01-17-2022,01:36 PM
128,459114,GavenCarley,"Yeah, that's what I thought. What could be better than 12 unused vCPUs?",0,01-17-2022,01:38 PM
129,458793,nxnut,The next thing i need to do is to get this thing licensed but not finding out any information on this.,0,01-14-2022,10:52 AM
130,458085,dmaynard,Fixed in 10.0.8 &10.1.0https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-release-notes/pan-os-10-0-addressed-issues/pan-...,0,01-11-2022,02:52 PM
131,458085,Dynam0,Thanks Dmaynard.I have upgraded to 10.0.8h8 and the tab is now there.,0,01-12-2022,06:41 PM
132,357021,JoeLentz,Just ran into the same problem. For me it was because the disk image was missing from the paloalto directory in /opt/unetlab/addons/qemu/ . Moving the file virtioa.qcow2 into the correct folder fixed it for me.,0,01-03-2022,10:34 PM
133,455110,avelK,"Thank you for the post@Srikanth-RRegardless of platform (HW Series or VM) and regardless of PAN-OS version, the reboot is required for enabling/disabling jumbo Frames to take an effect:https://docs.paloaltonetworks.com/vm-series/10-1/vm-series-deployment/about-the-vm-series-firewall/e...I would recommend you to schedule a maintenance window to proceed with this change.Kind RegardsPavel",0,12-24-2021,05:27 PM
134,340165,jdelio,"@RobertPrattI am sorry that this is happening, and quite odd to have it behave like that. I have not heard of that happening before, must be some sort of anomaly that is causing that to happen. I would see if others have anything to say about it, but this sounds like Palo Alto Network support will need to be contacted so they can help research and find out why it is happening.",0,07-22-2020,02:22 PM
135,340165,jguffroy,"Hello@RobertPratt,Did you resolved this issue?",0,12-22-2021,02:16 AM
136,340165,RobertPratt,Hello the issue was with the fqdn. I put a catch all rule at the bottom and used ip address instead of fqdn and we havent had the issue since.Thanks.,1,12-22-2021,06:22 AM
137,367335,BPry,"@deepak12,Azure's VMware solutions is just baremetal VMware. You'll want to decide if you are actually going to utilize NSX-T or not, but since you're paying for it as part of your subscription I would recommend it personally. You'll want to take a look at the following deployment guides as a starting point.https://docs.paloaltonetworks.com/vm-series/9-1/vm-series-deployment/set-up-a-vm-series-firewall-on-...https://docs.paloaltonetworks.com/vm-series/9-1/vm-series-deployment/set-up-the-vm-series-firewall-o...",0,12-04-2020,10:29 AM
138,367335,deepak12,"@BPry,Thanks , i will check on this. For AVS related can see below , so want to check still you recommend for NSX-T as if we go with NSX 3.2.0 version need to deploy Panorama on-prem ?=========================================================================================When using the Panorama plugin for VMware NSX 3.2.0, Panorama must be deployed on-prem, not in any public cloud environment, to manage VM-Series firewalls on AVS. This requires a VPN connection between your on-prem Panorama and your public VNet and an ExpressRoute between your public VNet and NSX-T Manager on AVS.=========================================================================================",0,12-05-2020,07:20 AM
139,367335,deepak12,"@BPry,Could you please suggest on below :For NSX-T if we go with NSX 3.2.0 version , need to deploy Panorama on-prem ?=========================================================================================When using the Panorama plugin for VMware NSX 3.2.0, Panorama must be deployed on-prem, not in any public cloud environment, to manage VM-Series firewalls on AVS. This requires a VPN connection between your on-prem Panorama and your public VNet and an ExpressRoute between your public VNet and NSX-T Manager on AVS.=========================================================================================",0,01-08-2021,12:37 PM
140,367335,EduardoNavarro,"Did you were able to deploy Palo VM inside AVS? Did you used ESX or NSX-T Service insertion mode?I have tried NSX-T Service insertion mode on AVS we were not able. Connection to NSX manager was ok, however when trying to deploy the service, it was asking for the attachment point and none was available, it seems tier0 was not an option as its on active/active and even creating a tier1 it didn't allowed us to select it as an attachment point, so not sure if I'm doing something wrong or if this is a limitation of NSX-T on AVS.Any suggestion or feedback is welcome.thanks",0,12-19-2021,07:43 PM
141,358060,Ravindra692,"Does any of the interfaces has a Public IP's associated with them?I also had a similar issue but in my case I had public IP's associated with the interface and I used the Standard SKU for it. Once I changed it to Basic SKU the failover is working fine for me. However, the failover time was 6 to 8 mins each time.In your Active/Passive Scenario Do you have L2L VPN tunnels configured?",0,10-28-2020,06:12 AM
142,358060,RyanJohnstone11aria-label44,"Hello, thanks for response. yes we have public IPs on one interface, i will ask our CSP for guidance on this setup.Yes we have L2L tunnels configured as well, are there issues here which could be cause?Thanks again for replyRyan",0,11-09-2020,02:16 AM
143,358060,Ravindra692,"I ran the failover test like 20 times in the Active Standby Scenario. Two things I observed there.1. A couple of times that tunnel took 20 mins to failover.2. Three times the tunnel didnt come up after the failover, I had to do a force re-negotiate",0,11-09-2020,05:36 AM
144,358060,JoshuaKovach,"Was there ever a solution found for this issue? If so, could you please share?",0,08-20-2021,11:51 AM
145,358060,RyanJohnstone11aria-label44,"HI there, no solution no. am pending some assistance from PA TAC once i can arrange an outage. We have tried multiple code versions and plug ins but problem remains. i will update once i have an update, hopefully in the coming month.",0,08-31-2021,01:24 AM
146,358060,RyanJohnstone11aria-label44,"still no ""solution"" to this but carried out a controlled failover last week and it worked, first time it has worked as it should have done since the PAs were stood up about 2 years ago. FYI the code we are on is 9.0.13 Azure plugin 1.0.13.have some upgrades coming up over next few months to get to 9.1 so be interesting to see if any issues occur then. otherwise can only assume something was fixed in the background Azure end or maybe i just got lucky...",0,10-06-2021,08:51 AM
147,358060,JimMcGrady,I have always found this failover mechanism within Azure to be impractically slow. I look forward to the day when it improves.,0,12-16-2021,11:10 PM
148,161223,Warby,"Hello,You have two choices here:One is to deploy another Azure load balancer just for outbound traffic and point your outbound UDR (default route) to the outbound load balancer. Azure allows such a configuration. The problem is, the healthcheck from the load balancer is always from the same IP address. So if you have one load balancer for inbound traffic and one load balancer for outbound traffic pointing to the same set of VM-Series firewalls, the firewalls will receive healthchecks from two different load balancers on two different interfaces but coming from the same IP address. This can be solved using two virtual routers on the firewall - one for each interface.The other option is to split inbound and outbound traffic to two different set of firewalls. Then each set of firewalls will only receive healthchecks from one load balancer. This adds VM-Series cost to the solution but it simplifies the routing and also has the advantage of having policy separation (inbound versus outbound). Also, the outbound firewalls can be used for multiple applications/resource groups in a hub and spoke modelHTH,Warby",1,06-14-2017,07:58 AM
149,161223,michelvankessel,"Hello WarbyThanks for the quick response! I am going to try the multiple router approuch and will return with the outcomeQuick question. Why doesn't it work with one virtual router? I mean, from a deeper technical point of view.RegardsMichel van Kessel",0,06-14-2017,01:28 PM
150,161223,Warby,"It's a basic routing problem. Each subnet (even a /32) must be maped in the route tableto/from a unique interface. The Azure load balancer always sources the probe from 168.63.129.16. If we have a default route for the external interface (say ethernet1/1), all responses to the healthcheck will go out ethernet1/1 even if the healthcheck came from the internal load balancer (on say ethernet1/2). This results in an asymmetric path and the health probe fails.If we then created a specific168.63.129.16/32 route to use ethernet1/2, then the probes from theexternal load balancer would become assymetric andthose healthchecks would fail.With multiple route tables, we could have one route table with a 168.63.129.16/32 static route that points to ethernet1/1 and another route table with a staticentry for the same168.63.129.16/32for ethernet1/2.Make sense?Warby",1,06-14-2017,01:40 PM
151,161223,michelvankessel,Hello Warby.. I was completely looking into the wrong direction! Sometimes there is a simple solutions and it makes complete sense!I've got it all running now.One question. do we need Floating IP (direct server return) enabled on the rules for the outbound LB?Thank youMichel van Kessel,0,06-15-2017,05:06 AM
152,161223,kblackstone,"Yes, enable floating ip for your outbound rules so the destination remains true as requested.",0,10-23-2017,10:34 AM
153,161223,junior_r,"Hi,For the outbound LB what was the prober you setup?Thanks",0,12-10-2017,05:29 PM
154,161223,junior_r,"Hi,Anyone can let me know prober for outbound traffic?Thanks",0,12-11-2017,11:36 AM
155,161223,kblackstone,"HI junior_r,There are a few options when it comes to setting up the outbound probe but the most common that I haveseen isto probe to port 22 on the firewall and enable the related interface management profile (for ssh) on the interface that will receive the traffic first. You may need to add the route to support return traffic to the probe source ip address:168.63.129.16.Alternitavely, you can probe to port 80 or 443 and write a NAT rule that sends traffic from168.63.129.16 on the appropriate zone out to 8.8.8.8 on the Internet, or some other website that you wish to verify connectivity against. Leverage destination NAT to accomplish this.-kb",1,12-11-2017,05:05 PM
156,161223,junior_r,ThanksQuick Question with this setup how does the LB know to keep the traffic symmetric for TCP FLOW.Web Server -> LB -> PAN FW1 / PAN FW2 -> InternetThanks,0,12-11-2017,05:16 PM
157,451938,glynn,"Assuming the underlying instance size supports it, you can have up to 8 total interfaces on the VM-Series in AWS. One is dedicated to management leaving 7 remaining for the dataplane.",0,12-07-2021,01:54 PM
158,451938,OtakarKlier,"Hello,Remember there is no layer 2 in the cloud so its all Router on a stick.Regards,",0,12-10-2021,01:32 PM
159,343115,claudec,"Sounds like maybe you have route asymmetry. The path from your test VM subnet to the on-prem networks is routed through the VM-series in Azure but what about the return traffic?Typically you need to have UDRs in the gateway subnet route table that routes traffic from on-prem networks to protected VNET resources via the VM-series trust interface.It is also common to explicitly route the on-prem networks in your protected resource subnets and not rely on the default.Lastly, when you are using a dynamic routing protocol between on-prem and the VNG you need to be mindful of potentially unwanted route propagation to the various VNET subnets that would allow flows that should be inspected to unintentionally bypass the VM-series.Hope this helps.",1,08-10-2020,04:46 PM
160,343115,bottiglieri,"@claudec,bingo!Indeed, I did have asymmetric routing back to the VM host. Even though the traffic destined for the NYC campus went out the trust interface and traversed the ExpressRoute connection, return traffic was not routing back through the trust interface of the firewall, causing the applications to break. As you mentioned, the solution is to create a route on the GatewaySubnet. The idea that ping tests and traceroutes were both working - even from the trust interface of the campus firewall - was driving me nuts!Anyway, I created a route table, associated it with the GatewaySubnet, and I created a rule that basically forced all traffic destined for my test server subnet to route back through the trust interface of the firewall. Once I added that, everything worked.Thanks for the tip!Rich",1,08-10-2020,07:40 PM
161,343115,anh2lua,We are going to have ExpressRoute setup soon and we do want to use Express Route as primary connection back to our On-Prem resources and VPN connection betwen the VM-Series Firewall and our On-Prem Palo Firewalls.I am thinking about adding a fourth interface on the VM Series Firewall and use that to route traffic to ExpressRoute Gateway.Will that work?Thanks,0,11-23-2021,01:57 PM
162,343115,bottiglieri,"I haven't looked at this in a little while, but I don't think a VPN between on-prem PA to Azure virtual PA is a supported or recommended solution due to internal Azure routing practices. The supported solution is to setup an always on VPN between your on-prem PA and a virtual network gateway in Azure. I have that setup, and it's been solid for me.",0,12-01-2021,06:27 AM
163,450239,TomYoung,"Hi @kapildev87 ,When you say ""login works fine"" I assume that you mean the web login on the portal? If so, then check your traffic and system logs (or GlobalProtect logs for 9.1+) for dropped traffic or errors. If you can't find the issue there here are in-depth troubleshooting steps -> https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClkBCAS.Thanks,Tom",0,11-29-2021,04:56 PM
164,450239,kapildev87,"Hi Tom Young,I had configured private IP for global protect which should have been public IP --> After updating config it worked fine.Thanks,Kapil",1,11-29-2021,05:18 PM
165,449324,tostern,"Hi@SampleWu-TDKi am seeing that issues in the past really often. In 90% all the cases is the reason the Password.Please redeploy the Firewall and use a Password only with with upper/lower cases and numbers for example PaloAdmin12345I hope it will help you.Regards,Torsten",2,11-24-2021,10:38 PM
166,449324,SampleWu-TDK,"Thank you so much,@tostern,I did the test and it works, my issue's reason is really the password format.Thanks again,Sample Wu",2,11-25-2021,12:10 AM
167,406035,SteveMcBride,"Any one managed to solve this issue? In essence the GP client seems to just leverage the default PC login credentials for the authentication. In this instance we do not want to use login credentials but the credentials from a different organisation.I can only assume this is some sort of setting on the PC itself as other ""non-domain"" domain joined PCs are prompted to choose which account to utilise. I have tried logging out of the account on my browsers and have also tried deploying registry keys to prevent SSO logins. Nothing works and we continue to receive login errors due to the wrong user credentials been automatically submitted.",0,08-22-2021,08:11 PM
168,406035,MStork,"Hi Steve,in meantime I solved this issue for us.The root cause why our users weren't asked for credentials was the lifetime of the Azure token lifetime, which is very long in my opinion. (If I remember right, it's about 90 days or so)With an active token the user isn't asked for new credentials and then it's possible, that a wrong account is selected by the application. This is especially a problem, when the application should be used with another account than the ""normal"" user account which is used for logging into their client or their standard enterprise applications.Microsoft don't want the user to get asked for credentials every hour, day, etc. because this could be uncomfortable for a normal user to work with.There is no chance to modify this token lifetime in Azure so I did a workaround. I created a ""Conditional Access Policy"" on Azure in my GP application which set's the sign-in frequency to 1 hour. So when a user is logged in to GP and he's disconnected within the first hour, he won't be asked for his credentials and he can re-login. But after 1 hour he is asked for credentials, again.This work's fine for us till now and our users are automatically asked for new credentials or their account every morning when they start to work because the night over they were disconneced and the single hour their sign-in frequency is valid has expired till then.You can find a lot of articles how to set up these conditional access policies for sign-in frequency on the internet.",1,08-23-2021,01:13 AM
169,406035,SteveMcBride,"Finally solved this. Basically needed to add the account under the Windows > Settings > Email and Accounts > Add a work or school account.After that we get a window that pops up and asks which account to sign in with. I have had a couple of corner cases where some PCs insist on using the user configured default browser which then signs them in with the ""other"" SAML creds. I think this issue is because of another GP Client configuration that allows for the default browser to be utilised even though this profile does not allow it.",0,11-24-2021,05:58 PM
170,412578,StevenRogers,"We use FIPS-CC mode in the Azure Government Cloud, usingthis articleto set it. Basically:As to your second question, we don't use an ARM template, but use Terraform instead, specifically the ""tls"" provider (hashicorp/tls | Terraform Registry), which lets you make a private/public key pair, which we then import into Azure Key Vault.Hope that all helps!",0,11-24-2021,10:52 AM
171,214622,OtakarKlier,"Hello,Are the PAN's active/passive or active/active? If A/A, its proably asymetric routing back to the client.Just a thought.",0,05-18-2018,10:05 AM
172,214622,jmeurer,What is your NAT configuration? You should have both a Destination NAT of the FTP server and a Source NAT of the Trust side interface of the Firewall in the NAT policy. That will ensure proper return path.,0,05-18-2018,10:20 AM
173,214622,glynn,"Are you using FTP or FTPS? I see both mentioned in your post. Also, when you say you see the connection in the traffic table, do you see both the control and data channels or just the control?One thing to look at is the distributionmode on the load balancer:https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-distribution-modeIf you are using 'None' as the distribution mode, the load balancer will use src IP, src port, dst IP, dst port, and protocol to determine the backend pool member to use. If the control channel lands on one FW and the data channel on the other, the data channel will be dropped. Changing to one of the other distribution algorithms (""src IP"" or ""src IP and protocol"") should ensure that both land on the same FW.",0,05-18-2018,11:10 AM
174,214622,brookman,"I am using FTPS, but also tested with FTP. I am using Src IP and Protocol for the transmission of the packets thorugh the load balancer. I have other services working as expected on the PAs. As far as traffic, I only see the control traffic in the monitor tab.",0,05-21-2018,07:14 AM
175,214622,brookman,"The firewalls are in an A/A setup, but Azure doesn't really do HA, so they don't syncronize the session information.",0,05-21-2018,07:14 AM
176,214622,Steven Tan,Hi! Did you ever resolved this issue? I am facing the same problem and have not been able to find a solution. I have to add that my FTP works if I force the client into Active mode. I can then see the DATA traffic using TCP 20. However it does not work when using Passive mode which is required for FTPS. Appreciate any assistance here. Thank you in advance!!,0,11-18-2021,08:07 PM
177,446132,SutareMayur,"Hi@Amit_Sharma,The document that you are following has mentioned the prerequisites regarding AWS AZ. It tells -Coming to Palo Alto HA configuration on AWS, the VM palo alto supports A/P HA configured within a single AWS AZ. A/P Palo Alto VM HA cannot span multiple Availability Zones due to the AWS limitation of not allowing ENI moves to span AZs. Kindly refer below article -https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClD9CAKHope it helps!",1,11-09-2021,05:51 AM
178,439160,avelK,"Thank you for posting question@RyanJohnstone1144I was researching this and eventually ended up with opening a ticket to Microsoft to get definitive answer. The answer is: unfortunately it is not possible and at least at this moment there is no other alternative way capture traffic. I am sure you are aware of data plane packet capture in Firewall:https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClTJCA0If you requirement is to confirm that traffic is egressing an interface, potentially this might be up to the job.Kind RegardsPavel",0,11-04-2021,11:24 PM
179,445252,TomYoung,"Hi @birdperson ,Yes, you can see encaps and decaps from Network > IPSec Tunnels > Tunnel Info next to your VPN.You can also see them on the CLI with the command 'show vpn flow tunnel-id <tunnel-id> | match ""p p""'. This doc is an excellent VPN troubleshooting reference -> https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClivCAC.Thanks,Tom",0,11-03-2021,10:16 AM
180,418483,dashnet,"Sorted it.So the Azure public load balancer needs to point to the backend using NIC configuration and probes on whatever service the interface management profile will allow that is convenient for you. Example uses TCP 22.I'm not sure if it's needed, but I have loopback addresses configured with the public IP of the load balancer frontend.The NAT rule needs to be source zone public, destination zone public, destination service <frontend listening port>, destination address public IP of the frontend, source translation dynamic-ip-and-port interface private, destination translation <private ip of secured resource>.The security policy is source zone public destination zone private destination address <ip of the public load balancer frontend>, application/service depending on what you're allowing inbound.Then you also need to allow the private interface to talk to the secured resource in the subscriber VNET, and make sure all the routes are good.You don't need to configure any outbound rules on the load balancer, you can keep the public IP addresses that are associated with the public interfaces of the firewalls associated for outbound traffic and return traffic will work because of the source NAT.I was not able to get things working with FQDNs. It may be because the FQDN associated with the public load balancer IP is not the same as the URL that's being used to resolve it.There's a question - do you have to associate the FQDN that you'd use in NAT policy with the load balancer frontend public IP azure object?Would it work with external (not in Azure) DNS resolving names to the IP?",0,07-12-2021,08:23 AM
181,418483,Dynam0,"Hi Dashnet,Do you have to change the static routes in the trust and untrust VR to point to the LB?Can you please share a screenshot of your PA NAT and security rules?The ELB only has a public IP which points and checks the untrust interface of the PA.I don't believe the ELB requires an internal IP which the PA NATs to.",0,11-02-2021,04:39 PM
182,321461,EnsanOdeh,Tony I have the same issue. Was your resolved ?,0,11-01-2021,07:45 PM
183,321461,tonyrobson,"It was but I can't 100% remember what I did to solve it unfortunately, is it enabled on your panorama?",0,11-02-2021,03:45 AM
184,438771,avelK,"Thank you for your post@Muruganandham.SPSince passive Firewall is not passing any traffic, you will not see any Traffic Log, Threat Log,.. etc, however System Log as well as Configuration Log will be generated and if configured correctly sent to external syslog server.Since you mentioned that configuration is identical and active Firewall is sending logs to external syslog server as a next thing I would check settings that are not HA synchronized, for example DNS server IP address. If you have configured Syslog as FQDN make sure that passive Firewall can resolve the IP address.Also check System logs to see any related events:( eventid eq syslog-conn-status ).Kind RegardsPavel",0,10-05-2021,05:11 AM
185,438771,Muruganandham.Saria-labelP,"@PavelK Yes, the Passive node cannot write any Traffic/Threat logs unless he becomes an active. So it is expected not to see Traffic/Threat logs.The concern here is, system-log config-log etc.Yes, we do have the proper reachability to the Syslog server, FQDN works fine, DNS settings are made correctly and works fine. HA status is 'In-Sync'.The system-log in Passive node states that the syslog-server is 'connected' (it shows the old date though, while the Active node shows two different dates with newer date)",0,10-05-2021,05:25 AM
186,438771,avelK,"Thank you for quick reply@Muruganandham.SPSorry if I ask silly question, but based on your screen shot, the destination IP address is: 127.0.0.1 which is reserved loopback IP address. It looks like it is sending logs to itself?Kind RegardsPavel",0,10-05-2021,05:54 AM
187,438771,asangra,"1. Passive firewall will not forward logs until failover2. However, this looks like you have configured transport protocol as TCP in syslog server profile and an internal connection is established to syslog-ng on port 2625 and this keeps popping up in system logs.",0,10-05-2021,06:04 AM
188,438771,Muruganandham.Saria-labelP,,0,10-05-2021,09:29 AM
189,438771,Muruganandham.Saria-labelP,"I have the Syslog configured with UDP only. And I believe the Passive node should forward the system-log, config-log kind of logs to the Syslog-Server.",0,10-05-2021,09:31 AM
190,438771,avelK,"Thank you for update@Muruganandham.SPI am running in my environment the same setup where Passive Firewall is sending System logs to syslog server and I can confirm that I can see logs on server side, so this should be definitely working.As next step to troubleshoot, I would advice to check detailed output from:less mp-log syslog-ng.log and take packet capture on management interface:tcpdump filter ""port 514"" (https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000CleECAS).Kind RegardsPavel",0,10-05-2021,03:45 PM
191,438771,Muruganandham.Saria-labelP,"Hi Team,I've just opened the ticket with the TAC. Also on the other hand I'd performed all the above steps mentioned by@PavelKprior coming to this live-community forum.The behavior is, no packets were observed at the Passive device. Had a multiple sessions with the TAC. Even on a remote-session, the TAC couldn't see any packets being forwarded at the Passive unit.Restarted the management-server, device-server, vardata-receiver, log-rcvr, Also restarted the syslog-ng. The Passive unit's tcpdump and debug log-receiver statistics didn't show any clue about the packet-forward to syslog-server. So none of the above activities has helped.Post couple of weeks, TAC has again joined the call. And interestingly, without doing anything on Passive Unit, now thetcpdumpoutput show that the packets are being forwarded to the syslog-server. While the debug log-receiver statisticscommand doesn't show any numbers incrementing.Regards,Muruganandham SP",0,11-01-2021,07:52 AM
192,443767,sthornton,"It can be done but isn’t typically recommended, due to the inability to have ENI moves across an availability zone.Here is a GitHub repo you can take a look at to see one method.https://github.com/wwce/AWSCrossZoneHANormal HA config, same zone.https://docs.paloaltonetworks.com/vm-series/10-1/vm-series-deployment/set-up-the-vm-series-firewall-...",0,10-27-2021,07:44 AM
193,188944,kblackstone,"Hi eosminer,The VM Series supports packet captures natively within the operating system:Here is a link to more detailed information about how to run packet captures from the console or ui:https://live.paloaltonetworks.com/t5/Learning-Articles/How-to-Run-a-Packet-Capture/ta-p/62390-kb",0,11-28-2017,06:39 AM
194,188944,sminer,"Azure Network Watcher looks beyond the PA, however requires the extension to be installed on the PA for it to work. It allows a capture past the PA through the Azure infrastructure. Not a great solutionfrom Microsoft, but it's what I have.",0,11-28-2017,06:45 AM
195,188944,RyanJohnstone11aria-label44,"Hello, did you get an answer to this? we want to do the same but our CSP is advising this is not possible.let me know please if you managed it.ThanksRyan",0,10-06-2021,08:53 AM
196,188944,solarstone,"I also need to do this. Network Watcher works fine between Azure VMs, but it's not possible to add the extension on a Palo Alto VM. I see my traffic arrive on the PA, but need to trace it onwards to the Azure VM, but can't. It seems that I have correct NSG setup, but cannot get to the VM. Packet capture in PA is clunky with wireshark, I just need a simple view of what's happening.",0,10-21-2021,07:25 AM
197,441723,SutareMayur,"Hi@ETateSo as per my understanding, you are trying to ping inside (or Data Plane) interface of the firewall. I would recommend you to check few things given below-1. Check if Interface MGMT profile is configured on the interface which actually allows required services like ping on it.2. Check routing to reach host from the firewall. If interface IP is configured using /32 subnet mask, you would need to define specific routes for the host to reach.3. Verify the traffic logs on the firewalls to see what's happening on the firewall.",1,10-20-2021,01:00 AM
198,440631,sthornton,Can you share a picture of the error you are receiving?,0,10-13-2021,01:33 PM
199,440631,AJuarez,,0,10-13-2021,01:59 PM
200,439401,avelK,"Thank you for the post@razzitpcaCould you navigate to: Monitor > Logs > Traffic, then search logs to confirm what rule is getting hit? To filter logs, you can use for example:( port.dst eq 25). If you are seeing: ""incomplete"" message in the Detailed Log View, this indicates that TCP 3 way hand shake has not completed:https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClibCACIn order to drill down more into details of the traffic, I would recommend to take packet capture on data plane interface with the filter for this traffic, then export it and check it in Wireshark:https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClTJCA0Kind RegardsPavel",0,10-07-2021,02:59 PM
201,439401,OtakarKlier,"Hello,In my experience, it has usually been a routing issue. Check all of your routing as well as policy base forwarding.Regards,",0,10-12-2021,12:54 PM
202,439401,OtakarKlier,Could also be that the other side is blocking your traffic over port 25.,0,10-12-2021,12:54 PM
203,439895,avelK,"Thank you for the post@nazrul13Could you check in System log with filter: (subtype eq gre) any corresponding logs? What is the model of the router? If it is Cisco, could you turn debugs:debug tunnel packetdebug tunnel keepalivedebug tunnel eventKind RegardsPavel",0,10-10-2021,12:11 AM
204,330334,dmaynard,"Keep in mind that before licensing VM-Series the no-license VR limit is 2.https://www.paloaltonetworks.com/products/product-comparison.html?chosen=vm-100,vm-300,vm-500",0,05-28-2020,09:26 AM
205,330334,jmeurer,"The VR limit per license type can be viewed here.https://www.paloaltonetworks.com/products/product-selection.html#The limit on a VM-300 is 10 VRs. With that said, you generally shouldn't need more than two. You should route all internal traffic through the same interface with the HA Port LB. If you try to Zone Policy that traffic, you will need SNAT. Azure maintains persistence on a 1-arm routing mode only. We touch on this in the East-West component of the reference architecture.https://www.paloaltonetworks.com/resources/reference-architectures/azure",0,05-28-2020,09:29 AM
206,330334,andreb,"I have seen and followed the Reference Architecure guides and they are very helpful. When i was testing it out, i had a VM-100 license, i was pretty sure it limited me to two Virtual Routers, but this comparison tool, says it allows 3. Can you confirm it is 3?The only reason i ask, is we have a customer that deployed their VM-Series with a Untrust, Trust and VPN segments, and three Load Balancers. A Load Balancer on each segment.So with that i was thinking it would be best to have a Virtual Router for each segment so that the Probes from the Azure Load Balancer are routed back to the LB.Anyways, if you are able to confirm that the VM-100 supports 2 or 3, that would be great.Thanks,",0,05-28-2020,09:42 AM
207,330334,Eslam_Sayed,"Hello all, is there any link to determine max no of VR Per each hardware appliance? Thanks in advance",0,10-06-2021,11:45 AM
208,436549,simonajgerner,"Hello everybody,I see that we have AWS secondary CIDR on VPC ability to NAT to PAN in original CIDRmyaccountaccess.onl",0,10-04-2021,12:34 AM
209,430558,DIRTT,"Downgrade of devices only worked for me, Panorama is still at 10.0.7 and it works now.",0,09-25-2021,11:27 AM
210,435173,HarcharanSingh,"Just to add, there is no Panorama and no HA sync between Palos and they are operating independently as active/active.",0,09-20-2021,02:13 AM
211,435173,sthornton,"As long as traffic enters and leaves the same load balancer and firewall interface, Source NAT is not required. As soon as you cross a zone or use a different load balancer front end IP, SNAT will be required to maintain symmetry. It has to do with the way the load balancer algorithm is calculated when the firewalls are added to the backend pool.Hope that helps.Scott",1,09-23-2021,04:04 PM
212,435173,HarcharanSingh,"Thanks for the guidance Scott, I was chasing Microsoft for this since many days but didn't get any concrete reply so far regarding the Internal LB working. Appreciate your big help. I understand it as - Because I have multiple front-end IPs on Internal LB with traffic crossing the zones on firewall, I have to source NAT the traffic as Internal LB cannot maintain symmetry in this case. If in another case where the traffic communication would have been on same front-end IP in same zone on firewall then source NAT wouldn't be required as the symmetry will be maintained by the Internal LB.",0,09-23-2021,09:02 PM
213,435173,sthornton,That is correct. Have a good one and let us know if you have any additional questions.,1,09-24-2021,05:51 AM
214,431336,avelK,"Thank you for posting question@rkbalaguruThis requirement should be achievable by placing an interface facing Azure VNET and Tunnel interface to different zones and then configuring NAT policy using respective zones and interfaces. With regards to NAT, you can configure Translation Type: static IP, subnet to subnet (For example /24 on one side gets translated to different /24 subnet on the other side) or Translation Type: Dynamic IP And Port.Kind RegardsPavel",0,09-03-2021,05:25 PM
215,431336,kbalaguru,"@PavelK Thanks for your input, do you have use case document to refer. Also can we NAT entire VNET subnets with just single public?",0,09-05-2021,10:23 PM
216,431336,avelK,"Thank you for reply@rkbalaguru and sorry for getting back to you with delay.Based on how I interpret your requirement, I would configure following 2 NAT policies. This would be private subnet to private subnet translation between Azure and Onpremise.Source NAT:Destination NAT:An alternative would be a Dynamic NAT + PAT to interface:Kind RegardsPavel",1,09-23-2021,11:46 PM
217,434641,sthornton,It's recommended to be using redundant firewalls in your scenario.Here is a good article using the firewalls in L3 mode in ESXi.https://live.paloaltonetworks.com/t5/globalprotect-articles/deploying-vm-series-on-esxi-in-layer-3-m...,0,09-23-2021,03:16 PM
218,435666,tostern,"Hi@sameer.ahmadhere are the official document from Palo Alto about the configuration of native HAhttps://docs.paloaltonetworks.com/vm-series/10-1/vm-series-deployment/set-up-the-vm-series-firewall-...We tested it already several times and it is working but you have to know that failover time is around 3 - 10 minutes because of the API calls on the Azure side. We can't speed up that process.Our recommendation is always to use Azure Load Balancers, then you get better SLA's and higher resilience.Regards,Torsten",0,09-21-2021,11:56 PM
219,435666,sameer.ahmad,"Thanks Tostern, is there a working template for Secondary firewall. Also I see in some documents we need to add route tables in Azure , can you clarify on it ?Also which permissions we need to add like Secondary HA , UDR or all. If we just add permission using Secondary HA is it sufficient.",0,09-22-2021,06:59 AM
220,435666,sameer.ahmad,@tostern: Also is there a specific guidelines if we can assign our own public IP instead of Azure IPs to Palo Alto firewall. If we cannot assign it where it is specified in the docs.Thanks,0,09-22-2021,07:02 AM
221,435666,sthornton,Sameer:Here is a community supported template that does HA faster than the normal API method Torsten described. Some customers have tested this and liked it. The design still uses load balancers though so this would only be used in the event that you had a driving reason to run active/passive.https://github.com/PaloAltoNetworks/azure-terraform-vmseries-fast-ha-failover,0,09-23-2021,03:08 PM
222,435672,SebRupik,"Hi there,Take a look at this document:https://www.paloaltonetworks.com/resources/guides/azure-transit-vnet-deployment-guide... Page 127 -Deployment Details for aBackhaul Connectioncheers,Seb.",0,09-22-2021,01:07 AM
223,431454,avelK,"Hi@JakeKremerthank you for posting question.Based on all the inputs you have given, you meet all prerequisites to push Templates to managed firewall.Could you please confirm below points?- Are you having an issue only with Templates? Are settings that are being pushed in Device Group applied correctly to managed firewall?- When you navigate in Panorama to: Panorama > Managed Devices > Summary > Template Last Commit State, what does it says? Does it says commit succeeded?- Could you go to managed firewall and navigate to right bottom corner, then click on Tasks. When you push Templates from Panorama, are you seeing in real time that Commit task is getting executed and returns: Status: Completed / Result: Successful?- Could you in managed firewall navigate to Configuration logs by going to: Monitor > Logs > Configuration > Then search an entry by using filter( client eq Panorama )? Are you seeing Result as: Succeeded?- The configuration you are pushing using Template, is it not applied at all? Are you able to see an icon similar to below?Thank you and RegardsPavel",0,09-03-2021,03:01 PM
224,431454,JakeKremer,"Hey Pavel,I opened a support case regarding this, and I guess the issue was actually that I needed to define a template stack in order for the device and network templates to push. I was unaware of this, and I thought that simply having the templates linked to a device would be enough.",0,09-07-2021,11:22 AM
225,431454,avelK,"Thank you for update@JakeKremerI see, it makes sense. Template itself is just configuration place holder, but Template Stack is where you group all Templates and associate the manage Firewalls to:Without adding Templates to Template Stack, Template is not associated to any Firewall and therefore can't be pushed.Kind RegardsPavel",0,09-07-2021,04:49 PM
226,257321,jperry1,The 00000000 indicate it's not able to communicate with it's IKE partner. Either it can't communicate with it's IKE partner or the IKE partner isn't configured. Check the session table to see if you have any hung sessions by doing show session all filter application IKE or something of that effect.If the connection abruptly broke for some reason you have to make sure that each device doesn't have the original IKE session in it's session table or one of the devices may try to connect to that old IKE session. That is only if the session didn't clear out automatically.,2,04-11-2019,12:11 PM
227,257321,kshukla,"No, there isn't any active sessions. This tunnel was working until last night.I get this error since morning.019-04-11 09:49:23.090 -0400 [INFO]: { 3: }: received IKE request 192.80.70.8[500] to 10.114.0.10[500], found IKE gateway vtx-ike-gw2019-04-11 09:49:23.090 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION STARTED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Initiated SA: 10.114.0.10[500]-192.80.70.8[500] SPI:605e0e637f087627:84333958942be627 SN:7 <====2019-04-11 09:49:23.090 -0400 [INFO]: { 3: }: NAT detected: behind NAT2019-04-11 09:49:23.107 -0400 [PERR]: { 3: }: 192.80.70.8[4500] - 10.114.0.10[4500]:0x8e4770 received ID_I (type ipaddr [10.90.0.200]) does not match peers id2019-04-11 09:49:23.107 -0400 [INFO]: { 3: }: 10.114.0.10[500] - 192.80.70.8[500]:(nil) closing IKEv2 SA vtx-ike-gw:7, code 132019-04-11 09:49:23.107 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION FAILED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Failed SA: 10.114.0.10[500]-192.80.70.8[500] SPI:605e0e637f087627:84333958942be627 SN 7 <====2019-04-11 09:51:26.462 -0400 [INFO]: { 3: }: received IKE request 192.80.70.8[500] to 10.114.0.10[500], found IKE gateway vtx-ike-gw2019-04-11 09:51:26.462 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION STARTED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Initiated SA: 10.114.0.10[500]-192.80.70.8[500] SPI:0b2355a633b31e8c:733e8c0fb00833f0 SN:8 <====2019-04-11 09:51:26.462 -0400 [INFO]: { 3: }: NAT detected: behind NAT2019-04-11 09:51:26.479 -0400 [PERR]: { 3: }: 192.80.70.8[4500] - 10.114.0.10[4500]:0x8e4750 received ID_I (type ipaddr [10.90.0.200]) does not match peers id2019-04-11 09:51:26.479 -0400 [INFO]: { 3: }: 10.114.0.10[500] - 192.80.70.8[500]:(nil) closing IKEv2 SA vtx-ike-gw:8, code 132019-04-11 09:51:26.479 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION FAILED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Failed SA: 10.114.0.10[500]-192.80.70.8[500] SPI:0b2355a633b31e8c:733e8c0fb00833f0 SN 8 <====2019-04-11 10:13:56.157 -0400 [INFO]: { 3: }: received IKE request 192.80.70.8[500] to 10.114.0.10[500], found IKE gateway vtx-ike-gw2019-04-11 10:13:56.157 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION STARTED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Initiated SA: 10.114.0.10[500]-192.80.70.8[500] SPI:8911e04f2285562d:246854598fcb243d SN:9 <====2019-04-11 10:13:56.157 -0400 [INFO]: { 3: }: NAT detected: behind NAT2019-04-11 10:13:56.174 -0400 [PERR]: { 3: }: 192.80.70.8[4500] - 10.114.0.10[4500]:0x8e4750 received ID_I (type ipaddr [10.90.0.200]) does not match peers id2019-04-11 10:13:56.174 -0400 [INFO]: { 3: }: 10.114.0.10[500] - 192.80.70.8[500]:(nil) closing IKEv2 SA vtx-ike-gw:9, code 132019-04-11 10:13:56.174 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION FAILED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Failed SA: 10.114.0.10[500]-192.80.70.8[500] SPI:8911e04f2285562d:246854598fcb243d SN 9 <====2019-04-11 10:35:34.471 -0400 [INFO]: { 3: }: received IKE request 192.80.70.8[500] to 10.114.0.10[500], found IKE gateway vtx-ike-gw2019-04-11 10:35:34.471 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION STARTED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Initiated SA: 10.114.0.10[500]-192.80.70.8[500] SPI:3d886a38166f0488:e7e29686196121d9 SN:10 <====2019-04-11 10:35:34.471 -0400 [INFO]: { 3: }: NAT detected: behind NAT2019-04-11 10:35:34.488 -0400 [PERR]: { 3: }: 192.80.70.8[4500] - 10.114.0.10[4500]:0x8e4770 received ID_I (type ipaddr [10.90.0.200]) does not match peers id2019-04-11 10:35:34.488 -0400 [INFO]: { 3: }: 10.114.0.10[500] - 192.80.70.8[500]:(nil) closing IKEv2 SA vtx-ike-gw:10, code 132019-04-11 10:35:34.488 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION FAILED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Failed SA: 10.114.0.10[500]-192.80.70.8[500] SPI:3d886a38166f0488:e7e29686196121d9 SN 10 <====2019-04-11 11:19:05.461 -0400 [INFO]: { 3: }: passive mode is specified for IKE gateway vtx-ike-gw.2019-04-11 11:20:55.814 -0400 [INFO]: { 3: }: passive mode is specified for IKE gateway vtx-ike-gw.2019-04-11 11:39:54.447 -0400 [INFO]: { 3: }: received IKE request 192.80.70.8[500] to 10.114.0.10[500], found IKE gateway vtx-ike-gw2019-04-11 11:39:54.447 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION STARTED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Initiated SA: 10.114.0.10[500]-192.80.70.8[500] SPI:7cd39c06ac200b9a:e637226750aa505a SN:11 <====2019-04-11 11:39:54.447 -0400 [INFO]: { 3: }: NAT detected: behind NAT2019-04-11 11:39:54.466 -0400 [PERR]: { 3: }: 192.80.70.8[4500] - 10.114.0.10[4500]:0x8e4750 received ID_I (type ipaddr [10.90.0.200]) does not match peers id2019-04-11 11:39:54.466 -0400 [INFO]: { 3: }: 10.114.0.10[500] - 192.80.70.8[500]:(nil) closing IKEv2 SA vtx-ike-gw:11, code 132019-04-11 11:39:54.466 -0400 [PNTF]: { 3: }: ====> IKEv2 IKE SA NEGOTIATION FAILED AS RESPONDER, non-rekey; gateway vtx-ike-gw <========> Failed SA: 10.114.0.10[500]-192.80.70.8[500] SPI:7cd39c06ac200b9a:e637226750aa505a SN 11 <====",0,04-11-2019,12:22 PM
228,257321,pkathiria,did you tried with test command to initiate the connection?test ipsec vpn-sa tunnel ( name),0,04-11-2019,04:24 PM
229,257321,kshukla,"I did, but it didn't bring tunnel up and create SA.",0,04-12-2019,07:46 AM
230,257321,kshukla,"From logs I found 10.90.0.200 did not match as Peer Identification, so I put that IP in IKE Gateway property as Peer Identification and my Public IP as Local Identification and problem got resolved.Customer is saying I should not see this IP because their firewall is behind NAT and this is internal IP of their VPN gateway. I am still not sure why but tunnel came up.I don't have this issue anymore.",5,04-19-2019,07:10 AM
231,257321,a2019,"Hi Perry , thank you for the contribution, is the best answer I found till now.",0,08-27-2021,09:13 AM
232,257321,Samira,"Thanks so much, my issue is now resolved! I didn't understand why I was getting that error message at first.",0,09-07-2021,09:41 AM
233,425768,avelK,"Thank you for posting this issue@AshishWCould you please provide full details of the error together with Panorama's PAN-OS version? You can recall the details of the error by going to: Panorama > Managed Devices > Summary > Shared Policy Last Commit State, then click on: ""commit failed"" and Last Pushed State Details will appear. Please copy the full screen and provide it.Thank youPavel",0,09-06-2021,05:46 PM
234,303983,sdurborow,Has anyone received a fix for this?,0,09-03-2021,06:01 AM
235,375805,aper,Is there a way for the loadbalancers to not perform NAT?if there's a proxy component (rather than NAT) you could try adding x-forwarded-for headers,0,12-22-2020,05:11 AM
236,375805,KunalChopra,No there is no option of removing NAT functionality from LB.I think the only option left is to enable XFF under URL filtering .what say ?,0,12-23-2020,03:26 AM
237,375805,timturner,"Thanks for helping solve my problem. Finally, custom software development can be used to support a company's long-term viability.",0,08-30-2021,05:20 AM
238,426824,dmifsud,"Hello,Personally I would set up a packet capture at the receive, transmit and drop stages, then check:1) Does the firewall transmit the request (assuming yes)2) Does the firewall receive the response from 8.8.8.83) If it does, does it transmit this to the clientYou can check the drop capture for any drops, although if the counters are clean you shouldn't be seeing anything there.Also, open the detailed log view (that magnifying glass at the left-most side of the traffic log) to check NAT was performed and if the NAT IP/interface make sense.- DM",0,08-14-2021,08:49 AM
239,426824,Connected123,"Hi@dmifsudThank you for your response.1) Does the firewall transmit the request >YES2) Does the firewall receive the response from 8.8.8.8>NO3) If it does, does it transmit this to the client>There is nothing in between FW and VM4) No drop seen in global counter. I have turned off DPDK setting.> show counter global filter packet-filter yes delta yesGlobal counters:Elapsed time since last sampling: 7.5 secondsname value rate severity category aspect description--------------------------------------------------------------------------------pkt_sent 1 0 info packet pktproc Packets transmittedsession_allocated 3 0 info session resource Sessions allocatedsession_installed 3 0 info session resource Sessions installedflow_ip_cksm_sw_validation 3 0 info flow pktproc Packets for which IP checksum validation was done in softwareappid_ident_by_icmp 3 0 info appid pktproc Application identified by icmp typenat_dynamic_port_xlat 3 0 info nat resource The total number of dynamic_ip_port NAT translate calleddfa_sw 3 0 info dfa pktproc The total number of dfa match using softwarectd_pscan_sw 3 0 info ctd pktproc The total usage of software for pscanctd_process 3 0 info ctd pktproc session processed by ctdctd_pkt_slowpath 3 0 info ctd pktproc Packets processed by slowpath--------------------------------------------------------------------------------5) NAT seems fine as configured.Waiting for your response.",0,08-14-2021,10:16 PM
240,426824,Connected123,Hi@dmifsudI am checking on the Azure side.Just wanted to ask if you have come across this issue below.1) tracert is failing. It should show the trusted interface of PA as next hop>tracert 8.8.8.8Tracing route to dns.google [8.8.8.8]over a maximum of 30 hops:1 * * * Request timed out.2 * * * Request timed out.3 * * * Request timed out.4 * * * Request timed out.5 * * * Request timed out.6 * * * Request timed out.7 * * * Request timed out.8 * * * Request timed out.2) Same route settings is used for Hub machines and they can access the Internet. Effective routes in Azure is showing the correct path.The only difference is Spoke VM is on the other side of VNET peering.Thanks,0,08-15-2021,06:31 PM
241,420562,tostern,"Hi@abhishah03,sorry to hear that had no luck with our TAC team.Your problem that you subscribes could have many reasons.- Did you checked your Security Groups on all interfaces?- Did you reviewed all route tables that the traffic get's forwarded correctly?- Did you already asked AWS TAC if they can see the packets and could they explain you the reason why the packets didn't received the client host?Regards,Torsten",0,07-19-2021,11:43 PM
242,420562,abhishah03,"@tostern -- Please find the answer inline -- Did you checked your Security Groups on all interfaces? --SG is set, properly -- Hence the packets are reaching the PA firewall & logs reflecting the same on (AWS flow logs, PA monitor logs)- Did you reviewed all route tables that the traffic get's forwarded correctly? --Routes is straight forward --- 2 routes on virtual router --default - 0.0.0.0/0 -- exit thru untrust -> IGWprivate subnet - 10.x.x.x/24 -- thru Trust interface -- 10.0.0.1- Did you already asked AWS TAC if they can see the packets and could they explain to you the reason why the packets didn't receive the client host? --Reason needs to be explained from PA I believe, the packets are reaching the firewall, but not exiting from there :(.",0,07-20-2021,12:01 AM
243,420562,tostern,"@abhishah03so you can see that the packet is leaving the PAN FW but you didn't get any return traffic?Did you checked the AWS route tables and are you sure you haven't any SG on the Server that can block the traffic?Regards,Torsten",0,07-20-2021,12:13 AM
244,420562,abhishah03,"Nope , I can see the packet only entering PA FW ...",0,07-20-2021,12:15 AM
245,420562,tostern,"@abhishah03please send me a email tostern@paloaltonetworks.comthen i want to have a deeper look into it.Afterwards we can share here the solution of the problem.Regards,Torsten",1,07-20-2021,12:17 AM
246,420562,abhishah03,"I've just sent you email, with all the details. Pls check & suggest.The interesting part is everything works fine with traffic ingress point changed to AWS NLB; rather than utilizing the EIP of untrust NIC.",0,07-20-2021,01:32 AM
247,420562,jmeurer,"Make sure your SNAT rule is set with the original packet set to the untrust private IP and not the EIP. AWS SNATs on the way in and firewall sees the packet after the EIP translation. Also, ensure both interfaces are added to the VR.",0,07-20-2021,08:52 AM
248,420562,abhishah03,"Yup , that's already in place.Using Private (untrust) IP in NAT; also both interfaces are added in VR.",0,07-20-2021,11:34 AM
249,420562,Connected123,@abhishah03what was the solution to your problem? Pls advise the steps so we can also benefit from it.,0,08-12-2021,07:15 PM
250,425670,kiwi,"Hi @Connected123 ,In order to get better traction for this, I have moved this discussion to the VM Series in the public cloud area.Cheers,-Kiwi",0,08-12-2021,03:02 AM
251,425670,aper,Didn't azure reserver .1 through .4? Try setting the panw to .5?,0,08-12-2021,03:14 AM
252,425670,Connected123,"Hi@reaperSorry I deleted my previous post as it was the response from another discussion that I have created.I have solved this issue (ping fails in same subnet) by unticking Packet Buffer Protection.Global counters:Elapsed time since last sampling: 34.223 secondsname value rate severity category aspect description--------------------------------------------------------------------------------pkt_recv 32 0 info packet pktproc Packets receivedflow_dos_pbp_drop 57 1 drop flow dos Packets dropped: Dropped by packet buffer protection REDflow_dos_drop_ip_blocked 11 0 drop flow dos Packets dropped: Flagged for blocking and under block duration by DoS or other modules--------------------------------------------------------------------------------Total counters shown: 3--------------------------------------------------------------------------------It was enabled by default so didn't catch our attention at first. Not sure, if it is a new thing in ver 10.1.I will close this thread.@kiwi sorry about that. Now I know where to post VM/cloud related issues.Could you pls move this post below of mine as well?https://live.paloaltonetworks.com/t5/general-topics/azure-vm-cannot-access-the-internet/m-p/426333#M...",1,08-12-2021,04:20 AM
253,425533,jdelio,"In order to get help on this, I would recommend that you call into the TAC and select CSR (Customer Service Representative), and talk with someone about this. You should be able to talk with someone quickly about this.Available from all countriesEither that or contact your sales rep about this. But the CSR group may be the quickest way to get some help.I hope that this helps.",0,08-10-2021,03:28 PM
254,211091,jmeurer,"DHCP is the way to go. It eases automated deployments and prevents any possible misconfiguration. If you statically assign and it does not match what was assigned on Azure side, the traffic will not flow.",0,04-19-2018,06:50 PM
255,211091,junior_r,What about when you assign multiple IPs to a interface for NAT purposes,0,04-19-2018,06:58 PM
256,211091,jmeurer,You still assign them on the Azure side. You then need to specify them direcdtly as either objects or directly in the security or NAT policy.,0,04-19-2018,08:13 PM
257,211091,kblackstone,"There are 2 options here when you want to service multiple ips on a load balancer:1) add additional ips to the firewall interface from within the azure portal AND you will have to switch to static on the firewall and manually add the first + additional ips that you want to service (they'll match the ips on the azure portal). dhcp only picks up the first address from the azure side in my experience (this may have changed so please double check).#1 isn't the best option for ease of management2) on the load balancer, enable floating ip on the rule and you will see the ip requested by the user come through to the firewall (even when having multiple front-side ips on the load balancer). you can then create corresponding nat and security rules based on that. using this method you can stay with dhcp on the firewall and do not need to add additional virtual ips from the azure portal side, nor on the firewall itself.#2 is the better way to go.",0,04-20-2018,06:17 AM
258,211091,junior_r,"Hi,Would you configure this onPanorama and push to device using templae or just have DHCP configure on local PAN side.PROsPanorama*Can you push routes/interface(dhcp mode) to both devices at onceCons* If UDR messes up you cannot modify interface/route settingsThanks",0,04-20-2018,05:44 PM
259,211091,kblackstone,"The UDR is at the subnet level, so all firewalls put into those subnets would behave the same from the routing perspective if they have the same policy and virtual router configuration. I would bootstrap to get the interfaces up and in dhcp mode for both untrust and trust, and possibly the virtual router setup. Then let Panorama push down the policy and other information when the vm registers itself.The way bootstrapping works within Azure, you could have multiple bootstrapping configuration options available behind different shares on the same disk.",0,04-20-2018,06:58 PM
260,211091,junior_r,Thanks would you keep the network interface and VR configuration on Panorama?,0,04-25-2018,10:19 AM
261,211091,kblackstone,"The network interfaces I would add to the bootstrap.xml file. The VR configuration I would let Panorama push, along with the interface management piece if any load balancers are in play, and the larger security policy, etc..",0,04-25-2018,11:11 AM
262,211091,Harcharan,"Referring to the solution- ""#2 is the better way to go."" Can we still go with this solution with below scenario.Scenario- Active/Active Palo-alto Firewalls without Panorama managed and without HA between firewalls. The firewalls will be independent behind External and Internal Load Balancers.Can we use floating IP on External Load Balancer to reflect on both Active Firewalls.Will the Load Balancers still maintain the 5 tuple Hash and send packets to correct firewall of same session.Because there will be same floating IP on both the Firewalls, how will External LB maintain the hash.",0,08-06-2021,05:35 AM
263,421968,SutareMayur,Hi@ttak87You need to do settings on firewall to enable these logs. Its not enabled by default on Palo Alto.Kindly refer below article.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClIVCA0Hope it helps!,0,07-26-2021,05:14 AM
264,421968,ttak87,"Hi,@SutareMayurThanks for your reply.However, I have already set the settings you taught me.I want to check the Client IP and not the ALB IP in the log.",0,07-26-2021,06:29 PM
265,421968,SutareMayur,Hi@ttak87Could you please share PA o/p of below cli command -show system setting ctd state | match x-,0,07-26-2021,10:35 PM
266,421968,ttak87,"Hi,@SutareMayurThis is the result of the requested command.",0,07-27-2021,06:11 PM
267,421968,ttak87,"Additionally, I looked at Palo Alto's document, and it seems that only the LB's IP is checked for the XFF IP in the proxy type LB.If so, I think that GCP is limited in practically using XFF when using ALB.Am I right?https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/policy/identify-users-connected-through-a...",0,07-27-2021,06:18 PM
268,421968,jmeurer,The issue is that the firewall is using the last IP in the list and not the first. Please open a TAC case to push the fix through to engineering.,0,07-27-2021,08:03 PM
269,421968,Susaant,"Hi@ttak87,There are a couple of options around XFF in PAN-OS:Hope this helps.",1,07-27-2021,08:49 PM
270,421968,ttak87,I understood the content.Be able to explain well to customers.Thanks everyone for the replies. 🙂,0,07-27-2021,10:17 PM
271,351702,Firas_Obeidat,"After doing some digging the issue seems to be coming from GCC, as even though I have internet access doesn't appear that I can download files",0,09-24-2020,01:43 PM
272,351702,ndogwow,"Hi Firas,I am facing similar issues, how did you fix it?",0,07-16-2021,03:25 AM
273,418676,OtakarKlier,"Hello,Make sure to download and install all the dynamic updates, this could be causing it.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000PMoaCAGRegards,",0,07-14-2021,01:05 PM
274,419368,ddallmann,"For global protect vpn? If yes, should make sure ipsec is allowed/enabled, ssl vpn will get lower speeds.",0,07-14-2021,11:39 AM
275,419368,OtakarKlier,"Hello,If running a VM-50, you might want to think about upgrading. Its the smallest and could be causing your performance issues:https://docs.paloaltonetworks.com/vm-series/10-0/vm-series-deployment/license-the-vm-series-firewall...Regards,",0,07-14-2021,01:00 PM
276,418564,aji_toor,"@a-techie When using a load balancer in front you have to either use different ports for each of your web server which likely would not be happening in a real scenario or you have to a create new load balancer for every webserver, that would mean 10 load balancers.Application Gateway would be a better option, you get use 1 gateway for upto 5 domains I think, and you won't have to change front facing port, as an example all domains can have 80/443 from single gateway.",0,07-12-2021,11:29 PM
277,416871,TonyCleveleys,I fixed this. Just incase it's useful for anyone else the guide is unclear and it's important to name your template with a different name than the template name in the init-cfg.txt. The lambda creates a template stack and it's important this name is unique. Once I changed the name the firewalls registered.,0,07-08-2021,09:45 AM
278,416555,TonyCleveleys,To clarify we are using AWS deployments of Panorama with virtual firewalls.,0,07-01-2021,09:35 AM
279,416555,TonyCleveleys,Resolved. It was a misunderstanding on my part 🙂,0,07-02-2021,08:43 AM
280,416817,glynn,"There is no longer a need to load the image into cloud storage as the images for the PAYGO bundles as well as BYOL are available directly from GCP. To see a list of available images/versions, you can use a CLI command from a cloud shell:gcloud compute images list --project paloaltonetworksgcp-public --no-standard-imagesIf you need the entire URI:gcloud compute images list --project paloaltonetworksgcp-public --no-standard-images --uriOnce you have the target image, it should be a matter of configuring your automation to reference it.Regards,Patrick",0,07-02-2021,04:28 AM
281,416817,greg.donohoe,"This is exactly what I am looking for. Thank you very much Patrick.Out of interest is there a link somewhere which outlines these steps or did you learn this the ""hard way""?",0,07-02-2021,04:51 AM
282,416817,glynn,"Greg:I was involved early on and did it ""the hard way"". It has subsequently been documented:https://docs.paloaltonetworks.com/vm-series/10-0/vm-series-deployment/set-up-the-vm-series-firewall-...",1,07-02-2021,06:48 AM
283,413616,jmeurer,"We have an update coming to the ASG scripting in the next week or two that greatly simplifies the scripting. Now with that said, there are few functions performed by the scripts, and here are some ways around them.1. AWS had a limitation with Launch Templates that limited the instance to one interface. A large portion of the code adds the second interface after boot. That limitation no longer exists but you a forced to run mgmt and data plane in the same subnet. If you properly configure your security groups, this is not a risk as you just need 0/0 pointing to a NatGw and RFC 1918 pointing at the TGW in that subnet.2. The scripting also handles delicensing and removal from Panorama. We have a licensing plugin that can handle those tasks for you.https://docs.paloaltonetworks.com/vm-series/10-0/vm-series-deployment/license-the-vm-series-firewall...",0,06-17-2021,10:53 AM
284,413616,TonyCleveleys,"That is really helpful, thanks for such a quick reply. Much appreciated",0,06-20-2021,01:32 PM
285,413616,jmeurer,Circling back to this. I recently posted the simplified autoscaling template that I mentioned.https://github.com/PaloAltoNetworks/AWS-GWLB-VMSeries/tree/main/cft_simplifiedASG_with_warm_pools,0,06-22-2021,10:24 AM
286,413616,FranklinV,"Tony, I am working on a similar project. I am curious why not use the vm-series plugin (instead of terraform) to deploy the security dmz?",0,06-26-2021,10:38 AM
287,413616,TonyCleveleys,We can use terraform for the supporting infrastructure but it’s the ASG that’s the challenge and all the associated lambda scripts. Needs to plumb in to the cloud formation infrastructure to work properly,0,06-30-2021,01:17 PM
288,413616,TonyCleveleys,"This is brilliant, thank you. Really helpful. We are trying version 3.0 first which all seems to work but never registers as a managed firewall in panorama. Will do some more digging. Thanks for your help. Keep up the good work!",0,06-30-2021,01:19 PM
289,397059,ssyed,We recommend deploying firewalls in separate AZs or at least put them into an Availability Set in Azure. HA mode is supported as well but not typically recommended. The load balancer method is recommended. You can see both setups in our reference architecture guide. https://www.paloaltonetworks.com/resources/guides/azure-architecture-guide,0,04-12-2021,12:22 PM
290,397059,JimMcGrady,"From what i can see, the issue is that the VM-series firewall available from Azure Marketplace does not facilitate choosing an Availability Zone. And once the firewall is created, there is no reasonable way to move it into an AZ.",1,06-21-2021,09:31 PM
291,397059,aji_toor,I would also like to know how to install it as the only method of deployment in Azure I know of is through marketplace..Or is there some kind of ovf file provided which we can use for installation.,0,06-21-2021,10:47 PM
292,397059,tostern,"Good morning@raji_toorand@JimMcGradyThe Azure Marketplace offering has limited features and you can't deploy two firewalls over the marketplace in a single Ressource Group.That why we are using Terraform templates or ARM templates. Below are the link to the ARM Templates with the examples how to use it.ARM Templates: https://github.com/wwce/azure-armTerraform provider:https://registry.terraform.io/modules/PaloAltoNetworks/vmseries-modules/azurerm/latestHow to setup HA in Azure:https://docs.paloaltonetworks.com/vm-series/10-0/vm-series-deployment/set-up-the-vm-series-firewall-...i hope i could help you.Regards,Torsten",0,06-21-2021,11:13 PM
293,397059,aji_toor,"@tosternThanks. But PA needs to better their documentation regarding Azure deployments. While the Github mentions 3 models (Shared, Scaled and Dedicated). There is little explanation for each them and also there is no mention of them in the design guide. I understand and have tested implementation of both options with HA/without HA(load balancer)options. From what I understand the template I will use is shared model here andTransit VNet model (Common Firewall Option).And I had got it working in HA without ARM template for those who are not comfortable using it. Install in dedicated resource group and then move the resources to another resource group where you want both firewalls to be.",0,06-22-2021,08:24 AM
294,397059,aji_toor,"And interestingly we get the pricing for a 2vCPU deployment but azure VM does not support more than 2 NICS, if i try to deploy with arm template a VM with 2 vCPU.",0,06-22-2021,09:34 AM
295,397059,US_SOC_Analyst,Great to hear the recommended architecture.What's the reason you say HA is not recommended?And why do you recommend load balancer over floating IP?,0,06-22-2021,01:18 PM
296,397059,aji_toor,"@US_SOC_Analystbecause of 3-4 minutes downtime when doing failover, with failover its alomost instant..no session persistence with either.Also have to maintain a servie principal which has to be renewed every 2 years",0,06-22-2021,04:22 PM
297,397059,US_SOC_Analyst,"Thank you for your response.>No session persistence with either.Does this mean if we have HA configured firewall, the session is not shared between the HA pair?That sounds pretty weird, then what's that HA configuration for?",0,06-22-2021,04:29 PM
298,414232,abhishah03,"@Muttley,@PAvillach --- Thoughts ??",0,06-23-2021,01:14 AM
299,327257,JimMottershead,"I have the exact same question, if anyone can shed some light on it",0,06-02-2020,06:29 AM
300,327257,kap130,Following.I'll reach out to our SE and see if something is in the road map.,0,08-24-2020,05:00 AM
301,327257,Chris_Johnston,"Timing is perfect as I'm also interested in this. Per PA docs, not supported OS, but going to open case and check with our SAM as well.https://docs.paloaltonetworks.com/compatibility-matrix/terminal-services-ts-agent/terminal-services-...",0,08-24-2020,05:51 AM
302,327257,Chris_Johnston,This is officially supported now (release/update today)https://docs.paloaltonetworks.com/compatibility-matrix/terminal-services-ts-agent/terminal-services-...,0,10-20-2020,01:25 PM
303,327257,Mt_103,"Hi Chris,I can not find out 'Azure Windows Virtual Desktop' inthe list:https://docs.paloaltonetworks.com/compatibility-matrix/terminal-services-ts-agent/terminal-services-...Do you mean 'Windows 10 Enterprise Multi-session' is same as'Azure Windows Virtual Desktop'?",0,05-27-2021,06:11 PM
304,327257,Chris_Johnston,One in the same 🙂,0,06-01-2021,06:19 AM
305,408324,jmeurer,"If the public IP is set on the Panorama side, you can try this. Otherwise, you will need to contact TAC as the Public IP is the preferred IP that it should be using.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u0000008UpdCAE&lang=en_US%E2%80%A...",0,05-21-2021,08:43 AM
306,405834,jmeurer,Have you enabled Appliance mode on the TGW Attachment and cross-zone load balancing on the GWLB?Interface swap is not required but recommended when using automation script or autoscaling.,0,05-10-2021,11:31 AM
307,405834,Jayeshkumar.pataria-labelel01,After implementing cross-zone load balancing it fix issue.Thanks,0,05-14-2021,08:05 AM
308,406715,jmeurer,Panorama has the ability to export to SCP. You would need to run a sidecar box that accepts the SCP transfer and subsequently moves the data to S3.https://docs.paloaltonetworks.com/panorama/10-0/panorama-admin/administer-panorama/manage-panorama-a...,0,05-14-2021,05:57 AM
309,406588,abhishah03,"@jmeurer,@BPry ,@Warby -- Any pointers . Need urgent help to restore connectivity to management interface.",0,05-13-2021,11:51 AM
310,406588,jmeurer,"As long as you know the user name and password, EC2 Serial Console works with Panorama. I just realized that you mention m4 instance type. Serial console only works with Nitro based instance. If you are running 9.0 or greater, you can shutdown the instance and convert it to an m5. Ideally is better to control access to instances with Security Group and NACLs rather than within the PANOS config.https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-serial-console.html",1,05-13-2021,11:56 AM
311,406588,abhishah03,"Hi@jmeurer -- Is it safe to change the instance type to M5 , for serial console . Fix the issue , then again change it back to m4 ??Is there any risk in doing this ?As per AWS doc , it shouldn't be problem -""Upgrade Or Resize EBS Backed EC2 InstanceIf the EC2 instance you want to change has an EBS (Elastic Block Store) root partition, you can simply change or ‘resize’ the instance. The instance type that you want to resize to must be compatible with the current instance type, otherwise you will need to create a new instance and migrate your apps and data to the new instance (see next section for details on how to do this).""Just wanted to be sure.",0,05-13-2021,11:12 PM
312,406588,jmeurer,"It shouldn’t be a problem but I would snapshot it first. You may also want to consider leaving it an M5, better performance and you should compare the per hour running cost, it could be cheaper.",0,05-14-2021,05:52 AM
313,197364,hshah,"Steps look correct, it should work.Please focus on following part.1. Make sure key is properly converted with putty.gen2. Make sure that key is associated in putty from ""Auth"" option.Let me know if this helps.",0,01-29-2018,04:56 AM
314,197364,nson2139,"yes, I tried those options. It gives an error saying:Server refused public-key signature despite accepting key!and then it goes ahead and asks for the admin password which should not be the case.",0,01-29-2018,05:08 AM
315,197364,nson2139,"This has been resolved, we had some challenges in the corporate firewall which has been worked on.",0,01-29-2018,06:14 AM
316,197364,KishoreK,"Hello Linker,How did you resolve the issue",0,04-29-2021,02:18 AM
317,197364,nson2139,"Hi,The corporate firewall policies had to be change to allow some communication. Once we did that it was resolved.The steps we were doing for the AWS side were all correct.",0,05-11-2021,08:20 PM
318,213926,jperry1,"I don't believe there is a way to answer that because of the variables involved. If there is VPN to the cloud from corporate you have to consider1. the bandwidth and throughput of the connection from Corporate into the Cloud2. The bandwidth and through of the connection to the internet from the cloudAfter you have considered that then comes the question of the type of traffic the customer will need to pass through the firewall.1. http, https smb?2. What will the transaction sizes be?As you can see there are too many variables to make a blanket statement saying that customers are seeing a certain level of performance in those scenarios.",0,05-10-2018,08:37 AM
319,213926,OtakarKlier,"Yeah I couldnt agree more on your response. So let me rephrase the question a bit and see if the answers change. I'm trying to size a solution for end users to VPN into a cloud PAN just for web browsing, non corporate tasks. Looking at the published guide,VM-SERIES ON AMAZON WEB SERVICES, I see the following:It seems that the test results for the vm-100 and 300 are the same so why pay the extra? I know they have different CPU/RAM specs and also the VM Instances are different. Just seeing if a vm-100 would work for 2K+ users performing casual web-browsing, nothing too bandwidth intensive.Thoughts?",1,05-10-2018,08:50 AM
320,213926,AustinS,"Running into the same sizing issue with Azure, there is limited purpose to go for the higher models of Palo Alto VM500 / VM700 as the throughput is simply capped due to the limitations in running in the cloud. Only recomendation I can provide is to try a lower spec model VM100/VM300 aligned to the PA recomended hosting specicifactions and peform testing to see how it peforms.",0,05-14-2018,07:12 PM
321,213926,AnkitChhabra,Do we a similar testing table on KVM ?ThanksAnkit,0,05-07-2021,10:47 AM
322,405255,SebRupik,"Hi there,The TGW which the DX links are attached to will have been configured with an ASN. This ASN will be part of the AS_PATH attached to the /32 prefix which it is received by the Palo Altos. As such the TGW will not accept /32 being advertised from the Palo Alto as a loop avoidance measure. To mitigate this issue you need to have the TGW ASN only appear once in the routing path.A possible solution would be to create a VPN tunnel from the on-premise hub site direct to the virtual Palo Alto, then allow the virtual Palo Alto to peer with the TGW via the VPN attachments. The TGW ASN would then only appear once in the AS_PATH.cheers,Seb.",0,05-07-2021,03:47 AM
323,405255,KhurshidAnjum,,0,05-07-2021,04:20 AM
324,405255,SebRupik,"Couldn't you create another TGW 'behind' the Palo Altos and attach VPC1 and VPC2 to it. This way traffic would have to flow through the Palos which is what you are trying to achieve.Currently your topology looks as if you have placed all of your EC2 compute in the DMZ in front of the firewall perimeter, except maybe worse as traffic to those hosts is not secured by the firewall, so they are more like bastion hosts.Granted this is all a private network so the above statement is probably not that alarming(!) but it makes more sense to place the compute logically behind the firewalls.cheers,Seb.",0,05-07-2021,04:33 AM
325,402555,Hasan1,"By default azure subnets in spoke vnets are able to communicate directly with no need to reach hub. But you can add outbound deny policy at NSGs to block 'virtual network' traffic. Basically you will need to add 2 statement at outbound nsg for the subnet, first one deny any-any, then allow virtual network to next hub.",0,05-03-2021,09:13 AM
326,402643,jmeurer,"Yes, you can decrypt on the ALB to perform any URI-based policy or insert the XFF. You can choose to keep the traffic decrypted behind the ALB and the firewall will see the clear text traffic or reencrypt on the ALB and use inbound SSL decryption. Typically you would use the same cert for the ALB, backend, and firewall. At the time of this posting, the ALB does not care about mismatched certs so you could actually use a self-signed cert on the firewall.",0,04-28-2021,05:28 AM
327,402643,mprasadax,"In SSL inbound inspection , will self signed certificate work or we would require server certificate?",0,04-28-2021,09:37 PM
328,402643,jmeurer,"At the time of this posting, the ALB does not care about mismatched certs so you could actually use a self-signed cert on the firewall.",0,04-29-2021,06:49 AM
329,402576,JoergSchuetter,"Hello @omprasadaxThis mainly depends on how the routing is configured. Azure is very kind and adds routes of peered vNets and so on. Unfortunately this is not what we need when using a NVA.Check the effective route on the servers, and overwrite the routing accordingly. Asynchronous routing has to be prevented.",0,04-27-2021,10:47 PM
330,402576,jmeurer,"It's due to the return path routing. If you were using a single firewall or an HA pair, you would need to have your 0/0 route pointing back to the firewall to maintain symmetry. Typically, it is recommended to use an App Gateway in front of the firewalls which can insert the XFF header if the traffic is HTTP.",0,04-28-2021,05:23 AM
331,397302,apatil,"Hi Tariq87,",0,04-12-2021,11:23 AM
332,397302,apatil,,0,04-12-2021,11:23 AM
333,397302,jmeurer,"How are you directing traffic to the firewalls? If you are using an ALB/NLB, ensure that your routing allows the firewalls to communicate with all of the LB Subnets via the same interface that is specified in the Target Group. Similar question on the backend. If the application is deployed across multiple subnets, ensure the firewall can route to all of the backend subnets via the SNAT interface.",0,04-12-2021,11:25 AM
334,397302,Tariq87,"Yes, we are using NLB, which is deployed in 2 subnets across 2 az's, the backed firewalls are also in the same AZ's. The backend to the firewall is an Haproxy which are also spread across the same az's.What else can I check?",0,04-12-2021,11:33 AM
335,397302,jmeurer,"There is a very good chance that your external interface cannot route to the NLB subnet in the other zone or that your Trust side interface cannot route to the other zone. If you can post your subnet lists and your firewall VR ""More Runtime Stats"", we may be able to see the issue.Also watch that you do not have ""Automatically create default route pointing to default gateway provided by server"" enabled on both of your interfaces.",0,04-12-2021,11:48 AM
336,397302,Tariq87,"I am sure of the second point you have mentioned, no we did not do that.For the first, I'll check and get back to u",0,04-12-2021,07:45 PM
337,397302,Tariq87,How can I do that?,0,04-12-2021,07:54 PM
338,397302,tostern,"@Tariq87see below on the picture. You have to make sure that on the interface on the firewall are you not select ""Automatically create default route....."" ",1,04-12-2021,08:04 PM
339,397302,Tariq87,"Yes, we have not selected this for the trust interface",0,04-12-2021,08:23 PM
340,391405,ydhanuka,"Hi@greg.donohoeYou may want to upgrade your panorama to 10.0.5 if not done already.Check the release notes here and search for ""PAN-152813""https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-release-notes/pan-os-10-0-addressed-issues/pan-...If that does not fix the issue, then I would suggest to open a support case with the tech support from panorama attached.Hope this helps,Yogesh",0,04-09-2021,08:24 PM
341,394729,andreb,You will need to use Automation (Ansible or Terraform) to deploy into the Resource Group as the manual process will not let you deploy to a Resource Group that has resources in it.,0,04-07-2021,08:58 AM
342,165760,michelvankessel,"you may alter the ARM templates on github. That is the fastest way.I made one for myself with 8 interfaces, using a Standard_DS4_v2 instance on a premium Storage account.What I would like to do, is change the template to install the VM with managed OS disk, that is the next step.you can checkout the files I have created -https://github.com/michelvankessel/azure/tree/master/vmseries-avsetregardsMichel",0,07-12-2017,04:57 AM
343,165760,melamin,"Adding NIC to VM in azure is only possible via Azure CLI v2.0 using the following steps: - Create a NIC in the desired subnet using Azure Portal, or use Azure CLI version 2.0. This NIC should be in the same VNET as VM-Series. - Shutdown VM-Series - Attach the NIC using Azure CLI v2.0 commands# az vm nic add -g MyResourceGroup --vm-name MyVm --nics nic_name1 nic_name2If that does not work then you need to use ARM template as stated by Michel.ThanksMo",0,07-12-2017,05:21 AM
344,165760,Gustavo_Aristi,"Old question but I just dealt with this yesterday and it's not easy to find the answer so I'm posting here for the community.The templates from the Palo Alto GutHub are deployed with a VM size of D3_v2 which supports 4 interfaces including the MGMT interface.If you want to use more interfaces for your VM-Series deployment, you need to re-size your VM-Series in Azure after deploying it with the templates.See information about sizes and number of interfaces supported below (as well as other specs such as CPUs):https://docs.paloaltonetworks.com/vm-series/10-0/vm-series-performance-capacity/vm-series-performanc...The only ugly thing is that from 4 interfaces the next size (D4_v2) supports 8 interfaces so the price is a bit over double what the D3_v2 costs (a bit less than $427.05 per month at the time of this post).Re-sizing can be easily done after the template is deployed.Steps:Shut down the VM-SeriesCreate your new subnet(s) (if they are not created yet)Create your new interface object in AzureClick on the VM-Series from your resource groupOn the left pane, click on ""Size""In the search filter type ""D4_v2""Click on the resultClick on the ""Resize"" buttonIt takes less than one minuteAfter resizing:Go back to the VMClick on ""Attach network interface""Select your new interface from the dropdown listClick ""OK"" and wait for the success messageYou can see now your additional interface along with the othersTurn your VM-Series back onEnjoy",1,04-06-2021,03:02 PM
345,396111,jmeurer,"The zoning capabilities is dependant on the traffic direction.Inbound, we have the ability to map GWLBe's from the various inbound VPCs to a subInterface. This traffic will still be Intrazone, but you can have each VPC in its own zone.https://docs.paloaltonetworks.com/vm-series/10-0/vm-series-deployment/set-up-the-vm-series-firewall-...Outbound, we added the ability to route traffic outbound out of an Untrust interface using Overlay routing in 10.0.5. This allows for the creation of the traditional Trust->Untrust style policy.https://docs.paloaltonetworks.com/vm-series/10-0/vm-series-deployment/set-up-the-vm-series-firewall-...East-West, VPC to VPC communication through a TGW deployment cannot be broken into zones. This traffic must hairpin back to the GWLB for routing. This traffic will continue to be Intrazone and your policies will need to be DAG or Subnet based.",0,04-06-2021,01:09 PM
346,396111,jon.swick,"Is there any reason to map the VPC's to zones for inbound then if i can't create zone based policies?are you stating that if VPC A is sending traffic to VPC B the palo will recognize the inbound as coming from Zone A but will send it out ""Zone A"" because it hairpins. so i just couldnt define destination zones but i could still utilize source zone?",0,04-06-2021,01:33 PM
347,396111,jmeurer,The purpose for the Zones in an inbound flow is to handle the possibility of overlapping IP schemes when not using TGW. Diagrams for this flow are here. https://live.paloaltonetworks.com/t5/vm-series-in-the-public-cloud/aws-vm-series-gateway-load-balanc...In VPC to VPC communication the traffic is as follows. This traffic flow hairpins back to the GWLBe before routing back to the TGW. This traffic must stay within the GENEVE encapsulation tunnel to maintain the 5-tuple perisistence that the GWLB performs.VPCa -> TGW -> Firewall VPC -> GWLBe -> firewalls -> GWLBe -> tgw -> VPCb,0,04-06-2021,02:32 PM
348,396111,jon.swick,Awesome!! Thank you so much for your help that put a light on a lot of things.,0,04-06-2021,02:38 PM
349,387980,SebRupik,"Hi there,On the CLI, the ping command defaults to being sourced via the management interface. Can you try your test again but source it from the outside interface IP:eg for PA-VM-01:ping source <PA-VM-01-outside_IP> host<PA-VM-02-outside_IP>cheers,Seb.",0,03-29-2021,02:51 AM
350,394037,JoergSchuetter,Hello @Ash2kChange the IP assignment in Azure to static (for all fw IPs).Configure the primary IP on the firewall with the correct network mask (e.g. /24). Configure all further IPs on the same NIC with /32,1,03-25-2021,01:17 PM
351,391899,JimMcGrady,"My current thinking for the method is to take a backup of the gateway. And also to export a named config. Followed by:- Delete the gateway in Azure.- Create a new gateway (from Marketplace) with the same name, subnet, and ip address as the old.- Once the new gateway is up and reachable, import the named config.- Update the license/subscriptions, as saved in the Palo portal, with the new gateway ID.Is there a better way? Or any missing steps?",0,03-24-2021,10:53 PM
352,331342,DavidAzzopardi,Hi RyanDid you ever get to the bottom of this?David,0,07-09-2020,10:16 AM
353,331342,dmaynard,Azure VM backup is not supported on Palo VMs.,1,07-09-2020,10:25 AM
354,331342,RyanJohnstone,"afraid not, had another answer though saying its not supported...",0,07-28-2020,06:57 AM
355,331342,naviman,I know this is an old post but is there anyone out there backing up the config? Are they waiting for it to fail over and lose the config? Surely there is a way?I was reading this old post from 2019. I cant even locate this portal.https://docs.paloaltonetworks.com/panorama/8-1/panorama-admin/administer-panorama/manage-panorama-an...,0,03-17-2021,08:59 AM
356,389341,OtakarKlier,"Hello,I would ask what are you attempting to accomplish? Could you provide a simple network diagram?Please advise,",0,03-10-2021,02:48 PM
357,389341,attarachai,"Sorry, I mean on AWS front Palo alto instance has ELB such as ALB but behind Palo, all vpc, not has Internal NLB or ALB how to flow traffic or NAT to endpoint instance can you suggest meThank you",0,03-11-2021,08:38 PM
358,387896,OtakarKlier,"Hello,Not sure why you would want this? But it could present asymetrical routing and cause the application/traffic to not work correctly.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000CllzCACRegards,",0,03-10-2021,02:51 PM
359,389284,OtakarKlier,"Hello,If you have a static IP on the Azure external IP side. You should be able to get this going. Just remember on the Azure PAN on the IKE gateway setting, make sure to use the Local IP Address of the untrust interface in the local IP address. Then on the other PAN in the IKE gateway setting, make sure to add the Peer Identification IP address of the Azure PAN.Hope that makes sense.",0,03-10-2021,02:46 PM
360,215354,jperry1,Can you make sure IP forwarding is enabled on Eth1 which would be the Untrust interface on the firewall in Azure?,0,05-25-2018,11:44 AM
361,215354,dmarlow,"It is enabled. I don't think I set those, so I believe they were set by the ARM template. Both trust and untrust interfaces have IP forwarding enabled.I think the issue is NAT related. I can see the expected packets in the ""drop"" packet capture log.",0,05-25-2018,12:17 PM
362,215354,jperry1,Please provide a link to that template from GitHub or where you received this template?,0,05-25-2018,01:53 PM
363,215354,dmarlow,"To be honest, I'm not sure exactly which template is used. When selecting the VM-Series Next Generation Firewall (BYOL) in the marketplace, it only says this:Documentation and sample ARM templates:http://azure.paloaltonetworks.comHowever, not much is mentioned on that site.I would imagine the templates are here. However, I'm not sure exactly which one is used.https://github.com/PaloAltoNetworks/azureI do see that this one has IP forwarding enabled:https://github.com/PaloAltoNetworks/azure/blob/master/vmseries-test-drive/main-template.json#L320",0,05-25-2018,02:15 PM
364,215354,jperry1,The link you sent me takes me to the Test Drive registration page? Is this a test drive? If so which one did you register for specifically? I'm not familiar with the Test Drives but the more I know about it I can direct you to the appropriate party.Did you launch via azure deploy button on github? How was this BYOL template launched? If it is a test drive does it list how to get assistance within the test drive?,0,05-25-2018,02:25 PM
365,215354,jperry1,"Try this in the meantime1. Go to the interface, go to the DHCP options and uncheck the option to automatically add the default gateway2. Do this for both Trust and untrust3. Go into the virtual route and statically add the default gateway for both the trust and untrust interfaces. They should point to .1 of the subnet that is assigned to the interface via DHCP",3,05-25-2018,02:32 PM
366,215354,dmarlow,"Sorry for the confusion. I used the Azure marketplace version of the VM series, not the ""deploy"" button from github. I'm assuming they're similar. I'm not sure of the actual template that was used.",0,05-25-2018,02:40 PM
367,215354,dmarlow,"This was it, thank you! I knew something seemed wrong with all of this. The documentation needs to reflect the fact that the untrust and trust that obtain the IPs via DHCP don't have a default gateway.The instructions do mention to unckeck the option to add the default gateway, but even checking those don't work (one of my attempts to get things working was to try that, to no avail).For future generations (in case the original document isn't updated).Go into the Palo Alto web interface --> Network --> Virtual Routers --> defaultStatic Routes --> add:Destination: 0.0.0.0/0Interface: ethernet1/1Next Hop: IP Address and specify the .1 like@jperry1mentioned (typically you have .4 assigned to the VM by Azure).(e.g. machine got 10.2.1.4, use 10.2.1.1 as the next hop).---------Now to figure out how to get a GlobalProtect agent installer so that when someone tries to click the download in the portal, they don't get ""errors.txt"" to download...",1,05-25-2018,02:51 PM
368,215354,jperry1,Thanks for the update. Unless we go into the interface and check that we want to receive default gateway interfaces then it will not provide them. Only the management interface will receive them by default.That being said that is usually part of the config process on the PAN for interfaces to receive DHCP.There may be a weird occurance where the interfaces receive a 168 for the default gateway instead of a the default gateway of .1. I have seen that before in which I have to manually add the route in the virtual router. But you should be able to check DHCP option to add the default route and for the most part that will work. Thanks again and take care.,0,05-25-2018,03:02 PM
369,387642,Gladstone,"To egress the internet from your 'public' interface, you'll need to put it into a Public AWS subnet. For this subnet in the aws route tables you'll route 0.0.0.0 to the Internet Gateway (IGW). Also set an EIP on your Eth1/2 ip address. The IGW does the nat translation as it leaves to the internet.",0,02-25-2021,01:12 PM
370,387733,jmeurer,The behavior you are looking for can be implemented with the GWLB. You can find more information in the links below.,0,02-25-2021,07:20 AM
371,373786,JoergSchuetter,Hello @mylimo456Did you check the events on Azure regarding the network interfaces?How long did you wait?,0,12-11-2020,04:53 AM
372,373786,Fitzpatrick,"Does theService Principal have all the correct permissions? Contributor to the Resource Group. Also, try rebooting the passive node (the one with the floating IP attached) after a fail over.",0,02-09-2021,10:26 AM
373,380617,phinneywill,Oddly enough there were duplicate certs and this caused issues with the import device state. I deleted the dup certs and all is well!,0,02-05-2021,08:17 AM
374,381441,jmeurer,You have two options. You can either use BGP to prepend the routes from one of the firewalls to create essentially an Active/Passive routing hierarchy or use SNAT. The former is generally preferred. We have this documented in our AWS Reference Architecture here.https://www.paloaltonetworks.com/resources/reference-architectures/aws,0,01-22-2021,05:04 AM
375,376138,SureshReddyM,"You can not use PA-VM for free of cost and you have activated your VM and purchase subscription license.PAN doesn't do free lab licenses. You can purchase a LAB SKU or you can get a trial license(local SE/AM) for you if you already have an account team.https://docs.paloaltonetworks.com/vm-series/9-0/vm-series-deployment/license-the-vm-series-firewall/...Regards,Suresh",0,12-26-2020,07:13 AM
376,376138,Furqon,"Thanks for the answer to put me to use the trial license. I had my account team and have them. But as for me, we would like to going to develop a simple deployment without trial license is still possible. Just several features like log traffic and ACC is not completely open.",0,01-06-2021,12:22 AM
377,247958,aullJD,"I have the same issue, accidentally I deleted .txt file I also unable to run the script file too. I also try via Java and c++ but it's not working,https://tutuappvip.info/https://appvalley.mobi/https://3utools.online/",0,08-21-2020,07:48 AM
378,247958,Adelahelen,"That problem I come across often, it's annoying, so I switched to using whatsapp gb.",0,12-25-2020,01:34 AM
379,365659,nanasin,"SR-IOV and DPDK can be enabled simultaneously.Slightly misleadingly, SR-IOV is assisted by the network card and DPDK is assisted by the CPU.https://en.wikipedia.org/wiki/Data_Plane_Development_Kithttps://en.wikipedia.org/wiki/Single-root_input/output_virtualizationEnabling SR-IOV bypasses the hypervisor that exists between the PAN-OS(VM-Series) and physical NICs.Enabling DPDK bypasses the PAN-OS (linux kernel) that resides between the NIC bypassed by SR-IOV and the pan_task (a process that represents the data plane).DPDK is effective for simple processes such as just moving data from east to west, raising the limit from around 20 Gbps to around 100 Gbps.I think DPDK probably won't be effective until Threat Prevention's throughput exceeds 30 Gbps, which is not very useful at the moment.In other words, I don't think it's very useful at this time (the unconfigured defaults should be the most secure).Where DPDK is useful is in eliminating most of the bottlenecks, even in configurations that connect via Open vSwitch (OVS).Here are Intel's test resultshttps://builders.intel.com/docs/networkbuilders/demonstrating-data-plane-performance-improvements-us...It should be possible to use OVS in AWS as well, but there should be little benefit to using it (although I did some research).Therefore, I think it's enough to just enable SR-IOV, and I think it's safer to not change the default.",0,11-29-2020,08:17 PM
380,365659,Sidneyy,"Supported SR-IOV for Palo Alto in WS. Hello everybody,I see that we have SR-IOV and DPDK modes supported for Palo Alto in AWS and understand that DPDK",0,12-18-2020,02:10 AM
381,373773,Hakes_Pop,Thanks for the information keep sharing,0,12-13-2020,09:34 PM
382,363551,Savannah,"My question is - am I an ignoramus for not knowing this?I get that I probably shouldn't have taken their published throughput numbers at face value, but I've just never had reported issues with throughput using this type of design in the past. Moreover, this limitation was not mentionedanywherein any documentation/blog posts, etc. I could find previously.",0,12-11-2020,11:54 PM
383,353322,BrianFyre,"maybe I'm just being impatient. The 2nd firewall finally got deployed it looks like. No VPN tunnels yet, and still can't access either firewall incorrect username/pass using the defaults from the bootstrap.Just going to give it some more time and see if hopefully it finishes everything. Still curious if there is something weird with the scripts because of the versionsThanks",0,10-01-2020,07:32 AM
384,353322,Smitham,"As IT environments grow, they can become more complex, with additional accounts, VPCs, and the networking between them. AWS Transit Gateway is a service that addressesUpsers networking complexity by building a hub-and-spoke network to simplify your network routing and security. With Transit Gateway, you can connect your Virtual Private Clouds (VPCs) that span multiple accounts and on-premises networks to a single gateway.",0,10-26-2020,10:43 AM
385,353322,ximatan,"So many employees of upserscom are reporting that they are not able to access their accounts. As far as the portal is concerned, there is no technical error that is resisting that access.",0,12-10-2020,10:48 AM
386,282057,BPry,"@chrisjin,Officially I don't think this is supported at all, as CloudWatch doesn't really expose an easy way to injest logs outside of an instance with the agent installed. That being said, you can rig CloudWatch to look at /var/log/messages and configure an EC2 instance to accept your syslog messages and pass them to that location to get them into CloudWatch.",0,08-10-2019,05:13 PM
387,282057,Sagar_D,"Hi,You need to have a IAM Role associated with the Palo Alto EC2 instance.AWSTemplateFormatVersion: 2010-09-09Resources:IAM-NPD-INT-PAFWMON:Type: 'AWS::IAM::Role'Properties:AssumeRolePolicyDocument:Version: 2012-10-17Statement:- Effect: AllowPrincipal:Service:- ec2.amazonaws.comAction:- sts:AssumeRolePolicies:- PolicyName: PAFWMON_PolicyPolicyDocument:Version: 2012-10-17Statement:- Effect: AllowAction: cloudwatch:PutMetricDataResource: '*'RootInstanceProfile:Type: ""AWS::IAM::InstanceProfile""Properties:Path: ""/""Roles:-Ref: ""IAM-NPD-INT-PAFWMON""",0,12-01-2020,06:13 AM
388,282057,glynn,One of the AWS SAs blogged about this:https://aws.amazon.com/blogs/apn/monitoring-your-palo-alto-networks-vm-series-firewall-with-a-syslog...I found that it lends itself well to containerization as well.,0,12-01-2020,08:38 AM
389,366407,ALangendijk,OK now I changed the outbound ruleOutbound and inbound use the same IP. SNAT port exhaustion may occurNow it works question is what is the logic behind this.,0,12-01-2020,01:07 AM
390,362218,nanasin,"Whatever hypervisor you are using, with proper CPU pinning (or CPU affinity) settings and SR-IOV settings, Threat Prevention can achieve 10 Gbps on modern high performance servers.Check the Table 4, where Threat Prevention achieves 13552 Mbps.See https://eantc.de/fileadmin/eantc/downloads/News/2019/EANTC-TestReport-PaloAlto-v1.0.pdfHowever, most network engineers cannot properly tune the above settings, and they are impossible to tune in the public cloud.Also, since HTTPS traffic accounts for more than 80% of any enterprise traffic, Threat Prevention's 10 Gbps is rarely useful because SSL Decryption is the bottleneck.Even in the Table 4 above, the throughput of SSL Decryption is only 24722 Mbps (about 18% of Threat Prevention).",1,11-29-2020,06:49 PM
391,362218,jerrybonner,"Thank you for the link to that document. That is interesting information that I haven't seen publicly available before. It seems in some cases the VM-700 is able to achieve over 10G of throughput. Why then doesn't PAN advertise or officially support this? We're running into educational institutions with 10G requirements. Fortinet does advertise a solution, although with twice the required vm-700 vcpus (32 vs 16). On paper, this put us at an immediate disadvantage.We operate our own private cloud and we substantially tune for throughput whenever possible. So my question is less concerned with public cloud and I understand the issues there.",0,11-30-2020,06:57 AM
392,362218,nanasin,"Palo Alto does not advertise and support it because it does not benefit them.In this area, their main battleground is the public cloud where Prisma Access is running.So for products running in the public cloud (mainly AWS), it seems that they are updated with every new PAN-OS that comes out.Private clouds, in this case, Network Functions Virtualization (NFV), can achieve unified High Availability (HA) through live migration, scale up through physical enclosure replacement, expand physical enclosure to scale out.If we follow Moore's Law, the capacity of NFV doubles in 18 months simply by replacing the physical enclosure.In a virtualized product, capacity and performance can be determined by us, who can choose the physical enclosure, not the manufacturer.Conversely, if we are using an old physical enclosure, then of course it will not perform. Performance and capacity is our responsibility as users, not the manufacturer.Physical enclosures without an OS are cheap, but physical enclosures that work as products (i.e., traditional network devices) are very expensive.Once manufacturers officially support live migration, what used to require multiple physical enclosures for HA will be able to be one virtualized product.If the virtualized product is not a subscription license, these facts are a manufacturer's nightmare.For the above reasons, Palo Alto has little benefit in supporting performance and promoting performance in specific environments with respect to its products for the private cloud, even though there are risks. Maybe they want to stop selling and supporting some of their products per se (I think so, especially for the KVM).And the benefit of advertising the performance improvements of NFV-related products lies with the hardware vendors selling the physical enclosures and the manufacturers of the hypervisors. So you're looking at the wrong people for capacity and performance support. You should be looking to the hypervisor and hardware manufacturers.",0,11-30-2020,06:48 PM
393,365125,nanasin,Isn't it the same VCN but can't communicate between different subnets?VCN Transit Routing is likely to be required for subnets that want to communicate with or through PA VMs.You can find it at https://docs.cloud.oracle.com/en-us/iaas/Content/Network/Tasks/transitrouting.htm,0,11-29-2020,10:17 PM
394,348557,jmeurer,You may see a nominal performance increase by running the bigger instance size due some of the underlying AWS hashing to hardware. The increase will be no where close to the performance of running a VM-300 on the same instance types.,1,09-11-2020,05:36 AM
395,348557,SergGur,"Update: I discovered that SNMP monitoring does indeed only report 2 CPU and does individual graphs got each.Now I'm suspecting AWS CloudWatch graphs does not represent true AWS VA firewall load. This is because AWS combines the load of 4 VCPUs (2 busy and 2 totally idle) and therefore in this situation, AWS CloadWatch results need to be multiplied by two (to compensate for CPUs provided by AWS but not used by firewall software)My sample data for a firewall I'm examining (24 hours - but it can not be compared because in a massive difference in polling frequency and methods)AWS CloudWatch:SNMP monitoring:",0,09-11-2020,05:55 AM
396,348557,SergGur,"Similar to physical firewalls there is the management and data plane separation. And there is (at least one) dedicated CPU assigned to the management. I'm getting there but still confused. In one hand there is a document (see below) telling unlicensed CPUs allocated to management. In the other hand, my SNMP monitoring only reports two CPUs back.Does my VM-100 in AWS effectively only has 1 VCPU for traffic?From VM-Series System RequirementsThe number of vCPUs assigned to the management plane and those assigned to the dataplane differs depending on the total number of vCPUs assigned to the VM-Series firewall. If you assign more vCPUs than those officially supported by the license, any additional vCPUs are assigned to the management plane.",0,09-11-2020,06:07 AM
397,348557,SergGur,@jmeurerwith regards to your statementThank you for sharing the first-hand experience with running VM-100 and VM-300 on the same instance type. Perhaps the difference is due to the number of VCPUs used by bata plane.,0,09-11-2020,02:13 PM
398,348557,jmeurer,"You are correct, the VM-100 will only utilize 2 vCPU for data plane.",0,11-23-2020,01:10 PM
399,348557,SergGur,I tested this inside out. Here is final take:,0,11-23-2020,01:42 PM
400,348557,nanasin,"What OIDs are you using in SNMP monitoring?If you are monitoring hrProcessorLoad, you will only see two objects, no matter what model of Palo Alto FW you are using.It corresponds to the utilization of the data plane and the management plane.Also, these values correspond to the values of the system resource wedge in the dashboard.You can find it at https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClaSCASIf you want to see the utilization per VCPU, you need a little trick.Please press ""1"" after running ""show system resources follow"" to toggle view to show separate states.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000PLZZCA4I do not know the REST API that corresponds to this idea. Naturally, I don't know the corresponding SNMP objects either.Therefore, I don't believe there is an elegant means of continuous monitoring.In the VM-Series and PA-850, for example, the management plane and the data plane are not physically separated, and the data plane is run as a process called pan_task.The number of pan_task processes increases or decreases according to the capacity of the Palo Alto FW and is allocated to logical cores from CPU1 onwards using CPU affinity (a feature of the Linux kernel).I remember that the CPU utilization of the pan_task process, which can be checked with the above command, behaved a little differently depending on whether SR-IOV was enabled or not.",1,11-29-2020,09:28 PM
401,358147,yannogrodowicz,"For those who might be interested, I finally figured out why this was not working.This was due to server-side encryption being enabled on the S3 bucket.After disabling server-side encryption on the S3 bucket, the bootstrap worked fine and the content updates could also be installed. Please note that you will need at list version9.1.7 or 10.0.2 if you want the self-registration to Panorama to work together with the installation of content updates during the bootstrap, otherwise autocommit will fail at the end of the bootstrap process and your vm-series will not self-register to panorama using its vm-auth-key.Many thanks to the Palo Alto TAC Engineer who took the time to reproduce this in his lab to confirm what was the expected behavior.",0,11-13-2020,12:16 AM
402,348019,tostern,"Hi Ravindra,it is hard to say what are the requirements for the Panorama in Azure, it is also important to know what are the use case.When you logs/sec are lower the 10,000 and you didnt want to manage more then 500 Devices then are the min requirements:Then you can use a DS5_v2 vm instance typeDetails are herehttps://docs.paloaltonetworks.com/panorama/9-1/panorama-admin/set-up-panorama/set-up-the-panorama-vi...1. there is no version requirements for Panorama in Azure it is again depends what are you trying to archive here but i use in the past the Version 9.1.42. I have already a lab running in Azure Panorama HA and i can't complain. It works really stable for me.I hope i could help.Regards,Torsten",1,09-10-2020,12:00 AM
403,348019,Ravindra692,Thank you very much,0,09-10-2020,05:15 AM
404,348019,BalaBWV,is there any link to setup active/passive in Azure. How about HA link ? can we deploy in two different regions ?,1,11-04-2020,12:14 AM
405,360248,kakuda.tomoyuki,"[Additional info]I found, unfortunately I miss-selected ""autosave-pre-cfg-202001XX.xml"" forconfiguration while downgrading.In this case anyone know how to recover?According to my investigation, it is impossible to recover. I'm about to give up( it means I will re-install)",0,11-03-2020,05:20 AM
406,359438,nleslie1970,I got it working. I created a static route on my Trust-vr for my On prem network - 10.0.0.0/8 that routes to my load balancer on my trust side. Then on the gateway subnet i created a route for my Azure subnet going to my loadbalancer as well and now traffic from my express route is going through my firewall!,1,10-29-2020,12:16 PM
407,351422,Ravindra692,"I was able to make it detect the disk by doing the below.I added a small 64GB disk as the logging Disk 1 and then the 2TB disk as the logging disk 2. I do not have an explanation for this, I just came to this by trial and error and this worked for m",0,10-28-2020,06:22 AM
408,357333,Ravindra692,"In an active Passive scenario you do not need a Load Balancer.For the Active/Standby Scenario this is what I did1. Deploy the Azure VM's in a availability set2. Do the HA app registration with the Azure AD and then make sure this App registration has the Subscription contributor roles assigned to it for the subscription where the Palos are deployed3. if the palo VM's are going to have Public IP's associated with the NIC then make sure you use the basic SKU for those Public IP'sDoing these I got the active/standby situation working for me, however the failover time it takes 6-8 mins in the least.",0,10-28-2020,06:19 AM
409,347245,jmeurer,"The way I have solved this in the past is to configured the API Gateway with a private endpoint in the firewall VPC. Configure the the firewall pool behind a Public ALB to serve as you front end with your desired app cert. Use a source and destination NAT rule to forward that traffic through the firewalls to the API GW endpoint FQDN.One nuance, if you intend to decrypt the traffic on the way through use a SSL Forward Proxy decryption profile rather than the more intuitive Inbound Decrypt profile. The API gateway does not allow you to load a custom cert when using a private endpoint. By flipping the profile, you can get around the SSL handshake errors. The ALB will ignore the self signed cert warning.",0,09-07-2020,09:26 AM
410,347245,charles07,"Thank you@jmeurerI was exploring around the method you said, could not get it done. Could you please help with the steps you followed?Create Private APiPrivate endpoint......Finally how was it linked with Palo Alto/Firewall DNAT.",0,09-08-2020,02:50 AM
411,347245,jmeurer,"I used this guide.https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-private-apis.htmlWhen the private endpoint is created, it will have a zone redundant FQDN assigned to it. You use that FDQN as our destination in the NAT rule.https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/networking/nat/configure-nat/configure-des...You do also need a source nat on the same rule to ensure the proper return path from the api GW to the firewall. That would typically be your trust side interface address.",0,09-08-2020,06:15 AM
412,347245,charles07,"@jmeureryour reply is helping. I tried the following;1. Create a sample lambda function of pet store -http://petstore-demo-endpoint.execute-api.com/petstore/pets2. Created VPC endpoint3.Created private REST API and attached endpoint4. Created DNAT in PA with destination as VPC endpoint**PA LAN and VPC endpoint are in same subnetNow I called the URL http://PAWANIP/petstore/petsTried diff URLs, patterns, https nothing worked. Is there anything wrong in the method done.",0,09-10-2020,08:59 AM
413,347245,jmeurer,"Did you add a source translation to the NAT rule with the firewall's interface address? Otherwise the endpoint will try to respond directly to the original client IP.If you spin up a bastion host in the VPC, can you access the end point? It could an SG on the endpoint not allowing the traffic in.",0,09-10-2020,09:29 AM
414,347245,charles07,"Thank you@jmeurerI did create an SNAT from internal to external with external interface IP.DNAT from PA to an EC2 in AWS is workingI checked SG of API gateway, endpoint, lamda. It's all full allow.Are the steps I followed correct?Is the URL I used to call lambda correct?",0,09-10-2020,10:38 AM
415,347245,jmeurer,"That SNAT flow does not sound correct. The NAT rule that Destination Nats the traffic to Endpoint, should also have source translation set to the internal interface.Would you mind posting screen shots of the nat rule.",0,09-10-2020,11:07 AM
416,347245,charles07,,0,09-11-2020,06:51 AM
417,347245,jmeurer,"Assuming your IP specified it the Untrust IP and Eth1/2 is your Trust side interface, your NAT rule translated tab should look like this. This indicates that we are sending the traffic on to the API Endpoint and setting the source IP to be the internal interface of the firewall so that they endpoint knows where to respond to.",0,09-11-2020,07:02 AM
418,319743,LCMember3289,HiIs there an update or workaround for this i get the same issue.Thanks,0,04-23-2020,04:15 AM
419,319743,Ezekoli,User certificate if you are accessing secured device or adding user in authentication server. Machine certificate if you are adding machine to a domain or setting up SMTP,0,04-23-2020,04:52 AM
420,319743,MPotgieter,"Hi@EzekoliThanks for your response, but it's not quite what I'm asking. My query isn't about which type of certificate to use.When you create a certificate profile, you are able to select how the username field will be populated from the certificate (if for e.g. you are using the certificate as part of GlobalProtect authentication). The three options are Subject (which populates from the common name), Alternative Name (which populates from the Email or Principal Name depending on your choice) or None (which doesn't fill the username field at all).Everything I've read indicates that you can select a username field to add security to that process, i.e. I've got a username and password but I don't have a cert, I can't use another user's certificate if I had to get hold of one or I can't use another users machine to log on with my credentials. But if you don't need or want that extra level of security, you should be able to select ""None"".However, when I do that, I get commit failures. This is the issue I would like to address - why does the firewall fail to commit if there is no option selected for the username field on the certificate profile.",0,04-23-2020,05:07 AM
421,319743,jsayer,Seeing the same issue committing with a certificate profile if Username set to None. Tested this with 8.1.14h2 and commit was successful. Fails on 9.0.8. Support engineer tested also on 9.0.6 and saw the same commit failure.,0,06-03-2020,09:48 AM
422,319743,jsayer,"PA Support Engineer discovered that the commit failure occurs when the setting for Client Authentication is set to ""Yes (User Credentials OR Client Certificate Required)"". this appears both in the portal and gateway settings I believe. Changed this to ""No (User Credentials AND Client Certificate Required)"" and the commit was successful. This appears to be a new option in 9.0 that was not available in 8.1.x code.Trying to decipher the implications of setting that to User Credentials AND Client Certificate. We want to have the machine connect pre-logon, so not sure whether this setting will cause problems with the desired behavior or not.",1,06-03-2020,10:58 AM
423,319743,BrentA,"I'm facing the same issue, Please do update with any information you can get from them!",0,06-09-2020,03:55 PM
424,319743,tcleghorn,"This is by design. If you allow a user to connect using Credential OR Client Cert, we'd need a username from the client cert.A workaround is to set the User Name in the Certificate Profile to using the Subject Alt Name of the Certificate. When you generate the Machine Certificate for the Pre-Logon, do NOT put anything in the Subject Alt Name field. This should allow both Machine Cert users (without Cookies) and non-Machine Cert users.Best practice would be to set-up 2 Portals and 2 Gateways. One with the CertProfile (for your domain trusted machines) and one without (for your contractors).",1,07-23-2020,05:30 PM
425,319743,doug-elliott,"I used this document -- https://supportcases.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClFoCAK -- and instead of ""none"" for username in the cert profile, I used `Subject'.",0,09-29-2020,01:35 PM
426,308092,khurramq,"Hi,Did you ever get this resolved?Also come across an issue whereby Panorama login prompt does not load following a downgrade from 9.1Thanks",0,09-29-2020,05:03 AM
427,350200,BPry,"@pmchenry,You are correct, this is a known limitation within AWS. The only interface type that you are allowed is layer3, and VLAN and subinterface isn't supported at all. There's really no way to workaround that issue that I'm aware of, at that point you would be having more of a design discussion about how the environment is being built out and isolated.",0,09-17-2020,09:41 PM
428,350200,tostern,"Hi @pmchenryYes,@BPry is correct we don't support sub-interfaces in Public Cloud for now. There is no workaround for this.As already mentioned you should plan your design and to avoid this.Regards,Torsten",0,09-18-2020,12:32 AM
429,350200,Welborn,On both of the configurations above I've set the IP settings to dhcp server with a static address and dhcp client. When in client mode it doesn't get an address and when in server mode nothing can reach itUPSers Login,0,09-29-2020,03:34 AM
430,350200,tostern,"Hi@Welborni dont' understand the question. could you please explain what are you trying to do?Regards,Torsten",0,09-29-2020,03:39 AM
431,344952,OtakarKlier,"Hello,Where is the traffic failing? Check the traffic logs to see. Might need to make additional policies to allow it.Regards,",0,08-28-2020,02:44 PM
432,344952,benslade,"I've been working on a similar problem and as we're in a hybrid Azure/O365 state, we've had to implement more infrastructure than simply authenticating AD users! To cut a long story short we've go this working using SAML authentication from our AzureAD and have a hybrid connector to sync on-prem AD with AADIf you've got GP on your VM working then it's pretty straight forward to configure SAML for SSO, following this article worked for us;https://docs.microsoft.com/en-us/azure/active-directory/saas-apps/palo-alto-networks-globalprotect-t...good luck",0,09-22-2020,08:59 AM
433,349383,christucker,+1 we are looking for the same information.,0,09-17-2020,05:43 AM
434,349383,Ravindra692,"HelloI am able to get to 9.1.4 for Panorama in Azure.First, I started deploying the Panorama in Azure from Market Place. I input all the details (Names, Resource groups, NSG's, Networking info etc) in the process of deployment and come to the last step of creating the VM. Before creating the VM you should be able to download the Azure ARM template.Once I downloaded the template, you will get a zip folder which contains two files. ""Parameters"" and ""template"".Open the template file and look for the below code. As you can see in the version change it from ""Latest"" to ""9.1.2"" and then run the ARM templates. Once you successfully run this updated ARM template, your panorama with Version 9.1.2 will be deployed. Make sure your Panorama has internet access and download the updates and from there you can update the software from 9.1.2 to 9.1.4. i did the same for two Panoramas in my environment and it worked.One more thing, in Azure you have 9.1.1 and 9.1.2 as available version. you cannot deploy 9.1.4 directly since that version is not available""name"": ""[parameters('virtualMachineName')]"",""type"": ""Microsoft.Compute/virtualMachines"",""apiVersion"": ""2020-06-01"",""location"": ""[parameters('location')]"",""dependsOn"": [""managedDiskResources"",""[concat('Microsoft.Network/networkInterfaces/', parameters('networkInterfaceName'))]"",""[concat('Microsoft.Storage/storageAccounts/', parameters('diagnosticsStorageAccountName'))]""],""properties"": {""hardwareProfile"": {""vmSize"": ""[parameters('virtualMachineSize')]""},""storageProfile"": {""osDisk"": {""createOption"": ""fromImage"",""managedDisk"": {""storageAccountType"": ""[parameters('osDiskType')]""}},""imageReference"": {""publisher"": ""paloaltonetworks"",""offer"": ""panorama"",""sku"": ""byol"",""version"": ""latest""",0,09-17-2020,06:30 AM
435,349383,christucker,Thanks! I missed the template download when I tried this yesterday. Rebuilt the VM successfully with the method described.,0,09-17-2020,01:28 PM
436,349775,tostern,"Hi@careem785where do you deploy it? Azure/AWS/GCPRegards,Torsten",0,09-16-2020,06:49 AM
437,349775,JoergSchuetter,"Hello @careem785Are you talking about a setup in Azure? If so, please check the NSG (Network Security Group) for the firewall (NIC and VNET).",0,09-16-2020,06:49 AM
438,349775,tostern,when you talk about Azure then create please a NSG as shown below and attach it to the NIC. Then when you using a Public IP (Standard) then is there a implicite deny when you not attach any NSG to it,0,09-16-2020,06:52 AM
439,349775,careem785,"its in AWS and security group rules are fine , i can ping to the device but SSH and HTTPS not working",0,09-16-2020,06:53 AM
440,349775,tostern,"Hi@careem785are you using the correct ssh key pair? Look at Step 4 in that documenthttps://docs.paloaltonetworks.com/vm-series/9-0/vm-series-deployment/set-up-the-vm-series-firewall-o...Then AWS works with ssh key pairs and not with username/passwordRegards,Torsten",0,09-16-2020,06:56 AM
441,349775,careem785,"key pair is fine , i am getting ""connection refused"" error message",0,09-16-2020,06:58 AM
442,349775,tostern,did you swap the management interface?,0,09-16-2020,07:09 AM
443,349775,careem785,"no , how to do that?",0,09-16-2020,07:27 AM
444,349775,tostern,you can't doing it without having cli access to firewall. Please double check taht you are using the right interface and not that you try to connect to the untrust interface.,0,09-16-2020,07:29 AM
445,176704,vvenkatara,"Hello,We have some sample playbooks to install Palo Alto Firewalls into AWS at:https://github.com/PaloAltoNetworks/ansible-playbooks/tree/master/awsYou should be able to adapt the playbook to deploy into an existing VPC. Let us know if you have any specific questions with that.Hope this helps.Thanks,- Vinay",0,09-18-2017,02:35 AM
446,176704,smjones,"Is there an updated link for the Ansible playbook for deploying in AWS/Azure/GCP? The link provided above isn't working for me.Thx,Scott",0,09-16-2020,02:44 PM
447,176704,smjones,"***Update***I was able to find this link:https://github.com/PaloAltoNetworks/ansible-panThx,Scott",0,09-16-2020,02:46 PM
448,349297,tschuler,"Yes, that is a typo and you have the correct IP addresses. Thank you for reaching out for clarification. I should have the updated guide posted in the next couple of days.",0,09-15-2020,07:32 AM
449,344296,pili1313,"Some extra info, if I put for example value: 2 for the zone parameter I get this error:{""code"":""DeploymentFailed"",""message"":""At least one resource deployment operation failed. Please list deployment operations for details. Please see https://aka.ms/DeployOperations for usage details."",""details"":[{""code"":""BadRequest"",""message"":""{\r\n \""error\"": {\r\n \""details\"": [],\r\n \""code\"": \""ComputeResourceZoneConstraintDoesNotMatchPublicIPAddressZoneConstraint\"",\r\n \""message\"": \""Compute resource /subscriptions/XXXXXXXXXXXXXXXXXX/resourceGroups/platform-fw-rg/providers/Microsoft.Compute/virtualMachines/paloalto has a zone constraint 2 but the PublicIPAddress /subscriptions/XXXXXXXXXXXXXXXXXX/resourceGroups/platform-fw-rg/providers/Microsoft.Network/publicIPAddresses/glpgfwmgt used by the compute resource via NetworkInterface or LoadBalancer has a different zone constraint Regional.\""\r\n }\r\n}""}]}",0,08-18-2020,01:45 AM
450,344296,tostern,Hi@rpili1313did you checked that in your regions are Availbilty Zones available? Check here pleasehttps://azure.microsoft.com/en-us/global-infrastructure/geographies/,0,09-10-2020,10:21 AM
451,348032,tostern,"Hi Ravindra,there is no special configuration needed on the Palo side. You have only to make sure you route traffic correct on the azure side and that the Firewalls has the route configured too.Check this outhttps://www.paloaltonetworks.com/resources/guides/azure-transit-vnet-deployment-guideyou can compare the configuration for backhaul. it dosen't matter if it is a VNG or Express routeRegards,Torsten",0,09-10-2020,12:55 AM
452,348032,Ravindra692,Thank you. I will go through the guide,0,09-10-2020,05:17 AM
453,348032,Ravindra692,"I also have another question.When we deploy the Palo Alto Firewalls in HA (Active/Standby), how effective is the failover?I mean if we force a failover or a failover happens because of a failure, Does it take a lot of time for the failover?",0,09-10-2020,05:22 AM
454,348032,tostern,"Hi,it will not chance anything because the problem is not our firewall the problem is on the Azure side and detach and attach process.so it will be still between 2-5 min.Regards,Torsten",0,09-10-2020,06:37 AM
455,347462,tostern,"Hi Andrew,we talking here about two different things. the documentation is talking about Azure Autoscaling no we didnt use here a native HA configuration both firewalls are working independently. the is no Session Sync. the Panorama is taking care here about the increase and decrease of VM-Instances inside the VMSS and this is done via the AppInsight Metrics.the Native HA configuration is working in Azure but without a Loabbalancer in the Front or Back. look here about the Setuphttps://docs.paloaltonetworks.com/vm-series/9-0/vm-series-deployment/set-up-the-vm-series-firewall-o...I hope that helped you?Regards,Torsten",0,09-09-2020,07:22 AM
456,347462,JoergSchuetter,"HelloWe have configured HA on Azure, but it turns out that is not the best setup. You don't need a loadbalancer (and therefore no additional virtual router if you have more than one interface behind a loadbalancer).Unfortunately the failover (regardless of triggered manual or due to an failure) is very slow. The command ""hey Azure, shift IP from from interface A to interface B"" is triggered immediately. In our environment (trusted, untrusted + two additional IPs with public IP) it typically takes 3 up to 5 Minutes until the failover is completed.",0,09-09-2020,07:53 AM
457,347462,tostern,"Hi Jörg,thats correct and thats a normal behaviour in Azure. The Problem here is the API call from Azure to detach and attach the interface.Regards,Torsten",0,09-09-2020,08:10 AM
458,167031,pcaphunter,I haven't been able to get it work. PA support told us it was due to Azure limitations and the drivers they are using for their NIC's. The workaround we were provided was using the Palo Alto chrome app....,1,07-28-2017,10:51 AM
459,167031,howardtopher,"That's unfortunate. I was hoping to add that interface to my ""outside world connectivity"" dashboard, but I guess that won't be happening.",0,07-31-2017,01:13 PM
460,167031,Eric_Zuidema,"I just wanted to chime in here that we are currently experiencing this exact same issue in Azure using VM-300's. We have 3 interfaces, including the management interface, and we are only able to see traffic data for the management interface. We've tried using both the 32bit Counters (1.3.6.1.2.1.2.2.1) and the 64bit Counters (1.3.6.1.2.1.31.1.1) and both are 0.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000CmrcCACThis KB describes the exact same issue; however, the 0 values persist even when using the 64bit Counters. Is anyone able to confirm that this is in fact an Azure problem? It's very odd that some traffic and not all would be showing, especially since the management NIC is also hosted in Azure.",0,06-14-2019,12:16 PM
461,167031,BizBo,"Yep, VM300 on Azure and I get nothing but the MGMT interface.Anyone had any joy in getting this to work.D.",0,08-12-2020,01:39 AM
462,167031,glynn,"What version of PANOS are you running? If it is 9.0 or below, it will not work due to the drivers. It was fixed in PANOS 9.1:https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000PMWvCAO",0,08-12-2020,06:48 AM
463,341001,jmeurer,"he tunnel build process is documented here.https://www.paloaltonetworks.com/resources/reference-architectures/awsIn general, if it works intermittently, check your timers in your IKE and IPSec profiles. Also, ensure that only the VPN ethernet interface has the ""Automatically create default route pointing to DG provided by server"". If you have multiple interfaces, you may end up with 2 default routes in the VR that are competing with each other. If you have EIPs on multiple interfaces, then you give each its own virtual router with a 0.0.0.0/0 route pointing outbound.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClQRCA0",1,07-28-2020,10:39 AM
464,341001,tinaye-hgi,HelloThanks for your response but sadly that was not the correct solution and i am still working on the case ....,0,08-05-2020,01:44 AM
465,341286,claudec,The secondary/floating IP is configured on the active firewall only. The IP moves to the passive firewall during a fail-over event. The VM-Series admin guide has the details.,1,07-29-2020,02:20 PM
466,341286,ZuberP,"Firewall switches over correctly when the primary goes down but on Azure backend side we can't have the same floating ip on secondary firewall VM, so traffic can't find next hop.",0,07-30-2020,10:11 AM
467,340467,JoergSchuetter,"Hello @cryptoDid you already try to change the service routes? Updates are pulled using the management interface. As long as you do not facilitate NAT for this interface, you have to make use of other interfaces where Internet access is possible.",1,07-23-2020,11:48 PM
468,340467,crypto,"hi,I have three interface WAN,LAN and Management interfaces.I tried service route with other LAN interface.And then i also tried management interface as service route interface.but i still got this issue. I am using WAN interface as a NAT (WAN ) .If service route have any impact to operation ? Can i use WAN interface as source interface for service route and it is any impact to existing operaton ?",0,07-26-2020,06:51 PM
469,340467,crypto,"Hi,Now all are ok ready. i need to add service route for NTP and DNS.I also need to add access rule for NPT and DNS too.",0,07-28-2020,10:40 PM
470,340694,bit_byte,@aadarshg3Did you have any bug id regarding this issue,0,07-26-2020,11:35 AM
471,339484,Norbert527,"I used ""gsutil"" to turn on logging on the bootstrap bucket. Not much help right now since it takes an hour to see bucket access messages .......  SMH.""Access logsprovide information for all of the requests made on a specified bucket and are created hourly."" ",0,07-19-2020,11:17 AM
472,339484,glynn,"The management interface is set to DHCP and cannot be changed as you risk locking yourself out if you mis-type or otherwise enter incorrect information on the management interface. You _can_ tell GCP to assign a static IP to that interface so that whenever it sends a DHCP request, it always gets the same IP.Regarding bootstrapping, you shouldn't need to tell the FW where the bucket is located. Bucket names have to be unique in the DNS namespace so it is sufficient to specify the name you gave the bucket. The FW also has to have permission to access it and the bucket has to be configured with _all_ of the required folders (config, content, license, software) so that might be worth verifying as well.If you specify a correctly-formatted SSH key at deployment time, it should be inserted into the admin account even if bootstrapping fails. The correct format for the ssh key is ""ssh-rsa <public_key> <username>"".There are some examples of Terraform deployments with bootstrapping here:https://github.com/wwce/terraform/tree/master/gcpMost of them create/populate the bootstrap bucket at runtime. The process is the same and they might provide a template for your development.",0,07-20-2020,01:04 PM
473,339484,Norbert527,"Seeing the bucket name in a working example of code helps a lot. Thanks! About the bucket -- I have all the folders created in the bucket....but the permissions on the bucket. How do I ensure the firewall/GCE instance has the correct permissions to access the files in the bucket? Currently ""members"" of the bucket are Project owners, Editors, and viewers. And the bucket is ""multi-region"" location type.",0,07-21-2020,06:17 AM
474,339484,glynn,"That is controlled by the service scopes assigned at deployment time. Have a look at the Terraform docs for google_compute_instance for more details:https://www.terraform.io/docs/providers/google/r/compute_instance.htmlIn the GH link I posted, there are a few examples of this. Note that they could be defined in variables files or explicitly set in the TF template but would look something like this:variable scopes {type = list(string)default = [""https://www.googleapis.com/auth/compute.readonly"",""https://www.googleapis.com/auth/cloud.useraccounts.readonly"",""https://www.googleapis.com/auth/devstorage.read_only"",""https://www.googleapis.com/auth/logging.write"",""https://www.googleapis.com/auth/monitoring.write"",]}If the storage bucket is not in the same project as the FW, then you will need to grant the FW service account the permission to access the bucket. You can also make the bucket readable by anyone or by all authenticated users but that is insecure and not recommended.",0,07-21-2020,07:04 AM
475,339484,Norbert527,"""If you specify a correctly-formatted SSH key at deployment time, it should be inserted into the admin account even if bootstrapping fails.""So....the bootstrap process has to succeed or the firewall comes up with no admin password, right? If bootstrap process fails, I can't get into the firewall CLI even if my public SSH key is installed, right? Because, the firewall is asking me for the password, and it won't take the password in the bootstrap.xml file--which is the password in PDF guide in the same folder in the Repo.",0,07-21-2020,09:37 PM
476,339484,glynn,"Correct on the first question. The virtual FW does not have a built-in password the way the HW FW do since they can be deployed/accessed across the internet. By specifying an SSH key at deployment time, you can authenticate to the CLI and set the admin password for use when logging into the GUI. The SSH key gets inserted into the admin account so you would need to connect as ""admin"".If the bootstrap fails, you should still be able to get into the CLI using SSH provided you specify an SSH key at deployment time even though admin password exists on the box.It can take several minutes for the FW to completely boot up post-deployment. During that time, you will get prompted for a password but authentication will fail since all of the management plane processes are not yet completely up. If after 10-15 minutes, you cannot authenticate, chances are that the SSH was not formatted in a manner that the FW could accept.If the bootstrap fails but you can get into the FW, you can see information from the bootstrap attempt with the following command:show system bootstrap status",0,07-22-2020,11:03 AM
477,339484,Norbert527,"So the firewall deploys now--kinda. I set the bucket to just allow all users from everywhere, deployed a firewall, and I was able to SSH into it.  So I'll need to look at the scope in TF and the bucket permissions more closely. Now, auto-commit hangs, and the firewall says bootstrap failed, but the name of the firewall is the name that I set in init-cfg.txt. So it's reading the bootstrap file, and I assume, the bootstrap.xml file. The hung auto-commit issue is a separate issue I think?Thanks for helping with this, Glynn. ",0,07-23-2020,08:50 AM
478,339484,glynn,"Progress at last.I've seen the initial auto-commit fail/hang before. Hangs usually sort themselves out if you give it some additional time. It might be instructive to temporarily remove the bootstrap.xml file so that all you have is the init-cfg.txt file in the config directory. That should allow the FW to bootstrap but remove any configuration weirdness from the picture. You should be able to access the CLI via SSH key authentication and then use ""show jobs all"" to quickly check the status of the initial autocommit. If it is successful, then you can look at your boostrap.xml file more closely.If nothing else, you can have the TAC look at it. Since you can now access the FW, they should be able to take a peek and tell you what's going on.",0,07-23-2020,09:15 AM
479,339138,craig.beamish,"Got there in the end.Had to butcher the Palo github python scripts (also clean a LOT of the errors and inconsistencies in there. that code realllly needs reviewing and error checking)removed anything referencing nlb/alb and it worked fine from there.Also had to add some steps in for firewall initilisation, as the 9.1.3 images im using are failing the panorama auto commit (saying loopback.1 has no VR configured, must be a problem in panorama pushed template?) so had to create a loop to look for that and revert configuration, update the masterkey (because the templates have no consideration for following best practices?) and then force template values in a template-stack commit from panorama before pushing the shared policies.Will document all the changes and submit to the repo in a fault ticket for the owners to fix.",0,07-22-2020,08:08 PM
480,339487,glynn,A couple of things I can think of to double-check:- Are you deploying the FW to the same region as the VPC network?- Are you using separate _VPCs_ for each interface?GCP doesn't permit you to attach multiple interfaces from the same system to the same VPC network:https://cloud.google.com/vpc/docs/create-use-multiple-interfaces,0,07-20-2020,12:41 PM
481,335188,mmclimans,"Based on the information provided, it is most likely an asymmetric route.By default, Azure propagates the VNET routes to the ExpressRoute gateway. These routes do not use the VM-Series as the next hop.If intent is to send traffic from ExpressRoute to the VM-Series, then the GatewaySubnet must have a User Defined Route that points to the firewall. Likewise, the AD server subnet's in Azure must also have a UDR that points to VM-Series. You can disable route propagation between the GatewaySubnet and AD subnet by disabling BGP route propagation within their Azure route tables.",0,07-16-2020,02:44 PM
482,338696,mmclimans,Here is a collection of Community Supported ARM templates that you can use.https://github.com/wwce/azure-arm/tree/master/Azure-Common-Deployments/v1I believe you should be able to launch any of those templates via Ansible.,0,07-16-2020,02:33 PM
483,331857,mmclimans,"I do not know if you are still looking for a resolution, but I have placed answers to some of your questions below:The public load balancer forwards the traffic to the VM-Series. The load balancer itself is comprised of 3 major components.The load balancer is just forwarding traffic from 140.242.125.50:80 to the VM-Series untrust interfaces (private IP). When the VM-Series receives the request, the firewall DNATs the traffic to the internal address in Azure. We must also apply a dynami SNAT on the policy. This is required because the public load balancer does not maintain flow symmetry. The SNAT guarantee's synchronous responses for a given request.This post may also answer your question on how to NAT inbound traffic from a public LB:https://live.paloaltonetworks.com/t5/vm-series-in-the-public-cloud/active-active-gateways-in-azure-a...",0,07-16-2020,02:22 PM
484,338324,claudec,"For your outbound flows, you can just configure a Panorama based NAT policy that uses a source translation that references the egress interface.If for some other reason a NAT policy needs to be different on each firewall in the LB pair you could just use rule targets.",0,07-14-2020,06:23 AM
485,338324,mmclimans,"The firewalls can be apart of the same Device Group and Template Stack.For inbound NAT policies, the set the source interface to the untrust NIC and the destination address to ""any"". The DNAT address must be set to dynamic-destination-translation.The example below has 2 inbound DNAT policies (jump-server and web-server) and 1 outbound SNAT (for outbound internet). Ethernet1/1 is untrust and Ethernet1/2 is trust.(Optional & only if using Azure's public load balancer): If you enable ""Floating IP"" on the load balancing rule, the original packet's destination address can be set to the load balancer's public IP. This is useful if you have multiple applications that share the same port.",0,07-14-2020,09:43 AM
486,336605,jperry1,"We have noted your question and although we are exploring our options to accomplish this in the future, as it stands now this VM-Series HA in different availability zones is not supported.",1,07-13-2020,04:44 PM
487,325262,jmeurer,You would typically do one or the other. HA is use cases where you are routing through firewalls or firewalls in a pool behind a load balancer in an application hosting scenario. There are also multi-VPC designs using a TGW. Please have a look at the Reference Architecture for some additional information.https://www.paloaltonetworks.com/resources/reference-architectures/aws,1,04-29-2020,05:17 AM
488,325262,crypto,i saw below design in your provide link. let me know can i deploy without Public LB and Internal LB ?if we don't have those LB what is the impact ?,0,07-02-2020,01:57 AM
489,325262,jmeurer,"The load balancer is your fault tolerance mechanism for the inbound traffic. For inbound you have two options essentially for fault tolerance. Use the load balancer to health check and distribute traffic to the firewalls or set up HA between two firewalls in the same AZ. HA is active passive while LB is active/active giving you better overall utilization and spend.For outbound, AWS does not currently offer route to load balancer so your only option is to configure HA with your 0/0 route pointing at the active firewall.",1,07-02-2020,08:38 AM
490,325262,crypto,"Hi ,i am still confusing. if you don't mind please help me to explain below ?",0,07-02-2020,11:28 PM
491,325262,crypto,"Hi ,i am still confusing HA setup in multi AZ.I would like to deploy Paloalto HA setup in different AZ without using loadbalancer.let me know it is possible ?If I want to do VPN between our PA and customer gateway, I still need load balancer ?",0,07-05-2020,06:15 PM
492,325262,jmeurer,"We do not currently have native support for HA across zones. Typically in a VPN scenario, you use BGP to handle the failover between the two firewalls running tunnels to both firewalls. You can use a script such as this one to handle the VPC route table. You would just need to change the path monitor to monitor something across the VPN tunnel.https://github.com/wwce/AWSCrossZoneHAI a more robust scenario, you would use a Transit Gateway and the on-prem aspect of the reference architecture to treat the firewall as an inspection zone in the routing path.",0,07-06-2020,06:22 AM
493,325262,crypto,"Hi ,As per your recommendation , we should use load balancer or we should use transit gateway ,correct ? whatever we use loadbalancer or transit gateway,we still use PA firewall as VPN gateway ?",0,07-08-2020,10:06 PM
494,325262,jmeurer,"If using the TGW, vpn to the TGW rather than to the firewalls and use the TGW routing mechanism to route through the firewalls before going to the spoke VPC. If using a single VPC, vpn to a VGW attached to the VPC and use Ingress Routing to route through the firewalls. If you VPN to the firewalls and they are not configured for HA, you either need to SNAT the traffic or use some additional scripting to update the VPC routing to avoid asymmetry.I believe you could benefit from a white board session with one of our SEs. Reach out to your local account team and they can assist with locking in a design that suites your environment.",1,07-09-2020,07:03 AM
495,306077,JoergSchuetter,"HelloOne option is to bind the public IPs (bound to the web-servers right now) to the outside (untrusted) interface of the firewall.There might be other ways, but the one depicted above worked at least in my environment.",3,01-09-2020,12:24 AM
496,306077,JimMcGrady,"A related question; If i have an Azure VM with IP 10.1.1.4, i can have it route via my PA firewall bidirectionally. Outbound traffic from 10.1.1.4 would be source natted behind the firewall's public interface. Inbound traffic would require a public IP on the firewall's public interface, or on an external load balancer in front of the firewall. A destination nat will deliver the inbound traffic to 10.1.1.4.But what happens if 10.1.1.4 is assigned a public IP in Azure? The Palo has no knowledge of this public IP and only handles the ranges it has routing for. Say public ip 13.75.5.5 has been assigned to 10.1.1.4. Traffic to 13.75.5.5 will be translated by Azure to 10.1.1.4 and delivered directly to that VM. The VMs replies will come from 10.1.1.4 and route via the Palo. The Palo will see this as an asynchronous session and drop the traffic. Is this understanding correct?",0,07-02-2020,08:18 PM
497,306077,jmeurer,Your understanding is spot on. That PIP should be moved to the FW or ExtLB and natted to ensure proper bi-directional flow.,0,07-02-2020,08:41 PM
498,259088,jmeurer,"Do you have a corresponding route in subnet 2 pointing to the firewall for subnet 1? If you do not, azure will assymetrically return the traffic directly to the server rather than return routing through the firewall due to the VNET route.",0,04-29-2019,08:27 AM
499,259088,LukeBullimore,"Hi@jmeurerThanks for your input. Yes the UDR for subent 2 is there.Any other ideas?Thanks,Luke.",0,04-29-2019,08:31 AM
500,259088,jmeurer,"I assume the firewall has corresponding routes for both subnets pointing to the first IP of the internal subnet the firewall is attached two.Also, check to ensure the interface has IP Forwarding enabled on the azure side. If you do need to change this setting. Reboot the firewall. I have seen it not apply until after reboot.https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-network-interface#enable-or-d...From there, double check your NSGs.Since this intrazone traffic, it should be allowed, but you may not be logging it due to the inherent rule. Override logging on intrazone, it may give you some further information in the Monitor.",0,04-29-2019,08:38 AM
501,259088,LukeBullimore,"Hey@jmeurerFirewall routes exist and are correct.IP forwarding enabled on all interfaces. I've also rebooted the firewall.nSGs are all allowed.I've done logging on the policies but just show ""bytes received: 0""I've tried with a NAT rule to source NAT and not, makes no difference.",0,04-29-2019,08:49 AM
502,259088,jmeurer,You have hit all of the usual culprits. Time to get a TAC case open.,0,04-29-2019,08:53 AM
503,259088,dmaynard,Is Subnet 2 a gateway subnet?,0,04-29-2019,09:36 AM
504,259088,LukeBullimore,Hey@dmaynardNope! It's not a gateway subnet.,0,04-30-2019,12:53 AM
505,259088,LukeBullimore,Found out the issue.. the static routes on the firewall were pointing to each .1 address of the subnet rather than the .1 address of the address range assigned to the VNET,1,04-30-2019,06:56 AM
506,259088,atboy1607,Can you elaborate little bit ? you are saying you pointed static route on Palo Alto to VNET .1 IP ? and not first IP in subnet of interface of firewall for example eth2 ?,0,03-10-2020,07:12 AM
507,259850,Louey_Bencheikh,"Hello,can you share your Deploy.Json file please ?Louey",0,07-01-2020,05:29 AM
508,333892,jmeurer,You could potentially run the following command but it sounds like you have lost access entirely. Interface Swap just moves the management to ETH1 of the instance which may have a different security group that is blocking access. You may want to try adding a bastion host and access the firewall from within the VPC to circumvent any routing to a NatGW that is preventing inbound due to the different subnet.set system setting mgmt-interface-swap enable no,0,06-17-2020,12:06 PM
509,333892,NSS-ATPCO,"Thank you for your reply, but I ended creating a template from the old one and just rebuilding..",0,06-25-2020,05:44 AM
510,334894,jmeurer,In-place upgrades should be done from the Software Download option within the firewall gui. No need to replace the AMI from the marketplace.,1,06-23-2020,06:36 PM
511,334675,jmeurer,"Which cloud? (Network) Security Groups or GCP firewall rules could certainly be in play.Double check your route table on the firewall. You should have 0/0 route pointing to the ETH1/1 subnet first IP address and a route for your vnet/vpc cidr sending the traffic back in through ETH1/2 interface. If you have both interfaces set to DHCP and default settings, they both inherit a default route. You need to disable it on the ETH1/2 interface. Do you see the traffic in Session Browser?",0,06-22-2020,06:15 PM
512,333993,jmeurer,"You are on the right track, you don't actually need secondary IPs of the Untrust interface. We typically use Port Address Translation. The Load Balancer Backend would be the firewall's Untrust Interface IP on a custom port such as 4431. The load balancer rule would then map the front end IP on the standard port to the backend pool on the non-standard port. The firewall performs both source and destination nat. The original packet is the non-standard port traffic arriving on ETH1/1, the translated packet sources from Interface Eth1/2 and the destination is the actual application on the proper port. We document this path in the reference architecture.https://www.paloaltonetworks.com/resources/reference-architectures/azure",0,06-18-2020,07:51 AM
513,333993,JimMcGrady,Its my understanding that the Azure external load balancer cannot do port address translation. So i'd need to use an Azure application gateway to do that?EDIT: I am incorrect. The standard load balancer can use a different port for the backend traffic:https://docs.microsoft.com/en-us/azure/load-balancer/tutorial-load-balancer-port-forwarding-portal,0,06-18-2020,07:39 PM
514,295405,jmeurer,Did you attach an NSG to the Untrust interface? When you assign a PIP to the interface an NSG is required even if it allows all traffic.,0,10-31-2019,05:16 AM
515,295405,LukeBullimore,"Hey@jmeurerDidn't originally since I thought no NSG meant allow all. I've applied an allow-all one to the untrust interface now and I'm seeing traffic thats hitting the palos untrust public IP. but not the public ip of the load balancer, any ideas?",0,10-31-2019,05:30 AM
516,295405,jmeurer,"Are you seeing the Health probe traffic? Azure's LB does not easily report pool member status, you have to go to Metrics. The easiest way to determine if the Health Probes are working is to ensure you see the traffic in the FW Monitor/Session Browser and ensure it is completing.",0,10-31-2019,05:42 AM
517,295405,LukeBullimore,"Looking at the metrics, both firewalls are showing as 100% healthy.The traffic is now coming from outside -> into the load balancer -> into the firewall -> we are sending it from the firewall to the test web server but if we do a pcap on the test web server, it doesn't see anything.",0,10-31-2019,06:53 AM
518,295405,jmeurer,"Assuming your SNAT/DNAT rules are correct, routes in the firewall send the traffic through proper interface to get to the internal site, Azure route tables and NSGs all correct, I believe you are at the point of reaching out to you Account SE and Support for further eyes on console diagnostics.",1,10-31-2019,07:02 AM
519,295405,gangqu,"We ran into this very same issue. The solution for us was to enable the ""Floating IP"" in the ""load balancing rules"" section in Azure.",0,06-18-2020,05:24 AM
520,260375,DrewWilliams201aria-label9,Per PaloAlto Support: Currently Palo Alto Firewall do not support terminating 802.1Q-in-Q (type 0x8100) tag packets. It can process the packets using the outer VLAN tag as a match to create sessions.,1,06-16-2020,02:52 PM
521,333306,claudec,The public IP should not be defined on the firewall. The firewall interfaces should be configured for DHCP and have static assignments from the trust/untrust VNETS.You can optionally have the firewall learn the default route via DHCP or configure it statically.,0,06-13-2020,12:00 PM
522,333306,Ezekoli,,0,06-13-2020,12:40 PM
523,333306,Abhijeet007,"I have this set-up in HA, if I enable DHCP, I cannot define IPs there in the interface.",0,06-13-2020,12:50 PM
524,333306,Abhijeet007,"It is set to any at this point. So, I don't think that should be the issue.",0,06-13-2020,12:51 PM
525,333306,claudec,"Traditional HA is not typically the preferred solution for high availability in the cloud.That said, even with a traditional HA config, the public IP is not configured on the firewall. The interface IP addresses are from the directly connected subnets, including the IP that acts as the ""floating"" IP when the firewalls fail over.The ""floating"" IP is a private/static IP defined in azure and configured as a secondary interface IP on the firewall. A public IP is then associated with this ""floating"" private IP in Azure.",0,06-13-2020,03:14 PM
526,333306,Abhijeet007,"Got the trick. Although the way I defined the Public IP was correct. The Palo does not see the traffic with PIP, I changed the NAT and security policy to land to the Private IP on which the Public was defined and it worked.",0,06-14-2020,01:09 AM
527,333306,claudec,"That is correct. The only time, I recall, that the firewall will see the original, un-translated public destination IP is when you front end the firewall with a public standard load balancer and enable the ""floating IP"" option. In that configuration, you do reference the public IP associated with the load balancer in the NAT policy of the firewall.It wasn't clear from your original post that you were attempting to use the public IP in your NAT rule so sorry for that assumption on my part.When you associate a public IP to a private IP in Azure it handles the NAT. That is why you don't need a public IP configured on the management interface of the firewall, just like you don't need a public IP configured on the un-trust interface.",0,06-14-2020,08:36 AM
528,333189,jmeurer,"AWS does not allow of the addition of more specific routes in a VPC. Due to this, you would typically look at a multi-VPC model to achieve east-west inspection between instances. We have examples of these types of deployments in our AWS reference architecture.https://www.paloaltonetworks.com/resources/reference-architectures/aws",0,06-12-2020,08:05 AM
529,326956,andreb,"I'm not sure where you are testing from but if you are initiating your test from the Internet to access the servers on trust2, did you create a NAT statement on the Palo Alto for the traffic to allow it to be routed over the Internet?Otherwise, also confirm the subnet mask you put on the Trust2 interface. Make sure you used a /24 (or whatever the mask is for the entire subnet) as opposed to just the /32. If you use the /32 the firewall won't know how to get to that subnet.",0,05-28-2020,09:16 AM
530,330034,jmeurer,We cannot route to the backend via an HTTP header. We would typically deploy the ALB on the front side of the firewalls and use port address translation to maintain the application mapping through to the backend application. Here is a sample diagram of what that would look like. TGW is optional.,1,05-27-2020,07:14 AM
531,326158,Sec101,bumping this,0,05-06-2020,09:59 AM
532,326158,dmaynard,Are you using a distributed switch or standard switch?Information is not pulled from vCenter by firewall if distributed port group is used. If standard vswitch port group is configured it pulls the Network information.,0,05-06-2020,10:13 AM
533,326158,Sec101,"Is there a solution to this, or is this a limitation of this setup? Probably that same would happen if you directly monitored the ESXi host? That is exactly what is happening. It is using a distributed virtual switch, and that is why it's not pulling in the information. ",0,05-06-2020,12:48 PM
534,326158,dmaynard,Would look into using Panorama VMware vCenter plugin which can pull vDS info.https://docs.paloaltonetworks.com/vm-series/9-1/vm-series-deployment/set-up-a-vm-series-firewall-on-...,0,05-07-2020,10:34 PM
535,326083,jmeurer,We usually design away from a zone-based architecture and leverage the Azure Load Balancer with a 1 arm design to achieve fault tolerance and scale. It does move you to a subnet based policy design which is just as secure given Azure inherent capabilities to prevent spoofing. Please refer to our reference architecture for more details.https://www.paloaltonetworks.com/resources/reference-architectures/azure,1,05-05-2020,08:25 AM
536,325924,jmeurer,That template stack is TAC supported. Please open a case with Support to investigate further. That error on its own does not provide enough information to diagnose. A few questions to consider.Are there any other errors earlier in the CFT?Does your account have permissions to create Lambda Functions?Have the zip files been uploaded to your S3 bucket and did you overwrite the default bucket in the template creation?,0,05-05-2020,08:18 AM
537,325295,jmeurer,The load balancer is typically not an option for VPN termination b/c there is no persistence as the port moves through phases of negotiation. I typically recommend that you terminate the VPN on the Azure VGW and use our reference architecture method of routing through the firewalls from the gateway subnet. More information can be found here.https://www.paloaltonetworks.com/resources/reference-architectures/azure,0,04-29-2020,05:20 AM
538,175890,johnsonto,"Amresh,Would you be able to share any of your configuration? Todd",0,09-25-2017,07:11 PM
539,175890,Amaresh,Thanks for your reply.Is it ok If i upload the screenshoot of the config,0,09-26-2017,07:26 AM
540,175890,johnsonto,"Amaresh,Sure. I will take a look when I can. Thank you,Todd",0,09-26-2017,08:36 AM
541,175890,Amaresh,,0,09-29-2017,02:28 AM
542,175890,Amaresh,,0,09-29-2017,02:35 AM
543,175890,Amaresh,Also configured routes and policies .Note - The interface is mapped with Public IP on azure.,0,09-29-2017,02:36 AM
544,175890,johnsonto,What do your logs say? Have you run a debug on the ike yet? If you are trying the connection take a look at the mp-log ikemgr.log and look at the messages. Watching that will give you a good indication where the issue might be. Are you able to ping the public IP peer on the remote side? I would also go over your ike/ipsec settings from the vendor and make sure you are matched up. Todd,0,09-29-2017,06:20 AM
545,175890,mgarg,look at the system logs and filter with (subtype eq vpn) .If you seel messages saying failing due to negotiation timeout then take a packet capture on palo alto and checkpoint to check if you are sending/receiving isakmppacketsRun a test vpnike-sagateway <gateway> and have a look at mp-log ikemgr.log for more info,0,10-02-2017,04:55 AM
546,175890,Amaresh,Is there any docs available for the config of site to site VPN/Remote access VPN  in azure palo alto .Note - I do have docs related to appliance box.,0,10-04-2017,01:31 AM
547,319505,JoergSchuetter,"The IP address should defined as a static IP in Azure. You can add multiple secondary IPs (static) as well. All of them can have a public IP.On the firewall, configure the IPs as static. The primary IP should have the matching netmask (e.g. /24), but the secondary IPs should be listed with /32.Now",0,03-31-2020,01:49 AM
548,319505,stdragon,@JoergSchuetterThat did the trick. Thank you!,0,03-31-2020,02:31 AM
549,318354,JoergSchuetter,"Hello @doug-elliottWe did a downgrade from 9.1.x (don't know the exact details) to 9.0.6 (in Azure). Not sure if this can be compared to your situation, since the 9.1 was not configured at all (besides the mgn interface and the local admin user). Keep in mind that the default user (admin) might not be configured. In the deployment task we provided a different user name.",1,03-26-2020,07:43 AM
550,318354,dleitzel,"I ran into the same issue when I tried 9.1 down to 9.0.4. What did work was 9.1 down to 9.0.6 then down to 9.0.4. Not sure exactly why a straight shot down to 9.0.4 isn't working, but adding an intermediate step to 9.0.6 does.",1,03-26-2020,01:44 PM
551,318354,jmeurer,BTW...9.0.4 is available in Azure for direct install. It might be cleaner to install 9.0.4 directly and restore your config.,1,03-26-2020,01:52 PM
552,318354,doug-elliott,"Thanks for the solution, I found this to be the way to go. As a follow up to the other replies, I made another attempt to downgrade to 9.0.4 with another firewall (the HA partner) by downloading the base and attempting to install 9.0.4. Same result. 9.1.0-h3 was installed as part of a solution template I used from Github. For the replacement firewall, decided to deploy a single firewall at PANOS 9.0.4 and avoid the downgrade. Much better idea so be careful with solution templates and what they deploy.Thanks for your responses.",0,03-26-2020,06:46 PM
553,318526,jperry1,on the firewall from the CLI runshow bootstrap statusmake sure your Panorama mgmt interface is accessible from the IP's the firewalls are attempting to connect frommake sure you have a valid VM-auth key as well.,0,03-25-2020,10:26 AM
554,318526,nkatSira,Ping works for panorama serverIt ahs right auth codeBootstrap command shows all success.Bootstrap Phase Status Details=============== ====== =======Media Detection Success Media detected successfullyMedia Sanity Check Success Media sanity check successfulParsing of Initial Config SuccessfulLicense Install Successful Successfully installed license key using authcode xxxContent Install Successful Successfully installed ContentAuto-commit Failed Bootstrap failed.Parsing of Initial Config SuccessfulLicense Install Successful Successfully installed license key using authcode xxxContent Install Successful Successfully installed ContentAuto-commit SuccessfulThanks,0,03-25-2020,10:45 AM
555,318526,jperry1,Not auth code. you have a to generate an auth-key on the Panorama and add it to your init-cfg.txt file when you bootstrap. If you don't have a vm-auth-key then you will not be able to bootstrap to Panorama. So not the auth-code but auth-key,0,03-25-2020,10:59 AM
556,244930,jmeurer,"Yes, we announced our intentions here.https://researchcenter.paloaltonetworks.com/2018/11/reinvent-2018-update-aws-security-hub-integratio...You can build it out manually today, it works and has been tested internally. We will be releasing additional documentation and templates soon.I would recommend reaching out to your account team for additional information.",1,01-04-2019,10:37 AM
557,244930,mike,"Thanks@jmeurer.Is there an ETA on the documentation?I've asked our SE for more details.Yes, we announced our intentions here.https://researchcenter.paloaltonetworks.com/2018/11/reinvent-2018-update-aws-security-hub-integratio...You can build it out manually today, it works and has been tested internally. We will be releasing additional documentation and templates soon.I would recommend reaching out to your account team for additional information.",1,01-07-2019,07:11 AM
558,244930,Cdchamberlin,"Hi @jmeurerAny updates on the documentation? I'm interested in securing traffic flowing Inbound, East/West and Outbound with VPC insertion and VPN insertion. Particulary interested in taking advantage of ECMP VPN to connect the VM_SERIES to the TG. Any documentation would be greatly appreciated.Thank you.",0,03-09-2019,06:10 PM
559,244930,jperry1,Here is some information on Transit Gateway manual deployment as well as a YAML template for automated deployments. Hope this helps.https://github.com/PaloAltoNetworks/TransitGatewayDeployment,0,03-09-2019,06:53 PM
560,244930,Cdchamberlin,"Hi@jperry1,My concern with this design is the VPC attachment from TGW SN to the TGW. Rather than using ECMP VPN links 'that I have been unable to find documentation on', the data sent across that connection will be in the clear; right?What are your thoughts on that?",0,03-11-2019,01:11 PM
561,244930,buzor.okoye,"Fantastic documentation here in the manual buildhttps://github.com/PaloAltoNetworks/TransitGatewayDeployment, I think you left out one thing. A need to add default route on FW2 pointing to eth1, otherwise the outbound traffic will be dropped by the firewall.",0,02-06-2020,06:21 PM
562,244930,DewhirstR,"I am on my third or fourth attempt to walk through the Manual build guide and every time I reach Page 22, step 8, the TGW Attachment ""attach-spoke1"" is not available as a target. Only the tgw-security gateway.",0,03-10-2020,12:39 PM
563,244930,jmeurer,Please switch the deployment guide and reference architecture here.https://www.paloaltonetworks.com/resources/reference-architectures/aws,1,03-10-2020,12:44 PM
564,244930,Cdchamberlin,"Hi@DewhirstR,Hope all is well and you get this worked out.Take a look at page 13-15 and verify the VPC attachments for both spokes to the TGW. Verify Associations in the TGW Route Table for the VPCs.",0,03-10-2020,01:08 PM
565,253849,jmeurer,"While it is possible, I would not recommend going this route.To make it work, you need to be diligent in ensuring your UDRs point to the correct firewall IP for the bidirectional traffic. One thing that jumps out at me is that your VR is utilizing E1/3 interface for the Trust 2 routes but you do not have E1/2 specified for the Trust 1 routes.Another common issue is that manually added Azure Interfaces typically do not have IP Forwarding Enabled in the IP config. Check this on your E1/3 and E1/2 interfaces.With that said, this model does not hold true when you introduce the Internal LB with HA Ports for Fault Tolerance and Scalability. In order to introduce this model, a single LB Front End IP and single Interface per Firewall needs to be used for all East/West/Hybrid routes to ensure symmetric routing and persistence due to Azure's hashing algorythm. This results in Security Policies that are subnet based and not zone based.You can use the Transit VNET template as an example.https://github.com/PaloAltoNetworks/Azure-Transit-VNet/tree/master/Azure-Transit-VNET-1.0",2,03-14-2019,07:18 PM
566,253849,Edwardo,"Hello@jmeurer,Thank you so much for your help!! Looks like the issue was that I did not enabled IP forwarding when I created the Azure NIC for the Palo Alto second trust interface. I also added the interface name for th estatic routes on the Palo Alto VR for better reading.Regarding the model that you are telling me, what will be the recommended arquitecture if I only have one firewall?? All models that I have found on Palo alto documentation seems to be for HA.. Also, is there a use case where I have one firewall that I will want to have load balancers and/or other Azure resource?Is the model that you told me for HA, or it can be applied to a single firewall? Just want to know possible deployments. I only have one subnet with aroudn 20 servers that I want to protect with a single firewall.Thanks again!",1,03-15-2019,08:01 AM
567,253849,jmeurer,Your model works for single firewall. My point was more so if you want to consider Fault Tolerance in the design when adding a second firewall. No need for the added complexity of the load balancers in a single firewall use case.,1,03-15-2019,08:25 AM
568,253849,Edwardo,"Thanks for the prompt reply. I see, I will stick with the one interface approach to have the versatility to change to an HA model if needed in the future.Thanks again!",0,03-15-2019,11:25 AM
569,253849,atboy1607,"We are running into same issue where in palo alto VM ( NVA) is deployed in HA on azure using design mentioned below.https://docs.paloaltonetworks.com/vm-series/9-0/vm-series-deployment/set-up-the-vm-series-firewall-o...Looks like Palo Alto interface is not routing packet .I checked routing is fine with azure UDR and on Palo Alto VR , issue is only when traffic hits palo alto floating IP interfaces.Anyone faced same issue ? Basically issue we are facing with HA deployment .",0,03-10-2020,03:06 AM
570,314912,Werpet,"Nevermind,It's working.",0,03-07-2020,02:26 AM
571,312991,LukeBullimore,"Hey@JimMcGrady,When doing a firewall failover, how long are you waiting between checking interface IPs? The reason for this is because using the Plugin for failover can take a few minutes. The recommended method to deploy VM series for high-availability in Azure is with two VM series deployed into two availability sets that sit in a load balancer sandwich.Thanks,Luke.",0,02-26-2020,03:59 AM
572,310624,jmeurer,There is an additional step necessary to export the 0/0 route. Please have a look at this article. https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000CltUCAS,0,02-11-2020,08:45 AM
573,310624,hafeezy2j,@jmeurer Just tried that and it didn't work.It removed more specific routes which were propagated before.,0,02-11-2020,10:00 AM
574,310624,jmeurer,Do you have an existing 0/0 static in the VPC route table? We will not override that route.,0,02-11-2020,10:07 AM
575,310624,hafeezy2j,@jmeurerShow routing protocol bgp rib-out doesn't even show 0/0 default route. Pan-os 9.1 has additional setting which I'm missing. I have deployed similiar setup with 8.1.4 (later upgraded to 9.0.6) and it works as expected.,0,02-11-2020,12:12 PM
576,310624,jmeurer,"at this point, it might be good to get a TAC case open. I have not tried Transit VPC with 9.1. I would be curious, if you add a static route in the vpc pointing to the vgw, does the traffic flow?",0,02-11-2020,05:23 PM
577,310624,dmaynard,@jmeurerTransit VPC is community supported not TAC supported.For additional clarification:As this is related to route propagation with the VM-Series firewall it would be TAC supported for assistance within the PA-VM.Issues related to deployment and automation for transit Arch would open issue in github.For assistance open issue in github.https://github.com/PaloAltoNetworks/aws-transit-vpc,0,02-11-2020,05:26 PM
578,310624,jmeurer,I labbed it with a single firewall running 9.1 and the 0/0 exported to the VPC route table as expected. Please post screenshots of your VR BGP settings and AWS route table for review.Where is your 0/0 route configured in your firewall? Do you have a static to the first IP in the subnet or do you have DHCP configured to Automatically create the default route?,0,02-11-2020,10:11 PM
579,307096,Matt_Farnan,We ended up giving the firewalls internet access during bootstrapping to resolve this issue.,0,02-07-2020,08:27 AM
580,308540,jmeurer,We would typically recommend a different set of firewalls for inbound traffic outside of the Transit Firewalls. They would then either sit in the VPC with the application or connected to the VPCs via a peering link. This is to alleviate the fact that Transit VPC firewalls are active/passive in terms of routing load and an inbound design is active/active resulting in a possible overloaded firewall.Knowing that this is not always feasible. You can use a public-facing ALB/NLB in front of the firewalls and then SNAT to address that has been distributed via BGP to the spokes. This would either be one of the Ethernet addresses or a loopback. Do not SNAT to the tunnel address as they are not fault-tolerant on a tunnel failure.,0,01-29-2020,08:54 AM
581,308540,hafeezy2j,@jmeurer Do you happen to have the documentation or link which could guide me on your purposed solution?,0,02-03-2020,07:41 AM
582,308540,jmeurer,There is nothing public-facing that directly lines up. This is more of a blending of a couple of designs. It would be beneficial to engage with your account team to have a more tailored conversation to your specific needs.,0,02-03-2020,07:57 AM
583,308540,hafeezy2j,@jmeurerOn the page 12 of the aws-transit-vpc-model-deployment-guide there is a way to create an inbound NAT on Transit firewalls. My question is how can you ensure that same elastic ip address is failed over to the other firewall just in case if it looses connectivity the subscriber VPC which is being used for destination NAT. We would like to leverage our existing Transit VPC setup to see if it fulfills our needs.,0,02-05-2020,04:31 AM
584,308540,jmeurer,"The design on page 12 of that guide utilizes a separate set of firewalls in the spoke VPC that are dedicated to the inbound traffic for only that spoke VPC. This design is different than bringing inbound traffic in through the Transit VPC. In either scenario, the EIP/FQDN is assigned to the public-facing load balancer, it is not released if a link is down. The design you are looking for is not in that guide. It would be best communicated through your Systems Engineer.",0,02-05-2020,07:21 AM
585,308783,megrez80,"In case anyone is interested in the answer, no, the trial version is not limited.My traffic was going out a NAT gateway, not my PA-VM, and that's why it wasn't being logged.",1,02-03-2020,10:13 AM
586,308224,jmeurer,Does your management interface have a route to Panorama and vice versa? Assuming you are using the Transit VPC for VPN connectivity to on-prem that would typically not encompass the Management Interface. You may need to add a service route so all Panorama communications occur from a routable address such as Eth1/1 or a loopback added to BGP.,0,01-28-2020,05:31 AM
587,308224,glynn,You also need to allow the relevant ports from the FW to Panorama. Communication flows from the FW to Panorama on specific ports depending upon functionality:https://docs.paloaltonetworks.com/pan-os/8-1/pan-os-admin/firewall-administration/reference-port-num...The main one is TCP/3978 but TCP/28443 is necessary for the FW to pull updates.,0,01-28-2020,07:20 AM
588,228864,jperry1,BGP is BGP and it is compatible. I suggest to trouble shoot it as you would troubleshoot a physical device attempting to establish a BGP peer relationship that is getting stuck in a connect state.,0,08-30-2018,08:48 AM
589,228864,ToshiNakano,We upgareded the PAN from 7.1.14 to 8.0.10. This solved the issue. Now Azure VPN and BGP is working as expected.,1,09-07-2018,05:56 AM
590,228864,DEBABRATA_TALLY,"HI ,Can you please share the configuration.",0,01-24-2020,10:26 PM
591,303888,jmeurer,"You can find the build-out of the LB sandwich with TGW in our reference architecture.https://www.paloaltonetworks.com/resources/reference-architectures/awsAs far as automation goes, we do have tag monitoring with DAG update capabilities native to the firewall in AWS. That will not solve your NAT Policy question though. Other customers typically build the firewall API calls into their CI/CD pipeline when the back end is built. An example of this flow can be found in our autoscale 2.0/2.1 templates. You can extract the PY code to incorporate it into your DevOps process.https://github.com/PaloAltoNetworks/aws-elb-autoscaling",0,12-16-2019,06:33 AM
592,303596,thampton,It sounds like an Interface Management profile needs to be assigned to the outside interface. Here are some links that should help.https://docs.paloaltonetworks.com/pan-os/8-1/pan-os-admin/networking/configure-interfaces/use-interface-management-profiles-to-restrict-accesshttps://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClM4CAK,0,12-13-2019,08:00 AM
593,302895,Muttley,UPDATE:The plugin does not seem to work with VPC endpoints. When I removed the endpoint and rebooted the VM-serise connects to CW public IP and works properly.I believethis is because the metrics are sent using HTTP which is not supported on VPC monitoring enpoints. At least not in EU-west-1,0,12-12-2019,08:57 AM
594,240819,jperry1,You have it right in terms of needing 2 VR's to route each health check for your ELB and ILB. you IP probes from the LB's you both come from two separate 168.x.x.x addresses. you have to use a separate VR and static route for the ILB health probe in order for the ILB to work.But i'm a bit confused because the VM-Series should only be in the backend pool of the ELB and the Web servers should be in the backend pool of the ILB. The VM-series should route traffic out of the trust side to the ILB Virtual IP address unless you have a specific reason not to.,0,11-21-2018,10:13 PM
595,240819,Ansh.mi,@jperry1thanks for your reply. Couple of points here:1. IP for health-probe for both ELB and ILB is same.2.In our setup we have an ILB where the the PA is in backend pool so that traffic initiating from Azure VM can be send to the FireYou have it right in terms of needing 2 VR's to route each health check for your ELB and ILB. you IP probes from the LB's you both come from two separate 168.x.x.x addresses. you have to use a separate VR and static route for the ILB health probe in order for the ILB to work.But i'm a bit confused because the VM-Series should only be in the backend pool of the ELB and the Web servers should be in the backend pool of the ILB. The VM-series should route traffic out of the trust side to the ILB Virtual IP address unless you have a specific reason not to.wall.My question now will this setup work with one VR on PA because in other firewalls it does work.,0,11-21-2018,11:28 PM
596,240819,jperry1,Oh ok got it. so you must be using the Azure Standard Load Blancer as the ILB. if not I would suggest this. The reason that you can't use one VR is because of the way we route. The ILB health check needs to go back out of the internet the ILB health check comes but it will take the default route which is more than likely on a different interface. To overcome this you have to have 2 VR's and place the interfaces in each VR.,0,11-22-2018,09:04 AM
597,240819,Ansh.mi,"I got that part. I currently have one VR setup where a default route from external interface and have assymetric routing allowed on on Palo Alto, so for ILB health proble syn comes on Internal Interface and syn-ack initiates from internal interface and checks the routing and moves out from the external Interface. So for some reason PA is building two session one for Syn packets coming from ILB to PA and other for response with Syn-ACK.The setup works fine with other Firewalls because we are getting ACK back from the LB.Note: Session with Syn Packet from ILB to PA is in INIT state, so I am also looking for a possible reason behind it.",0,11-23-2018,02:03 AM
598,240819,jperry1,@Ansh.miThis issue is a fundamental routing issue not a VM-Series issue. Although you are experiencing this due to using ELB and ILB in Azure this would also happen in physical firewall based on the way the PANW firewall handles routing. If this is a bahavior you are interesting in requesting to change please reach out to your account team and regarding this and they can file a feature request. Thanks for the input and contributing in the AWS/Azure Discussions board.,1,11-23-2018,10:57 AM
599,240819,sagar.debnath,"I am also facing the same issue. The trusted interface is configured as DHCP there there is no issue with Health probe I can see session getting completed in session browser, but while I switch the trust interface to static IP (10.205.96.5/24) the heath probe traffic is in INIT state.",0,12-04-2019,06:22 AM
600,300919,jmeurer,"Satish,In reviewing this and your other post which seems to be somewhat related, I would encourage you to engage your Palo Alto Networks SE. We have resources that can assist with straightening this out. Your external ALB should have a listener on the proper app port such as 443 and the target group mapping is port 15000 which the firewall is listening on. The NAT rule on the firewall will then have original source port of 15000 and a destination NAT of the internal ALB listener.",0,11-26-2019,08:19 PM
601,300919,SatishNair,Ok thanks. I have opened a case with palo alto.,0,11-27-2019,05:57 AM
602,300911,jmeurer,"Watch your routes on the firewall. The ALB fires its health probes cross zone. If you are using DHCP on your interfaces, ensure that only your Untrust interface is configured to import the Default route. You will then want to put a static route for any internal subnets that are not directly connected to your Trust interface subnet pointing to the first IP of your trust subnet.Additionally, change your management interface a static DNS server set to the second IP address of the VPC CIDR. We had an issue in older versions of 8.1 where we were not importing the DHCP assigned DNS server.",0,11-26-2019,05:09 PM
603,300911,SatishNair,The addresses are static and the default routes are correct. We use the transit gateway to connect to other accounts. In addition using an NLB in a sandwich mode works without issues.,0,11-26-2019,08:00 PM
604,300911,jmeurer,Are you using FQDN DNAT objects for NLB and ALB? ALB IP addresses change more frequently which is why I mention the static configuration of the DNS servers. Feel free to post your Route Table from the firewall for review.,0,11-26-2019,08:15 PM
605,300284,LKalicki,It was the AMI version.You can find the latest AMI from the marketplace on the page where you begin configuration.,0,11-22-2019,11:44 AM
606,299691,stravze,The interface just shows the followingInterfaceethernet1/3State InitRemaining Lease Time0 days 0:00:00IP Address0.0.0.0Gateway0.0.0.0Primary DNS0.0.0.0Secondary DNS0.0.0.0Primary WINS0.0.0.0Secondary WINS0.0.0.0Primary NIS0.0.0.0Secondary NIS0.0.0.0POP3 Server0.0.0.0SMTP Server0.0.0.0DNS SuffixDHCP Options,0,11-20-2019,04:36 AM
607,299691,glynn,"What Azure machine size are you using to deploy the FW? With 4 data plane ports, you would need at least a DS4. Also, what do the interface icons look like in the FW GUI (red, green, grey)?",0,11-20-2019,07:50 AM
608,153672,Warby,"Hello,You are correct, our PAN-OS stateful failover solution requires an interface move which cannot happen between subnets and subnets do not span AZs.For AZ redundancy, we recommend the load balancer sandwhich covered in the video you referenced. It doesn't track state between AZs but AZ failure is very rare and session restablishment for web based applications is usually transparent for the user.Make sure you are using the latest template for the auto scaling solution:https://github.com/PaloAltoNetworks/aws-elb-autoscaling/tree/master/Version-1.2HTH,Warby",1,04-21-2017,11:27 AM
609,153672,nronica,"Hello,I was investigating this issue. my problem is that I need cross AZ . VPN+NATAWS speaking, I could move the EIP of the Trust interface to an ENI on another AZ. And then, update the route tables pointing to the second ENI. This will be with some downtime, which is acceptable as this is based on AZ failure, the other system behind my nat need to recover as well.On paper, looks good. I'm wondering if there's a way to know with an external tool about the failure and initiate the failover process? and when the route is considered being down? no more ping? how about the WAN down and not the router?Thanks",0,11-14-2019,10:23 AM
610,153672,jmeurer,"Please have a look at our reference architecture for AWS.https://www.paloaltonetworks.com/resources/guides/intelligent-architectures-aws-reference-architectu...We have several approaches to Fault Tolerance, most recently including the Transit Gateway.",0,11-14-2019,10:46 AM
611,298413,jmeurer,2 Thoughts.,0,11-14-2019,04:30 AM
612,298413,nronica,ThanksI made those changesThe nat is working if the trust ENI is on the same subnet than the server I'm trying to nat.is there any way I can point other route tables to this ENI? I made the change but they can't connect to internet.Thank you,0,11-14-2019,05:03 AM
613,298413,jmeurer,"Excellent, that is a step in the right direction. Create a static route on the firewall VR to send all of the VPC subnets that are behind the firewall out of the Eth1/2 interface to the first IP in the firewall's Trust Subnet. AWS will then route it to the Server subnet.I assume the Server subnet has a 0/0 route point to the Trust side of the firewall?",0,11-14-2019,05:21 AM
614,298413,nronica,"ThanksThis is how my network looks likePalo in PublicA same subnet that the trust interface, works fineB diff subnet, same vpc, same Route Table, pointing to that ENIFor the route you mention, Unfortunately... I don't know how.. this is above the knowledge I have for this POCThis is why I tried172.31.0.0/16 is my VPC CIDR172.31.38.193 is the private IP of the ""non trust interface""",0,11-14-2019,05:32 AM
615,298413,jmeurer,"Rather than specifying your Trust side IP of the firewall as the next hop in that route. Set the next-hop IP to the first IP of the Trust subnet which is the AWS router IP.ie. if the Trust subnet is /24, set the next-hop to172.31.38.1",0,11-14-2019,05:44 AM
616,298413,nronica,"what I learning experience!My original routesThen I added the VPC CIDR pointing to the ""gateway of the trust interface"" (Trust = 172.31.123.37)New routeThanks for all your help, just documenting here if someone is on the same spot",1,11-14-2019,05:55 AM
617,298356,jmeurer,Looks like the interface is not associated with a Virtual Router.,1,11-13-2019,01:49 PM
618,298356,nronica,"I think I skipped that step.""Select the Config tab, assign the interface to the default router.""Thank you, I was fighting with this for hours",0,11-13-2019,01:52 PM
619,298364,jmeurer,"In all honestly, waiting longer and reconnect your SSH session. You will get the password prompt during the firewall start-up which could take 10-15 minutes. Once you log in with the pem file you should set a password and commit.configureset mgt-config users admin passwordcommit",0,11-13-2019,01:51 PM
620,297671,jmeurer,"I would double check that the IAM role is properly configured and assigned to the firewall. Additionally, ssh into the firewall and run the following commands for additional information regarding what may have failed.",1,11-11-2019,04:47 AM
621,297671,Muttley,"Thank you,The first command helped, second one is not available.The problems was that my security group was blocking outbound access.Stuart",0,11-11-2019,05:50 AM
622,296489,andreb,"Check the route table on the Web Server.I have found that even though you create a route in the route table for the subnet, the route table directly on the web server will still have it's default route pointing to the IGW. If this is the case, this explains why the return traffic from the web server is not showing in the firewall logs.",0,11-09-2019,04:32 PM
623,295171,BatD,"@Chacko42The UserID agent software is only on Windows Server. If you no longer use Windows server, you will not be able to have the agent.",0,10-31-2019,09:49 AM
624,285351,apatil,We will have a beta coming out in a week which will have VM-Monitoring support for GCP.,0,10-01-2019,02:14 PM
625,285351,andreb,Great. Thanks for the response.,0,10-10-2019,07:51 AM
626,289063,BatD,"@SimilityCan you clearify what do you mean by ""External IP""",0,09-19-2019,04:02 AM
627,289063,Simility,"Apologize for not being clear. By ""External IP"", I mean public ip.Ideally it should be external ip of box which host vm-series. However, when I connect to VPN, I'm getting a different unknown IP address.",0,09-19-2019,10:50 PM
628,261573,mls577,"Hello,  Do you see the VPN Phase 1 & 2 up and traffic counters incrementing?",0,05-19-2019,07:25 PM
629,261573,OtakarKlier,"Hello,If both phase 1 &2 are up, its probably the ACL firewall on AWS that is preventing the traffic.Regards,",0,05-20-2019,11:44 AM
630,261573,atboy1607,"@scottoliver , You need to check route table on AWS side to make sure it is pointing to correct VGW.Do you see packets getting encrypted on palo alto side ?",0,09-09-2019,09:19 PM
631,284894,OtakarKlier,"Hello,On the ASA you have to use a SLA. Check out these articles. The PAN is OK with multiple tunnels, just use a dynamic routing protocl between the two devices so the routes update and the PAN sends traffic down the correct tunnel. You can also use static rout monitoring or Policy Based routing. I prefer to use OSPF for simplicity.https://learningnetwork.cisco.com/blogs/vip-perspectives/2018/07/27/cisco-asa-site-to-site-vpn-failo...https://community.cisco.com/t5/vpn-and-anyconnect/cisco-asa-dual-isp-vpn-redundancy/td-p/1723979Regards,",0,08-28-2019,01:43 PM
632,284894,MUmanath,"Already we are using BGP routing protcol on Palo alto.Do you want to use ospf Routing on both Palo and ASAHello,On the ASA you have to use a SLA. Check out these articles. The PAN is OK with multiple tunnels, just use a dynamic routing protocl between the two devices so the routes update and the PAN sends traffic down the correct tunnel. You can also use static rout monitoring or Policy Based routing. I prefer to use OSPF for simplicity.https://learningnetwork.cisco.com/blogs/vip-perspectives/2018/07/27/cisco-asa-site-to-site-vpn-failo...https://community.cisco.com/t5/vpn-and-anyconnect/cisco-asa-dual-isp-vpn-redundancy/td-p/1723979Regards,",0,09-04-2019,07:06 AM
633,285241,OtakarKlier,"Hello,This is only for deployment. Once deployed it is managed just like any other firwall either standalone or via Panorama.Regards,",0,08-28-2019,01:39 PM
634,284942,jmeurer,"I would encourage you to review our reference architecture. It covers east-west flows that is the cloud reclassification of a DMZ. As designs scale, we move Azure toward transit VNET designs.https://www.paloaltonetworks.com/resources/guides/azure-architecture-guideIn addition, your SE can engage with you in a design session around cloud architectures as they typically differ from traditional DC designs due to the lack of L2 in the cloud.",0,08-25-2019,09:05 AM
635,284647,jmeurer,You need to assign a static IP address to the Interface before it can be used as a service route. Just ensure you use the same IP as what is assigned by the cloud provider.,0,08-22-2019,10:17 AM
636,284647,atboy1607,Problem is I cannot change it to static as it needs to stop VM to do that ? would it be possibel to change it to static without rebooting VM ?Secondly I dont understand why my firewall is using public ip to communicate with DC even though I have private ip assigned on management interface,0,08-22-2019,10:30 AM
637,284647,jmeurer,"You do not need to reboot to assign a static in the Firewall GUI, you leave the assignment as is on the EC2 side. You just need to assign that IP in the firewall GUI as a static. I cannot guarantee that it will not be traffic impacting though as it works through the DHCP release during the commit.As for your second question, that comes down to how your VPC routing is configured. Traffic leaves the Firewall Mgmt interface on its private IP, if VPC routing sends the traffic to an IGW or NatGW, the fabric will then SNAT to the assigned EIP. If you have a route pointing to on prem via a DX or VGW, then the traffic should remain private.",0,08-23-2019,10:06 AM
638,259683,jperry1,If you are doing HA in AWS I take it there is no plan to use a load balancer. That being the case then the interface swap is not needed. The interface swap is so that the VM-Series can receive traffic from a load balancer in AWS because it has to be sent to the first ENI. So unless you plan on taking your firewalls behind a load balancer there is no need to swap the mgmt interface. Hope this helps.,1,05-02-2019,04:41 PM
639,259683,A_Lok,Eth 1 in AWS is the the Palo Alto 1/1 interface used for HA2 (Data Link) and Eth 0 in AWS is the primary management interface and could be used for Control Link (HA1) configuration. The rest of the interfaces can be used to route data place traffic and are the elastic network interfaces that will be swapped via IAM role in case of failover.,0,08-20-2019,03:31 PM
640,283354,jmeurer,We have examples of firewalls in an ASG here. Please review and post back with any questions.https://github.com/PaloAltoNetworks/aws-elb-autoscaling,0,08-18-2019,02:34 PM
641,283354,Cdchamberlin,"I apologize for asking stupid questions. .Looking at the templates, there are many and it appears most - if not all would work.I guess I'm looking for direct guidance on the approach to take.The two firewalls I have are being load balanced under an NLB. One firewall is in AZA and another in AZB.I can export the xml configuration..With that, what template should I dig into that you suggest? I just want an ASG in each AZ.Thanks again.",0,08-18-2019,03:00 PM
642,283354,jperry1,If you would like an ASG in each AZ then you would have to use Auto Scale 1.2 template for that. Auto Scale 2.1 Template only uses one Auto Scale Group for all the AZ's,0,08-19-2019,10:00 AM
643,276586,OtakarKlier,Didnt get it ;)...,0,08-09-2019,01:09 PM
644,279696,dmaynard,https://docs.paloaltonetworks.com/compatibility-matrix/panorama/panorama-hypervisor-support,0,07-28-2019,11:23 PM
645,279696,jperry1,Panorama should automatically create a backup of the major release software version that you are upgrading/downgrading from. I would still advise you to manually create a backup config file in PAN-OS and download it as well. You will also want to understand what functionality is in 8.1 that is not in 8.0. Then be prepared to lose that functionality. Otherwise upgrading or downgrading should be straight forward. Just make sure any managed FW's are the same version or lower or you will not be able to manage them in Panorama.,0,07-30-2019,08:36 AM
646,279696,atboy1607,getting error when downgrading.Downgrade to pre 8.1.0 is not allowed for following instance : Microsoft Azure.,0,08-07-2019,11:30 PM
647,279696,hsong,"Hi, Panorama Azure VM started with 8.1 version. You will not be able to downgrade to 8.0.thank you.",1,08-08-2019,07:51 AM
648,280337,jperry1,"That would vary based on your environment and the type of traffic you inspect. You may want to look at a sample size of your data to find the value better suited for your app mix. For example, if you have high session count traffic then you may want to trigger based on session utilization table. If you have traffic that depleted dataplane cpu then you may want to look at the processor utilization. It all depends on the type of traffic you have. Our Auto Scale templates support this and you can set your ASG to have 2 FW by default. But if manually scale is what you want you will have to manually monitor this or write a script to check either metric.",0,07-31-2019,04:54 PM
649,280337,jperry1,"Also, for AWS auto scale 2.1, it supports deployment into an existing application environment.https://docs.paloaltonetworks.com/vm-series/9-0/vm-series-deployment/set-up-the-vm-series-firewall-o...",0,08-01-2019,11:48 AM
650,253018,Cdchamberlin,Push.,0,03-11-2019,01:13 PM
651,253018,hsong,"You can build VPN attachments to TGW with VM-Series and enabling ECMP. However, you will have to configureSNAT on the VM-Series firewalls (endpoint source IP will be replaced with the firewalls IPs.Regards.",1,06-06-2019,08:23 PM
652,253018,Artman1000,"Hi, Just curious if anyone has done this. I have transit gw with three route tables- security, spoke and Vpn. My VPNS are terminated in the TG with two customer gateways one for DC Vpn one for internet vpn. My issue is to get vpc spoke routes iinto my data center routes I i had to send them from my vpn route table. Traffic comes in from Data center via. e-w and leaks back via Transit GAtewat bypassing E-W day inspection",0,07-27-2019,06:28 AM
653,253018,jperry1,@Artman1000Please start a new question for this as this is not related to the question in this post. Thanks,0,07-30-2019,08:28 AM
654,204480,s.nelson,Are you MiTM the connection? I guess I am really asking why are you having to ignore the certificate?,0,04-06-2018,06:30 AM
655,204480,Dave_Fitzjarrelaria-labell,I found out you have to use a valid certificate. Either accept the cert by manually updating the keystore or use a trusted CA. We had a wildcard cert and once that was applied the connections started working and I can manage the firewall with ansible.,0,04-06-2018,07:20 AM
656,204480,unamuck,"If you are on RedHat or Centos, the easiest way to do this is to export the following environment variable before you run your playbook:This works with virtual environments as well.",0,07-24-2019,02:01 PM
657,204480,Dave_Fitzjarrelaria-labell,That is valid however I would not recommend it.This is a global setting and could be a security risk.Here are some alternatives that I have used.1. Use a valid cert2. Use a SSC and add it to the key store on the server3. Use the URI ansible module and set validate_certs=noI'm sure there are many others that could be used.,0,07-25-2019,08:40 AM
658,268726,Chacko42,@dhakad-rakeshCould you be a little bit more specific with your problem?Do you followed this guide?https://docs.paloaltonetworks.com/vm-series/8-1/vm-series-deployment/set-up-the-vm-series-firewall-o...Is the basic networking already working or do you got problems configuring GlobalProtect?,0,07-16-2019,09:52 AM
659,275017,Chacko42,"@JohnRoberts: Is the issue still persistent?I would suggest to have a log in the traffic log, if you got any dns response packets, while you experienced the issues.Nonetheless, the current preferred PAN-OS release is 8.1.8.If the issue is persitant after upgrading, please test, if other dns resolvers work better for your environment",0,07-16-2019,09:41 AM
660,271845,hsong,"The intercace not coming up: is that means no traffic flow? If it’s newly added to the VM, please make sure that disable source/ destination check of the ENI.",0,06-20-2019,12:45 PM
661,271845,ASM_Research,"I have a better understanding of the problem. In AWS , the way the IP addresses are allocated are very confusing to me. Ive read the PA documentation and I cant find anywhere were it explains how you are supposed to use the Eth0, Eth1, etc and how these map back to the Palo Alto vm's. I have to understand IP addressing in AWS land and I just cant get my head around it. If anybody has a knowledge based article that explains this please send. Also, the vm-series deployment guide IS NOT helpful for this. Yes, I read it",0,06-20-2019,02:50 PM
662,271845,jmeurer,AWS ETH0 = PA ManagementAWS ETH1 = PA ETH1/1AWS ETH2 = PA ETH1/2AWS ETH3 = PA ETH1/3This assumes you did not perform an interface swap during deployment. If so Management and ETH1/1 would be reversed so that ETH1/1 is the target of an ELB.,0,06-20-2019,03:03 PM
663,271845,ASM_Research,"Thank you. unfortunately, that brings up more questions so I think I will stop here",0,06-21-2019,08:03 AM
664,271845,ASM_Research,"Can somebody tell me this - if Eth0 and E1/1 are showing different IP addresses in teh AWS instance window, than what I have configured, what course should I take. Currently, E1 is a private ENI and Im pretty sure that wont work as my public IP address.",0,06-21-2019,08:41 AM
665,271845,jperry1,"I may have missed something but it sounds like you did the following1. configured your interfaces in PAN-OS statically2. Didn't set the AWS ipconfiguration to staticIf that is the case go back into the VM-Series and change the interfaces to dynamicFor any of the dataplane interfaces only check ""add default route"" for your untrust interface",0,06-21-2019,08:59 AM
666,271845,ASM_Research,"Thanks for the help. The problem I have now is that even though E1/1 (untrust) is configured as DHCP client, Palo Alto shows N/A for the IP address. Under ""dynamic IP int status"" everything is all zeros.",0,06-24-2019,08:03 AM
667,271845,ASM_Research,Went ahead and made it static. Seemed to work. Attribute this as a PANOS bug in 9.0.1,0,06-24-2019,01:49 PM
668,267891,jperry1,What is the actual error you are receiving? If you are using a bundle you shouldn't be on a free trial. If you haven't tried this already go back to the licensing tab and fetch licensing again.,0,06-07-2019,09:30 AM
669,267891,dd_mann,"Thanks for the response.Whenever I attempt to commit changes with subscription based functionality (i..e URL filtering) enabled I get 'No Valid License' errors.However, when I check the license page I get the following output which leads me to believe the License is valid? and there is no option to fetch the license again.",0,06-07-2019,09:39 AM
670,267891,bartoq,I'm having the same issue. This is very odd. it should the very least shows the vm-model.I will raise a case on this.,0,06-21-2019,05:13 AM
671,267891,dleitzel,I just spun up a FW in AWS and short of complaining that the sig pack wasn'tloaded the FW worked as expected.,0,06-21-2019,10:13 AM
672,267891,bartoq,"Hi all, can you please check the instance type. This was caused by chosing the wrong instance type. Vm-series PAYG model in AWS is a VM-300 model, if you do not allocate the right memory and number of CPUs, then, it wont be able to register itself to the license server. I have changed my instance type to m4.xlarge, the everything is working as expected. I can see the instance now is licensed properly (see the below screenshot). To find out the minimum requirements for VM-300, go to the following linkhttps://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClDCCA0On how to change EC2 instance type, go to the following linkhttps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-resize.html",0,06-23-2019,03:02 PM
673,267891,bartoq,"@jperry1there is no option to fetch a license in PAYG model. Once you have registrered the CPUID and serial number in customer support portal (https://docs.paloaltonetworks.com/vm-series/9-0/vm-series-deployment/license-the-vm-series-firewall/...), the instance (if properly sized) will download the license automatically.",0,06-23-2019,03:07 PM
674,272365,jperry1,VM-series in the Public Cloud only supports Active/Passive High Availability.BGP for Transit VPC is configured in an Active/Standby mode.I just wanted to clarify that before moving forward.Also a key note. Transit VPC the VM-Series is not in an HA configuration. BGP is set to ACtive/Standby but the VM-Series are not HA.,0,06-22-2019,12:59 PM
675,272027,jperry1,"Ryan,This is something you will definitely need to discuss with your account team. Physical firewalls and VM-Series firewalls have different license types so you will not be able to take a Physical auth code and apply it to a VM-Series. The account team will have a better understanding of the back end mechanics and what approach will be better suited for your scenario.",0,06-21-2019,10:17 AM
676,269064,Mark_Brook,"I do believe you need the Threat Prevention licence to get the dynamic updates for Application and Threats.The DNS sinkhole information is updated via the ""Application and Threats"" updates",1,06-12-2019,07:22 AM
677,266657,hsong,"Hi Pranjal,Please find this link, which is explaiining similar to your scenario. This template is AG --> FW --> Internal LB.https://docs.paloaltonetworks.com/vm-series/8-1/vm-series-deployment/set-up-the-vm-series-firewall-o...Thank you,HS",0,06-05-2019,07:57 AM
678,262224,OtakarKlier,"Hello,Start with the logs, where are they blocking you, set a filter with the source IP of the interface you are pinging from. My suspicion is that its either a missing route, a security policy, or a NAT rule not configured properly. Also for interfaces, they need to have an interface management profile to allow responses to ping.Regards,",0,05-28-2019,11:48 AM
679,260878,OtakarKlier,"Hello,The short answer is yes, use the zero-trust approach model and have all traffic flow through the Firewall. Since zones are limited, you can just create one internal zone and have the policies use IP's/Subnets as source/destination so the firewall can inspect the traffic.Hope that helps.",0,05-14-2019,02:44 PM
680,260878,dhakad-rakesh,"Thanks Otakar for your quick responce.If you have any reference about configuration, please share with me. thanks in advacne.",0,05-15-2019,01:49 AM
681,261001,hsong,A/A HA is not supported on AWS VM.,0,05-14-2019,04:14 PM
682,260171,jmeurer,"In a transit VPC model, cross account is not a factor. The VGW in the spoke and EIP of the firewall communicate over the open internet eliminating any cross account issues. If you are using the automated CFT, the steps to add the accounts are documented in the template instruction.In a Transit Gateway scenario, VPC insertion models natively support cross account attachments. This article speaks to TGW sharing.https://docs.aws.amazon.com/vpc/latest/tgw/tgw-transit-gateways.html",0,05-07-2019,01:28 PM
683,259982,dleitzel,"Routing should not be an issue if all of the devices are in the same VPC. The routing for the packets from the bastion directly to ip address of the web server will be direct across the fabric and will not pass thru the firewall. Typically the issue will be the security group on the web server not allowing SSH (port 22) access into the web server.If you want to have that traffic pass thru the firewall, you will have to create NAT polices inside the FW. You will need to NAT both SRC and DST addesses to insure symetrical flows of traffic to be thru the firewall.",0,05-06-2019,06:59 AM
684,259982,dhakad-rakesh,"I already added ssh 22 in security group, but still can't access to web server.",0,05-06-2019,08:06 AM
685,259982,dleitzel,Which web server have you loaded? Are you sure the server can accept an SSH connection?,0,05-06-2019,08:10 AM
686,259982,dhakad-rakesh,"Yes, Opened port 22 in security group",0,05-06-2019,08:17 AM
687,259982,dleitzel,"I was refering to the server software you call web server. What is it, Linux, Windows?? Also is this from marketplace or something you have built.",0,05-06-2019,08:19 AM
688,259982,dhakad-rakesh,Its Amazon ecs-optimized AMIsLinux,0,05-06-2019,08:53 AM
689,251992,OtakarKlier,"Hello,Unless this is a dev environment, I would honeslty wait. I always wait till at least the 3rd or 4th update before considering the newest version. Check out the release notes and see if there is something you absolutly need.Regards,",0,03-04-2019,09:16 AM
690,251992,civilised,"I have setup Ha in Azure.I'd like to wait but I have an issue forcing me to go down this route.I know pre 9.0 methodology is to use two firewalls and Panaorama but I haev an API service provider charging us per VPN so the HA will save us a bomb,Anyway I have it working. Problem is failover is 3 minutes plus . Also secondary device stops workign after 20 minutes,Shows a lot of promise once these bugs are sorted.",1,03-11-2019,05:54 AM
691,251992,Matthew_Miller,"I've deployed a few Azure HA PANOS 9.0.1 pairs.They work as expected, I've done many rounds of testing. It is true, the Azure portion of the failover can take 2 - 3 minutes for the floating IPs to move; however, the design is much more straight forward than the LB sandwich in Azure. Also, I've tested VPN/IPSec tunnels failover smoothly with the HA deployment, can't say that's even an option with the Azure LB sandwich without Azure Function/Automation updating a UDR after the pri fails.I'm curious about the previous poster's passive node not working after 20 minutes... was that issue resolved?",1,04-23-2019,10:49 AM
692,253713,jperry1,Region support for Azure Availability Zones is determined by Azure and not the NVA provider. That being said you will only be able to use the AZ's in regions that Azure supports AZ's. Have you checked Azure's list of regions that support availability zones? What regions have you tried thus far?,0,03-14-2019,08:42 AM
693,253713,Unisys-SOC,"This issue resolved because issue was with subscription, where Availability zone deployments are working fine in US Central but not in France Central.I am working with Azure team for this issue.",0,03-22-2019,02:22 AM
694,254008,jmeurer,"Rather than different interfaces, I would recommend using Port Translation or secondary IPs on one Untrust interface to glue the inbound traffic to the destination nat. As you encountered, multiple interfaces will result in complex routing that is accomplished through VR mapping internal and external interfaces together or putting all Untrust Interfaces in the same zome to over come the asymmetry with multiple 0/0 outbound routes for each interface.",0,03-15-2019,08:59 PM
695,253714,jperry1,Although i'm not familiar with Panorama mode enough to provide you suggestions I can tell you that if you plan to upgrade your Panorama to PAN-OS 9.0 you would probably want D5_v2 size For Panorama functionality questions you will want to post those questions in the general forum as Panorama is not included in the VM-Series category. But here is the Panorama admin guide which has information on sizes and config. Hope this helpshttps://docs.paloaltonetworks.com/panorama/9-0/panorama-admin.html,0,03-14-2019,08:45 AM
696,251432,OtakarKlier,"Hello,Check the logs to see if the packets are getting from one pan to the other. If not it could be the AWS ACL firewall or your security groups are preventing the communication.Hope that helps.",0,02-26-2019,02:56 PM
697,251432,ckyyuan,"So the support team resolved it.. it was due to the tunnel endpoint sitting on the same subnet as the private subnet on VPC 1.. apparently you need some subnet indicator on the 10.60.66.14 or it won't know where the gateway is, even if you hardcode the ARP. We solved the issue by making another subnet at 10.60.0.0/24 and used that for E1/1 in VPC 1.I also needed to setup static routing config on the virtual router for E1/1.Finally, we needed to run the following two commands to manually initiate the tunnel.test vpn ike-sa gateway [ike gateway name]test vpn ipsec-sa tunnel [tunnel name]",0,02-27-2019,10:10 AM
698,251074,glynn,,2,02-24-2019,05:46 AM
699,251074,LukeBullimore,"Hey@glynnAbsolute legend, that fixed it. Really don't know why I didn't think of grabbing the IP from the DHCP Client Info.",0,02-24-2019,06:15 AM
700,250411,OtakarKlier,"Hello,The generic comm error is hard to determine. However I would revcommend not upgrading to 9.0 unless there is a feature you absolutly need. There are still things they are working out with it and can cause you more harm than good, potentially.Take a read at thishttps://live.paloaltonetworks.com/t5/General-Topics/PAN-OS-9-0-Released-Stop-and-Think/m-p/249866#M7...Regards,",0,02-19-2019,09:52 AM
701,250411,sercotcs1,"Hi Klier,Thanks for your input. Exactly what was in my mind and now its clear. However I think i should at least get ready for it by upgrading to the latest maintainance release of 8.1.6. Any major issues people been reporting about this?Regards",0,02-19-2019,03:33 PM
702,250411,OtakarKlier,"Hello,I dont know since I dont run that code. However I do recommend you read hte release notes and maybe post in the general forum is anyone is having issues with that code. I do it quite often just to see what others are running into, if anything.https://docs.paloaltonetworks.com/pan-os/8-1/pan-os-release-notesRegards,",0,02-20-2019,06:56 AM
703,218978,Artman,"Hi, Were you able to figure out the problem? I tried changing the fw_ip etc to a value and removed the os.environ. Then, it errored out in the next function. Does anyone know if this works? I see no updates and Palo Alto will not provide any support on it.",0,02-17-2019,12:09 PM
704,249054,jperry1,you don't have to build the template from scratch. you can leverage the app gateway template we provide and change the firewall model to BYOLhttps://github.com/PaloAltoNetworks/azure-applicationgateway,0,02-06-2019,01:42 PM
705,249054,urite,"I'm actually not sure this will work for me after looking into it further. The challenge is I have multiple publicly available sites/resources...the bulk of which are 80/443 based, and since the AppGateway can only support a single public IP address I don't think this will work for me.Are there any other options?",0,02-15-2019,05:01 AM
706,249054,jperry1,Maybe you can consider URL path based redirection for the Azure App Gatewayhttps://docs.microsoft.com/en-us/azure/application-gateway/tutorial-url-redirect-powershell,0,02-15-2019,09:54 AM
707,249054,urite,That may work....but I don't have a highdegree of confidence as we have some proprietary webappsrunning and not sure if they will work over non-standard ports.If this won't work are there any other options that could work?,0,02-15-2019,12:43 PM
708,249344,OtakarKlier,"Hello,That would allow ssh and sftp, most common on that port, outbound from that environment. I would suggest you follow the deny all allow by exception meaning only allow traffic that needs to pass. Also make your policies as specific as possible, source/destination/ application ,etc.Regards,",0,02-08-2019,09:16 AM
709,249344,NarenderPulkam,,0,02-08-2019,09:29 AM
710,249344,NarenderPulkam,Thanks Otakar !,0,02-08-2019,09:30 AM
711,249040,jperry1,What version of PAN-OS software are you running on the firewall? is a it a VM-Series firewall or a physical firewall?,0,02-06-2019,02:01 PM
712,249040,OtakarKlier,On our side we are running a physical PAN with 8.0.14 code. On the AWS side its the built in AWS connectors.,0,02-06-2019,02:02 PM
713,249040,jperry1,I've never seen any issue like that with our VM-Series firewalls. I don't deal with the Physical firewalls but the IPsec/IKE enginee should be the same.Have you tried clearing the tunnel and reestabling the IPsec tunnel? if so and that didn't resolve the issue I would suggest opening up a case with support.,0,02-06-2019,02:08 PM
714,249040,OtakarKlier,Thanks for the suggestion. It didnt worl so I opened a support case. I'll post the solution when we find one.,0,02-07-2019,08:38 AM
715,249040,hsong,Did you set proper MTU set on the tunnel? 1427,0,02-07-2019,08:42 AM
716,249040,OtakarKlier,Yep as well as leaving it default. No Joy.,0,02-07-2019,08:46 AM
717,249040,OtakarKlier,"Ok so wierd settings, who knows where the real issue is since AWS is a blackbox.IKE settings:These are OK as aes-256-cbc, sha256, DH group14IPsec settings:aes-256-cbc, sha1, DH group 14.So it was the SHA version on the IPSec config that was causing the issues. Wont do sha256 but still estabilishes the tunnel.Gotta love interoperatability....",0,02-07-2019,10:47 AM
718,246787,mvaidyanathan,"One instance of the VM Monitoring script can monitor one Azure subscription, and it must target a set of firewalls in a device group. Even when you deploy multiple instances of the script to monitor mutliple Azure subscriptions,you can’t have multiple script instances targeting the same DG (or set of firewalls). The reason is that you may have unexpected results with which tags are registered to the firewalls in the event that you have the same IP address across subscriptions.There can also be a race condition between multiple instances of the script as each script attempts to determine the delta of tags between what is on the firewall and what is in the azure subscription.",0,01-22-2019,10:57 AM
719,246787,kleh,"Ok, so then it seems that's not the solution for us. The case is basically that we have Hub&Spoke setup in Azure with several subscriptions and the firewalls are in that HUB and should be updated with VM info from all the peered VNETs in other subscriptions. ...it was working so nice with single subscription. Would it be the same with Panorama, so it can query VM's only from single subscription?",0,01-23-2019,12:55 AM
720,246787,mvaidyanathan,"You can use the Azure plugin on Panorama to monitor up to 100 subscriptions. Please make sure to review the planning checklist and think through your device groups carefully,the details arehere.",1,01-23-2019,10:14 AM
721,245399,jmeurer,Please post any other errorsearlier on in theEvents list.Are you running this template?https://github.com/PaloAltoNetworks/aws-alb-sandwich,0,01-09-2019,01:28 PM
722,245399,JasonInsight,"Hi jmeurer,Yes, that's the template I'm running..Here's the output, I'm starting to wonder if it's permitions based, or maybe outdated ami's in the template.2019-01-09 Status Type Logical ID Status Reason",0,01-09-2019,01:53 PM
723,245399,JasonInsight,"After seeing this, I'm going to try it from a different account but I normally don't have issues deploying anything from the marketplace which is why i'm thinking it's an outdated amiAPI: ec2:RunInstances Not authorized for images: [ami-1c1d9664]",0,01-09-2019,02:04 PM
724,245399,JasonInsight,"I just tried it from a different AWS account, same thing. Does the Template need to be updated with a current marketplace image?API: ec2:RunInstances Not authorized for images: [ami-1c1d9664]API: ec2:RunInstances Not authorized for images: [ami-1c1d9664]",0,01-09-2019,02:14 PM
725,245399,jmeurer,"Yes, it does appear that Canonical has updated their AMI list. The template utilizes Ubuntu 16.04. You can update the Mappings section for the Xenial map and retest. I will work to get the repo updated.",1,01-09-2019,03:13 PM
726,245399,JasonInsight,"This fixed it,Mappings"" : {""AWSRegionAMIEC2"" : {""us-east-1"" : {""Xenial"" : ""ami-70dad51a""},""us-east-2"" : {""Xenial"" : ""ami-7ea88d1b""},""us-west-1"" : {""Xenial"" : ""ami-693d4009""},""us-west-2"" : {""Xenial"" : ""ami-70e90210""},Thanks jmeurer for confirming my suspicions",1,01-10-2019,06:23 AM
727,245399,JasonInsight,"fyi, It looks like the username and password in the document no longer works,Username: pandemo Password: demopassword",0,01-10-2019,07:48 AM
728,245399,jmeurer,That is an indication that bootstrapping has failed as that usename and password is not added until the bootstrap.xml is read from the S3 buckte. Log in to ETH0 with your pem file and a username of admin.You can utilize the following commands to verify the bootstrap process.showsystembootstrapstatusdebug logview component vm_install_mediaYou can alsoview the system screen shot during bootup to watch for bootstrap errors.,1,01-10-2019,08:34 AM
729,245399,JasonInsight,"Thank you, sir... I was able to get it figured out, permissions in the S3 bucket.Then I added my info to the bootstrap file just in case 🙂Thanksagain..",1,01-10-2019,02:31 PM
730,244585,jperry1,We have no idea what is taking place. unfortunately it sounds like something may have been corrupted and you may need to redeploy. 😞,0,01-04-2019,10:38 AM
731,243843,jperry1,This is actually a Panorama functionality issue and not a VM-Series firewall issue. You will want to move this question to the following thread.https://live.paloaltonetworks.com/t5/General-Topics/bd-p/members_discuss,0,12-19-2018,08:37 AM
732,242202,jmeurer,"Since you mention this is a new tenency, you may still be in the new/free subscription which typically does not allow Pay as you go. Bundle1 and Bundle2 are PayGo licenses. You will need to have a Pay-As-You-Go subscription on the Azure side to use the Bundles.https://azure.microsoft.com/en-us/offers/pay-as-you-go/",0,12-05-2018,05:43 AM
733,242202,IrfanFaruki,Thanks for the reply@jmeurerLet me get the team to check this.,0,12-05-2018,06:23 AM
734,242202,IrfanFaruki,"Hi,I have checked with the team. The tenancy is not in free or trial mode. So that does not seems to be an issue.Thanks",0,12-06-2018,01:58 AM
735,242202,jmeurer,"In that case, I would suggest opening a support case with the Microsoft Azure Team. That error is a Marketplace error not specific to Palo Alto Networks. Your account is not allowing you to purchase PayGo licensed instances.",0,12-06-2018,06:00 AM
736,242202,IrfanFaruki,"Hi,Can anyone confirm if its true that Palo PAYG is not support with Azure CSP?Thanks",0,12-07-2018,08:15 AM
737,242202,jperry1,For Azure CSP only BYOL is currently supported.,1,12-07-2018,08:53 AM
738,239873,jperry1,in order for ECMP to work it must be configured on both ends and at this stage it is not supported in the AWS VGW unless something has changed.in Github for our transit VPC architecture we do have a manual deployment guide. In that manual deployment guide it will walk you through1. How configured VPN tunnel from PAN with AWS2. How to configure BGP for the transit VPC architectureThe use case may not be completely the same but it should be close enough to get you going. Here are the linkshttps://github.com/PaloAltoNetworks/aws-transit-vpc/blob/master/documentation/Transit_VPC_Manual_Bui...Here is a link on how to propagate the default route after you have configured BGPhttps://github.com/PaloAltoNetworks/aws-transit-vpc/blob/master/documentation/Default_Route_to_Subsc...Hope this helps.,1,11-14-2018,02:14 PM
739,239873,Huddlebuy,"Thanks JPerry, for taking the time to suggest the 2 options. Am fairly new to the aws world, so excuss me if i use the wrong terminology. So from what I imaging, the transit vpc is using a VM series palo alto FW's in the AWS enviroment to connect to the on prem Palo alto's. So this will need to be an investment from our end to purchase the licences for this series. Is that correct.Kind regards",0,11-15-2018,01:54 AM
740,239873,jperry1,"Transit VPC is using two firewalls in a ""Transit VPC Hub"" to terminate VPN connections back to one or many VPC Spokes using the AWS VGW. If you choose to connect your Transit VPC Hub back to an On-Prem location you can use any IPSec device you have on premises to accomplish this.",0,11-15-2018,01:02 PM
741,239873,Huddlebuy,"The issue was we were trying to seperate the 2 vpn tunnelsin 2 seperate zone - which can make the pan think - packets are spoofed. Moving them to the same zone, did the trickThanks for the help.",3,12-04-2018,04:35 AM
742,227660,jperry1,You can try to use the SSH into maintenance mode method that is posted on our Live communityhttps://live.paloaltonetworks.com/t5/Management-Articles/How-to-SSH-into-Maintenance-Mode/ta-p/59635Other than that method we currently don't have a console access method in the Public Cloud,0,08-21-2018,07:45 AM
743,227660,ssghanim,I have a PA-220 firewall and while connected to putty and console port tried to access the maint by pressing M and pressing space and none worked the unit keep taking me to the login screen of the old company that lost the contract for this new company and the new company kept me as IT manager. Any other suggestion to reset this unit to factory default and start over so I can use it?,0,12-04-2018,01:39 AM
744,236700,OMatlock,"I've resolved this, able to communicate to AWS EC2 back and forth. I've corrected my screenshots above.My configuration errors:- PBF destination IPs were incorrect.- NAT rule not needed.- Was using incorrect IP when attempting to RDP from LAN resource. That's why was not showing up in my log.- Ping was not working because was not enabled on AWS security group.",1,10-24-2018,11:13 AM
745,236700,Junaid-Khan,Does the inbound from AWS to On-Prem(resource) work ?Are you using multiple-vr's ?,0,11-13-2018,04:24 PM
746,236700,OMatlock,"Sorry for my delayed response. Yes, I did get AWS to On-Premise working. I did not create a separate or second Virtual Router. Just used my default. Please let me know if I can help or provide more notes. I still have this running...",0,11-17-2018,11:02 PM
747,236700,Huddlebuy,"HiOMatlockWe have a similar issue from or end, for some reason we can't enable both tunnels at the same time- as it creates asymmetric routing. For e.g if traffic is sent from one tunnel, the PAN will reject any traffic from the other tunnel.I see you have configured both tunnel interfaces to be part of the same zone. But we have used different zone, not sure if this is an issue too?- we had to enable ECMP- later knew its not supported by AWSKind RegardsAnu",0,11-19-2018,02:57 AM
748,236700,jmeurer,"If you are refering to both tunnels going to the same VPG on the same firewall, yes, leave them in the same zone. While they do not support ECMP, they also do not guarantee the same tunnel will be active always. Putting the tunnels in the same zone will overcome IP Spoofing issue that creates.",0,11-19-2018,05:01 AM
749,236700,Huddlebuy,"Thanks for the suggestionwe will try that option as well. Also AWS suggested the belowEntering configuration mode [edit] # set deviceconfig setting tcp asymmetric-path bypass# set deviceconfig setting session tcp-reject-non-syn no# commitWe are quite hesitant to enable this gloabally, as this would also apply for non aws traffic. So enabled this via the zone protection profile - strickly for that zone.",0,11-19-2018,05:13 AM
750,236700,jmeurer,"I agree with your hesitation. In general, routing asymmetry is bad for security visilbility. I would not turn off reject no sync on your internet facing interfaces.",1,11-19-2018,05:18 AM
751,236700,Huddlebuy,thanks Jmeurer. I will try re-try this by moving to the same zone. Do you know or come across any step by step guide to the setting up process between the tunnels between on-prem palo and aws VPC's.Kind regardsAnu,0,11-19-2018,05:39 AM
752,236700,jmeurer,"I typically recommend to start with this guide.https://github.com/PaloAltoNetworks/aws-transit-vpc/blob/master/documentation/Transit_VPC_Manual_Bui...Once you have your Transit Firewalls built, you can terminate the on-prem Firewalls on the Transit Firwalls with VPNs as if they are another spoke. From there you can control policy locally or with Panorama, creating rules based on zones or subnets.",1,11-19-2018,05:57 AM
753,238387,jperry1,if you go into the GitHub repo you should see a manual deployment guide. This guide was created so that folks such as yourself that want to build one manually will have all of the steps. That should walk you through the BGP portionhttps://github.com/PaloAltoNetworks/aws-transit-vpc/blob/master/documentation/Transit_VPC_Manual_Bui...,0,11-02-2018,11:41 AM
754,238387,dmcneill,"Thanks, but I've leaned heavily on that guide for my buildout, and I'm still not seeing how this specific item is achieved, or I'm being completely oblivious.the ""Configuring BGP"" section describes setting up BGP to exchange routes with the subscribing VPCs...which I've done successfully at this point. Where I'm falling flat is getting the Transit VPC itself (and, from there, my on-premesis routers) to learn the routes to those subscribing VPCs from the Palo virtual firewalls that reside within the Transit VPC.",0,11-02-2018,12:29 PM
755,238387,jperry1,Got it. I believe I understand. I created this document to get the quad zero routes to populate throughout the BGP environment. This is specific to PAN-OS so this may be exactly what you are referring to. If you have the BGP configured already then I am pretty sure this is the last step you need.Transit VPC Default Route Prepagation using BGPhttps://github.com/PaloAltoNetworks/aws-transit-vpc/blob/master/documentation/Default_Route_to_Subsc...,0,11-02-2018,12:39 PM
756,238387,jmeurer,"The Transit VPC firewalls can distribute the Transit VPC subnets to the spokes by adding the ETH1/1 connected subnet to the BGP redistribution profile.https://www.paloaltonetworks.com/documentation/81/pan-os/web-interface-help/network/network-virtual-...With that said, the on-premisis firewalls will not learn the spoke subnets and vice versa from the Direct Connect VGW. Here is where we typically run an IPSEC tunnel between on-prem and the transit firewalls to allow for bgp peering and route exchange. You utilize the Direct Connect for IP transit and gain the benefit of Encrypted traffic in flight.",0,11-02-2018,12:42 PM
757,238387,JD-SECD,"Hi @dmcneill,You are probably not seeing routes due to how BGP operates, if BGP see's route advertisments coming from its own ASN it will not populate those routes. You can do some crafty BGP ninjaing with redistribution profiles, either import or export (in your case I think you would need do do some configuration on your VR's BGP import section).Instead of working and playing with BGP configurations. I've found it easier for me to detach the virtual gateway from the Transit-VPC. From there you you can establish your point-to-point tunnels from the transit-PANW-fw's to the detached VGW. You would also have your on prem-fw (if applicable) terminate to that detached VGW. Please see below document for a little bit more clarity:https://docs.aws.amazon.com/solutions/latest/cisco-based-transit-vpc/appendix-d.htmlFrom there you can select the option to propogate routes in the respective AWS's route tables.",0,11-05-2018,11:39 AM
758,238287,JD-SECD,"I've figured out my own solution. The solution is to use a Public Network Load Balancer. The NLB passes the source IP address to the downstream device (i.e., Palo Alto firewall).You would still need to perform the interface swap outlined in the above subsection ""Registering PANW firewalls as instances of a ALB Target group"".",1,11-05-2018,11:25 AM
759,236759,jperry1,The all depends on what type of design and throughput you are looking for?For example if you use AWS Native IPsec then you will need to setup a VGW which has a limit of 1.25 Gbps throughputif you setup VM-Series to Device your limit is only the bandwidth and the performance capabilities of the devices you are using for VPN. That will probably be the main thing to consider but I am sure there is more.,0,10-24-2018,11:45 AM
760,236759,jperry1,The AWS VGW limit is 1.25Gbps not Mbps,0,10-24-2018,11:51 AM
761,236759,junior_r,@jperry1wouldn'tVM-Series to Devicebe slower...even if I take the VM with higest resources?Thanks,0,10-24-2018,04:38 PM
762,236759,jperry1,It depends on the size VM-Series you use but certain VM-series devices will give you over 2GB throughput on IPSec. At that point you are at the mercy of your Internet speed.,0,10-24-2018,05:45 PM
763,236759,mrzepa2,"It would be best to do the VPN to AWS and let the VM firewall deal with inspection. After all, why bog down the VM firewall with the extra overhead of doing encryption/decryption? AWS VPN is also pretty easy to set up, even with BGP for dynamic routing for failover.",0,10-31-2018,12:29 PM
764,236759,jmeurer,"Without knowing more about your use case, the decision around where to decrypt will come down to routing. In general, if you terminate on the VGW, there are very limited options to have the traffic route through the Firewalls due to routing limitations within the VPC. AWS typical recommends ""Transit VPC"" designs where remote traffic and/or spoke VPC traffic can route through multiple Firewalls in a fault tolerant fashion. You can find both manual and automated Transit VPC Options here.https://github.com/PaloAltoNetworks/aws-transit-vpc",0,10-31-2018,01:16 PM
765,231918,jperry1,If this is a default build in Github then you should be able to reach out to Palo Alto NEtworks TAC for support. The GitHub Read me page will list the support policy of whether the GitHub template you are deploying is community supported or Officially TAC supported.,0,10-23-2018,09:12 AM
766,231927,jperry1,The Internal IP address of the Load Balancer should be a separate IP address. We provide a default configuration xml to upload. If you are following the deployment steps and If this is a default build in Github then you should be able to reach out to Palo Alto NEtworks TAC for support. The GitHub Read me page will list the support policy of whether the GitHub template you are deploying is community supported or Officially TAC supported.,0,10-23-2018,09:10 AM
767,231896,jperry1,"If you are using an App gateway you don't need a public LB because the APP gateway is public facing. Just note that the App Gateway is for HTTP(S) traffic only. That being said it provides additional benefits such as WAF, SSL termination and decryption etc.",1,09-22-2018,09:52 AM
768,231537,niyengar,you can always choose the byol option and enter the eval authcode in the bootstrap file.,0,09-19-2018,02:28 PM
769,231537,jmeurer,"The License type is driven by the AMI you specify in the PAGroupcft file that is uploaded to the S3 bucket. You can select the proper license type from the following list.https://www.paloaltonetworks.com/documentation/global/compatibility-matrix/vm-series-firewalls/aws-c...If you have obtained Eval licenses from your account team, you will want to use a BYOL AMI rather than Bundle 1 or 2 which are PayGo.",0,09-19-2018,02:30 PM
770,231537,Krishnasg,"Thank you both.We are planning to run transit-vpc script tomorrow.Thanks,",0,09-20-2018,07:10 AM
771,230878,jperry1,"Question 1. Is there a particular reason that you are using two separate VRs?If not I am not a fan for unecessary complexity but if you have a valid reason then please feel free.If you use a VR you have to be sure to route traffic between VR's correctly by using the ""Next VR"" setting etc or you could have a black hole.",1,09-14-2018,10:45 AM
772,230878,BeyondPalo,"We are a small company right now and don't have a full time Network Engineer/Admin/etc. so there's 2 of us that are trying to make all of this work with a consultant. The consultant built 2 VRs as I assume for some sort of extra security but I don't understand what they really do. I assume they are similar to say a SonicWall's route section; just done in something called Virtual routers but I can't be sure (the different lingo Palo uses is confusing to me as well but that's no biggie).Here's the Trust VR settings:This looks like it shunts all internet traffic over to the Untrust interface VR to handle, and then shunts all inter-subnet traffic to the gateway that the Trust interface is attached to. I would assume that gateway would know where the other subnets are once traffic hits that but it looks like we're missing something somewhere as traffic just dies at some point..Maybe we are missing routes? I understand Palo can do all this with 1 interface as we've been thinking about dropping extra NICs on the VM into each subnet to see if that helps but would hate to do that since it's not what Palo docs say for this type of setup.Thanks!",0,09-14-2018,10:56 AM
773,230878,jperry1,Are you using Azure load balancers in this scenario?Also if you can go to your CLI and run the command>show routing routePaste the output,0,09-14-2018,11:41 AM
774,230878,BeyondPalo,We are not using any load balancers right now.After running the command provided here's what I see:Thanks!,0,09-14-2018,12:04 PM
775,230878,jperry1,"Your untrust VR needs to have routes for ""NextVR"" in order to understand how to get back to the 10.x.x.x networks.",0,09-14-2018,01:10 PM
776,230878,OtakarKlier,"Hello,I second@jperry1recommendation of a single VR, unless there is an absolutle compelling reason to use multiple. Especially for a small shop such as yours. The simpler it is setup the easier it will be on you to manage it.Regards,",0,09-18-2018,08:51 AM
777,230757,Seema,Looks like I figured out the solutionHaving multiple IP based target groups for the ALB.ThanksSS,0,09-13-2018,12:18 PM
778,230708,jperry1,We should outline that in the documentation but answer is yes and no.1. You do have to create the policy yourself2. But it should be attached to your AWS useraccount/role/usergroup. So no you don't attach it to an instance you attached to an identity.there is a hyperlink in the IAM Roles for HA that provides all of that info. https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage.html#create-managed-policy-c...,1,09-13-2018,09:12 AM
779,228096,jperry1,If I understand the question correctly you can use User Defined Routes in the route table. You can state the IP's that have internet access to go to the internet gateway for 0.0.0.0/0.You may have more context but based on what I see this would be the way to move forward.,0,08-24-2018,10:05 AM
780,228096,OtakarKlier,"Hello,Also you can force static IP's onto your Azure servers so that they wont change. Another way would be to use dynamic IP's and use the automaticlly created DNS entries as your allow source/destinations.Just some thoughts.",0,08-28-2018,10:03 AM
781,228117,jperry1,VM Series in AWS supports Active/Passive only and must be in the same Availability Zone. Here is where you can find more information on this setuphttps://www.paloaltonetworks.com/documentation/81/virtualization/virtualization/set-up-the-vm-series...,1,08-24-2018,10:08 AM
782,228117,ksudheer,Dearjperry1Thanks much for your inputs.Will go through the link.,0,08-24-2018,02:23 PM
783,228117,OtakarKlier,"Hello,Also check out the documentation on AWS, they have best practives and deployment guides:https://www.paloaltonetworks.com/documentation/81/virtualization/virtualization/set-up-the-vm-series...Cheers!",0,08-28-2018,10:01 AM
784,227874,jschamp,"Ran it, created a subscriber VPC, am getting this error in the createNewPaGroup CloudWatch log. The step function shows there should be a ""check stack"" lambda executing immediately after but it does not get created nor does it run. The process just dies here.An error occurred (AlreadyExistsException) when calling the CreateStack operation: Stack [PaGroup58] already exists: AlreadyExistsExceptionTraceback (most recent call last):File ""/var/task/createNewPaGroupLambda.py"", line 48, in lambda_handlerresponse = pan_vpn_generic.createNewPaGroup(region, result['PaGroupName'],config['PaGroupTemplateUrl'],result['PaGroupName'],config['SshKeyName'],config['TransitVpcMgmtAz1SubnetId'],config['TransitVpcMgmtAz2SubnetId'],config['TransitVpcDmzAz1SubnetId'],config['TransitVpcDmzAz2SubnetId'],config['TransitVpcTrustedSecurityGroupId'],config['TransitVpcUntrustedSecurityGroupId'],config['PaGroupInstanceProfileName'],config['PaBootstrapBucketName'], str(result['N1Asn']), str(result['N2Asn']), config['TransitVpcDmzAz1SubnetGateway'], config['TransitVpcDmzAz2SubnetGateway'])File ""/var/task/pan_vpn_generic.py"", line 552, in createNewPaGroupOnFailure = 'ROLLBACK'File ""/var/runtime/botocore/client.py"", line 314, in _api_callreturn self._make_api_call(operation_name, kwargs)File ""/var/runtime/botocore/client.py"", line 612, in _make_api_callraise error_class(parsed_response, operation_name)botocore.errorfactory.AlreadyExistsException: An error occurred (AlreadyExistsException) when calling the CreateStack operation: Stack [PaGroup58] already exists",0,08-22-2018,01:35 PM
785,227874,jperry1,"Because the Transit VPC is based on the ""account number"" You will have conflicts in trying to deploy 2 transit VPC solutions. Cloudtrail and cloud trail lamba performs alot of action base on account number and I can see the PA-Groups and spokes causing a conflict. That being said Transit VPC wasn't designed for this use case.",0,08-24-2018,09:29 AM
786,227874,jperry1,"We try to shed light over certain things in the Git Hub repo. For this particular question you asked when you goto to the Transit VPC Solution Overview link below in GitHubhttps://github.com/PaloAltoNetworks/aws-transit-vpc/blob/master/documentation/solution_overview.mdThen search by the word ""account"" you will seeWhen a solution is community supported as the support policy on GitHub states it's more of an initial run. it doesn't mean it will never be officially TAC supported and as the demand grows and the feedback on functionality increases it allows us to take that information into consideration when there is an official release. That being said we will definitely take the option to have 2 Transit VPC's deployed within the same account into consideration moving forward. Thanks for the use case",0,08-24-2018,09:39 AM
787,226542,jmeurer,"Yes, you can deploy our V2.0 Autoscaling template from GitHub, you will have an ALB externally with anautoscale group (ASG)for the firewall. You can then manually create the NLB with a Target Group pointing to the firewall. You would then update the ASG with the new target group. Any autoscaling events that occur will add or remove the firewall from the NLB's target group.https://github.com/PaloAltoNetworks/aws-elb-autoscaling",1,08-09-2018,07:10 AM
788,226542,hsong,"So, Is it basically replacing the external ALB from V.2 autoscalling template with manually built NLB?",0,08-09-2018,07:31 AM
789,226542,jmeurer,"I would set it up in parallel, there are some other automations that you could impact by deleting the ALB entirely. You can delete the Listener rule so it does not handle any traffic.",1,08-09-2018,07:59 AM
790,226542,8kmiles,I have alreadydeployed V2.0 Autoscaling template from GitHub for http/https traffic. LikeALB--->Auto-Scale Palo Alto firewall --->NLB--->Backend ServerBut now my requirement is for non-http/https traffic whether Autoscaling features will support or not? If yes can you just let me know how to deploy or any template need to use.Proposed Traffic flow:-NLB--->Auto-Scale Palo Alto firewall--->Backend serverORNLB--->Auto-Scale Palo Alto firewall--->NLB-->Backend server,0,08-09-2018,10:31 PM
791,226542,jmeurer,"Either of the proposed flow will work, it just depends on if you need LB in front of your backend servers.As for what to change.1. Create the front door NLB.2. Add the Firewall Untrust side to the Target Group of the newly created NLB.3. Add the newly created Target Group to the ""Target Groups"" field on the Details tab of the Firewall Autoscale Groups created by the ALB CFT.",0,08-10-2018,05:50 AM
792,226542,8kmiles,"Done the same thing but getting as ""None of these Availability Zones contains a healthy target. Requests are being routed to all targets.""1. Created NLB in frontdoor and backend.2. Deployed the VM-Series Auto Scaling Template for AWS (v2.0)3. Remove the listener rules in ALB.4. Frontdoor NLB has routed to Auto Scaling group.5. Backend NLB routed to backend target group.6. Tested from Internal backend NLB to backed target gorup which is working perfectly.What i found is that from Auto scaling group to backend NLB integration which i stuck. How to do that? and why unhealthy status is showing due toAuto scaling group to backend NLB integration or some other reason?Traffic Flow:-NLB-->VM-Series Auto Scaling-->NLB-->Target Group backend serverThanksKS",0,08-13-2018,10:35 PM
793,226542,jmeurer,Did you create a Security policy allowing the traffic and a corresponding NAT rule to map the traffic to the internal NLB? The NLB sends the health probes on the port that the backend servers are configured on unless you have overridden that port. ,0,08-14-2018,05:48 AM
794,226542,8kmiles,"Finally, it works for me after configured Destination NAT and Security Policy, Swapping mgmt interface in one of the Auto Scaling Palo Alto instance.But this won’t full fill our expectation by mixing template and manual configuration, which is not compatibility with each other.Because there are many things we need to change during scaling in and out.Like I’m giving one example below:Whenever scaling in will happened we have to register those scaling in instance to the front door NLB listener rules to be working. So in real time in production environment its not possible to monitor when scaling will happened and we will have to add it immediately.Manually both NLB can be configured but not auto scaling features of palo alto firewall.Is there any Template is availble for end to end solution i.e External NLB-->Auto Scalaing Palo Alto-->Internal NLBor in coming future it will be release.That will be more usefull for everyone for deploying in Prod environment.Thanks,KS",0,08-15-2018,05:36 AM
795,226542,jmeurer,The final bits that you have encountered are possible with modification to Lambda code and either an update to the bootstrap file or integration with panorama.Your first example of a scale in/out events registering with the NLB is my early point of adding the NLB's target group to the Firewall's autoscale group.The piece that you will need to incorporate into your environment is the addition of the security and NAT policy for the NLB. That is where either addition to the bootstrap or integration witha Panorama Template come into play.Our PS and Partner community can assist with formalizing a solution for you. I would suggest reaching out to your SE for an introduction.,0,08-15-2018,06:43 AM
796,224401,BatD,"Hi@R_SharmaYou are correct, that routing can be changed for private, but not public IPs.It is how AWS works. Public IP is, as the name suggests “Public”. It is not ""your server’s"" IP, but is rather an AWS owned IP address, which is NAT-ted by AWS to the private IP of your server. You cannot control the routing of traffic for public IPs and traffic will always be sent out to internet. ",0,08-01-2018,07:13 AM
797,224401,R_Sharma,,0,08-01-2018,07:21 AM
798,224401,BatD,"@R_SharmaYou just can not use the Public IP as proxy-id, you need to use private. This is how AWS works.",0,08-01-2018,07:33 AM
799,224401,R_Sharma,,0,08-01-2018,07:38 AM
800,224401,akhar,"R_sharma.- I think AWS VPNs are designed to use a proxy at their end. The remote interesting traffic (AWS side) is NAT or PATed or proxy device IP. AWS gives the proxy IP as the parameter for interesting traffic their side. So in Proxy ID filed we never use public IP, we use proxy IP (private) only. On local PA side we will NAT the AWS proxy IP.Needless to say local/remote peer IPs will always be a public IP.",0,08-07-2018,08:41 AM
801,224972,hshah,"Please refer to the following document. Its 2000 for PAN-Os 8.0.x. I think AWS has some limitation on how may route it can learn over IPsec. In that case, you may want to advertise just default route from PANW firewall.https://www.paloaltonetworks.com/documentation/80/pan-os/newfeaturesguide/virtualization-features/vm...",0,08-06-2018,09:40 AM
802,224972,Krishnasg,that helps.Thanks for the quick response.,0,08-06-2018,10:57 AM
803,171006,Warby,"There are several options for high availability in Azure. Check out our cloud integration page and expand the Azure section for some examples:https://live.paloaltonetworks.com/t5/Public-Cloud-Integration/ct-p/Cloud_TemplatesFirewall configurations can by synchronized accross multiple firewalls using:We don't maintain session state in the public cloud as most cloud applications are designed to handle state and the infrastructure is stateless. This is true of other services as well like load balancers in Azure.If you want to have redundant firewalls for security between subnets, you will need to either:Follow the link above for examples.",0,08-10-2017,04:34 PM
804,171006,sougata,"Hi Warby, thanks for the prompt response.======================================Firewall configurations can by synchronized accross multiple firewalls using:======================================I do need some clarity on the above. Following is what I have understood:Is my understanding correct. Also, please share any configuration guide for the same, if available.",0,08-10-2017,10:29 PM
805,171006,Warby,EitherAnsible (using our API) or Panorama can keep the configs in synch post deployment (while the firewall is running.),0,08-26-2017,03:05 PM
806,171006,sougata,"Hi Warby,The subnet requirements for VM series as mentioned belowCIDR block 192.168.0.0/16, and allocates five subnets (192.168.1.0/24 - 192.168.5.0/24) for deploying the Azure Application Gateway, the VM-Series firewalls, the Azure load balancer and the web servers.Question:Is it a mandate to have 19.168.x.x/24 (subnet ./24) or we can use (/30) subnet as it will consume 1 IP for external NIC, internal nic, management nic?",0,03-08-2018,06:28 AM
807,171006,jmeurer,"Azure reserves the first 3 IP addresses for Azure services and /29 is the smallest allowed mask leaving only 3 usable in the subnet, 2 of which will be assigned to the firewalls. There are times where you may wish to bring up a new pair of firewalls in parallel and you will not have enough IPs to do so.https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-faq",0,03-08-2018,07:26 AM
808,171006,brookman,"We actually used 2 pairs of firewalls for our Azure deployment. One pair is North-South and the other is East-West monitoring. We used Standard SKU load balancers to make a ""HA"" solution. It is important to note that you have to have a LB on the trust and untrus side for this configuration. With the Standard SKU vs Basic SKU, you are able to select ""HA Ports"" meaning you don't have to specifcally call out the ports for the load balancers to forward traffic to the Firewalls. For routing, all on-prem traffic went to one pair of firewalls and Internet went to the other.Our UDR looks like this:Trust vNets:From Any to 172.x.x.x/x goes to EW Trusted Load balancer (one for each vNet)0.0.0.0/0 goes to NS Trusted Load balancer.Untrust vNet:From 172.x.x.x/x To 192.168.x.x/x goes to EW Untrust Load Balancer",0,05-17-2018,01:53 PM
809,171006,RREALICA,"Hi ebrookman,are you using the basic sku load balancer to handle east-west monitoring?If you dont mind how did you configure the ""basic sku"" load balancer to handle all the ports that might be required for east-west monitoring? Say all the dynamic high level ports for instance?Thanks,R",0,06-25-2018,01:30 PM
810,171006,brookman,"We started using the basic load balancers, but found out that you would have to declare all ports that will be used. By using the Standard Load Balancers, you can use what they call ""HA Ports"" which is just dynamic port mapping.",0,06-25-2018,01:37 PM
811,171006,RREALICA,"Thank you.In our instance the, since we are in Azure Gov, the standard load balancer is not available as of yet so we have to lived with the limitations of the basic load balancers for the time being. I'm wondering how other users handles the requirements for example for Active Directory dynamic ports like a range of 49152 - 65535 TCP? How do you define that in the basic load balancer? Is there a need to?",0,06-25-2018,05:32 PM
812,219653,jperry1,What Azure Machine size are you using?What version of PAN-OS are you using?,0,07-25-2018,12:54 PM
813,222805,jmeurer,"With the jumpbox, you have to ensure it that it is in the NATGateway subnet, that is the only subnet that has an IGW for the EIPs to utilize. Additionally, there is a security group created by the template that allows ports 22/3389 for access to the jumpbox. If that SG was not used for the jumpbox, ensure that your jumpbox does have the proper SG applied.As for outbound, this template was notdesignedfor protection of traffic originating within the VPC. You can choose to create a route for your application servers pointing to the Trust side of the firewall in the corresponding AZ and validate that ETH2 has Source/Destination check disabled. You will then need to add corresponding security and hide nat policies to allow the traffic.Please note that this creates a single point of failure within the VPC. In order to perform outbound inspection of traffic originating from within the VPC, utilization of a transit VPC or other automation to monitor the firewalls and move the routes is necessary. That is topic better suited for a discussion with your Palo Alto Networks SE.",0,07-20-2018,05:26 AM
814,217519,kblackstone,"I have an ARM template that will create this entire environment for you. It can be used as a great learning tool since it includes the UDRs and other pieces necessary to make traffic flow work, in addition to the firewall policy that you'll need as a starting point.https://github.com/kblackstone/Dev/tree/master/Standard-SKU-LB-SandwichThis will eventually be moved to the corporate github, but in the meantime feel free to use. It might help answer your questions and allow you to see the pieces working together.-kb",2,06-12-2018,07:22 AM
815,217519,tchark,"awesome!! many thanks for this, im going to give this a go and report back how i get on.hopefully i can take the lessons learned from this and move it to my live environment.thanks again for this.",0,06-12-2018,07:26 AM
816,217519,RREALICA,"Hi,We are in Azure Government and the standard load balancer SKU is not available as of yet so we only have the basic load balancer at our disposal at this time (looks like an July-Aug 2018 ETA for standard lb to be avaiable in Azure Gov) - what are our options if we only have the basic load balancer? Our desire is also to have to have a pair of VM-300 in an availabilty set in a load balancer sandwhich and be able to load balanceALL traffic from multipe vnets to go through the firewalls.Thank you,richard",0,06-21-2018,09:47 AM
817,217519,hsong,"Hi Richard,I have same issue and have same design in Azure Government.Other than the basic LB issue, how did you solve the avaiablity set? Are you able to deploy the VM-300s on an availabilty set. I heard that there is no availability set on Azure Government. Standard Avset ARM template is failing run on Azure Government.Thank you,",0,06-25-2018,07:42 AM
818,217519,RREALICA,"Hi,We also have a problem with the availability sets - there's no options to add the Palo Altos to an availability set. So we have 2 problems: the availability set and the load balancer sku.I've opened a case with MS support about the availability set in Gov and there reply was """"I did test the deployment in both environments using the same Marketplace image and was unfortunately unable to complete the Palo Alto deployment using Availability Sets. This limitation is on the Image itself and not the environment.""We are also working with Palo Alto directly to get answers/options for us.The ARM templates also does not work 100% for us, it can create some of the structure but it's not fully successful so we are building the infrastrucutre manually - which is not bad but just running into issues with Gov limitations.",0,06-25-2018,09:09 AM
819,218400,JoyLiu0331,,0,06-19-2018,11:01 AM
820,217809,chrgre,We determined the failure here was related to the account number. The actual account number has a 0 in front of it. The stored record in excel eliminated the 0 and caused the aws account number to be inaccurate.,0,06-18-2018,01:35 PM
821,217029,mvaidyanathan,"Hello,Is your Panorama in Management Only mode? The CLI command is not available in the Management Only mode becauseyou cannot dologging in that mode.I believe that by default, Panorama on Azure is inManagement Only mode. You will need to change to Panorama mode to enable the logging disk.",1,06-08-2018,09:47 AM
822,217029,scaringosv,"Yes, I think is set toManagement Mode, I'll double check ans see if that the case, Thanks",0,06-08-2018,11:11 AM
823,204701,scaringosv,"There is a BYOL vm that I just spin up, the only issue that I'm having is adding an extra disk. rather than that the Image works just fine.",0,06-08-2018,06:09 AM
824,214868,jperry1,Typically as long as the S3 bucket is created with the default settings and in the same region it will work. Maybe try launching it one more time using the same S3 Bucket. You need to have listbucket and getobject permissions set so if there was any deviation from the base permissions you could get an error.https://www.paloaltonetworks.com/documentation/81/virtualization/virtualization/bootstrap-the-vm-ser...,0,05-21-2018,09:56 AM
825,214868,brichbourg,"I'm getting errors from the CloudTrail based bucket that is created, not the bootstrap bucket I created manually before. I've launched this many times and I continue to get the same permission error on that bucket.Right now I am just trying to get it to work within the same account.The CFNs are creating, these are just errors I see on the Lambdafunction afterwards.",0,05-21-2018,10:24 AM
826,214868,jmeurer,Can you run a test in a Region other than East 1. I have seen something similar in East 1.,0,05-21-2018,10:53 AM
827,214868,brichbourg,"Yeah I can try that, but my client hasresources in US-EAST-1, so this will still be an issue.Stay by, I will try US-EAST-2",0,05-21-2018,10:57 AM
828,214868,jperry1,,0,05-21-2018,11:01 AM
829,214868,brichbourg,CT bucket has the account number in the name.,0,05-21-2018,11:02 AM
830,214868,brichbourg,I got the solution to finally deploy in US-EAST-2.,0,05-21-2018,12:56 PM
831,214868,jmeurer,Could you retest. There was an API call on the AWS side that was not working and appears to be resolved.,0,05-24-2018,02:18 PM
832,214868,brichbourg,"I was actually able to get this working a few days ago when I deployed into my lab account as the root user. Worked in us-east-2 and us-east-1.I am deploying to a customer account today again, and I get the same error message in S3. Created an IAM role to give the cloudTrailLambda function admin access (just for testing) and now the solution works.I am still seeing another error message in the Cloudtraillogs for cloudTrailLambda, but once we gave it admin access the VPN tunnels to a test VPC were created and connected to the PANs.The only difference between my lab and my customer's environment is I am deploying with my company's AWS account using an an assumed role that has admin access, and I used my root account for my lab.Even though it is working with the modified Lambda role right now, we are going to attempt to re-deploy tomorrow under the customer's root account to see if that keeps these issues from occuring.",0,05-24-2018,02:33 PM
833,199271,jmeurer,"Watch for a type-o in either your VNET name or the subnet named ""Mgmt"" especially a trailing space in the template which I have seen often when copying and pasting from the portal. That error is indicating that the VNIC cannot be added to subnet Mgmt. The templates assume the subnets designated already exist, they will not create them in the RG.",0,02-07-2018,05:40 AM
834,199271,stan1,Its a fresh newdeployment of firewall to existing RG without any existing firewall. I suspect there is issue with the Github template.,0,02-07-2018,06:42 AM
835,199271,kblackstone,Which of the templates did you use?,0,02-07-2018,06:49 AM
836,199271,stan1,Both of the below links:1.https://github.com/kblackstone/PaloAltoNetworks2.https://github.com/PaloAltoNetworks/Azure-interface-options,0,02-07-2018,06:51 AM
837,199271,kblackstone,Which one specifically? There are multiple ARMtemplates in those directories.,0,02-07-2018,07:00 AM
838,199271,stan1,I tried both existingenvironment with and without New AVSET. Same result.,0,02-07-2018,07:06 AM
839,199271,jmeurer,"Could you please post a picture of your subnets under Settings in the VNET. The Mgmt, Trust and Untrust subnet names in the template are the default example and need to be changed to match the subnets you have previously created in the VNET. Same will apply to the subnet prefix and Start Address.",0,02-07-2018,07:28 AM
840,199271,stan1,"There are no Mgmt, Untrust and Trust subnets in my existing RG. There is only web subnet inthe vnet.",0,02-07-2018,07:34 AM
841,199271,jmeurer,"The subnets are prerequisits. The template does not create them. Each of the templates notes in the initial section what needs to already exist such as the Resource Group, VNET - with subnets, Storage Account for the VHDs, Load Balancer and AVailability Set.",1,02-07-2018,07:47 AM
842,209868,BatD,"I see that no one answered you question and I can try to help, but it is not quite clear what are you trying to do.I am not sure where you had that from, but taken out of context both statements are not necessary correct. You can surely protect multiple webservers with a single firewall without using load balancer. Also strictly speaking you can have more than one ENI per subnet.",0,05-26-2018,05:28 AM
843,209868,jperry1,We definitely need more context. You can have one ENI per subnet but in that subnet you can have multiple backend resources. So as@BatDreferrenced you can secure multiple servers with a firewall. If you have multiple resources in multiple subnets and you would like to secure them via the firewall then you need to add more ENI's and configure multiple zones. the VM-Series can have up to 7 Dataplane interfaces + 1 the management interface depending on the machine type used in AWShttps://www.paloaltonetworks.com/documentation/71/virtualization/virtualization/set-up-the-vm-series...,0,05-28-2018,09:35 AM
844,214864,jmeurer,,0,05-21-2018,08:12 AM
845,214864,brichbourg,Thank you,0,05-21-2018,08:49 AM
846,211547,niyengar,"The VMs are part of the budle so no need to buy additional VMsJust note that we do not support PAN-OS stateful HA in Azure. You can deploy firewalls behind a load balancer and that will give you resiliency.Availiability sets are more for when you want to account for planned and unplanned outages. Such as patching of the system, power failure etc.I deally you will have your VMs in an avaialbility set and behind a load balancer.",0,04-24-2018,10:12 AM
847,211547,tchark,"Hi Niyengar, thanks for the update,thats great news that the VMs are included in the bundle, but i was confused as to why Palo Alto gave sizing info for virtual machines, or is that for virtual firewalls that are not bought as part of an azure subscription.Does Azure then choose the size of the virtual machine when we purchase the VM-300 and bundle option?Regarding the HA query, i did see that there was no HA for PAN-OS on azure, so how would i achieveresiliency to ensure that if one firewall fails (or needs rebooting) that i can continue to have security enforced through the palo alto firewalls, are you saying that there is no clustering or active/standby setup for palo altos in azure?I am going to be using a load balancer that sits in front of the firewalls, but need to ensureresiliency in the event of failure of one of the firewalls.many thanks for your assistance, really appreciate itTaib.",0,04-25-2018,04:37 AM
848,211547,AustinS,There simply is no HA however resiliency can be achieved by Loadbalancing across 2 independant Active Active firewalls when they are apart of an availability set. This is not the same as traditional HA however it does have resiliency. However there are complexities putting load balancing in front of firewalls such as NAT'ing.,0,05-14-2018,07:20 PM
849,211547,jperry1,"1. If you are using PAN-OS 8.1 you can leverage our enhanced bootstrapping for Azure. This makes bootstrapping easy2. If you have multiple firewalls in a backend pool of a loadbalancer your health probe will ensure that traffic is only sent to the active firewall3. Applications today are written to re-establish connectivity at the event of a connection lost for long lived sessions4. Even with HA in the cloud all platforms will typically have a 1-1.5 minute delay during failover and during that time sessions need to be restablished by the application either way.So i am not against stateful HA but stateful HA is a legacy way of thinking that comes from the physical architecture thought process and not the cloud thought process.Your availability set will ensure availability with the use of Update Domains and Fault Domains. That firewalls in the backend pool will need to go into an availability set for to help with infrastructure and natural disaster faults.Multiple firewalls in the backend pool and health probes will ensure availability due to any ""software"" issues.",0,05-14-2018,10:03 PM
850,211547,jperry1,To add to my post last night [PDT] here is a link to information regarding High Availability in AWS and AzureHigh Availability Considerations on AWS and Azurehttps://live.paloaltonetworks.com/t5/AWS-Azure-Articles/High-Availability-Considerations-on-AWS-and-...,0,05-15-2018,08:39 AM
851,211729,davanderson,AWS (and Azure) is not all rainbows and unicorns. These companies have taken standard products and have slapped a web gui over the top of them to make their cloud systems. We often find many issues with compatability or settings that should work that don't because of the GUI overlay. If you work within their boundries to perform basic functions - you will be fine. If you want really advanced stuff - you may have issues or limitations.,0,05-09-2018,09:02 AM
852,212067,ssumner,PAN on GCP is GA and we have several customers already deployed. As far as the experience the architecture is similar to AWS and Azure with LB sandwich and a Transit model and the GUI is straight forward. GCP does have a unique structure compared with AWS and Azure there is more information about that on my JIT for GCP. I encourage you to check it out. We already have Terraform templates and Python scripts available for deployments.,0,04-27-2018,09:21 AM
853,212067,OtakarKlier,"Thanks, I did see some good thing so far. I guess its interesting that I dont see a ready PAN package up on GPC.",0,04-27-2018,10:11 AM
854,212067,jperry1,Although we don't have a set time we do expect our VM-Series images to be in Google Cloud Platform soon.,0,04-28-2018,12:40 PM
855,212067,OtakarKlier,"Hello,Would the ballpark timeline be weeks, months, years? Just trying to guage on whomI should go with.Regards,",0,04-30-2018,03:02 PM
856,212067,ssumner,I do not have an exact time but I was told within a few weeks.,0,05-04-2018,06:57 AM
857,212067,OtakarKlier,Thanks! I'll keep my eye out for it.,0,05-04-2018,07:53 AM
858,212067,jchung,,0,05-04-2018,10:46 AM
859,212067,OtakarKlier,I would love to have them. Only I found was the following but that requires the package already on GCP.https://www.paloaltonetworks.com/documentation/81/virtualization/virtualization/set-up-the-vm-series...Thanks in advance!,0,05-04-2018,11:42 AM
860,211959,jperry1,in AWS you should be able to look at the console log snap shots and see the process. But if it is has been some time since it scaled or powered up then the console log output may not show anything.Also the ELB will say out of service if it can't reach anything on the backend to do a health check. For testing you can try to check the health checks to verify via TCP just to see if it work. Of course the load balancer would have to be a classic ELB,1,04-26-2018,06:21 PM
861,211959,yK,"Thanks. Both public and internal load balancers are classic. Where exactly in the GUI are you referring to in the console when you say ""console log snap shots"" ?We have been creating/deleting stacks while testing so no problem checking right after firewalls come up. The difference between the customer's template and the classic example seems minor. Hopefully the TAC engineers will know where to look.",0,04-26-2018,06:58 PM
862,211959,jperry1,,0,04-26-2018,08:17 PM
863,211959,yK,Thanks. As it turns out everything was properly configured yet the firewalls would not bootstrap properly. After TAC support attached an EIP to the public interface and got the log in page it appears that the mgt switch command in the init-cfg.txt didn't work. After deleting the init-cfg.txt (which had the proper text in it) with a fresh copy directly from the github page the firewalls came up as expected. So a 37 byte file somehow got corrupted.,0,05-02-2018,02:53 PM
864,211959,jperry1,i'm happy to hear everything is working and thanks for updating us also. Everyone once in a blue moon that will happen. The trick is to be sure that when you download the files from the GitHub resource you either Clone the resource or you click the RAW button and right click save as to save the file. If you right-click save as before clicking the RAW button then the file will download in a format that will not work. That may be what happened with the first download but either way I'm happy it works for you now. Take care.,0,05-02-2018,03:06 PM
865,211254,yK,Apparently the error is not related. I deleted the stack and re-created it exactly the same way and this time it create the firewalls. Go figure.,0,04-22-2018,08:58 AM
866,211254,yK,"OK, Upon further investigation I didn't choose all the default values. The firewalls weren't being created because their instance type isn't supported by AWS Market place. The template lists 2 instance types as allowed parameters that shouldn't be there and also is missing 2 instance types that should be allowed.Instance types that should be removed as not supported.c3,xlarge and c4.xlargeInstance types that should be added.c3.8xlarge and c4.8xlarge",0,04-22-2018,02:06 PM
867,211254,jperry1,Thanks for the information Perry and I am happy to hear you have it working now. We will take a look at the template and instance types and make any necessary changes. Thanks again and take care.,0,04-23-2018,08:15 AM
868,167650,Warby,"Hi KC Lee,One of our TMEs has a working prototype that uses Lambda to map IPs learned from XFF to a User-ID group that can then be blocked by policy. It isn't ready to be published as a template yet but if you'd like a preview, please reach out to your sales team to schedule a demo.HTH,Warby",0,08-26-2017,03:10 PM
869,167650,Warby,The XFF to User-ID solution has been published on GitHub:https://github.com/PaloAltoNetworks/XFF-to-User-ID-mapping,0,01-25-2018,04:17 PM
870,167650,theljula,The solution provided deployes the XFF solution into an new VPC and Palo Alto instance. Is there any cloudformation template that is available to be deployed into an existing VPC and Palo Alto?,0,04-18-2018,01:11 PM
871,208054,jperry1,I did a quick google search and found this information. It should have everything you need. The first link shows you how to get the serial number from the GUI. You need to have PAYG bundle 1 or 2. If you have bring your own license you need an auth key from Palo Alto Networks.from the CLI type>show system info | match serial>show system info | match cpuidhttps://www.paloaltonetworks.com/documentation/80/virtualization/virtualization/license-the-vm-serie...If this answers your question please note this as solved. If not please inquire in this thread further.,1,03-29-2018,08:41 AM
872,200178,jperry1,PAYG type licensing is not associated directly with Palo Alto Networks. That being saidyou will be charged hourly or annually depending on the type of license you use. But PAYG is listed as a consumption based licensing model so if your VM is powered off then there is no consumption. See the link below for information on PAYG and BYOL licensing.https://live.paloaltonetworks.com/t5/AWS-Azure-Articles/VM-Series-for-AWS-and-Azure-Licensing-Consid...,0,02-13-2018,12:56 AM
873,200178,kjsteven,"Will the configs be lost if I were to stop the VM, leave it and start it sometime in the future?",0,02-13-2018,01:02 AM
874,200178,jperry1,Rule of thumb when it comes to firewalls is to always back up your configurations. But the answer is yes. The configuration should still be there.,1,02-13-2018,10:07 AM
875,196345,jperry1,"I'm not sure about Junipers but on our devices when you see ""00000000"" in the log for your peer that means it doesn't recognize it or have a way to route back to it. It amost looks as if something is NAT'ing out for your firewalls untrust interface. Can you ensure that your PAN firewalls Untrust interface is reachable via internet? easiest way to do that would be to add a management profile to your Untrust interface for ping. If you can successfully do this be sure you have provided the correct IP addresses.",0,01-23-2018,11:52 AM
876,196345,Warby,"Also, make sure the Juniper isn't configured for peer identification based on the IP address of the VM-Series because the VM-Series is configured with a private IP on the firewall butthe packets arrive on the Juniper with a source IP of the IEP. When those don't match, peer identification fails. Instead, use something like FQDN or and email address as the peer identificaiton.",0,01-23-2018,01:50 PM
877,196345,nson2139,"Thanks, in this case the Juniper also behaves the same. That is why for some reason I believe the ID that the PAN is taking to the Juniper may be incorrect.Yes, the PAN interface is reachable over the Internet using the EIP assigned by AWS.We can ping/HTTPS to the EIP using the allowed IP range.Do you know if the EIP assigned on the AWS needs some different setting? I mean some NAT policy or something?Thanks for the response and suggestions on this.",0,01-23-2018,08:48 PM
878,196345,nson2139,We did not specifically configured the Juniper for any peer identification. The logs shows that the assinged EIP is reaching the Juniper so that should be correct.The other challenge here is we would need to build VPN tunnels from this PAN to other VPC's as well so all configuration would need to reside on the PAN itself.We did try by adding peer ID/local ID on the PAN but nothing seems to work. 😞,0,01-23-2018,08:51 PM
879,196345,jperry1,what type of error does the IKEMGR log show on the PAN firewall? you can see that by runningless mp-log ikemgr.log or something of that effect.Also out of curiosity check the ENI that is used for the VPN termination point on the VM series and see if Source Destination checks is turned on. If so as a test turn that off.,0,01-23-2018,10:02 PM
880,196345,nson2139,"It just shows failed due to timeout====> PHASE-1 NEGOTIATION STARTED AS INITIATOR, MAIN MODE <==== ====> Initiated SA: a.b.c.d[500]-1.1.1.1[500] cookie:916a1f78c71fbe00:0000000000000000 <====Failed SA: a.b.c.d[500]-1.1.1.1[500] cookie:916a1f78c71fbe00:0000000000000000 <==== Due to timeout.2018-01-23 22:02:17.000 -0800 [INFO]: { 4: }: ====> PHASE-1 SA DELETED <====Here the a.b.c.d is the private IP of the PAN Untrust interface and 1.1.1.1(changed) is the Juniper end IP.The Source/Destination checks have been turned off as per the guidance from the documents.",0,01-23-2018,10:08 PM
881,196345,jperry1,We should never see the private IP address is Phase 1 as this is where the peers are authenticated. If the Juniper doesn't have a routable public IP address then you need to be in aggressive mode on the PAN VM-Series for your VPN setup. At this point I wouldn't deem this an issue with VM series firewall itself. My suggestions here are1. Figure out why your Juniper Private IP is being sent to the PAN VM-Series firewall2. If the Juniper doesn't have a static IP address then configure the VM-Series in Aggressive Mode.,0,01-23-2018,10:22 PM
882,196345,nson2139,"The above log I took was from the PAN device. This is the one which is showing the Private IP.The PAN is the initiator and it starts the VPN tunnel with it's private IP.Now, technically this IP should be NATTted by the AWS and the EIP should be forwarded to the Juniper.The Juniper does show the EIP in it's logs. 🙂Is there a way to configure the PAN to send the EIP itself in the logs it sends to the Juniper?",0,01-23-2018,10:31 PM
883,196345,jperry1,,0,01-23-2018,10:40 PM
884,196277,hshah,"Hi Foobar,You can create custom URL and allow internet traffic for those URL for a specific subnet.Please refer the following doc.https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Create-Custom-URL-Categories/ta-p...-- Hardik Shah",0,01-22-2018,02:02 PM
885,196277,bar7,Thanks Hardik.I'm assuming this solution is available in Palo Alto Networks VM-series Next-Gen Firewall Bundle 1/2 in AWS Marketplace. Please confirm.,0,01-23-2018,11:30 AM
886,196277,jperry1,PAYG2 will have support for URL Filteringhttps://live.paloaltonetworks.com/t5/AWS-Azure-Articles/VM-Series-for-AWS-and-Azure-Licensing-Consid...If all you need to do is create a customer URL category and define the URLs then you shouldn't need a URL filtering license for that. But if you want URL filtering then PAYG2 is the way to go there.,0,01-23-2018,12:03 PM
887,196277,hshah,I Agree ...,0,01-23-2018,12:04 PM
888,196277,bar7,"Thanks.Is there a template readily available to deploy a simple solution for this usecase in AWS?From link, I guess I'm trying to implement ""Use Case: Secure the EC2 Instances in the AWS Cloud"" section. Looking for a template that I leverage.Thanks.",0,01-23-2018,02:35 PM
889,172858,bmaas,"Due to the nature of Azure networking, another loadbalancer won't probably fix thisproblem.When using another LB solution and making this HA, you probably going to need a Azure Internal LB.See this reference documentation:https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/dmz/nva-haI created a feature request at MS, you can upvote.https://feedback.azure.com/forums/217313-networking/suggestions/31116808-loadbalancer-multiple-ports...A (dirty) work-around can be using multiple internal loadbalancer, as far as the client doesn't use over 150 ports (the limit is actually 150).Unfortunately no (real) solution, but hopefully it will clear things up.",1,08-31-2017,05:48 AM
890,172858,michelvankessel,Thanks Rob! Just upvoted it several times 😉 Let's hope M$ is going to listen this time. This has been a feature request since 2013 and isput on the feature backlog since november 2016https://feedback.azure.com/forums/217313-networking/suggestions/4338247-endpoints-can-accept-a-port-...RegardsMichel van Kessel,1,08-31-2017,06:22 AM
891,172858,johnurbanek,"As of September 2017 Azure Load Balancer HA Ports capability is in preview. Allows the use of 0 for port number and All for protocol type which is shorthand for all ports, all protocols -- very useful for forwarding all traffic hitting the load balancer VIP to the back-end VM-series pool members (for both inbound and outbound use cases) -- in a single load balancer rule.Before HA Ports capability hits GA, request access to it (link above) and mind the regions where it is available.-John",2,09-28-2017,07:33 AM
892,172858,junior_r,"Hi,When using multiple PA firewalls on Azure how are you syncing the polices? Also for IPSEC are you terminated on PA or on AzureVPN gateway?Thanks",0,12-10-2017,01:50 PM
893,172858,Warby,"Hello,The easiest way to synchronize polices on multiplePalo Alto Networks firewalls is to use Panorama (our management station) to push policy. This works for all of our physical and virtual firewalls. Config elements can be shared or completely independant by device groups.Another option is to use a thrid party tool like Ansible to push configs to multiple firewalls. We have some sample Ansible plabooks available:https://live.paloaltonetworks.com/t5/Ansible/ct-p/AnsibleThe VM-Series firewalls can terminate IPsec tunnels very well. The decision to use the VM-Series versus the Azure VPN gateways should be based on the architecture, routing, performance, etc.HTH,Warby",0,12-10-2017,02:45 PM
894,172858,junior_r,"Hello,The easiest way to synchronize polices on multiplePalo Alto Networks firewalls is to use Panorama (our management station) to push policy. This works for all of our physical and virtual firewalls. Config elements can be shared or completely independant by device groups.Another option is to use a thrid party tool like Ansible to push configs to multiple firewalls. We have some sample Ansible plabooks available:https://live.paloaltonetworks.com/t5/Ansible/ct-p/AnsibleThe VM-Series firewalls can terminate IPsec tunnels very well. The decision to use the VM-Series versus the Azure VPN gateways should be based on the architecture, routing, performance, etc.HTH,WarbyHi Warby,Thanks for the reply the client don’t havePanorama. I guess I will explore the Ansible playbook route.If I have multiple FWs on Azure how would I create the IPSEC tunnel from high level? Wouldn'tExternal LBBreak the IPSEC tunnel? I could use multiple public IPs and tunnel monitor but that would mean only one tunnel will be up at a time. Also what is the performance impact of PAN IPSEC tunnel VS Azure VPN Gateway? What about Global Protect? Would it work with External LB? Would you assign two GP pools? One for FW1 and one for FW2 so the destinations know which firewall to return traffic to?Thanks",0,12-10-2017,04:23 PM
895,172858,junior_r,"Hi,Anyone?Thanks",0,12-12-2017,05:32 AM
896,172858,bmaas,"Hello,The easiest way to synchronize polices on multiplePalo Alto Networks firewalls is to use Panorama (our management station) to push policy. This works for all of our physical and virtual firewalls. Config elements can be shared or completely independant by device groups.Another option is to use a thrid party tool like Ansible to push configs to multiple firewalls. We have some sample Ansible plabooks available:https://live.paloaltonetworks.com/t5/Ansible/ct-p/AnsibleThe VM-Series firewalls can terminate IPsec tunnels very well. The decision to use the VM-Series versus the Azure VPN gateways should be based on the architecture, routing, performance, etc.HTH,WarbyHi Warby,Thanks for the reply the client don’t havePanorama. I guess I will explore the Ansible playbook route.If I have multiple FWs on Azure how would I create the IPSEC tunnel from high level? Wouldn'tExternal LBBreak the IPSEC tunnel? I could use multiple public IPs and tunnel monitor but that would mean only one tunnel will be up at a time. Also what is the performance impact of PAN IPSEC tunnel VS Azure VPN Gateway? What about Global Protect? Would it work with External LB? Would you assign two GP pools? One for FW1 and one for FW2 so the destinations know which firewall to return traffic to?ThanksI would connect the IPSEC tunnel(s) directlyon the firewalls. If you have multiple firewalls within Azure, with the same back-end, you can use OSPF and ECMP to utilize both tunnels.For GP I would use the same approach and terminate the GP GW directly on the firewall and only put the GP Portal behind the LB.",0,12-12-2017,09:10 AM
897,172858,junior_r,ECMP should return traffic on same tunnel correct? How wouldn't the GP gateway need to be behind LB to?Thanks,0,12-12-2017,10:12 AM
898,192634,jperry1,In a situation like this you can spin up a Palo Alto Networks VM series firewall in AWS and use the firewall as the VPN termination point to connecct to your on prem PA-3050. You can also use AWS VPN connection as well as the VPN termination point in AWS. Using Global protect VPN connectivitywould be limited to the one Global protect client that is connected. If only one person needs to connect then you can do that but you will still need a VM series firewall in AWS to terminate the Global Protect VPN,0,12-20-2017,09:39 PM
899,192110,niyengar,"Hello, In AWS the firewall needs to have an interface in thesubnet foritto be able to see the traffic.One other solution is to use a Transit VPC. This will be a centralized VPC with firewalls and then other VPCS with variouis APPS connect to this VPC to send data out (outbound protection) and you can also achieve inter-VPC security.We are working on a fully automated solution and it should be relased in the next few weeks.You can contact your SE and have them setup a meeting with folks here @ paloalto networks and we'll be happy to give you an overview.",0,12-18-2017,11:02 AM
900,192110,spetty01,"Hello, In AWS the firewall needs to have an interface in thesubnet foritto be able to see the traffic.One other solution is to use a Transit VPC. This will be a centralized VPC with firewalls and then other VPCS with variouis APPS connect to this VPC to send data out (outbound protection) and you can also achieve inter-VPC security.We are working on a fully automated solution and it should be relased in the next few weeks.@You can contact your SE and have them setup a meeting with folks here @ paloalto networks and we'll be happy to give you an overview.Great... sounds intriguing. I submitted a request online but haven't heard.Is there an easier way to identify the SE that would handle our account?",0,12-18-2017,11:59 AM
901,192110,niyengar,"What company do you represent?If you don't want to advertise here, you canunicast me at niyengar[at]paloaltonetworks[dot]com",0,12-18-2017,01:47 PM
902,192145,Warby,"Hi Stacy,We didn't want to have an auto scaling solution that has an upper limit based on something that has nothing to do with when to scale (EIPs). We recommend using Panorama for management which negates the need for public IPs altogether.Warby",0,12-18-2017,01:18 PM
903,191944,jmeurer,"In order to bring multiple applications through the firewalls, you need to differentiate them in someway. You can either consider adding secondary IPs to the Untrust ENI and have the Load Balancers target the individual IPs if using ALB or NLB or use PATto use a port per app on the Untrust interface which will be necessary Instance targeting LBs. You then configure the NAT rules per app to destination translate the Untrust port to the application server port with the source translated to the Trust Interface.ie.LB1:443 -> Untrust:1443 -> App1:443LB2:443 -> Untrust:2443 -> App2:443Have a look Autoscale v2.0 model currently in Beta utilizing the method.https://github.com/PaloAltoNetworks/aws-elb-autoscaling/tree/master/Version-2.0To Answer your interface swap question, whenever you use an Instance as a target on any of the load balancers, you need to perform Interface Swap on the Firewalls. Instance targeting onlysupportsETH0. If you use IP address targeting, then you can select the correct IP if Inteface Swap is not implemented.",0,12-16-2017,08:16 AM
904,191944,jperry1,"Nithin,To start we need to a bit more about your configuration and topology. You mention 20 load balancers and also some classic load balancers also. just from that statement I am assuming the 20 AWS load balancers are all ALB is this correct? Are all these load balancers in the same AZ? Can you provide a detail of your architecture so we can understand what you are lookingn to accomplish?Also when you say you are not receiving the expecfted behavior, please elaborate on what type of behavior you are receiving?What is the difference in the traffic source per load balancer?Also the ethernet swap must happen whether using Application LB's or Classic LB's because Dataplane traffic has to be received on Eth0.See link below for Details.https://www.paloaltonetworks.com/documentation/80/virtualization/virtualization/set-up-the-vm-series...Management Interface Mapping for Use with Amazon ELBhttps://www.paloaltonetworks.com/documentation/80/virtualization/virtualization/set-up-the-vm-series...Just off the top of my head you have to be sure to select the appropriate subnet for the firewall eth0 BUT the eth0 interface has to be swapped.Also how are you swapping the ENI's?Please answer these questions and provide a diagram of what you are looking to accomplish as well. Once I receive that I can take a look at it and we can go from there. Thanks Nithin.",0,12-17-2017,01:44 PM
905,188926,hshah,How is East and West Azure connected?Are they connected via IPsec? Is IPsec terminated on the firewall?Is there an Express Route between East and West region?,0,11-28-2017,01:13 PM
906,188926,MohanDorairaj,,0,11-28-2017,10:25 PM
907,188926,Jigar,"What is the latency between the two sides?What we've noticed is that when latency reaches 30-40ms, SMB performance is severely impacted due to the chatty nature of SMB. If you've opened a support case then we can work with you to review the details of your setup and run some tests to diagnose this further.",0,11-29-2017,04:55 PM
908,188926,Manjunath,Its aorund 70 ms...,0,12-12-2017,12:56 PM
909,158902,Warby,"Hello,The best tool for a central view of threats accross many firewalls is to use Panorama. There are several options for deploying Panorama to collect Azure VM-Series firewalls. Please work with your sales team for details.HTH,Warby",0,06-01-2017,10:57 AM
910,158902,ArturoRamirez,Did you find a standard solution?? I was thinking in use a SysLog to collect all logs and then extract the logs with the OMS,0,11-23-2017,09:33 AM
911,184970,hpunjabi,"Hi @nbenos,You should be able to form VPN between AWS VPC and Global Protect Cloud.Are you trying VPN connection with AWS VPN Gateway or do you have a VPN capable device (Palo Alto EC2 instance for example) in your VPC ?",0,11-05-2017,05:15 AM
912,184970,nbenos,"Hi hpunjabi,Thanks for the response. I'm trying to vpn between the AWS vpn gateway and the Global protect cloud. Just not sure of the configuration for this and if it's even possible?Thanks,Nick",0,11-06-2017,07:17 AM
913,184970,hpunjabi,"Hi Nick,Yes you should be able to configure VPN between GPCS Cloud and AWS VPN.1. Create a Customer Gateway (Amazon) pointing to GPCS Cloud Public IP.2. In VPN Connection (Amazon) specify static routes for Mobile VPN/Remote VPN subnet as well as Infrastructure subnet in GP cloud.3. In GPCS all configuration should be same like other VPN, specify Amazon VPC as remote subnet and in tunnel monitor specify 169.X.X.X ip address specified by Amazon (this can be viewed once you click Download configuration).Also one thing to take note that the encryption and authentication would be visible under downloaded configuration from Amazon which you will have to replicate in GPCS.",0,11-12-2017,07:38 AM
914,184970,nbenos,"Thanks so much for the infohpunjabi! So now I'm able to successfully build the tunnel in AWS and also GPCS.AWS Tunnels both show upGPCS shows status of ok for remote networkThe only issue I have is when I create a test machine in the AWS VPC I can't seem to send out the internet traffic through the tunnel. I'm pretty sure it's a routing issue on the AWS side.So far I have here's the routes I have for the VPC:local AWS subnet route and target is local0.0.0.0/0 which is going to the internet gateway. I figured this one had to be pointed to the virtual gw, but when I change it to that it just breaks my connection to the test device in the AWS VPC.GPCS infrastruture subnet and the target it the vgwboth tunnel 169.x.x.x addressess and the target is the vgwany ideas?Thanks,Nick",0,11-13-2017,12:16 PM
915,184970,hpunjabi,"Hi Nick,Have you setup Corporate VPN ? After the VPN is up now aren't you able to get access from Corporate LAN?One thing I can suggest is to add route for your public IP address (System or Laptop) from which you are managing test machine towards Internet Gateway and then default route towards VPN Gateway in Amazon.This way you will have the connectivity to the test machine and you can test for Internet connection through GP cloud.",0,11-14-2017,04:35 AM
916,184970,nbenos,"Hi hpunjabi,Thanks again for all the help. I did add a public route for the test IP and after troubleshooting a bit, I realized it was a route that needed to be placed on the vpn tunnel settings in AWS. I'm now able to filter traffic egressing the AWS VPC. Thanks again for all the time spent helping me out!-Nick",1,11-20-2017,06:35 AM
917,185433,hpunjabi,"Hi@GFN182,You can follow below link:https://www.paloaltonetworks.com/documentation/80/virtualization/virtualization/set-up-the-vm-series...",0,11-05-2017,05:32 AM
918,185433,GFN182,"Yes, i read through all that. I was hoping for practical experience.",0,11-13-2017,06:45 AM
919,151118,cstancill,Panorama will not ingest tags from AWS directly. What you can do is create the AWS tags in Panorama manually. Then the firewall will apply the tag to IP mapping when it inforces policy based on those same tag values it learns from AWS.,0,04-06-2017,08:55 AM
920,151118,Mike_Z,"Anyone aware of any plans for Panorama to also support dynamic retrieval of AWS tags (if so, when?)Static creation of objects on Panorama defeats the purpose of dynamically discovering AWS tags and applying policy from this centralized management source.",0,10-23-2017,10:47 AM
921,151118,Anon1,"You can create dynamic groups in Panorama with the needed tags typed in manually. When pushed to the firewall, it will then match it with the learned tags from AWS.",0,10-24-2017,08:37 AM
922,182067,jmeurer,"Keith, there are 2 options to explore as you are correct in that the NAT object must be an IP address.1. Please have a look at the autoscale template on GitHub. You will find that we can autoscale the firewalls to accomodate the FQDN change. As you already mentioned, that will require an external Load Balancer.https://github.com/PaloAltoNetworks/aws-elb-autoscaling/tree/master/Version-1.22. Amazon recently announced a newer network load balancer. This load balancer provides static IP addresses for you to use in the NAT object. You could consider replacing that classic ELB with the NLB.https://aws.amazon.com/blogs/aws/new-network-load-balancer-effortless-scaling-to-millions-of-request...",0,10-16-2017,12:07 PM
923,182067,keith_johnson,"Thanks, jmeurer. I had actullay tried the new HTTPS ELB before the classic ELB, but that didn't seem to work for ADFS. I learned while I setup the classic one that I needed to use TCP instead of HTTPS. It didn't occur to me to backtrack because it seemed to be working at that time. I didn't notice the IP was changing on the classic ELB until later. So far, so good with the network ELB.Thanks, again!",0,10-24-2017,06:51 AM
924,181258,niyengar,What's the reason to do this?I very much doubtyou can update the agenton the firewall.,0,10-11-2017,09:34 AM
925,181258,JagSandhu,"The existing agent is out of date and i'd imagine eventualy will not be supported.If this is not supported, the VM-Series is not really suitable for Azure.",0,10-12-2017,01:31 AM
926,181258,Jigar,"We plan periodic updates to components inside the VM-Series firewall for all platforms. This will also dothis for theAzure agent, howeverthere is no loss of functionality or issues related to agent versions. We typically wait for the Azure agent code to release, stabilize and then include it at the appropriate time. We will take proactive action ifthere are any bug fixes or issues that require faster update. The agent changes should be transparent/invisible to customers since it primarily deals with provisioning and backend/fabric communiations with Azure.",0,10-12-2017,02:16 PM
927,178439,Warby,"Hello,Have a look at the cloud integration page:https://live.paloaltonetworks.com/t5/Public-Cloud-Integration/ct-p/Cloud_TemplatesThere is an automation section with a link to some sample Ansible modules that may help you.If that isn't what you are looking for, please reply to this post with more details.Warby",0,09-25-2017,08:57 AM
928,178439,Anish123,"Hello Warby,I have already gone through those links. Infact the last three question i raised in teh forum has been pointed to the github link only ;-).I'm more intrested in understading ""interface-management-profile"" using Ansible and if there is a playbook or some direction that could be provided......Is Configuring ""interface-management-profile"" same as writing a firewall rule????Thank you",0,09-25-2017,10:57 PM
929,178439,kblackstone,"Hi Anish,I took at look at the Ansible modules we have and do not see interface management as a currently supported option.Please see:http://panwansible.readthedocs.io/en/latest/index.html for a list of the modules, syntax and examples. Disclaimer: it seems some of the syntax may need updating.Thank you.-kb",1,09-26-2017,05:43 AM
930,177997,Warby,"Hi Omar,This might be caused by a change in the bootstrap config files, change in S3 permissions, change in boostrap file locations, etc. If you can connect to the firewall management interface via HTTPs using the credentials in the boostrap file, then bootstrapping has succeeded. If you cannot, bootstrap may have failed for one of the reasons above. Sometimes the AWS console screenshot will shot bootstrapping success of failure.This might be difficult to troubleshoot here in this forum. As this solution is a TAC supported integration, I recommend you open a case to get troubleshooting asssitance.HTH,Warby",1,09-20-2017,07:01 PM
931,177997,TCS_Cloud,"Thanks for the reply Warby!I am able to https into the firewalls and I can also see the 'AWS instance screenshot' showing bootstraping is successful.However these two PA EC2 instances are still out of service under ELB with only one PA firewall serving the traffic in prod is a huge risk!The only difference I can see in all three of them is the EC2 instance tag.. I can 'NAT-commit-success' tag updated for the working PA firewall EC2 instance and same tag is missing for the two out of service PA firewalls. I have even tried to deregister them and register again with ELB but no luck ! We have a same setup with exact configuration in preprod but somehow PA firewalls behave strangely and flaky.I have also opened a case with support Case#: 00746231but it took them four hours to reply with this' We are trying to find a right resource to work on this case who is proficient in AWS deployment 'This is ridiculous as this is impacting our production system.Any other troubleshooting tips Please??Cheers,Omar",0,09-20-2017,07:51 PM
932,177997,TCS_Cloud,"Also , I checked the cloud watch logs for one of the faulty ASG lambda configurations and found out these errors[ERROR] 2017-09-21T03:03:14.743Z 6891dac9-9e79-11e7-a3a9-150d852f6372 [ERROR]: Got an error for the command: https://172.27.21.18/api/?type=op&cmd=<show><jobs><id>1</id></jobs></show>&key=LUFRPT14MW5xOEo1R09KV...Are they related ?Any suggestions?Regards",0,09-20-2017,08:09 PM
933,177997,niyengar,That commandis looking for a specific job id (id 1) and that is usually the auto commit job.Can you log into the firewall and check the status of all jobs?,0,09-20-2017,10:42 PM
934,177997,niyengar,"Oh...and as Warby suggested, please do open a TAC ticket o you can get the proper and timerly support you need.",0,09-20-2017,10:43 PM
935,176785,Warby,"Hi Keith,How are you setting up the routing? If you have two data plane interfaces with public IPs, they cannot both ingest the default route or you will get odd behavior. You'll need to create a more specific static route on at least one of those interfaces for bringing up the tunnel.If you have both of the interfaces setup as DHCP, the default setting will be for them both to add the AWSgateway as the default route and you will get unpreditable results.Another test to try is to allow ping to/from both ends of both VPNs and make sure they are routing symmetrically.HTH,Warby",0,09-16-2017,03:08 PM
936,176785,keith_johnson,"Hi Warby,Yes, I have set both interfaces to use DHCP and using the defaul virtual router.As it is currently configured, I have both public interfaces in the same public subnet of the VPC. Both servers that have traffic forwarded to them from their respective public interfaces with their NAT and security polices are on the same private subnet. All of the IPsec VPN tunnels are on the first public interface.Are you saying I will need to setup a seperate AWS internet gateway and/or a seperate virtual router for each public interface?Thanks.",1,09-18-2017,06:10 AM
937,176785,Warby,"If you have both dataplance interfaces configured as the interface for the default route, you will get assymetric routing for one of the interfaces.Easiest solution is to remove the default route from one interface (say E1/2) and then setup a static route to use E1/2 for only the remote IPsec endpoint that should connect to that interface.Then you will need to setup static routes on the tunnel interfaces for the specific routes that should use each of the VPN tunnels.HTH,Warby",0,09-18-2017,08:22 AM
938,176785,keith_johnson,"All of the IPsec VPN tunnels are on the first interface. My reason for having more than one public interface is for forwarding the same ports to different servers of the public IPs, in this case HTTP and HTTPS.So:Public subnet:EIP 0 - Palo management interfaceEIP 1 - Palo public interface 1 - ports 80 and 443 of server 1 (NAT and security policies)  All IPsec VPN tunnelsEIP 2 - Palo public interface 2 - ports 80 and 443 of server 2 (NAT and security policies)Private subnetPalo private interface as gateway for all servers in the VPC.",0,09-18-2017,08:39 AM
939,176843,kblackstone,"Anish123,Please check here:https://github.com/PaloAltoNetworks/ansible-panhttps://github.com/PaloAltoNetworks/ansible-playbooks",0,09-16-2017,12:47 PM
940,176559,kblackstone,"You can use any virtual machine with at least 3 interfaces (max 😎 provided the virtual machine meets the minimum requirements: https://www.paloaltonetworks.com/documentation/80/virtualization/virtualization/about-the-vm-series-...Once deployed, you can change virtual machine size by shutting it down and selecting a new size.",0,09-14-2017,07:59 AM
941,171844,marregoces,"Hi Amaresh,The internal server may not need a public IP as it could be access from By Internet users through NAT.These are the steps to follow:1. assigned a public IP to the public load balancer that front-end the VM-Series FWs2. add a NAT policy to all the FWs behind the public LB. The policy, I call it ""Inbound DNAT"". In the original packet section use Untrust in the src and dst zones, and add the IP address of the eth1 FW interface. In the Translater packet section use Dynamic IP and Port as Translation Type, Interface Address as Address Type and ethernet1/2 as Interface (leave IP address as None). Select the Destination Address Translatation and type either the IP address load balancer that front ends the internal server farm or the IP address of the internal server (private IP - make sure is static so if you reboot it does not change)You also need to configure routing on the VM-Series and routing entry in the UDR to direct traffic in the internal server subnet through the VM-Series.",0,08-29-2017,12:59 PM
942,171844,Amaresh,Does it require to configure NAT Inbound rule on Azure ?Consider the scenario as mentioned belowPublic IP (Load balancer ) Front end- 13.182.82.10Unrust Interface - 10.0.1.4Trust Interface - 10.0.2.4Internal server -10.0.5.4Port to be exposed - RDP and 443Could you help me with the NAT rule on palo alto firewall.,0,08-30-2017,02:09 AM
943,171844,kblackstone,"Hi Amaresh, there are 2 ways you can do this:1. Create a NAT policy that doesn't filter for inbound port so that you can account for both RDP (3389) and 443 coming into the same host. Then rely on your security policy to allow only the applications/ports you wish.2. Create 2 separate NAT policies, one that filters specifically for port 3389 and one that filters for 443.I've provided an example below of #1You will also need a corresponding Security Policy with the source zone of Untrust and the Destination zone of Trust, for the appropriate applictions that you want to allow access to. The Destination IP would be 10.0.1.4 in this case. You can leave the destionation IP set to any if you prefer to see the destination IP show up in the traffic log, and adjust the Security Policy after the fact.",0,08-30-2017,05:54 AM
944,171844,Amaresh,Thanks for the replyStill am not able to access the server with static nat config.Kindly find the configOn AzureNote - From machine 10.0.3.5 able to acces internet . But static nat is not working,0,09-04-2017,06:28 AM
945,171844,kblackstone,"Hi Amarash, have you created all of the necessary load balancing rules, probes, etc.? It might be worth contacting your Palo Alto Networks sales team who may be able to assist and get you up and running.You need:Front Side IP AddressBackend PoolHealth ProbeLoad Balancing RulesCorresponding port open on the firewall or wherever your health probe is going toCorresponding security rules to allow the health probe to passThe correct routes on your VM Series to account for the health probe(s)",0,09-04-2017,07:32 AM
946,138045,dmaynard,"Hellomathiasj,I have reviewed and your template and I can also duplicate your issue.I modified your code a little -(also removed the password from your code) check your post!https://github.com/dmaynard1/Azure-Custom/tree/master/vmseries-ARM4interfaceMy template creates 4 interfaces but eth3 does not get assigned. I have not found out why but have found a work around in powershell to get the interface attached.Powershell = PSps>Save the VM you want to add the vNic to a variableGet the network interface Location ID information for the vNic you want attached to firewallexample (/subscriptions/{your subscription number}/resourceGroups/{your RG name}/providers/Microsoft.Network/networkInterfaces/fw-eth3)Add vNicUpdate VM with newvNicStart VMConfigure IPv4 address and zone on firewall GUI",0,05-10-2017,11:43 AM
947,138045,niyengar,"Did you modify the virtual-machine-password.json and/or virtual-machine-sshPubliKey.json?That is the template that deploys the actual VM-Seires and need to know how many interfaces to attach to itself.""networkProfile"": {""networkInterfaces"": [{""id"": ""[resourceId('Microsoft.Network/networkInterfaces',concat(parameters('nicName'),'0'))]"",""properties"": {""primary"": true}}, {""id"": ""[resourceId('Microsoft.Network/networkInterfaces',concat(parameters('nicName'),'1'))]"",""properties"": {""primary"": false}}, {""id"": ""[resourceId('Microsoft.Network/networkInterfaces',concat(parameters('nicName'),'2'))]"",""properties"": {""primary"": false}}]}",0,05-10-2017,11:53 AM
948,138045,dmaynard,"I didnt add 4th interface to the deployment filesvmseries-ARM4interface/virtual-machine-password.jsonAndvmseries-ARM4interface/virtual-machine-sshPublicKey.jsonThe vm is getting delployed using those files as refernced the ""base uri"" to be my githup repoAdded the forth interface to those files and workedSince you are calling the paloalto master json files as your ""base uri"" and those files do not have the 4th interface is why the interface is not getting attached to firewall.",0,05-10-2017,12:22 PM
949,138045,dspears,There is an example of a 4 interface template on the Palo Alto Networks Github site.  A link to the template can be found on Live Public Cloud Integration website located here:https://live.paloaltonetworks.com/t5/Public-Cloud-Integration/ct-p/Cloud_TemplatesThe direct link to the template is:https://github.com/PaloAltoNetworks/Azure-FW-4-Interfaces-,0,08-28-2017,08:39 AM
950,170128,Warby,"Your DNS idea should work. Another option is to create an address object that gets updated via our API when there is a change but I think the DNS option is cleaner.Or, better yet, can you change the EC2 instance to use an EIP? When the EC2 instances gets blown away the EIP gets disassociated but not released. Then you can re-associatethe same EIP to the new EC2 instance. Then the firewall config won't need to change at all.",0,08-05-2017,03:00 PM
951,165417,aper,is ARP resolving on the firewall ? Have you verified there's no security policy blocking the pings (app ping instead of icmp or implied intrazone policy at the end). Can you doublecheck the mgmt profiles have ping checked and are assigned to the interfaces,0,07-10-2017,02:50 AM
952,165417,ausafali88,,0,07-10-2017,02:52 AM
953,165417,ausafali88,Should i allow ARP (via Ethertype)in my custom Interface profiles attached to interfaces?,0,07-10-2017,04:05 AM
954,165417,ausafali88,Done by Plao Alto support.,0,07-11-2017,01:26 AM
955,165417,jperry1,"What exactly does ""done by palo alto support"" mean?Can you please provide a case number?",0,07-11-2017,09:29 AM
956,165417,ausafali88,It means:cheers.,0,07-22-2017,09:08 PM
957,162515,michelvankessel,Was anyone able to use Managed Disks with an Availability Set inside this ARM template?https://github.com/PaloAltoNetworks/azure/tree/master/vmseries-avsetmany thanks in advance!RegardsMichel van Kessel,0,07-10-2017,05:43 AM
958,162515,michelvankessel,"managed to alter the ARM template to use 8 NIC's and Managed Disks. Still finetuning.I have to take out the storage account, not needed and alter the SSH public file to use the same config as the password versionhttps://github.com/michelvankessel/azure/tree/master/demo-vmseries-avset",1,07-13-2017,07:49 AM
959,160098,melamin,"Hi Jenny,There is multiple issues releated to ipsec between PanOS and Azure.And if you 100% SURE you are hitting the same issue as 96415 on 7.1.6, then another bug need to be raised.ThanksMo",0,06-08-2017,01:54 AM
960,160098,JennyHuang36,"Hello Mo,Thanks for the answer, however, I do not have access right to both links you provided.Could you advise how to get them?Thank you.",0,06-08-2017,07:54 AM
961,160098,melamin,"Hi,Please raise support ticket and TAC will assist you in this.ThanksMo",0,06-08-2017,07:58 AM
962,149421,narayan,Can you follow this for IKEv2 and let me know if it works:https://live.paloaltonetworks.com/t5/Integration-Articles/Configuring-IKEv2-IPsec-VPN-for-Microsoft-...There doesn't seem to be much difference between the two...you may need to uncheck the liveliness check andthe DH group to no-pfs.,0,03-24-2017,01:55 PM
963,149421,nformatiq,"Hello,Thank you for your answer.I make modifications, but it doesn't work. I have the same error message in systems logs :",0,03-27-2017,12:30 AM
964,149421,nformatiq,I have just had a new error message:,0,03-27-2017,07:50 AM
965,149421,TranceforLife,"Heys,Would be nice to see a full log output:>tail lines 200 mp-log ikemgr.logIt is beensome time since my last set-up but just a quickupdate/tips on this:- make sure Paloin the ""passive"" mode. So it will not be able to initiate a VPN but we could not make it working when its disabled.- IKEv2 initiate 2 tunnels: IKE tunnel ( old name of IKEv1 Phase 1) and CHILD_SA (old name of IKEv1 Phase 2). Default lifetime for IKE Tunnel is 86400 or28800 seconds (depends of the vendor)for CHILD_SA is 3600 seconds hence your tunnel will be always re-established every hour. But ittakes couple seconds not minutes.- disableno-pfson IPSec Crypto- disable ""Liveness Check"" on the IKE Gateway configuration.Make sure that all other setting are compatible with Azure. Please see below:IPsec ParametersAlthough the values listed below are supported by the Azure VPN Gateway, currently there is no way for you to specify or select a specific combination from the Azure VPN Gateway. You must specify any constraints from the on-premises VPN device. In addition, you must clamp MSS at 1350.IKE Phase 1 setupIKE Phase 2 setupAfter doing all this tunnel still stable for the past 3 days.You can clear the tunnel couple times to see if everything is working correctly:> clear vpn ike-sa gateway (for IKE Tunnel)> clear vpn ipsec-sa tunnel (for CHILD_SA)Hope it helps!more infohere:https://live.paloaltonetworks.com/t5/General-Topics/VPN-to-Azure-dropouts/m-p/98936#M44162",0,03-27-2017,03:01 PM
966,149421,tounsi,"Hi all,I need your help to configure a vpn between PA3020 and Azure with dynamic gateway.I have a problem ""ike-nego-p1-fail "" --> ( description contains 'IKE phase-1 negotiation is failed as initiator, main mode. Failed SA: X.X.X.X[500]-X.X.X.X[500] cookie:6a4facbf0c032fc8:0000000000000000. Due to timeout.' )and ( eventid eq ike-nego-p1-delete ) --> and and ( description contains 'IKE phase-1 SA is deleted SA: SA: X.X.X.X[500]-X.X.X.X[500] cookie:6a4facbf0c032fc8:0000000000000000.' )",0,05-02-2017,07:35 AM
967,149421,niyengar,"Hi, My guess is that you need an alternative authentication method in the IKE gateway setup: Local Identification portion.You can use email or fqdn and as long as they match on both sides it doesn't matter what it is...The guess is here that NAT is breaking IKE",0,05-02-2017,02:57 PM
968,149421,TranceforLife,"Make sure you have Layer 3 communicationbetween thepeer. Before setting up thetunnel, please ping the remote peer ip.If Layer 3 is good, make sure your policy is allowing ike,IPSecetc application on the untrust interface (zone).",0,05-11-2017,06:14 AM
969,149421,JennyHuang36,"Hi, I got question regarding 96415 fixed in 7.1.6. However, I am still seeing the issue in 7.1.6.What should I do, should I upgrade to 8.0.0+Please assist. Thank you.96415Fixed an issue where the firewall failed to pass traffic in strongSwan and Azure IPSec tunnels while using IKEv2 because it did not send a Delete payload during a Phase 2 Child SA re-keying. With this fix, the firewall correctly sends a Delete payload during re-keying if it is the node that initiated the re-keying.",0,06-07-2017,04:40 PM
970,158161,Warby,"I did some tests with dual VM-Series firewalls in a services VPC running PAN-OS 7.1 last year and I got about 320 Mbps per firewall with iperf and 300 Mbps with httperf. (The datasheet states 250 Mbps officially for IPsec.) I haven't re-run the tests with PAN-OS 8.0but according to the AWS specsheet, the VM-Series cando up to 3.5 Gbps now.",0,05-24-2017,12:56 PM
971,156922,niyengar,Is this usingPANOS 8.0? I assume you are sending all your traffic directly to internet from your GP Gateway?,0,05-16-2017,10:37 PM
972,156922,ACD-II,"It is 8.0.1, and it uses an Elastic IP for Internet facing traffic. The Agent is on my laptop in Corp over a Direct Connect 10 Gb connection. The tunnel connection for the GW is on the trusted side of the FW. I know throughput from Corp to a Squid to the PA is good, 600 Mbps, so it isn't connectivity between hosts.",0,05-24-2017,06:03 AM
973,157457,niyengar,What is your source on GitHub?Just visually the xpath looks correct...,0,05-19-2017,09:52 AM
974,157457,clyde.franklin,"supposdly the paloalto.py file below should workdef paloalto_rule_add(pa_ip,pa_key,rule_params): # Add a new rule on Palo Alto gateway # Input: Palo Alto gateway IP, Palo Alto Access Key, and rule_params # rule_params are the parameters to be configured for the new rule. It is a dictionary with the following values: # rule_params['name']: name of the rule # rule_params['dstZone']: destination zone # rule_params['srcZone']: source zone # rule_params['srcIP']: list of source IP addresses # rule_params['dstIP']: list of destination IP addresses # rule_params['application']: application # rule_params['service']: service # rule_params['action']: rule action (allow, deny) # rule_params['spg']: name of security group profile to be set # Output: returns 'success' or 'fail' depending on the result  ctx = ssl.create_default_context() ctx.check_hostname = False ctx.verify_mode = ssl.CERT_NONE  cmd = ""/api/?type=config&action=set&"" parameters = {'xpath':""/config/devices/entry[@name=\'localhost.localdomain\']/vsys/entry[@name=\'vsys1\']/rulebase/security/rules/entry[@name=\'""+rule_params['name']+""\']"",'element':""<to><member>""+rule_params['dstZone']+""</member></to><from><member>""+rule_params['srcZone']+""</member></from><source>""+rule_source_ip+""</source><destination>""+rule_destination_ip+""</destination><application><member>""+rule_params['application']+""</member></application><service><member>""+rule_params['service']+""</member></service><action>""+rule_params['action']+""</action><profile-setting><group><member>""+rule_params['spg']+""</member></group></profile-setting>""} url = ""https://""+pa_ip+cmd+""Key=""+pa_key+""&""+urllib.urlencode(parameters) response = urllib2.urlopen(url, context=ctx) contents= ET.fromstring(response.read()) result = 'success' return result",0,05-19-2017,10:13 AM
975,155104,niyengar,Do you mean bundle 1 to bundle2?You can get a new auth code for bundle2 and activate it (but you may need to deactivate the previous license),0,05-04-2017,10:06 AM
976,155104,mcov250,"Yes correct,Currently I have deployed an Azure Palo Alto appliance (Plan 1). We would like to migrate to the Azure Palo Alto appliance (Plan 2). Is it only a license code which upgrades the appliance from Plan 1 to Plan 2?What about the Azure pricing model.. will this also be updated automatically..?Regards,Remco",0,05-12-2017,01:04 AM
977,155104,niyengar,"Editing response...Are deploying Pay as you go models or BYOL models?If Pay-as-you-go, then you will need to deploy a new firewall (save the old config first)If BYOL, then you will just need to apply a new license/authcode to the existing firewall.",0,05-12-2017,09:33 AM
978,154126,niyengar,"Steve, For outbound, just add a static route that forwards trafffic as you suggest. I *think* you can just forward it to eth 1/1 (an not mentionthe ip address of the subnet) of the fw -- assuming eth1/1 is whatNIC1 is connected to.The NIC in Azure has the public IP and the firewall doesn't even see it. It only see the private address.",0,04-25-2017,10:49 AM
979,154126,24481,"I was not able to get this to work without putting a source nat policy in and after I put that in internet access is available.nat-type ipv4;from trust;source any;to INTERNET;to-interface ethernet1/1 ;destination any;service any/any/any;translate-to ""src: ethernet1/1 x.x.x.x (dynamic-ip-and-port) (pool idx: 1)"";",0,04-27-2017,12:45 PM
980,144903,TranceforLife,"Hello@faizullah,Your image is not uploaded properly. Please, can you repost it again? l am sure we can figure it outThx,Myky",0,02-27-2017,09:14 AM
981,144903,aizullah,errorError while selecting 2nd public ip.,0,02-27-2017,11:30 AM
982,144903,aizullah,errorError while selecting 2nd public ip.,0,02-27-2017,11:30 AM
983,144903,aizullah,"Thanks MyKy for looking into it please let me know if u need anything else , the only use case i want to understand here how we can configure Site-to-Site IPsec VPN b/w Palo Alto Device hosted in Azure cloud with only public IP on Mgmt Interface with ASAv hosted on Azure or AWS as ASAv honors use of MGMT interface as local address or source interface in S-S ipsec vpn.",0,02-27-2017,01:38 PM
984,144903,TranceforLife,"Hello@faizullah,As far as l am awareMGMT interface it is purely for the device management out-of-bandtraffic (getting updates, manage the device etc). To have an S2S VPN you still have to configure policy ( Palo is a zone-based firewall whereCisco ASA is an interface based). Since you cannot add your MGMT interface to thepolicy think it is not possible in your scenario. However, you still can manage firewall using any other interface with MGMT profiles applied allowing (HTTPS or/ and SSH).Thx,Myky",0,02-28-2017,12:48 AM
985,144903,aizullah,If Mgmt interface is only control plane traffic how we can use Palo Alto FW deployed in AWS cloud with single public IP for S-S ipsec VPN tunnel .I have checked this thread and used Elastic Public to asssociate with eth1 but still not working and is getting stuck in Maintaence mode .https://live.paloaltonetworks.com/t5/AWS-Azure-Discussions/Azure-VM-Series-and-mgmt-interface-swap/m...Will really appreciate if someone can tell me if S-S IPsec vpn possible for PaloALto deployed in AWS with Single IP or not .,0,03-07-2017,02:28 PM
986,144903,ChrisRussell,"You are going to have to set an unstrust interface to be public facing and terminate the IPsec tunnel there, and then apply a management profile to it. Using the only public IP for your management interface will not work for setting up a tunnel.",0,04-26-2017,11:03 AM
987,144903,Warby,"Hello,Azure announced last month support for multiple public IPs per instance: https://azure.microsoft.com/en-us/updates/ga-multiple-ips-per-nic/Youcan now assign a public IP to the VM-Series management interface and a separate public IP address to the dataplane and use that second IP to build your IPsec tunnel.",1,04-27-2017,10:12 AM
988,147469,niyengar,"Hi, The bootstrap config will have a user and a password associated with that user.When bootstrapping and if bootstrap is successful, then that username password should take into effect. If it doesn't then chances are bootstrapping has failed. One way to verify if bootatrapping has failed is to try to login to the firewall using the ssh key used to launch the firewall and see if any of the bootstrap config has madeit ot the firewall.Qs:1. Which reason are you deploying the instance in?2. Can you log into the firewall using your ssh key?3. If so, does it look like any of your config is in there?Few reasons bootstrapping could fail (and it should be covered in the guide, if not please let me know and we will add it):1. bootstrap bucket name is incorrect2. bootstrap iam policy is incorrect or not associated with ec2 instance.3. bootstrap bucket not in the same region as instance deployed.4. user-data field not sepcified when launching ec2 instance5. Bootstrap bucket configuration is incorrect.",0,03-13-2017,12:43 PM
989,147469,K_Celenza,"So you are correct, the bootstrap is not taking. I am ssh'd via pem key, and I can see this error message:( description contains 'Mandatory bootstrap bundle component missing.' )I am stuck in a support loop, where I need to register the device I am having a problem with, but it's on a new build, not an existing.From someone helping me on AWS side:yeah as far as I can tell, 1-4 are fine:bucket name matches up, IAM policy is associated with the EC2 instanceis set to allow ""ListBucket"" and ""GetObject"" on the bucketrecursively for all items in the bucketand the bucket is in ""US Standard"" regionuser-data field is set to: `vmseries-bootstrap-aws-s3bucket=customer-palo-alto-bootstrap`",0,03-13-2017,01:15 PM
990,147469,niyengar,,0,03-13-2017,01:19 PM
991,147469,K_Celenza,"It does, now possible one of them is misconfigured.But the error makes me beleive that my bootstrap.xml is off, but no way of knowing where/why?",0,03-13-2017,01:27 PM
992,147469,K_Celenza,I think I missed the init-cfg. Trying now.,0,03-13-2017,01:35 PM
993,143203,howardtopher,"I opened a case with support to ask them. I ended up having to use custom templates to deploy 7.1 in Azure. Honestly, it was a real pain and I'm not sure why Microsoft can't give us a choice of what version to install from the marketplace. Anyway, it worked and I now have a 7.1 VM in Azure.",1,02-16-2017,09:25 AM
994,136469,srar.ahmad,"Got it resolved by calling support. Support guy did it on behalf of me.Thanks,",0,01-09-2017,08:50 AM
995,133392,mlue,The Palo Alto Networks AMIs in AWS are created using EBS-backed storage. This provides persistency for the data stored on the root device and will allow the instance to be powered off withoutthe data being deleted.,0,01-03-2017,10:38 AM
996,133392,SalesforceIQ,Don't use anything with ephemeral storage. It is wasted. PAN uses only EBS which I prefer.Snapshots of EBS volumes are useless. We had to write something to backup the PANs. PAN support and documentation wasn't much help.,1,01-08-2017,10:16 PM
997,133949,TranceforLife,"Hi,l had a very interesting experience with Azure VPN. Fewthings to check check:1) PA has to be in passive mode so only Azure can initiate a VPN2) Suggested config:IKEv2Diffie-Hellman Group Group 2Authentication Method SHA1Encryption Algorithms AES256, 3DESPhase 1 Security Association (SA) Lifetime (Time) 28,800 secondsCHILD_SAEncryption Algorithms AES128, 3DESAuthentication Method SHA1Phase 2 Security Association (SA) Lifetime (Time) 5,400 (Azure side 3,600 seconds)Perfect Forward Secrecy (PFS) no-pfs3) Disable ""Liveness Check""More info here:https://live.paloaltonetworks.com/t5/General-Topics/VPN-to-Azure-dropouts/td-p/98936/page/3Thx,Myky",1,12-23-2016,03:57 AM
998,133949,DKanta,"Hi Myky,Thank for your suggestion, we solved it some days ago checking on Microsoft site (https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-vpn-devices), we used 'no-pfs' instead of DH group 2 on IPSEC Crypto key.Thank you again!Regards,Daniele",1,12-29-2016,02:35 AM
999,130439,jbaker,This capability is coming soon when Microsoft support multiple public IP's.Is there a native capability with the VM Series CLI to execute themgmt-interface-swap command? I would like to attach an Azure Load Balancer to the UNTRUST interface on eth0 so that I can force all internet facing application traffic through the VM Series firewall in my Azure vNET.,0,12-01-2016,03:07 PM
1000,130439,gduncan,"Thank you for your response. Outside associating a second public IP to UNTRUST on eth1 with that support from MS, what is the current use case for deploying VM Series in Azure for securing internet facing application traffic? In my case, I would like MGMT to only be private and UNTRUST to be public. It appears Palo Alto solved this alreadyfor AWS and using an ELB with the mgmt-interface-swap CLI command.",0,12-01-2016,03:47 PM
1001,130439,jbaker,"You are spot on with your thinking. By the way, I am not certain who you are. I know you are gduncan but I am having trouble connecting the dots. Let me check on the Azure managment interface swap for you.Jeff",0,12-01-2016,04:02 PM
1002,130439,gduncan,"Thank you Jeff, appreciate your input. I don't think we've met. I'm Geoff Duncan, Sr. Solutions Architect with Digital Fortress in Seattle. We focus on hybrid technology solutions and services for our clients as well as operate redundant datacenters in the Seattle metro area.",0,12-02-2016,07:35 AM
