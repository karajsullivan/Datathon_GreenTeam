,Discussion ID,Author,Body,Likes,Date,Time
0,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
1,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
2,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
3,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
4,507954,teJacobCF,what does your signature look like?,0,07-06-2022,01:01 PM
5,192889,benparker,"As an update to this, it can be accomplished using a custom Threat and the equal to operate to match against the Context of SSL-RSP-version. The values that are needed to match againstExample TLS 1.0I do not recommend leaving the TLS 1.2 threat in an alert mode if you create it but instead change it to allow as it will be extremely noisy. It is however useful if you need to verify the functionalityThese 3 custom vulnerabilities will allow you the capability of alerting or blocking lower level TLS encryption if areas that might require it for complaince such as PCI zones.Alternatively you can also use decryption profiles to force the traffic to the high level, but it does not produce the same logs for visibility.The attatched XML is the example threat signature to look for TLS1.0 responses.",9,01-09-2018,07:23 AM
6,192889,JTKoris,"Hi Ben,A couple of years behind but appear to be faced with a similar query from a customer I am currently working with.Essentially wanting to go about achieving the same - creating a log entry of each time TLS 1.0 or 1.1 is used by clients accessing their domain.With your suggestion, could you clarify what area of configuration you are going into in order to apply this or better yet, a resource of which shows how to go about this step by step?Essentially want to go about the same idea suggested just not wholly confident on where in the Palo Alto you would do this - any pointers would be greatly appreciated.Kind regards,JT",0,06-20-2022,04:06 AM
7,192889,hisingh,@JTKorisand@benparkerHere is KB articlehttps://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u0000008UgRCAUThanksHimani,1,06-20-2022,07:35 AM
8,300532,NikhilMohod,Recently we faced a similar scenario where multicast routes need to be converted to Palo Alto format. ForJuniper ScreenOS firewall to a PaloAlto firewall (5200) series conversion.Only relevant article we could find:How to Facilitate Multicast Routing when only One Palo Alto Net... - Knowledge Base - Palo Alto Netw...Here is cli o/p:set mroute multiple-iif-enableset mroute mgroup 200.X.X.X source 0.0.0.0 iif aggregate2 oif aggregate1Can Palo Alto please reply?,0,03-31-2022,08:24 AM
9,469555,LCMember3265,"More like ""http-req-host-header"" != ""ssl-req-client-hello""***Domain Fronting Detection",0,03-01-2022,11:00 AM
10,211714,jvalentine,"All of the *.ring.com URLs are categorized as ""business-and-economy"" in my firewall. Are you still having this issue?",0,07-28-2018,01:19 PM
11,211714,JoeAndreini,"If you know the URLS, and they are being categorized incorrectly, why not create a custom category for them and allow it?",0,07-30-2018,09:24 AM
12,211714,JoshFountaine,"I know this is an older thread, but we are experiencing this issue as well. All of the functionality within the Ring app works as far as we can tell except the live video feed. The other Ring traffic hits URL Category: business-and-economy.The live video feed traffic is showing up in our URL filtering logs as category: unknown, and action is block-continue. Unlike the rest of the Ring traffic, these requests are not resolving DNS, so the URL entry just shows an IP address:15064, so I don't have a list of URLs to add to a category.Thoughts/ideas to get this to work without allowing unknown category?",1,09-23-2019,08:29 AM
13,211714,Rosenbusch,I have the exact same problem with my 220. Only way that I can get it to work is remove the Palo. I have an any any rule and it still doesn't work.,1,11-16-2019,02:47 PM
14,211714,jeremyw,"I've had this issue for a while and have just looked into it further.In our case I just changed the unknown category to alert.However I understand that this might not be appropriate in all cases.To keep the unknown URL category blocked, what you could do is create a rule above your web browsing policy to permit ssl on TCP/15064 to the internet, and on this rule have a URL filtering profile applied which permits unknown URLs.If you wanted to make this more specific you could set up an external dynamic list for Amazon AWS using MineMeld and use that as the destination address.Hope that helps ðŸ™‚",0,11-28-2019,05:57 PM
15,211714,FrankJamesWilsoaria-labeln,"I know this is an old post, but I just ran into this problem as well. I have two Ring Cameras, one door bell cam and one stick-up cam in my backyard.All of sudden, both cams stopped showing recorded images and the live feed didn't work.I did get motion alerts, but when I tried to click on live view the image just never showed up.After some investigation, I found that RING was being stopped by threat prevention in the Palo.In the logs it appeared that there were to instances of calls being made from the inside that hit the Threat policy.Suspicious TLS Evasion Found on port 443 andMicrosoft Communicator INVITE Flood Denial of Service Vulnerability on port 15063Both of which where informational.To mitigate this I created a new Security Profile where I removed dropping packet that where on informational nature and added that to a policy that matched the predefined RING application.Once that was done, all feeds and events came right back up.",1,05-27-2020,03:06 AM
16,211714,JohnSmock,"Frank,Thanks for posting your solution, but I am not clear on how you see it in the logs? Which log were you seeing the threat? I can not find any log details that match up with this. Also, which security profile did you setup? I tried matching the Ring application and then just not having any security profile at all...",0,12-30-2021,01:15 PM
17,211714,BenNoonan,"After reading the article on ring, it doesnt specify but is required. TCP9002 for liveview on app.",0,02-27-2022,06:45 PM
18,441544,nikoolayy1,This question is for Cortex XDR/Traps categories not for here. From what I seen for example even in other endpoint systems like Microsoft defender extensions and hashes are used and not the file names. Maybe only URL filtering or file path can be used for something like that:Add a New Restrictions Security Profile (paloaltonetworks.com)Cortex XDR/Traps in itself does not support URL filtering like the Microsoft Defender custom indicators but the firewall can do this as it's job:https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000CljWCASMaybe endpoint DLP can do what you want like Digital Guardian etc. as blocking a file name is more like DLP task than EDR/Endpoint protection systems.,0,01-24-2022,01:11 AM
19,413613,nikoolayy1,The last I saw there were options for HTTP headers but I didn't see for email headers but you can double check it. See the link below and search for ''Pattern match''' with smtp:Create Custom Application Signature (paloaltonetworks.com),0,01-13-2022,12:56 AM
20,413613,SergiyL,"Hello Nikolay.I wrote that I didn't find description of the ""smtp-email-headers"" context in Custom Application IDs and Signatures guide. But this context is present in the list of available context options for Customer App in the real device software (for example PA-820, at least for s/w 9.1.x and later). See attached screenshot.The ""email-headers"" context description can be found using Search Box under Table of Contents in the document mentioned in your answer. Link to search result ishttps://docs.paloaltonetworks.com/pan-os/u-v/custom-app-id-and-threat-signatures/custom-application-...As I didn't find""smtp-email-headers"" description I hoped someone explains the difference between these 2 contexts.Thanks for your reply",0,01-13-2022,04:40 AM
21,400172,nikoolayy1,"You can look at the ""QUALIFIER"" option as you can select the request method ""POST"" or ""GET"" from there and maybe you will not need to specify it in the pattern match.Create Custom Application Signature (paloaltonetworks.com)Also for blocking something maybe better use IPS signature than app signature:Threat Signature Categories (paloaltonetworks.com)Learn More About Threat Signatures (paloaltonetworks.com)",0,01-13-2022,01:12 AM
22,452166,nikoolayy1,Please see if this helps as this is new feature in 10.0 with the enhanced signature match:Solved: LIVEcommunity - Custom threat signature- search full TCP payload of any AppId - LIVEcommunit...Enhanced Pattern-Matching Engine (paloaltonetworks.com),0,01-13-2022,12:59 AM
23,436096,nikoolayy1,"You check my idea for app signature for the referrer header:LIVEcommunity - Knowledge sharing: Version 10 no 7 byte limit for sinatures examples for Layer 7 (L7...Please also the link below and the part how to make multiple match conditions ""Create Custom Application Signature (paloaltonetworks.com)",1,01-13-2022,12:36 AM
24,430873,TomYoung,"Cool idea! Just like the GitHub code on HTTP response codes for visibility.This configuration works for Type 8 and Type 0:tyoung@fdslcofw01# show | match 4400set threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator equal-to value 0set threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator equal-to context icmp-rsp-codeset threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator equal-to negate noset threats vulnerability 44000 signature standard icmp-rsp-code order-free yesset threats vulnerability 44000 signature standard icmp-rsp-code scope protocol-data-unitset threats vulnerability 44000 default-action alertset threats vulnerability 44000 threatname ""ICMP Type 0""set threats vulnerability 44000 severity informationalset threats vulnerability 44000 direction bothset threats vulnerability 44000 affected-host client yesset threats vulnerability 44000 affected-host server yesset threats vulnerability 44008 signature standard icmp-req-data and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match pattern 8set threats vulnerability 44008 signature standard icmp-req-data and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match context icmp-req-dataset threats vulnerability 44008 signature standard icmp-req-data and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match negate noset threats vulnerability 44008 signature standard icmp-req-data order-free yesset threats vulnerability 44008 signature standard icmp-req-data scope protocol-data-unitset threats vulnerability 44008 default-action alertset threats vulnerability 44008 threatname ""ICMP Type 8""set threats vulnerability 44008 severity informationalset threats vulnerability 44008 direction bothset threats vulnerability 44008 affected-host client yesset threats vulnerability 44008 affected-host server yesset profiles vulnerability Internal-VP threat-exception 44008 action defaultset profiles vulnerability Internal-VP threat-exception 44008 packet-capture disableset profiles vulnerability Internal-VP threat-exception 44000 action defaultset profiles vulnerability Internal-VP threat-exception 44000 packet-capture disable[edit]tyoung@fdslcofw01# exitExiting configuration modetyoung@fdslcofw01> show bad-custom-signaturebad performance custom signature list:TID: 44008, Vsys 1, Context: icmp-req-data, Pattern: 8However, I did get the following commit warning: Warning: one or more custom signatures have big performance impact. Please see details in CLI ""show bad-custom-signature""You can see the command output above.There is one strange behavior. I enabled the signatures in 1 VP, but it logs for all. See step 4 in https://docs.paloaltonetworks.com/pan-os/u-v/custom-app-id-and-threat-signatures/custom-application-....",2,09-01-2021,06:40 PM
25,430873,Chris_Johnston,"Makes sense it would log in all, unless you went into each VP and marked it as 'ignore'. That was the challenge with creation of app - it overrides all other icmp apps and unless you create a new application group 'icmp-all' that included icmp and the customs....potential for things to be missedEdit: Actually, no...doesn't make sense on the VP now looking in depth. Probably one of those PA gotchasThanks for crafting the signature! I'm looking forward to seeing it in my lab (and potentially prod!)",0,09-02-2021,06:22 AM
26,430873,hisingh,"Hello@TomYoungand@Chris_JohnstonThank you for the post.What are we solving;Identify the ICMP request and reply using a custom threat signature.For ICMP response ( echo-response):In the custom vulnerability signature, the identity echo-response is easy as the context is available.The signature44000, will work perfectly as we have selected icmp-rsp-code [ as 0] and you can also add icmp-rsp-type [ also as 0].The threat logs is shown as below.â€ƒFor ICMP request, that is echo request:This is hard to identify as in the custom vulnerability signature, there is no context to select ""icmp-req-code"" or ""icmp-req-type"".The below line will match the payload in the icmp protocol.>>set threats vulnerability 44008 signature standard icmp-req-data and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match context icmp-req-dataThe best way to identify the response code is, please use the custom application identification with ICMP base and select the Type and code as follows.CLI:show application icmp-echo-requestset application icmp-echo-request default ident-by-icmp-type type 8set application icmp-echo-request default ident-by-icmp-type code 0set application icmp-echo-request subcategory internet-utilityset application icmp-echo-request category general-internetset application icmp-echo-request technology network-protocolset application icmp-echo-request risk 1set application icmp-echo-request parent-app icmp[edit]show threatsset threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator equal-to value 0set threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator equal-to context icmp-rsp-codeset threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator equal-to negate noset threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 2"" or-condition ""Or Condition 1"" operator equal-to value 0set threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 2"" or-condition ""Or Condition 1"" operator equal-to context icmp-rsp-typeset threats vulnerability 44000 signature standard icmp-rsp-code and-condition ""And Condition 2"" or-condition ""Or Condition 1"" operator equal-to negate noset threats vulnerability 44000 signature standard icmp-rsp-code order-free yesset threats vulnerability 44000 signature standard icmp-rsp-code scope protocol-data-unitset threats vulnerability 44000 default-action alertset threats vulnerability 44000 threatname ""ICMP echo response""set threats vulnerability 44000 severity informationalset threats vulnerability 44000 direction bothset threats vulnerability 44000 affected-host client yesset threats vulnerability 44000 affected-host server yes",2,10-10-2021,11:01 PM
27,430873,hisingh,"Hello@TomYoung and@Chris_JohnstonWith app and threat release 8484-7039, we have added a new context matching for customer signature. With these 2 new customer contexts, the type detection in ICMP will be a lot easier.icmp-req-typeicmp-req-codeI tested with icmp-req-type=8 to check the echo request and it was detected.Please see the attached screen capture.Himani",2,11-09-2021,04:27 PM
28,252502,Bart_Burford,"dpharis, on another post it was stated that Palo Alto does not do signatures for specific hashes since the same malware can/will use different hashes. My question is if my org decides to do custom sigs for specific hashes, will it eventually hamper/degrade FW's performance say, after a couple thousand signatures?Thanks!",0,04-25-2019,06:24 AM
29,252502,dparris,"Hello Bart,Your research is correct. We do not create signatures for specific hash values because it is both inefficient, and easily bypassed with a minimal change to the original file.The performance impact is difficult to determine in a hypothetical situation due to the limitless environmental variables. The short answer though is yes, there will be an impact to utilizing large numbers of custom signatures. If you intend to block a large number of files using customer signatures, instead of using hashes, we suggest you identify a unique character string in the file and utilize if after thorough testing, as this improves your changes of catching multiple variants of the same malware.",1,04-25-2019,07:00 AM
30,252502,Bart_Burford,Copy that. Appreciate your quick reply!,0,04-25-2019,07:13 AM
31,252502,Shane98,,0,07-23-2021,12:03 AM
32,412522,mivaldi,"You should try using a targeted security policy with a Custom URL entry to match the URN of interest in the Service/URL Category tab of the Security Policy Rule. You will then apply the restrictive Vulnerability Protection Profile with an Exception set to block on your Custom Vulnerability Signature. Note that given that these are HTTP(S) resources, this is dependent on successful TLS decryption.",0,06-30-2021,12:26 PM
33,412522,IamJoeG,"Thanks, any idea what the terminating character for the custom URL would be? For instance, how would one limit to only the top level meaning example.com but not grant access to example.com/file1, example.com/cgi-bin, or example.com/*",0,07-01-2021,04:59 AM
34,412522,Lucky,"you can block a single URL if you use a literal URL for the policy and no special characters such as asterisk tailing the string, so just put in example.com/ and no ""*"" at the end.",0,07-01-2021,05:17 AM
35,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
36,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
37,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
38,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
39,254483,nikoolayy1,"Version 10 does not have this limit, so consider an upgrade.",0,03-24-2021,02:37 PM
40,387628,claudec,"Hi,If you are using a text string you need to escape the ""."" because it's a regex token. For example:Edg/88\.0\.705\.63",1,02-24-2021,02:39 PM
41,387628,brian.saloum,"First and foremost, thank you for the response!!So you're using the \ to make the period digestible?",0,02-26-2021,07:34 AM
42,387628,claudec,"Hi,That is correct..if you want to perform an exact match on the period character and do not ""escape"" the period then the system will interpret it as the regex token ""."" which means ""match any character"".",1,02-26-2021,08:24 AM
43,387628,brian.saloum,Thank you very much!!,0,02-26-2021,09:20 AM
44,387045,hisingh,"Hello In 8.1, 9.x series; the Pattern will not be accepted if it is less than 7. We need some more data like any other common characters in the string to match.Here is the document that explained how the customer signatures are created:https://knowledgebase.paloaltonetworks.com/servlet/fileField?entityId=ka10g000000U0ruAAC&field=Attac...BestHimani",0,02-21-2021,09:53 PM
45,387045,Noam.Rotter,"Hi@hisinghThank you for the answer and referring me to the PDF - it's helpful.Well,The dir I need to block is /mng/ likehttps://www.mysite.com/mng/loginAs you can see, the uri /mng/ is less than 7 bytes...",0,02-22-2021,02:52 AM
46,387045,hisingh,"HelloHow about using the URL custom blocklist? You can create a custom URL list with URL ""https://www.mysite.com/mng/login"" and set up as blocked.BestHimani",0,02-22-2021,05:07 AM
47,387045,Noam.Rotter,"Hi,Thank you for your idea, it answers the requirement.Regards,Noam.",1,02-22-2021,09:15 AM
48,354727,CCACieszkowski,"Hi@Mohammed_Yasin,http_method in the Custom Vulnerability Object is thehttp-methodQualifier and thehttp_client_body is thehttp-req-message-bodyContext, i.e.,:Albert",0,02-18-2021,05:35 AM
49,385836,claudec,"Hello,You can enable CTD inspection for the custom app by enabling ""scanning"" in the advanced tab of the signature.Regarding the negate condition in custom threat signatures, there are some restrictions. One is that it can not be the only match condition. At least one non-negate condition must be included. Also, if the signature scope is ""session"" the negate condition can not be the last match condition.",1,02-15-2021,06:43 AM
50,385836,MCervenka,"Hello,I did some other tests...Yes, this we can read in some manual, but on the other hand, we can also read, that this is dependent on the parent application. These packet payloads signatures of course are not. Anyway, I tried at the end everything to turn on and it did not help. And even the property I am matching is unknown-req-udp-payload. Maybe this unknown is important ðŸ˜žSo I ended with this question.Yes, you are right again. But after 20 or so packets, this signature does not work anymore. My signature will drop the session if a vulnerability is found in the first 20 packets only. I would like to inspect every packet in the UDP stream.",0,02-15-2021,07:05 AM
51,385836,claudec,"I don't think it's possible to configure a custom threat signature using the ""unknown"" protocol decoder that will inspect every packet for the entire duration of the flow.There are some improvements to the threat inspection process in PAN-OS 10 and so if you can run that version you might try using the ""udp context free"" decoder for your custom threat signature to see if there is a difference. Note that use of this context will incur a significant performance penalty.",0,02-15-2021,09:15 AM
52,385836,MCervenka,"Thank you Claudec. I will try. But as I read before, this will gives us an opportunity to search in the headers?Anyway, I will try it and post the results.M.",0,02-15-2021,12:40 PM
53,385836,MCervenka,"Same results, unfortunately.",0,02-15-2021,01:02 PM
54,260010,EricHep,I second this - really surprised this is not already identified. Search for port 7680 in your logs and you're likely to see it come up a lot.,1,08-02-2019,07:14 AM
55,260010,sebastianvd,any update on this one ?,0,11-24-2020,12:31 AM
56,260010,Tim.Whittaker,For now I did a custom to tcp/7680 with the following sig that matches pretty consistentlySignaturePattern MatchContext:unknown-req-tcp-payloadPattern:\x0e 53 77 61 72 6d 20 70 72 6f 74 6f 63 6f 6c 00\x,0,11-24-2020,05:41 AM
57,260010,claudec,"Be aware that this byte pattern could possibly match anything that uses the swarm protocol, not just WUDO.",0,11-24-2020,07:52 AM
58,349114,claudec,"Unfortunately you can not create a custom threat signature based on a file hash.At least some of the hashes you reference already have Anti-Virus signatures. You can investigate signature availability at threatvault.paloaltonetworks.com.If you have the actual sample you can submit it using the wildfire portal so a signature can be generated.If you are a Cortex XDR customer, you can black list the file hashes on your endpoints.",1,09-14-2020,07:22 AM
59,349114,Mohammed_Yasin,"Thanks for your comments. Much Appreciated|||https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000PLOlCAOI have studied and found no way to block custom files based on hash-256 only.As per document file can block but based on patterns of specific file types.In my case, these Hash-256 only of near firms which recently attacked by these files and damaged therefore it needs to be blocked at my end as well to avoid any risk.I found few of them are blocked in wildfire but not all, so how I can add all in block state while having no file sample or pattern.Please advise the way to block all these hashes-256 without a sample or pattern.Your prompt response will be highly appreciated.",0,09-14-2020,10:29 PM
60,349114,claudec,The only way to block a file by hash is if you have Cortex XDR on the endpoint.One feature that might possibly help is the new MLAV feature in PAN-OS 10.0. Here is the information:https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-new-features/wildfire-features/configure-wildfi...,0,09-15-2020,07:45 AM
61,349114,Mohammed_Yasin,"@claudecI think it can be helpful, if converting the hash into HEX and create a custom vulnerability to drop anything that matches the file hashes.https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA10g000000ClOFCA0And I have noticed, few ofthe hashes are already listed in Cisco Talos File Repute but not in PA Threat Vault.",0,09-15-2020,10:37 PM
62,349450,John.Petrucci,"Replying to myself here...Per this thread, it looks like my initial assumption was correct: https://live.paloaltonetworks.com/t5/custom-signatures/need-help-with-creating-signature-for-pop3/m-......So is there any way to search the payload of a TCP datagram of a known application - but an application lacking a pre-built Context? I think we need a Context called ""raw-req-tcp-payload"". I find it hard to believe that PAN would assume that someone who goes to the trouble of creating a custom vulnerability signature would only do so for traffic that is not classified as a known application. In fact, these are the type of people who will also go to the trouble of creating a custom application signature to eliminate unknown-tcp from their environment.",0,09-15-2020,11:44 AM
63,349450,claudec,"Hi John,You are correct in that versions prior to 10.0 you can not write a custom signature against a known application unless the decoder for that protocol/context is ""exposed"" in the user interface.In 10.0, there is more flexibility, including a ""context-less"" signature that may meet your requirements. Be advised that there can be performance penalties when using these expanded capabilities. More info here:https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-new-features/content-inspection-features/enhanc...",2,09-15-2020,11:57 AM
64,340192,pshah1,Custom Signature worksBut can't get regex working correctEX->Negate all Private ip address and match rest ipv4/ipv6,0,07-23-2020,11:24 AM
65,336446,claudec,"There is already an out of box App-ID for IPSEC NAT Traversal...""ipsec-esp-udp"". If the App-ID engine is already detecting this traffic as this App-ID, then you can not write a custom signature for it because there is no exposed decoder for this protocol.If the firewall is detecting the traffic as ""unknown-UDP"" then there would be an opportunity to possibly use a custom App-ID.While you can use regex in an App-ID signature, you still need a 7-byte anchor.",1,07-02-2020,07:39 AM
66,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
67,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
68,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
69,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
70,319324,Lucky,"Hello, and welcome,your request sounds like very unusual one: you want to allow File Transfer Protocol but you want to prohibit file transfer with it. That is quite easy: disallow File transfer protocol in the first place.If you are still trying to do what you asked above, this will be hard, because nobody planned to do that (allow FTP but block file transfers with it) so such context aren't necessarily included/exposed in the custom signature engine.There is a few hacks you could try to do, to achieve the same, nevertheless. Hacks are weird because use case is weird, I guess, but:- to block such requests as PUT or GET, you need custom signatures. Custom signatures for FTP context work by either looking at the context (byte pattern) or checking the length of the request (byte size).- it is very hard to use custom pattern as those require at least 7 consecutive hard-coded bytes to catch on; what you COULD do is: 1. prepend all your files in said FTP server with fixed 3-character patterns, let's say you prepend them with three consecutive underscores, so ""file.exe"" becomes ""___file.exe"",2. create blocking signatures for ""GET ___"" and ""PUT ___"" which will give you 7 consecutive characters (3 for text, 1 for space, 3 for underscores prepending all file names)2a. alternatively, you could see if commands that you wish to allow contain 7 bytes or more; than you could create custom signatures for what you ALLOW instead of renaming all files in order to block. however, most of the FTP commands are 3-4 characters so it will still be hard to find 7 matching consecutive characters. maybe your use case allows for this approach.- as you can tell, that's an ugly hack as it requires control over the files that are sitting in the server. sounds impractical. another approach would be byte size. this is tricky, because it could work possibly only by:1. taking a pcap of the FTP session where you would execute some allowed commands;2. allowing only a specific byte-length of the requests (that you observed above when you executed allowed requests). this approach might work and would probably block most of the put/get requests, unless request weirdly matches exact length size allowed earlierAnother and proper approach, from the point of view of system administration, would be to simply disallow particular users/user group those commands on the FTP server itself, and leave firewall out of it. that would be recommended and proper approach in the real world.Hope that this conversation humored you and that you'll still go with blocking whole FTP or blocking those users on FTP server itself, rather than trying to achieve very opposing goals at the same time (allow FTP but block file transfers).Cheers",0,03-30-2020,02:00 AM
71,319324,Jayanth_Lakshmiaria-labelpathy,"Hi Lucky.Thanks for your quick response.This request is not for allowing FTP but blocking file transfer.Let me explain the real requirement.the requirement is not only with FTP, any mode of file transfers.We have two servers,1. only users can upload the files to the server2. only users can download the files from the serverexample scenarios tried:1. Applied file blocking profile named ""download_block"" and mapped to the policy.2. from client machine, using filezilla FTP to the upload server and uploaded a .exe, .dll, .txt., et., file successfully --> expected behaviour3. from the same client machine, using filezila, FTP to the same upload server and tried to download, .exe, .dll, got blocked by file blocking profile ""download_block""---> expected behaviour. BUT., .txt, .log files downloaded successfully --> This is not expected behaviourHope, the above might explain clearly about my requirement.Thank youJay",0,03-30-2020,02:12 AM
72,319324,JoergSchuetter,"Maybe you can solve this on the ftp server itself?If you do prevent file listing (dir, ls, ...), the users can only download a file if they know the name. Would this approach help?",0,03-30-2020,04:18 AM
73,319324,Lucky,"blocking plain-text data files is extremely tricky.additionally, file-blocking policies, when you check them, don't show you any .txt or .log or any similar file types; basically because there exists no magic number by which file itself would be recognized. As long as you're allowing HTML, for example (web-browsing) you're allowing text files (HTML is actually just a text file, from a point of view of computer).Let's turn this conversation around for a moment - what is it that you in particular need to allow to the end points? If it includes web-browsing as a rule, you're pretty much trying again to do opposite things - allow text files while blocking them. You obviously want to restrict thoroughly an endpoint's communication; what is it that you want it limited to - that can be achieved again with security policies, and maybe even without custom signatures, or with some sig...",0,03-30-2020,04:34 AM
74,310628,JoergSchuetter,"Hello @palmanzaIs it mandatory to have a signature, or would application override suffice for your need?I simply created a new application (copied over the things from ldap, named it ldaps), and created the override policy. The policies where ldap was listed as application were extended by ldaps.",3,02-12-2020,09:25 AM
75,310628,palmanza,I am enforcing APP-ID and wanted to do it at the application lever but your suggestion should be good. The insteresting part is that the Palo is showing hits to the rule with the custom rule but when I review the traffic it does not show anything with that rule. Any ideas on that?Update on my own question.Looks like I needed to create the APP override which is something I have not done before but was able to do it properly and now the rule it is showing the traffic properly.Thanks,0,02-12-2020,01:06 PM
76,306778,Astardzhiev,Hi @alalLooking at the KB you post it seems the OS check comes to regex match in the HTTP header user-agent string.As a start I would suggest you to check the regex expression and see if its match what it is expected or it needs to be improved. It will be useful if you can past it here.Googling around you should be able to find how different OS versions are described in the user-agent string. My first results says:https://stackoverflow.com/questions/40218173/user-agent-for-windows-7-vs-8-vs-10So the regex expression should look like:This is also very useful site - http://www.useragentstring.com/,0,01-15-2020,01:54 AM
77,290529,Rajesh12,"Is your ask is to block DNS query traffic of specific hostname (nslookup hostname)? If yes, then it is possible to do it with PA. Let me know if my understanding is correct.",0,09-30-2019,12:30 AM
78,290529,MP18,I have name server and I see so many queries to the domain names that do not exist.So i need to know if i can create custom signature for nxdomains,0,09-30-2019,09:26 PM
79,290529,Rajesh12,Ah I see. PA do have capability of blocking DNS queries for given name. But I don't think PA have capability of blocking nxdomain as PA will not have any prior knowledge of existent or non-existent status.,1,10-01-2019,01:21 AM
80,290529,MP18,Thanks for answering my question.,0,12-01-2019,08:18 AM
81,293735,s_quasar,Solved. You have to use \s for the space instead of %20,0,10-24-2019,08:52 AM
82,283010,SteveCantwell,"It would be something like this:User-Agent: Wget/[0-9]\.[0-20]\.[0-9]I am not sure how many versions of Wget there are.User-Agent: Wget/1.13.4 may be the only one you need.If you have higher versions, use the RegEx listed at the beginning of my message.",0,08-21-2019,02:15 PM
83,283010,sayed_shubbar,I got attached error message. I do not think palo allow backets,0,08-22-2019,01:42 PM
84,283010,SteveCantwell,Brackets are allowed. We just did not have the 7 bytes yet.I just created this one on my FWUser-Agent: Wget/[0-9]\.[0-20]\.[0-9]Give a go and let me know.,0,08-22-2019,02:51 PM
85,257011,Neil_Xu,"@DanimalNot sure if you've addressed your issue.Recently I've ran into a similar situation where a vendor's software does not addresses the TCPtimeout properly, which I had to create an customized AppID for it in order to customize the TCP timeout values for that particular traffic.Here's what I did: -Navigate to Objects --> Applications --> Add - Configuration Tab: - Name: Name your AppID - Description: Some documentation about this AppID - Category: business-systems - Subcategory: office-programs - Technology: client-server - Parent App: None - Risk: 1 - Advanced Tab: - Defaults: Port - Port: port(s) or your application uses - Timeouts --> TCP Timeout: <tcp timeout value> - Policies --> Application Override --> Add - Enter the basics of the traffics flows for the application override policy. - Name - Src Zone - Src Address - Dst Zone - Dst Address - Protocol - Port - Application: <your custom AppID name>I learned that the Application Override policy is the policy that will POINT the matched traffic pattern to aspecific AppID (custom or OOB)Hope this helps or at least shine a light to your problem.",0,08-05-2019,09:56 AM
86,259735,mopiy,"Hi,Thank you for this information. We currently do not have coverage for this. I have requested coverage assessment based on the POC provided.Regards,Faith.",1,05-03-2019,07:32 AM
87,259735,allee,"Just closing the loop on this post, looks like threatvault (https://threatvault.paloaltonetworks.com/) is now displaying coverage forCVE-2019-9082 as threat ID54825.",0,07-18-2019,08:48 PM
88,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
89,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
90,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
91,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
92,258964,aper,,0,04-28-2019,09:19 AM
93,258964,nkatesan_radharia-labelakrishnan,Can i able to find the signature pattern used by specific vulnerability.RegardsVenky,0,04-28-2019,10:37 PM
94,258964,aper,,0,04-29-2019,02:45 PM
95,178320,tboire,"If you can send us the hash we can look to try and find the file somewhere else and make a signature if the file is malicious, but we do not do hash based blocks.",0,09-22-2017,01:39 PM
96,178320,Anon1,"Hello tboire,many thanks for your reply. It is regarding a recent ransomware campaign, e.g.hash:0f6ae637a9d15503a0af42be649388f01f8637ca16b15526e318a94b7f34bf6eCannot find in PA Threatvault, but Virustotal shows many vendors classify it as malware.hash:39256f126bba17770310c2115586b9f22b858cf15c43ab36bd7cfb18ad63a0c2Is found in PA Threatvault as malware, but there seems to be no signature (nothing shown regarding which wildfire content update contains a signature to block it).So the only method would be to get hold of a sample file and upload to Wildfire portal in order to trigger analysis by PA and possibly signature creation?",0,09-22-2017,01:59 PM
97,178320,Eng-nezar,"can you check these hashsNew Hashese5bf756d5530ec38ff649b901b3c7506f8556821d979bdcb392237f2ff40daf85257f623270b4c5cc471ff35b1bfeec80ab37c7e012da76b50ebd2c4911a43d0c3ab58b3154e5f5101ba74fccfd27a9ab445e41262cdf47e8cc3be7416a5904f0694bdf9f08e4f4a09d13b7b5a68c0148ceb3fcc79442f4db2aa19dd23681afeOld Hashes5203628a89e0a7d9f27757b347118250f5aa6d0685d156e375b6945c8c05eb8a0266be9130bdf20976fc5490f9191edaafdae09ebe45e74cd97792412454bf0dd9e52663715902e9ec51a7dd2fea5241c9714976e9541c02df66d1a42a3a7d2a35ceb84403efa728950d2cc8acb571c61d3a90decaf8b1f2979eaf13811c146b0975eb436fb4adb9077c8e99ea6d34746807bc83a228b17d321d14dfbbe80b03391e7b90bf3f0bfeb2c2602cc65aa6be4dd1c01374b89c4a48425f2d22fe231c6985ef5809d0789eeff623cd2436534b818fd2843f09fa2de2b4a6e2c0e1a879ccb1209122085bed5bded3f923835a65d3cc1071f7e4ad52bc5cf42057dd2150dab3308ab60d0d8acb3611bf364e81b63cfb6b4c1783864ebc515297e2297589bc4513e1ea20e11d00cfc6ce899836e4f18e4b5f5beee52e0ea9942adb78fc70Is it possible to create custom antivirus signatures?Goal is to block files with certain hashes. The original file is not available, only the hash.Is there any way to submit hashes to PANW so that they create signatures? (Something similar like for URLs)",0,12-20-2018,01:08 PM
98,178320,dbilinski,"If you had AutoFocus, you can check these hashes to see how we classify them, IOCs related to the file (if malicious), when it was first seen, and if there is any relevance to threat actors, malware campaigns, etc. As a previous posted noted, Palo doesn't do signatures based on hash, as hashes are more unique than the malware itself and it would be inefficient to create hundreds/thousands or more of signatures for different hashes, especially if the underlying malware or virus is the same. Palo cares more about the underlying malicious file and its underlying activity.",1,01-09-2019,04:18 PM
99,245165,Kim_Hansen,"Himojunhwan,The best way of blocking naver is by application, but there are other ways as well.1. Create a security rule that blocks/denies the appnaver-mail. But this rule will maybe require you to have an outgoing decrypt rule to actually see this app over ssl/443. Port 80 would be fine.Two other ways of blocking naver:2. Create a FQDN address object called mail.naver.com with FQDN=mail.naver.com and put this in a security rule on destination server with action equal reset-client or reset.both.3. Create a custom URL-category called ""Denied URLs"" and but the url *.naver.com in this URL-category. On the outgoing allowed rule for the clients add this URL-category to the URL filtering profil (in the security profile) with a Site Access set to ""Block"".- Kim",0,01-08-2019,09:34 AM
100,244046,koenig,"Same question, please advise.",0,12-20-2018,09:02 AM
101,244046,dbrummer,They just released an emergency content update -https://downloads.paloaltonetworks.com/content/content-8108-5218.html?__gda__=1545934638_8c994cbef14...,2,12-20-2018,10:22 AM
102,244046,koenig,"Thank you, updated as soon as we could.",0,12-20-2018,11:44 PM
103,237202,svintinner,Solved my problem by changing from transaction to session and removing ordered condition match.,2,10-26-2018,08:26 AM
104,237202,Raido_Rattameisaria-labelter,Why don't you use custom url category and block this category with security profile?,1,11-13-2018,04:28 AM
105,237202,svintinner,"Well that would certainly be easier. I guess I was under the impression that URL Categories only worked on hostnames or domains, not paths.",0,11-13-2018,01:23 PM
106,237202,Raido_Rattameisaria-labelter,You can use path. For example permit single Youtube video.,1,11-13-2018,01:26 PM
107,237202,svintinner,I just tested and of course it works perfectly. Thanks so much for setting me straight.,1,11-13-2018,01:27 PM
108,236434,Rajeshshah,Request to help on above mentioned query.,0,10-23-2018,10:36 PM
109,236160,MP18,my understanding is that it will continue to scan for other apps in custom app if it does not detect any other app it willstop scanning for any other app and session is offloaded,0,10-20-2018,08:31 AM
110,236160,Emanuele,"Thanks Mike. Can you clarify what do you mean when you say ""session is offloaded""?In addition,do you know if there is any way to maintain traffic scanning active after custom app has been detected?my understanding is that it will continue to scan for other apps in custom app if it does not detect any other app it willstop scanning for any other app and session is offloaded",0,10-22-2018,12:38 AM
111,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
112,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
113,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
114,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
115,229784,vsys_remo,"and another App-ID for https DNS Requests goint to dns.google.com. This could also be done easily with URL filtering, but just in case (needs to be a seperate App-ID because the parent App needs to be another one to detect google traffic):",7,09-06-2018,10:34 AM
116,209663,zonbin,thank you so much,0,08-23-2018,11:17 AM
117,212358,assim.bejaoui,"Hello Victor,You can create your own application or you can contact the resarchcenter.If you are seeing unknown traffic for a commercial application that does not yet have an App-ID, you can submit a request for a new App-ID here:http://researchcenter.paloaltonetworks.com/submit-an-application/For more information visit this documentation:Create a Custom Application:https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/app-id/create-a-custom-applicationKind regards.Wassim",0,07-20-2018,08:04 AM
118,212358,pulukas,If you have actual traffic in a live network your best bet is probably to open a support ticket and generate some actual traffic that can be captured and passed on to the development team.There is no public submission on existing app-id but if you don't want to go the TAC route you could probably submit the information via the request new app-id process outlined here.https://live.paloaltonetworks.com/t5/Management-Articles/How-to-Request-a-new-App-ID/ta-p/60834,0,07-21-2018,07:46 AM
119,216732,Lucky,"Hello,adding complexity to the signature will not make it trigger more offten or better, it will trigger less, right? Probably ðŸ™‚Anyhow, I'd try to do this with hex pattern. Do you have a pcap of that communication?alhngdk should be sufficient, and it goes into hex as61 6c 68 6e 67 64 6b. Can you try with that and see what is your mileage? Once you get the hit with 7 bytes (minimum for signature) you can expand that hex to cover the whole string of yours (to avoid FPs).Best regards,Luciano",0,06-06-2018,02:42 AM
120,216732,jsalmans,@LuckyThanks for the reply. I was under the impression that it was recommended to add additional signatures to help to further ensure the traffic is actually for your application and not false positives? Whether those additional signatures are complex or not depends on the signatures I guess.I'll try it as hex... I've done some others like that but I figured it was unnecessary since I was tyring to match something that the http-req-header filter says it covers according to the documentation (Origin field in particular). I originally had this signature looking only at http-method POST but I removed it to try to get it to match.I've attached the pcap I'm working with. I hope Palo Alto makes an official app. The work is interesting but there are so many device types out there that all seem to want to do the same thing differently.Thanks,0,06-06-2018,06:40 AM
121,216732,Lucky,"Hi,as far as additional items in the signature go - sure, correct, it is better to ""pin-point"" it with more details, but as we aren't hitting original traffic with more detail, it makes more sense to have less detail until we hit it and then work our way back up to more details in the signature ðŸ™‚If you have problems with hex, lemme know - I will try to lab it up internally on my side and let test it, if it doesn't work for you.BRLuciano",0,06-06-2018,08:52 AM
122,216732,jsalmans,Unfortunately it still looks to be identified as web-browsing on our most recent test. I created a secondary rule to allow web-browsing over tcp 9163 to see if maybe the application wasn't getting identified at first and so was being denied as web-browsing before ID (that HTTP Post is really at the end of the session)... it's still just going through as web-browsing.,0,06-06-2018,11:21 AM
123,213639,JoeAndreini,What exactly are you looking for? did the settings in the article you linked not work for you?What versions of PanOS and anyconnect? can you include sample syslog messages?,0,05-09-2018,04:18 AM
124,213639,kemble,"Was looking for confirmation that someone implmented this specifically to fix stale or missing userID/ipAddr detail from AD server feeds to User Agents. In the mean t ime, I plan to try the regex next week some time, in the link I referenced.",0,05-09-2018,11:11 AM
125,213639,JoeAndreini,Roger - I have not encountered that before - hopefully someone is able to confirm or deny it for you.,0,05-09-2018,12:14 PM
126,213639,kemble,The PA is ver 8.0.7 . Still checking for the Anyconnect ver#,0,05-09-2018,01:44 PM
127,211688,JoeAndreini,"the [] operators do not work the way you think in regex.[170-179] means ""1, or 7, or a number between0 and 1 inclusive, or 7 or 9""therefore, [176-179] means ""1, or 7, or a number between 6 and 1 inclusive (this is invalid), or 7, or 9put another way, the [] operators mean ""one of these characters""to match numbers between 176 and 179, inclusive you should have ""17[6-9]""",0,05-02-2018,10:25 AM
128,211688,dkramer,Thank you for the answer. I figured it out just this morning as well. There is another option which is to use hex in place of the integers so that 176-179 becomes [\xB0-B3\x],0,05-02-2018,11:41 AM
129,208797,jwood,"I recently created a custom App-ID for Fortnite, and documented it here...(App-ID is at the bottom of the post)",0,04-12-2018,12:58 PM
130,132930,goku123,"Please refer to the thread on this forum:https://live.paloaltonetworks.com/t5/Custom-Signatures/Welcome-to-the-Palo-Alto-Networks-Custom-Sign...This has an example on how to detect Nikto Scanner traffic by sigging off the user-agent:Example 2: Detecting Nikto Scans through User Agent (Nikto User Agent.xml)The same thing can be achieved for OpenVAS by simply modifying the value in the user-agent field in the signature to ""OpenVAS"".The signature can then be used in policy to alert/block etc.",0,12-14-2016,05:33 PM
131,132930,Rags,"I could not get the OpenVAS signature to work by just switching Nikto for OpenVAS. I had to do a more basic string <pattern>OpenVAS</pattern> . I actually did <pattern>OpenVAS 8</pattern> at first to see if that would work, it did. (OpenVAS 8.0.9 was the user agent.Make sure you edit the entry name if you use my .xml file. You might already have that number in use. Also created one for Baiduspider since my IDS picked it up in a scan and I saw the user agent string for it.There's a few useful links that will show user agent strings for popular scanners/crawlers.https://developers.whatismybrowser.com/useragents/explore/software_type_specific/crawler/9http://www.useragentstring.com/pages/useragentstring.php?typ=CrawlerHope that helps, thanks -Rags",0,02-28-2018,11:44 AM
132,196253,Lucky,"Hello, Michael,and welcome to our forums.At the moment, that is not recommended approach, mostly because it is relatively easy to hit the limitation of the device when it comes to custom signatures. Those limitations aren't hard coded in the sense of how many particular rules can be set; they are rather limited in the terms of cumulative number of custom regex lookups that are contained in all custom signatures across the device. While it is possible to create quite a few custom signatures, depending on the complexity of those it is also possible to deplete firewall's resources when it comes to usage of custom regex lookups. Therefore, we are still expecting users to do this by hand.If your customer should have relevant information on attacks and/or trends they are seeing, it is always possible to open a TAC case and offer tangible information (exploitation strings seen, or the POC code, or whatever logs customers have) and we would evaluate and create relevant signatures per need; those would not influence number of custom rules and signatures as they are counted differently.Hope this helps; if there is more info or feedback from customer please let us know. If they still want to automate this maybe open a TAC case and route it to Threat Specialist, so we can look at it together and find a graceful way to do it.Best regards,Luciano",2,01-23-2018,06:02 AM
133,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
134,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
135,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
136,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
137,192911,bpappas,"I'd suggest doing some packet captures of the traffic to see there is something you can use to identify it.a tiny bit of googling suggests that the traffic is not encrypted so depending upon what you find in the captures it may be possible to build a signature using the combination of protocol, port, and pattern matching.if you post a few packet capture samples here, or show us some snippets of what you see during session setup, then the folks who participate in this forum may be able to help.-Benjamin",0,12-22-2017,09:18 AM
138,192911,jjurdi,"Hello Benjamin,I have gathered some packets, but do not know what types of identifers I'm looking for to make up a signature. Do you have any examples or could I PM you some of the capture?Thank you!Jon",0,12-22-2017,10:42 AM
139,192911,bpappas,"Jon,when you look at the captures in wireshark what do you see in the data portion of the packet?does every session start with a predictable string or sequence of bits/bytes? if so we can try to build a signature from that.assuming that the capture doesn't contain any information that you would consider confidential (IP addresses, personally identifiable info, etc) you could share it here and then we can try to find a way to help you write a custom signature.Benjamin",0,12-22-2017,10:48 AM
140,192911,jjurdi,Here are a few lines from the capture with the source and destination IPs removed. Is there enough info here or do you need more packet details.,0,12-22-2017,11:17 AM
141,192911,bpappas,We'd need to see what's in some of those packets to build a signature. the pattern matching engine works against the data portion of the packet if memory serves me.,0,12-22-2017,11:42 AM
142,192911,jjurdi,I thought that might be the case. Here are some data sections:0000 a0 05 00 60 00 00 00 00 c4 a3 af 48 99 56 b6 b40010 c7 8e 9e d1 c8 55 20 37 04 02 03 01 00 01 a1 aa0000 a0 05 00 60 47 00 00 00 00 00 00 00 00 00 00 000010 00 00 00 00 00 00 00 00 04 02 03 08 00 00 a1 aa0020 61 64 6d 69 6e 26 26 44 37 31 41 45 39 38 33 370030 31 42 33 33 35 37 42 36 34 45 38 31 34 30 32 360040 41 37 44 39 44 33 42 41 43 33 41 43 43 31 41 390050 46 31 30 46 31 46 32 32 43 44 32 42 43 35 43 460060 31 36 38 39 38 32 430000 a4 00 00 00 00 00 00 00 07 00 00 00 00 00 00 000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 000000 f4 00 00 00 55 00 00 00 00 00 00 00 00 00 00 000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 000020 54 72 61 6e 73 61 63 74 69 6f 6e 49 44 3a 31 0d0030 0a 4d 65 74 68 6f 64 3a 47 65 74 50 61 72 61 6d0040 65 74 65 72 56 61 6c 75 65 73 0d 0a 50 61 72 610050 6d 65 74 65 72 4e 61 6d 65 3a 44 61 68 75 61 2e0060 44 65 76 69 63 65 2e 44 65 63 6f 64 65 2e 43 660070 67 0d 0a 0d 0a0000 f6 00 00 00 5a 00 00 00 34 02 00 00 00 00 00 000010 5a 00 00 00 00 00 00 00 fa 02 d2 13 00 00 00 000020 7b 20 22 69 64 22 20 3a 20 35 36 34 2c 20 22 6d0030 65 74 68 6f 64 22 20 3a 20 22 61 6c 61 72 6d 2e0040 67 65 74 41 6c 6c 49 6e 53 6c 6f 74 73 22 2c 200050 22 70 61 72 61 6d 73 22 20 3a 20 6e 75 6c 6c 2c0060 20 22 73 65 73 73 69 6f 6e 22 20 3a 20 33 33 320070 35 33 30 34 32 36 20 7d 0a 00 f6 00 00 00 5b 000080 00 00 35 03 00 00 00 00 00 00 5b 00 00 00 00 000090 00 00 fa 02 d2 13 00 00 00 00 7b 20 22 69 64 2200a0 20 3a 20 38 32 31 2c 20 22 6d 65 74 68 6f 64 2200b0 20 3a 20 22 61 6c 61 72 6d 2e 67 65 74 41 6c 6c00c0 4f 75 74 53 6c 6f 74 73 22 2c 20 22 70 61 72 6100d0 6d 73 22 20 3a 20 6e 75 6c 6c 2c 20 22 73 65 7300e0 73 69 6f 6e 22 20 3a 20 33 33 32 35 33 30 34 3200f0 36 20 7d 0a 00 a4 00 00 00 00 00 00 00 1a 00 000100 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 000110 00 00 00 00 000000 f4 00 00 00 59 00 00 00 00 00 00 00 00 00 00 000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 000020 54 72 61 6e 73 61 63 74 69 6f 6e 49 44 3a 34 0d0030 0a 4d 65 74 68 6f 64 3a 47 65 74 50 61 72 61 6d0040 65 74 65 72 56 61 6c 75 65 73 0d 0a 50 61 72 610050 6d 65 74 65 72 4e 61 6d 65 3a 44 61 68 75 61 2e0060 44 65 76 69 63 65 2e 52 65 63 6f 72 64 2e 47 650070 6e 65 72 61 6c 0d 0a 0d 0a0000 a1 00 00 00 00 00 00 00 00 00 00 00 00 00 00 000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 000000 a4 00 00 00 00 00 00 00 08 00 00 00 00 00 00 000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00,0,12-22-2017,01:08 PM
143,118951,Lucky,"Hello Paul,welcome to our forums.Your captures do not contain enough information for custom signature. It would be recommended to collect whole pcap of the conversation between hosts, so initialization of their communication can be reviewed and possible signature created on that base. In the pcaps you attached there are only four packets, seemingly starting some SSL encrypted tunnel (there are bytes ""STARTTLS!EOT!DIASEND"" in the data portion of packets). You might want to use those bytes as a placeholder - or anything else that will be recognizable in (any) such session for which you want to have a custom signature.If this is SSL, it will get offloaded anyhow unless you use decryption rules; if it always remains as unknown-TCP and does never show as SSL you might need to open a TAC case to determine what whas the cause of it; as it is expected to show as SSL after several packets.If you can upload the whole TCP conversation, we might help you by looking into it with you and determining items above. For more detailed but generic information on what is needed, please review this document: https://live.paloaltonetworks.com/t5/Custom-Signatures/Welcome-to-the-Palo-Alto-Networks-Custom-Sign...Best regardsLuciano",2,10-12-2016,04:53 AM
144,118951,aulBrock,"Thankyou for your response Lucky and sorry for the delay,I was able to do a packet capture and now upload itIcan see it uses a server name: download.diasend.comIP of dest is 54.72.239.101src user IP was 10.10.60.88",0,10-18-2016,08:58 PM
145,118951,Lucky,"Hi Paul,this is encrypted traffic which would generally get offloaded and won't be inspected unless you have decryption policy running. For that reason, I think you will have much better results if you use IP address, rather than pattern-match. Pattern match is irrelevant once it get's offloaded, and it would get offloaded once it is recognized as ssl. Destination IP address, on the other hand, would be much more explicit.I have also noticed you use diasenddata.com along with the diasend.com; both diasenddata.com and download.diasend.com resolve to the IP address of 54.72.239.101 (while top domain, diasend.com, resolves to 52.16.54.164). Can you try to use this 54.72.239.101 as an IP address for this application and see if your results are better? Than, regardless of the underlying protocol, traffic towards diasenddata.com (or downloads.diasend.com) would be seen as your custom app.Let us know if you still have problems with it and what is your take on the whole situation.Best regardsLuciano",0,10-19-2016,05:48 AM
146,118951,aulBrock,"Hi Luciano,Thankyou again for taking the time with assisting me.I am very much a novice in custom app creation, could you help a bit with steps1. create custom app called diasend1a. on configuration page I have attached a screenshot1b Advanced as suggested i need to add the ip somehow1c ignore signature tab2. DoI need to then create a appplication override ? and if so what fields need to be entered ?RegardsPaul",0,10-19-2016,02:26 PM
147,118951,Lucky,"Hi Paul,here is a nice guide: https://live.paloaltonetworks.com/t5/Tech-Notes/Custom-Application-Signatures/ta-p/58625Application override is used if you want to omit that traffic from inspection. That is usually done in a very targeted manner and only if such exception is needed for uninterrupted traffic, meaning firewall is creating problems and until problem is resolved workaround is to omit such traffic from inspection.From your questions, I did not get an impression that application override is what you are trying to do, from my understanding - you just want to identify traffic to this host as a specific app in your logs, and possibly create security policies based on that. Scratch my idea by defining it only based on ports and IP address, my idea is bad because traffic is not unique enough and we might interfere with properly identified apps running on the same ports (80 and 443).It is worth investigating option of using SSL-req-client-halo with pattern ""646f776e6c6f61642e64696173656e642e636f6d"" (which is hex representation of download.diasend.com, I just copied that from your pcap). This should work, but I cannot be 100% sure without trying it. Can you try and see if comms are hitting this signature? If you are still having problems, I can try and create signature for you and export it.Best regardsLuciano",0,10-20-2016,09:07 AM
148,118951,aulBrock,"Hi Luciano,thanks again for all your help, is there any chance i could get you to create the signature for me please",0,11-10-2016,03:32 PM
149,118951,jjurdi,I am having the same exact issue with an application that does not seem to have a signature right now. If I send over a capture that I took of this traffic might you be so kind as to help create a custom signature?,0,12-21-2017,01:59 PM
150,118951,jvalentine,I'm sure someone here would be willing to help. Be sure to start a new thread for your application.,0,12-21-2017,03:23 PM
151,135488,aper,"hi@KiCheon.Leesorry for the late reply!the parent app is used when a custom application may match a different applicationa typical example is if you want to identify your own website, that normally matches web-browsing, as a different application for reporting. if you create the cistom app to match a signature and set web-browsing as parent-app, AppID knows how to properly identify your custom app and there are no accidental collissions",0,11-29-2017,12:32 AM
152,78827,bpappas,are you trying to identify and block this app? or.... ?,0,06-01-2016,03:16 PM
153,78827,david3,I use this signature to positively identify the application asthe firewall policy is configured toblock all unknown-tcp and unknown-udp.-David,0,06-01-2016,03:37 PM
154,78827,BenjAudy.MTL,"Hi,I also recently created a signature to identify that game. First, the protocol used is common to all Supercell games, not just Clash of Clans. I haven't seen a way yet to differentiate between the different games (not that I care about that). My signature was pretty similar to yours at first, but sometimes it would not match, like when an Android user needs to install an update for the game. I also sometimessee UDP traffic on the same port, after the game connects using TCP. I haven't been able to reproduce that traffic on my iPhone though. I suspect the UDP traffic is only used on Android clients. Also, I don't see any repeating pattern in it, probably because the negotiation happens in the TCP stream. I will try to get my hands on an Android device to reproduce the traffic.Benjamin",2,06-02-2016,01:33 PM
155,78827,mdensley,"This signature worked perfectly for me with Boom Beach, Thanks for sharing!",0,10-04-2017,03:03 PM
156,176575,bpappas,"If a known App-ID is not working as expected you should definitely open a support case to troubleshoot.Given that this is an encrypted, evasive VPN/proxy app I'm not sure how effective a custom signature would be.Benjamin",0,09-14-2017,10:43 AM
157,176575,pulukas,"I""m not sure, but it sounds like you might be applying the app-id rule for encrypted traffic without setting up the decryption rule. In order to apply inspected polcies on ssl traffic you will need to decrypt the the traffic first. As you noted things like the url are not visible in the encryptedstream.https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/decryption/create-a-decryption-polic...",0,09-18-2017,03:13 AM
158,176575,Rameshwar,"hi , i have the decryption in place .. but when i do a pcap it doesnt show any url ., is there any way to create a custom app to block zenmate ?wihout url",0,09-27-2017,09:37 AM
159,176575,pulukas,Pretty sure the pcaps are not the decrypted internal view that is why you can't see the URL.To use the built in app-id (best option) you need to use the app-id on a decryption rule so that the stream can be fully seen to match the PA patterns. Make sure the decryption is working and that the traffic from the clients to this application are hitting that rule.you can enable decryption and setup a url blacklist. And the same deal basically applies. Decryption must be working and the rule has to be hit by the traffic. But since there is an app-id for this you should work on the first option.,0,09-28-2017,04:14 AM
160,176575,bpappas,"If I recall correctly, you will need to use the decryption port mirror feature and stream the packets to a connected device. There you should be able to view decrypted traffic using a tool such as tcpdump or wireshark.",0,09-28-2017,09:38 AM
161,176575,Rameshwar,"If I recall correctly, you will need to use the decryption port mirror feature and stream the packets to a connected device. There you should be able to view decrypted traffic using a tool such as tcpdump or wireshark.decryption port mirror feature and stream the packets to a connected device. - can let me know how exactly to do this ... this is VM FW in my lAB",0,09-28-2017,10:30 AM
162,176575,Rameshwar,o use the built in app-id (best option) you need to use the app-id on a decryption rule so that the stream can be fully seen to match the PA patterns. Make sure the decryption is working and that the traffic from the clients to this application are hitting that rule.you need to use the app-id on a decryption rule - can you please let me know how can i get this work,0,09-28-2017,10:34 AM
163,176575,pulukas,These are the rule instructions. In step 3 you will need to include the app-id for zenmate.And the rules must be ordered so that this rule is hit before any other rule that the zenmate traffic may match. The policies are processed in order top to bottom and as soon as the traffic is matched we stop looking at further rules.Enable logging so that you can verfiy what traffic is matching which rule.https://www.paloaltonetworks.com/documentation/71/pan-os/pan-os/decryption/create-a-decryption-polic...,0,09-29-2017,02:38 AM
164,176575,Rameshwar,"hiThank you for the information ,but i have already done the steps and it is not detecting the application",0,10-01-2017,09:08 AM
165,178625,ajr0,"please try these, keep in mind I have only played around/tested these with data patterns and have not verified in a production environment the validity.for example, I think ammex is 1234-123456-12345 5376-4698-9386-4886 5564-8017-1758-1316 5464-9730-1302-5263 5257-2750-0534-2578 5564-9616-5310-6823 5483-3128-3984-7229 5352-9543-2663-9003 5130-0484-5710-3076 5210-3641-5712-1745 5559-4615-4452-4711",0,09-25-2017,06:34 PM
166,173910,Lucky,"Hi Markibr,How was the attack logged, as which application? Do you have any pcaps from that, a session or two? Did you already open a case with support?Best regards,Luciano",0,08-31-2017,05:18 AM
167,173910,markibr,Logged as SIP which is what is supposed to be since they are an VoIP provider. I have no pcap files currently.,0,08-31-2017,11:22 AM
168,173695,cstarks2,"I have an update to this custom signature issue. According to the PA custom signature documentation you can look at the document binaries and use regex or hex search strings to match traffic against strings in the binaries, but it looks like that won't work. I was able to get this alert to work by looking in packet captures and using the following pattern matches within the file-office-content context:Match one of the following:\x776F72642F5F72656C732F646F63756D656E742E786D6C2E72656C73\x\x4D6963726F736F6674204F666669636520576F7264\x\x540068006900730044006f00630075006d0065006e0074\xANDOne of the following:\x417474726962757400652056425f4e616d0065\x\x5f005600420041005f00500052004f004a00450043005400\x",1,08-30-2017,09:59 AM
169,173695,Lucky,"Hi,do you have pcap of such document? It is the easiest way to see / collect strings you need.At first, I'd go with only ""one and one"" string, without trying to match ""OR"" in the beginning. Once I have confirmed it works for one type of files, I'd expand it.If it doesn't work for you like this (step-by-step approach), can you maybe upload one file here and I will try to see if I can help?Best regards,Luciano",0,08-31-2017,05:23 AM
170,173695,cstarks2,"I've got the alert working now, but I appreciate the feedback. I was looking in the binary of the document, rather than the pcap originally. I can't speak for other contexts, but it appears that pcap is the only reliable way to gather search stings for the ""file-office-content"" context. Palo Alto should consider rewriting their documentation to reflect that.",0,08-31-2017,06:53 AM
171,173695,bpappas,Thanks for the feedback on the need to do some documentation enhancement.Sometimes we assume that everyone thinks the way we do and it's good to get a reminder that we all come at these problems with different assumptions and perspectives baked into our viewfinder.-Benjamin,0,08-31-2017,07:29 AM
172,170394,jvalentine,"Why are you making a custom signature for this? You can modify the action for the built-in SMTP brute force, assuming it's triggering. You can make the change in your Vulnerability Protection object, under Exceptions. Add an exception for the SMTP Brute Force and change the action. ",0,08-07-2017,02:07 PM
173,170394,Nicka,"The built-in filter only looks for the 535 response. Our appliance doesn't support the AUTH command so it doesn't respond with a 535, only 502 (Unsupported command).""If a session has the same source and destination but triggers our child signature, 31709, 10 times in 60 seconds, we call it is a brute force attack.The child signature, 31709, works on 3 apps, smtp, pop3 and imap.The trigger condition is found in response code 535 in smtp, ""No/bad logon/login failure"" pattern in imap and ""-ERR"" on pop3 PASS command.""",0,08-07-2017,02:19 PM
174,170394,jvalentine,Can you share a packet capturefrom one of theseevents? ,0,08-07-2017,02:46 PM
175,170394,Nicka,"No, but I was able to get the signature to work using the (or) | and adding frivolous text.Now the issue is when adding a combo signature to include the one I just created, I get an error ""Threat 41001 is not known -- cannot be added to this signature."" Not sure if this is a bug (Panorama 7.1.11) but even trying to recreate the Wordpress brute-force example document from 2016 just to verify if that works -- I still get the same error. *sigh*",0,08-08-2017,06:11 PM
176,170394,Nicka,"Definitely a bug. I was able to create it on the firewall itself without that error coming up, then exported the rule and imported it back into Panorama just fine.",1,08-08-2017,06:26 PM
177,170445,bpappas,can you share a pcap of influxdb traffic and show us the signature you wrote?that would at least help us understand how far you've taken your efforts thus far.-Benjamin,0,08-08-2017,06:59 AM
178,78973,mdensley,"Thank you for this!!! I see wpad.dat traffic ever 10 minutes from 3 different sources in california. I was able to use URL filtering to block it, but this is a much more precise approach!!!",0,07-19-2017,09:06 AM
179,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
180,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
181,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
182,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
183,166396,Lucky,"Hello,does it work when you chop it up in smaller pieces?Best regards,Luciano",0,07-14-2017,01:16 AM
184,166396,phi1771,"Looks like my issue was due to spaces on the hex indicators and I was using /x instead of \x. It worked after modifying the pattern match to the below,\x3531333438623763302d646432372d313164662d393337622d3038303032303063396136362e73332e616d617a6f6e6177732e636f6d\x",0,07-14-2017,11:40 AM
185,96642,BenjAudy.MTL,"Hi,I haven't seen the game's traffic since it hasn't been released yet in Canada, but the developer's previous game called Ingress relies heavily on Google API. You might have a hard time identifying the application without decrypting the traffic.Regards,Benjamin",1,07-12-2016,08:50 PM
186,96642,tboire,"Hello,From my research you can block the domainpgorelease.nianticlabs.com and the clients will not be able to reach out to the server to play the game. This does not however stop the employee from using their mobile data plan to continue playing the game.Regards,Tyler",4,07-13-2016,05:39 AM
187,96642,aelmore,"Thanks for all the feedback. I can confirm that I also see the app attempting to use the following URLs:pgorelease.nianticlabs.com -  Using a *.nianticlabs.com certificateappload.ingest.crittercism.com -  Using a *.ingest.critterciscm.com certificateThe latter URL appears to be a third party app analytics company. I've yet to receive an executive order to authorize blocking, but I believe tboire is likely correct that blocking the Niantic URL will prevent connections. Should I get approval to block, that is my next course of action.Thanks everyone.",2,07-13-2016,06:31 AM
188,96642,Willian,"Hi@aelmore@tboire@BenjAudy.MTLI know I am late in this thread, but I wanted to share this two options with you all.Option 1: URL filteringSimply blacklist the following url: pgorelease.nianticlabs.com(this is used to make API calls by the APP)Option 2: Create a custom application which looks for the SNI stringset application pokemon-go default port tcp/443set application pokemon-go signature PG-SSL and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match pattern pgorelease.nianticlabs.comset application pokemon-go signature PG-SSL and-condition ""And Condition 1"" or-condition ""Or Condition 1"" operator pattern-match context ssl-req-client-helloset application pokemon-go signature PG-SSL scope protocol-data-unitset application pokemon-go signature PG-SSL order-free noset application pokemon-go signature PG-SSL comment â€œPattern match against the SNI for Pokemon Go""set application pokemon-go category mediaset application pokemon-go subcategory gamingset application pokemon-go technology client-serverset application pokemon-go description ""Pokemon Go is a social game released in 2016 by Niantic Labs.""set application pokemon-go risk 1set application pokemon-go parent-app ssl",0,06-18-2017,09:44 PM
189,150650,bpappas,"Mario,Please read the documented process for new App-ID coverage here:https://live.paloaltonetworks.com/t5/Management-Articles/How-to-Request-a-new-App-ID/ta-p/60834But before you go....It sounds like most of the Zebra printer traffic is being recognized as a known App-ID. Is that true? If so are you expecting that this one printer model should also show up as the same App-ID? If so a Support Case might be appropriate to fix the existing App-ID.If you're interested in creating a custom signature for this traffic then please share some pcaps and other helpful contextual information that we might use to guide your efforts.All the best,Benjamin",1,03-31-2017,12:30 PM
190,150650,LCMember25117,"I did submit a request previously. I didn't get any reply so far on my inbox.Not sure, but the traffic for this specific model isrecognized as UNknown-tcp or insufficient data. At the moment we are allowing traffic for the service port 2001 TCP instead with ANY APPID. I am not sure for other Zebra printers. Do you mean appid ZPL?I have also just opened a support case to work on this already for further inverstigation. PCAPS, traffic logs, putty session logs and tech support file was submited.As per customer needs, no custom AppIDs are added to fix these kind of issues. They state that the same printer model and various of the same vendor's traffic has no APPID assigned to them.Regards,Mario",1,03-31-2017,01:13 PM
191,150650,bpappas,"Mario,ZPL is the App-ID for Zebra.I've talked to the case owner and he will request some packet captures of the mis-identified traffic and then it should be possible to update the ZPL App-ID.-Benjamin",1,06-16-2017,09:55 AM
192,161268,bpappas,"Andy,I suggest that you submit a request for a new App-ID via the process documented here:https://live.paloaltonetworks.com/t5/Management-Articles/How-to-Request-a-new-App-ID/ta-p/60834Also, it looks like this standard is not publicly documented. If you have details about the standard that you are allowed to share publicly then please do so here and we will see if we can help you out.-Benjamin",0,06-14-2017,01:52 PM
193,153846,vsys_remo,"Hi AnuragAre these log messages spitted into two lines or is this carriage return/new line added because of copy&past from your logs into live community?If these are two lines in your logs: did you try ""(Slot:{d}){1}"" for event regex?It all is on one line: try to simplify the regex string for the IP address to test.As you said your existing ip regex string looks absolutely correct - may be a bug?Regards,Remo",0,06-04-2017,11:08 AM
194,153846,ansharma,"@vsys_remoI should have updated this. I resolved the issue. The regex we used were fine, the UIA wasn't. We tested and the same regex worked on Agentless, then upgraded the UIA and it worked there too. Turned out 7.x UIA wasn't working correctly in regard to Syslog parsing.Thanks for your suggestion anyway ðŸ™‚Regards,Anurag",0,06-05-2017,06:26 AM
195,155794,claudec,"Hi Amogh,I would say this is anticipated behavior. You can not have two strings less than 7 bytes seperated by a wildcard element.-Claude",0,05-12-2017,06:01 PM
196,155794,agawade,"Hi ClaudeThanks for the reply, any idea how we can get the pattern working then , any input will be highly appreciatedRegardsAmogh",0,05-15-2017,08:02 AM
197,145982,BenjAudy.MTL,"I'm not sure I understand your problem. You mean you have a blocking rule with the FQDN as the destination address? If you want to reroute the traffic to some identified malicious websites, why do you have a blocking rule in the first place?Benjamin",0,03-06-2017,12:57 PM
198,145982,dlevenden,"great question. We offer a service to a customer that blocks on a paloAlto system at their end, which we're fine with them blocking the FQDN, but we need to not block the IP at the same time to allow other traffic to make it through if the name/domainisn't blocked on the customer side.Thanks.",0,03-07-2017,01:22 PM
199,145982,mivaldi,"Check dns-req-section in page 19 of this document:Creating Custom Application and Threat SignaturesThere's an example for FQDN www.thebayareagamers.comYou can also add an EDL of type ""Domain"" and point it to a web-server that contains the list of domains you want to block.See:https://live.paloaltonetworks.com/t5/tkb/articleprintpage/tkb-id/PANOS71Articles/article-id/10",0,04-27-2017,02:14 PM
200,148276,Evan.Sink,"Hi Everyone!After discussing with PAN Support we did come to a resolution on this.The solution is to create a DoS protection policy (specifically the SYN Flood settings) and create it as a Classified Profile using RED. SYN Cookie is not an option against this attack because of the way HULK is written. Basically the Client establishes an absurd amount of legitimate sessions with the server, then does an equally absurd amount of bogus GET requests which eventually takes a server to it's knees.The trick here is to determine how many SYN pps are typical for your enviornemnt, or the group of servers you want to apply this policy to. For me, I was seeing less than 10 SYNs per second from any given clientso I set all the RED settings in the SYN flood protection to 25. This makes sure that a busy client still works fine, but anything that is abnormal gets dropped.I tested the HULK attack again with this DoS Protection profile in place, and the server was protected.If anyone has this same issue and has a question that I did not cover above please feel free to reach out.thanks!/Evan",0,03-20-2017,02:17 PM
201,146156,BenjAudy.MTL,"Hi,The VLAN tag is part of the Ethernet frame and is used for networking, so I doubt Palo Alto Networks will ever offer the ability to create a custom application signature based onit.What is the original problem that made you want to have a custom app based on a VLAN tag?Benjamin",0,03-06-2017,01:12 PM
202,146156,goku123,"As Baudy pointed out, the custom signature contexts are exposed to target mostly layer7 payload patterns.VLAN tags at layer2 are not currently available to match a custom signature pattern against.",0,03-06-2017,01:19 PM
203,146156,Lucky,"Hi, and welcome to our forums.While other correctly pointed out this cannot be tagged as custom application; what you could do, in order to manipulate traffic from particular XXX vlan, is to create a .XXX sub-interface on the layer3 interface where trunked and tagged traffic is arriving, and add it to a separate new zone, than create traffic policies (whatever you need, blocking, allowing, alerting...) applied for that particular zone.I believe my understanding is correct - you have trunk on some interface and some of the traffic is tagged, you wanted to manipulate it in a particular way (so you wanted to create a custom app) - this way, you will see all the traffic, and you can still create a custom app just based on the ports or the port ranges of the layer 4, without furhter complication.Am I right and does this help? If not, can you try to explain what are you trying to achieve - perhaps we can solve it in a different way.Best regardsLuciano",0,03-07-2017,02:45 AM
204,101267,BenjAudy.MTL,"Hi,You could try to do a pattern match on the context ""file-unknown-body"", with 4 7-byte patterns representing the different classes (32-bit or 64-bit) and endianness (little endian or big endian):\x7f454c46010101\x\x7f454c46010201\x\x7f454c46020101\x\x7f454c46020201\xI haven't tried it myself, but I don't see why it wouldn't work.Regards,Benjamin",0,08-05-2016,11:28 AM
205,101267,BenjAudy.MTL,It looks like content update 667 added anew file type to detect ELF files (ID #52175).Benjamin,0,03-02-2017,07:50 AM
206,144361,murphyj,,0,02-22-2017,08:34 AM
207,144361,claudec,"Although the custom signature document indicates the ""http-req-headers"" context excludes the ablity to match on the method/path/version/host info, I have found that you can at least match on the method and version info using this context.I haven't tried to match path/host info, however, as there are specific contexts available for those headers.The attached vulnerability sig XML looks for v1.1 in a GET method, it would be easy enough to modify it to look for 1.0.-C",1,02-23-2017,04:25 PM
208,144361,pwebber,Thanks! I'll give this a try!,0,02-24-2017,07:25 AM
209,125185,Lucky,"Hi Kowu,Welcome to our community.When looking at this pcap - it seems to be a capture of communication to the localhost: Host: 127.0.0.1:9090; therefore I assume this was POC code. Firewall cannot help much in intercepting traffic from an endpoint to itself ðŸ™‚I am not familiar with this attack, can you share more details on the attack technique itself? What is the attack doing, what are bits related to the attack... is the CVE associated with this technique or some other detail, is it described somewhere? Or, at least, what is the string you believe implies that server was attacked? I see pcap looks complete but I am not sure what is ""good"" and what is ""bad"" part of the response. It is better to find ""bad"" code to create signature for it, to avoid possible false positives.Please share a bit more detail so we can help you better.Best regardsLuciano",0,11-09-2016,03:19 AM
210,125185,kowu,"Thanks luck!it is related with Jboss CVE vul(Red Hat JBoss Commons Collections Library Remote Code Execution Vulnerability) ID 38507,Customer want a custom signature to combine this CVE with the related reply session from the vicitm which means the attack is most likely successfullet's if the attack session hit the CVE, while the response traffic in the session from vicitm contain ""http 1.1 200 ok"" means the attack session is established or successfulthis signature is to create a signature that can match the reply/response traffic and combine them,Attacker:10.63.212.201 vicitm:10.10.228.94 (reponse traffic should be from 10.10.228.94 to 10.63.212.201)",0,11-09-2016,05:13 AM
211,125185,kowu,please filter the ip address in the pcap fileAttacker:10.63.212.201 http server:10.10.228.94,0,11-09-2016,05:16 AM
212,125185,kowu,any advise?,0,11-09-2016,10:51 AM
213,125185,BenjAudy.MTL,"Hi,I never tried it, but I guess youcould create a new vulnerability that looks at the HTTP response code 200 (http-rsp-code equals 200) and JBoss HTTP header (Pattern match http-rsp-headers on X-Powered-by ...). You could then create a combination signature that includes threat ID 38507with the new signature you made.Benjamin",0,11-16-2016,08:06 AM
214,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
215,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
216,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
217,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
218,117383,bpappas,can you provide a packet capture of some traffic as well as the signature?it's a bit hard to guess at a solution without both pieces of data.thx-benjamin,0,10-04-2016,07:14 AM
219,117383,Ntrust,"Thanks my dear friend,I have gothrough the pcap and resolved my issues. Anyway thanks for your help.",0,10-11-2016,12:56 AM
220,116639,murphyj,,0,09-29-2016,05:13 AM
221,116639,bpappas,"what do you mean by ""default signatures""?if you mean ""signatures released by Palo Alto Networks"" then the answer is: signature logic is not made available for viewing.",0,09-29-2016,07:40 AM
222,112437,Lucky,"Hi James,that will not be so straight forward. PAN does not have same signature structure nor triggers as Snort does, it is not translatable so easily.How many custom signatures do you have? Are your MD5 hashes for the whole file or for the portions of the files? I am asking to figure out how to help you better and if your work is doable by hand or should you look into scripting this.If they are file hashes, please use https://threatvault.paloaltonetworks.com to check if they already have coverage (in that case, you don't need to export that signature at all, as we do have it). If they are partial file hashes, depending what is hashed - you can use https://autofocus.paloaltonetworks.com to search for those files (please contact Systems Engineer assigned to your organization, if you need demo account to check Autofocus).If you have fewish custom signatures, it might be worth of re-writing them - this article here offers a Tech Note on Custom signatures and how to create them: https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5...Let us know if we helped a bit and show us an example or two, perhaps, if you need more info?Best regardsLuciano",0,09-12-2016,04:38 AM
223,112437,jamessong,"Thanks for your information. Since I am working on military sector, I have tons of other customer signatures from snort, Mcafee IPS, Cisco IPSm etc. I just wondering someone from community knows how to or have some kind of script to converting over to Palo. I know many other government convert to Palo FW and wondering how they convert their current customer signatures to Palo.If you know any script that useful, please let me know. I really appreciate for your support.Thanks",1,09-13-2016,01:10 PM
224,112437,Lucky,"Hi James,I hear you and understand issue you are facing, but as I am listening I also hear ""99 problems"" ðŸ™‚ Why?Because of the following facts:- snort signatures are yara-like, allowing more complex constructs than we can do with our signatures - therefore, not easily translatable or they easily loose their value when translated. For example, some signature might be looking for specific bytes found at unusually high offset; translating those to PAN rules cannot be automated as you cannot specify offset in bytes - you need to figure out where is it according to the protocol type. With PAN-OS, you can look for pattern match in DNS request header or DNS request body, but that cannot be specified as an offset from the start of the record.- plenty of ""other vendor"" signatures cover for things that are either not applicable to be covered by us (such as end-point issues) or might already be covered by us (we have plenty of AV and vulnerability signatures already)- ""tons"" of other signatures will never scale well: PAN-OS can take only ""so many"" custom regex patterns. More patterns in rules = less rules available; and also simpler rules (less regex) = lesser the chance to cover all (sub)variants of malware / vulnerability you are trying to coverI could probably come up with few more reasons where this will not end up well if being automated, but let's discuss how could you still resolve your issue... I believe that, considering aforementioned, the best approach would be for you to:- sort all the signatures you have according to severity,- weed out all signatures that aren't applicable/possible to be covered by firewalls (end-point issues such as Flash or PDF abuse, for example, or for signatures irrelevant for your infrastructure - you probably don't need signatures to protect Hummingbird print services)- when you end up with the list of what you really want covered, check in the Threat vault for CVE number or similar items to see if we are already covering that issue- review what is left and see how many can have signatures created in Palo Alto Networks firewalls (review documentation for threat signatures prior to starting to write them, so you know what you can do in the first place)- go with manual creation of signatures, starting from the top with severity ""critical"" and going down ""high"" and less....I would be surprised if you come up with more than few dozens that need converting, after ""review"" process suggested above.Of course, all this is not really answering your initial question but since answer is negative, I am just suggesting how I would approach it knowing what I know already ðŸ™‚ Sorry if I did not help much. I know there were talks on creating some semi-official supported script for converting this, but I think any potential author of such script faces challenges I named above and it would be very hard to create a script that would automatically check all the things I named above from ""any"" set of signatures. I know nothing has been published yet or nobody reported it's existance to TAC ðŸ™‚If you have a sub-set of signatures you could share for example, or can find a set of online signatures that mimic structure of signatures you have, let us know what they look like - there still might be a wild chance someone could see a pattern that could be scripted.Best regardsLuciano",1,09-14-2016,06:54 AM
225,112437,jamessong,"Thanks for thta information.How about adding MD5 hash (whole file) to Palo? I can see some of our hashes were already covered with built in Palo threatvault database but someone of them are not. Since Plao checking the file hash and compare its mailcious hash database, can I add my own hashes along with Palo predefined one? Is there any way to add our custom hashes to Plao? We have over 3000 hashes from previous IPS devices and it's not easy to check every one of them through threatvalut by manual process.Also, I would prefer not to hand-jam 400 snort signatures, but if we do, we would like to ensure that we are creating the new signatures properly so any help with conversion process and document to creating them would be appreciated.Thanks",2,09-19-2016,05:38 AM
226,88888,stephengun,What is the significance of the Hash?Hash256: 92fd1971f7ac512d096821a4bf8553bc13d1c478680999dd2e15400fe8973793Is there any relationship between the hash and the hex string you are testing for?,0,08-03-2016,10:14 PM
227,88888,goku123,The hash is mentioned to indicate which sample file was used for this example.The actual hex pattern in the signature is pulled from this binary's file body.,1,08-04-2016,08:55 AM
228,92514,aelatmani,"Hi Team,Can you please Help,feel free to ask if you need further information to identify the application.Regards,Abdelmounaim.",0,06-29-2016,09:58 AM
229,78952,cole,Good afternoon!I would try:scanner@[a-z]+\.domain\.comThis operates under the assumption that the child domain under domain.com consists of any number of the characters a-z.,0,06-01-2016,11:03 AM
230,78952,clewis1,Thanksrcole. I will give this a shot.,0,06-02-2016,07:25 AM
231,78952,clewis1,Unfortunately this signature did not work either.,0,06-02-2016,07:57 AM
232,78952,cole,"Hi clewis.I tested this signature in a lab with every variant of the domain you provided, and it triggered in each instance.Do you have a packet capture of the offending traffic?",0,06-02-2016,08:02 AM
233,78952,jambulo,I've been using this method for a while successfully...,0,06-08-2016,01:32 PM
234,78952,clewis1,I think I may be having an issue with decryption which may be casuing the issue. Just getting back around to looking at this one,0,06-15-2016,03:56 AM
235,78223,cole,"Good morning.My skillset is more around writing threat signatures (vulnerability and anti-spyware) rather than application signatures. However, if you provide a packet capture of some sample traffic you'd like to identify, this would likely be helpful, as many folks with varying skillsets frequent this forum. In order to test any of our ideas, having a packet captureof some sample traffic to replay in our lab environments would help to lead towards resolution.Is this possible?",0,05-17-2016,07:35 AM
236,78223,RepartoSistemi,"Yes it's possible, but I cannot attach the pcap file on my post.Perhaps a account limitation ?",0,05-17-2016,07:47 AM
237,78223,RepartoSistemi,"Ok bypass the limitation-Download this file.-Rename it to download.rar-Exctract two file (a unusefull jpg, and the dump file)The dump it's take from my Desktop (192.168.3.117) when jabber login to remote server (192.168.32.40)I send only the first transaction packet because inside the other packet I have in cleartext some reserved information.RegardsMax",0,05-17-2016,08:02 AM
238,78223,cole,"Thank you. That was a creative work around.One thing I've noticed is that the data pattern you are matching on is not present in the packet capture (or the excerpt from your initial post).Your pattern is:\x 55 43 50 72 6f 76 69 64 65 72 20 31 2e 30 \xHowever, the pattern in the packet capture and your excerpt is as follows:\x 55 43 50 72 6f 76 69 64 65 72 00 31 2e 30 \xNote that the 11th byte in your pattern is 20 (a space). The actual byte is a null byte (00).This may be a good place to start troubleshooting, if I have not overlooked anything.Respectfully,- rcole",0,05-17-2016,08:55 AM
239,78223,RepartoSistemi,"Ok RCole, I went in deep.After change the signature Palo Alto recognize logoff process asCisco Jabber (cti_cisco) application, but for the login process the result is ""insufficent-data"".Summary of example transaction:CISCO Jabber logoff => tcp.src 51084 tcp.dst 2748CISCO Jabber login => tcp.src 51351 tcp.dst 2748thake a look of this picture:And you know something even stranger?Take a look on the logoff/login process from the following tcpdump:On the logoff process we dont have any byte like our singature, and this is RECOGNISED ascti_cisco, instead on the login process we have some byte equal the singature, and this is NOTrecognized, it's insufficend-data.?????????Crazy!I get hold of the wrong end of the stick ?",0,05-19-2016,03:37 AM
240,78223,cole,Good morning! ðŸ™‚Would it be possible for you to export and attach the signature you've created so far so I can inspect it?,0,05-19-2016,08:23 AM
241,78223,RepartoSistemi,I try combination of:-both CONDITION in OR or in AND-SCOPE as Transaction or Session-Context Unknown-req-tcp-payload or telnet-req-client-data-Ordered Condition Match flagged or not flagged.,0,05-19-2016,08:29 AM
242,78223,cole,"Thank you for the complete packet capture! However, what I'm hoping for is the actual signature you've written. Can you export it from the firewall and upload it here? Additionally, .RAR and .PCAP formats should no longer require you to obfuscate them to upload.",0,05-19-2016,10:56 AM
243,78223,RepartoSistemi,"Sorry I had atteched a worg file, this is the current signatures xml.",0,05-20-2016,12:22 AM
244,78524,cole,"Good afternoon.For requests of this nature, please try to provide a packet capture if it is possible, highlighting the traffic you wish to create a signature on. It will greatly improve our ability to help you.It sounds like you want to trigger off something specific in SMB traffic, though based on your post above I'm not 100% certain what the actual offending traffic is. Would you mind elaborating slightly?As far as SMB based signatures go, we currently have one context for SMB, which is ""ms-ds-smb-req-share-name"" detailed on page 27 of the creating custom signatures document referenced in the sticky of this forum.Leveraging ""unknown-req-tcp-payload"" will not function as the traffic you reference will likely be caught by the SMB decoder. This would mean a custom signature is not possible with our current engine. ""Unknown-req-tcp-payload"" is for applications identified as ""unknown-tcp"" only, meaning we have no decoder for them.",0,05-23-2016,01:22 PM
245,78524,JuanB,"rcole, thanks for your answare. What im actually traying to do is capture in a pcap file every try of ntlm auth from a desktop machine with the hostname ""jbonaldo"". I attached you a pcap file with the capture and here it is a screenshot of what information im traying use to trigger my custom signature (and than, when the signature triggers capture this fail login).In the pcap file (row 10) you can see that the hostname is actually in the package sended to the server so, in teory, we can see this information with the palo alto and trigger the custome signature and then, capture the traffic.",0,05-23-2016,01:30 PM
246,78524,cole,"Juan:Thank you for the packet capture.I can confirm that we currently do not have a context available in the custom signature engine for the SMB hostname. If this is something you'd like to have added, you should reach out to your account team representative and file a feature request for inclusion in a future version.",0,05-23-2016,01:35 PM
247,78524,JuanB,"OK, Cole thanks for your help.BTW, do you know if there is any way to do what i need with the current PANOS?THanks in advance.",0,05-23-2016,01:39 PM
248,78524,cole,"Juan:As far as I am aware,no. This is due to the fact that we don't have a context for SMB hostname publicly available to customers to write signatures on, and would require a feature request be filed.",0,05-23-2016,01:43 PM
249,78524,JuanB,"Ok, Again, thanks for your help.",0,05-23-2016,01:46 PM
250,78524,cole,"Juan:No problem, sir. Thank you for your patience and for providing the data you did.",0,05-23-2016,01:47 PM
251,78351,Lucky,"Hi Zaki,there is no such set application or script that could help you with this. Depending how easy your list might be to implement, you could take a look at creating few signatures by hand, committing, exporting that saved configuration, and than writing your own script to insert the rest of the signatures following example of the first few ones imported manually. Once you are done, try importing this back into the firewall.Other than that, I am not sure if there is other automated ways - you could look into using API as well, probably.RegardsLuciano",0,05-19-2016,04:02 AM
252,78351,siganteng,"Hi Lucky,Interesting idea, i'll give it a try.Thanks",0,05-22-2016,08:08 PM
253,74746,cole,"Hello, ttanzi!According to page 38 of the creating custom signature document, case sensitivity will depend on the context you are pattern matching within, with some innately being case sensitive, and others not. requiring you define potential patterns of varying case manually.Reference:https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5...",0,03-15-2016,11:38 AM
254,74746,bpappas,Ignoring case sensistivity in pattern matching is not currently inPAN-OS (as of April 2016).-Benjamin,0,04-11-2016,10:45 AM
255,74853,abjain,Which context are you using. Please try using the http-req-params,2,03-16-2016,11:44 PM
256,74853,cole,"Good morning, jpeters.As abjain stated, http-req-uri-path and http-req-params contain some distinctions that will help you match in this case.See page 24 on this document:https://live.paloaltonetworks.com/t5/Documentation-Articles/Creating-Custom-Threat-Signatures/ta-p/5...",0,03-17-2016,03:51 AM
257,74254,cole,"Good morning, Passepartout.I'll do my best to provide some opinion on the above:\x begins a hex pattern match instead of literal string matching, and \x ends a hex pattern match, returning to literal string matching. (REF: Page 11, Custom Sig creation document in our sticky).My interpretation of what you want your signature to look for is ""2b(any number of 2d)2b"" which would look like:\x2b\x(\x2d\x)*\x2b\xHowever, this is not a valid pattern match for PAN-OS due to limitations described in the custom signature creation document on page 39; there is no static seven byte pattern, and two DFAs are juxtapositioned with one another.To illustrate what is required, I embedded your pattern in a default Apache configuration index.html, and generated a signature to look for it, with the pattern:\x2b 2d 2d 2d 2d 2d 2d 2d\x(\x2d\x)*\x2b\xmatching against the context ""File-html-body""This won't match anything with less than seven ""2d"" consecutively, but we need a static seven byte anchor to match on PAN-OS.See attached. I've validated the signature resets on detection. Please note this is just to illustrate what is possible, not for use. ðŸ™‚",1,03-07-2016,04:44 AM
258,74254,assepartout,"I don't know if we talk of the same things, but my string in ASCII char is:+-------------------------------------------------â€‹----------------------+ and the same string inHex char is: 2b 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2b",0,03-15-2016,07:11 AM
259,74173,cole,"Good evening, apike!I understand what you are requesting; however, given the current custom signature contexts available within PAN-OS, I am not certain if it is possible. I do not see any exposed POP3 contexts in our custom signature engine, meaning writing signatures for them is likely not possible.The contexts unknown-req-tcp-payload andcontext unknown-rsp-tcp-payload are for applications not successfully identified by the PAN-OS device (IE: application unknown-tcp);since the traffic you are trying to trigger off of is nested within a properly interpretted application (POP3), this signature will not trigger.The short version of my response is that I am uncertain if what you are trying to do via custom signature is possible; if it is, I do not know of a way to do it.",0,03-04-2016,12:56 PM
260,74173,Lucky,"Hi apike, welcome to community forums.I am not completely sure but I am thinking this might help: you need to work around of Rick's comment because he is right; why don't you try creating custom app ""myPOP3"" and define it for port tcp/110; thus you will override built-in decoder for pop3 because custom apps should kick in first and disable further lookup therefore chance exists your vuln sigs will trigger now?Or just create a custom app for your condition (perhaps in the whole session) and block that app. You have an explanation here how to create signatures for the session (part of base signature creation).Can you try and let us know what was your mileage?Best regardsLuciano",2,03-04-2016,08:35 PM
261,74173,apike,"I need help with the Regex according to my regex ""user ([A-Z a-z 0-9._\ \@]{0,100})"" this is vaild but not according to PANOSany thoughts?",0,03-06-2016,10:41 AM
262,74173,Lucky,"Hi,For what it's worth, I think your signature is mostly valid but it has some extra spaces and it also should probably escape brackets, I am not completely sure what are you trying to match, do you need brackets or not? Anyways, that is regex-wise; for PAN-OS you are failing to meet another requirement: Problem you are seeing is that for any custom signature, you have to have at least 7 bytes of fixed string that must be fixed; so no regex can be used WITHIN those 7 characters / bytes. You can use regex together with that anchor, but you must have a 7-byte anchor.I really don't have any pop3 service running or configurable to test this with, but there MUST be some string in email header that you can grab for this? (I still am not sure if my proposal works as I can't test it)What I would try - I would set:1. custom but simple application for pop3, as explained, just defining tcp/110,2. simple vulnerability signature catching onto fixed string, something like ""subject"",3. make an exception in all existing vuln profiles for this signature (you don't want it catching everything and anything before you test it!),4. create new vuln profile (that does not have this in exception),5. create new security policy applying only to sender/receiver of email, using custom app, using vulnerability protection profile from step 4 (only one that does not have new vuln profile in exception list)This way, you will start with very simple signature and work out if this works at all, if it does, than you can perhaps share with us how your headers usually look so maybe we can together find some 7-byte string that would work better.Best regards,Luciano",1,03-08-2016,11:03 AM
263,74173,apike,"Hi Luciano,We are targetting users sign-on failed auth message unfortunatly there is nothing more then the user command and the perameter the attacker uses. I don't need the brakets notice they did not make a diffrence if there in or not.https://www.ietf.org/rfc/rfc1939.txt (page 12-13) This is due to an attack we have seen and the last one was ~50K user attempts the bot never went to Pass command which would have trigger the failed login attempt. I have asked PA to step in at this point to develop some kind of recon signature for this type of attack/recon. hopefully they will come up with something. Thanks for your help!",0,03-08-2016,03:14 PM
264,74173,Lucky,"Hi,just to let you know - I checked, my idea with custom app won't work - it will not override settings of the default decoder. Scratch that and talk to PAN SE or TAC.Best regardsLuciano",0,03-09-2016,11:21 AM
265,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
266,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
267,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
268,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
269,73523,Lucky,"Hi Yarianto,I think from aspect of device OS and custom signatures you could probably craft something that would work for that purpose... you would match dns-req-section with regex pattern, but I am not sure where to start with this signature - you can ask them to give you regex of what they want to block and than test it as custom signature. I am not sure this would be my first approach for problem as you describe it, but I guess it could work, why not. What is their actual complaint, can't it be resolved on the DNS server itself?Here is manual for custom signatures that explains dns-req-section. Note that at the end of the document you have reference to PAN-OS regex characters - it is a subset of what you would expect and there are no greedy expressions.Best regardsLuciano",0,02-26-2016,01:33 PM
270,73045,cole,"Good morning, mgentile!You are correct in your analysis of the DNS response contexts being difficult to identify static patterns on; this is a challenge I've faced myself writing custom signatures where what I am looking for is shorter than our static byte length restriction. This is a current limit of the pattern matching capabilities in the custom signature engine, and as such, signatures requiring this type of evaluation require a decoder based signature (which is something our engineers would write.)The good news is that we released a signature in an emergency content (560) in the early hours this morning that protects from exploitation of this vulnerability under threat ID 38898.Additionally, as a result of your inquiry, I will investigate whether or not a context is possible for DNS request/response lengths, outside of a pattern-match (Meaning, contexts available for mathematical evaluations, like equal to, greater than, less than.)",3,02-18-2016,07:03 AM
271,73045,mgentile,"Thank you for the quick response! That is great news that there is a signature ready for install. Our vuln. mgmt team will breathe a sigh of relief ðŸ™‚I also checked the greater than/less than operators, but there were only two, very specific contexts for DNS available with those operators selected. They did not lend themselves to evaluating Answers for A records.",0,02-18-2016,07:10 AM
272,71971,cole,"Good morning!I usually work with custom threat signatures so I'm less familiar with the intricacies of custom application signatures.However, I have a few pointers to try and help!- There appears to be no space between Referer: and http. In most HTTP request headers, I see whitespace between the referer and it's contents, ie:Referer: http://uquest\.u-quest\.net- There is an unescaped special character in your pattern ""-"". According to page 37 of the Creating Custom Signatures document, ""-"" should be escaped with ""\-"" as it is a special character used for range expressions.In addition to the two above points, when trying to troubleshoot a signature, I usually try to start from the most basic form of the signature to identify where in the process the signature is not working. In this case, removing the GET qualifier to test just that the pattern matching itself is functioning would be a good step to take in my opinion. Then, once the pattern match is working, add the qualifier back.I hope this helps.",4,02-02-2016,04:38 AM
273,71971,KiCheon.Lee,@rcoleThanks a lot.Your advice is so helpful to me.,1,02-10-2016,06:27 PM
274,69551,kalakai,"FYI, content release 547 which was released today (12/23/2015) contains dections for this vulnerability. ID 38640 & 38638.",1,12-23-2015,01:14 PM
275,68977,cole,"Bkluth:This forum is for custom signature creation; for official content requests for PAN supported content coverage, please open a support case through the traditional process and provide all data gathered.If you're interested in a custom signature creation for this type of traffic, you can provide it here.",0,12-03-2015,10:51 AM
276,68977,bkluth,"Ok. Thank you for the clarification, although I cannot select a device to receive support for after selecting, ""new case."" There isn't a streamlined way to submit new threats? That's odd.",0,12-03-2015,11:32 AM
277,68977,cole,"Bkluth:The current method for reporting new threats and missed detection is to have a support case opened and ask to work with a threat specialist, where we will triage the issue and work with our research and development team to assist you in every way possible to close any gaps in coverage, provided that actionable data is available.There are automated methods for submitting URL recategorization for malware sites, but currently working with the threat speciailist division of the support team designed to assist you is the most effectiveavenue.If you are having trouble creating a case,Support <Support@paloaltonetworks.com> can assist you with this process, as our CSR folks are very experienced at addressing support accessibility issues.",0,12-03-2015,11:36 AM
278,68977,HITSSEC,"bkluth,As a best practice we put all IP addresses hosting an exploit kit (Angler, Rig or Nuclear) on a dynamic blocklist we do this upon notification of the IPS log event. Looking at all traffic going to the site that is hosting the exploit kit sometimes shows other users going there. The Impact to them is not known as there is sometimes no IPS event, nofiles coming down and sometimes no other network behaviors. Our rationale is that there is nothing good at that IP address.Phil",0,12-03-2015,11:54 AM
279,68834,cole,"bkim:Given that the traffic is being classified as ""unknown-tcp,"" you may be able to write signatures to pick off at least one of the methods being used in this app, by inspecting unknown-req-tcp-payload for some specific strings indicative of HTTP traffic. (GET / HTTP/1.1, etc)However, the obvious quick and blunt solution would be, ""Don't allow unknown-tcp traffic"" to egress to the web, which appears to defeat this tool entirely. This is probably a better solution than writing custom signatures.",0,12-01-2015,06:33 AM
280,68834,HITSSEC,"Bkim;I agree with rcole. If the evasion technique creates an unknown applicationthen you should already have policies in place to deny unknown udp and tcp traffic. While a signature (if possible ) would work in this situation the more encompasing approach would be to block unknown apps as mentioned. If the traffic causes a url category of ""unknown"" to be generated then you should deal with that situation within yout URL filtering policy. Signatures are great for specific or unique traffic patterns when other methods can't address the problem / situation. Glad you thinking out of the box.Phil",0,12-01-2015,06:28 PM
281,68702,murphyj,,0,11-26-2015,05:53 AM
282,68702,Froning,"Hello murphj,The initial session setup is an h.225 connection on tcp/1720, which is where this value is found.Thanks,Will",0,11-26-2015,06:27 AM
283,68702,cole,"I've reviewed some of the documentation available, and I don't believe we have any exposed contexts to make signatures for h225/h323 traffic.I don't believe attempting to match this as unknown-req-tcp-payload will work given that the traffic is likely being interpreted by the correct decoder and isn't technically ""unknown.""A custom application may be possible; I have less experience here, but am willing to investigate when I return to the office on Monday.If you attach a full packet capture, I can toy around with it in my lab to see what is possible?",0,11-26-2015,08:25 AM
284,68702,Froning,"Hello rcole,Thanks for the reply.This sounds about right. The PAN totally sees it as an h.225 app, and so it makes sense that it's not ""unknown"".I didn't see a place to attach a file, so here's a link to dropbox:h225-fw.pcapIt's not sanitized, but there's nothing you can't find out from a scan...I tried setting up a custom app, but the signature options I saw werethe same. Hopefully, you'll have more success.Thanks,Will",0,11-26-2015,09:54 AM
285,68702,cole,"Froning:I've verified your findings, and you are correct; it appears the exposed decoder contexts for custom applications are pretty much identical to the ones used in custom vulnerability signature creation.I'm not certain that with the currently exposed contexts we would be able to write a custom signature/app to match this traffic; if a way exists, I'm not seeing it. Can the scan be blocked by it's originating IP with a security policy?",0,11-28-2015,06:59 AM
286,68702,Froning,"I'm not certain that with the currently exposed contexts we would be able to write a custom signature/app to match this traffic; if a way exists, I'm not seeing it. Can the scan be blocked by it's originating IP with a security policy?At this point we've seen 230+ unique IPs with 10-15 new ones each day, so unfortunately blocking based on source IP isn't going to work. I have the pattern identified, which meansI can put something together, but the PAN is supposed to make my life easy.I appreciate you looking into this for me. I asked my partner support team to escalate the ticket to PAN, so hopefully we get something from them.Thanks,Will",0,11-28-2015,08:33 AM
287,68276,cole,"Hello, murphyj!I would expect your first example to satisfy this requirement.Operator: Pattern-MatchContext: http-req-host-headerPattern: 111\.2\.3\.4Qualifer: req-hdr-typeValue: HOSTHowever, in testing in my lab, I see that my expectations are not met, and as you said, it does not function.I've whittled the issue down to being something to do with the req-hdr-type qualifier you have specified. If you remove the qualifier, and simply do the below, it should function.Operator: Pattern-MatchContext: http-req-host-headerPattern: 111\.2\.3\.4As to why the qualifier doesn't work, great question! I'll address that on our backend and see if I can find something. I do find it odd that you can add a qualifier for req-hdr-type as ""HOST"" even when the context is already set to ""http-req-host-header,"" since the breadth of that entire context is simply just the Host value.Thanks for participating! ðŸ™‚",1,11-17-2015,11:04 AM
288,68276,HITSSEC,"Here is a signature that works:Operator: Pattern-MatchContext: http-req-host-headerPattern: 111\.2\.3\.4Qualifer: http-methodValue:GETWe have been using it for awhile. We set the action as reset-both. Can always use an exception response of block-IP if you are getting too many of them or if the originator has bad intentions.Hope this helps,Phil",1,11-17-2015,04:08 PM
289,68276,murphyj,"When I tried it with the Get it still did not work. There might be something with the version I'm running. I just test it on 6.1.3, when you have your setup is it for 1 ip address or a range? If its for a range how are you handling the last octet? ",0,11-18-2015,07:29 AM
290,68276,murphyj,That did work for me. Thank you.,1,11-18-2015,07:31 AM
291,68276,HITSSEC,If you want the entire class C address space you could have a three patterns:111\.2\.3\..  covers0-9and111\.2\.3\...  covers 10-99and111\.2\.3\.... covers 100-255the trailing period is a wildcardAlternatively you can have a pattern for each IP address.,2,11-18-2015,08:49 AM
292,68276,murphyj,,0,11-18-2015,09:19 AM
293,66860,HITSSEC,"Rcole,Here is an expanded version of the NMap signature. We noticed an additional web requests associated with the NMap tool and have included it in our signature. Below is what we have added as an ""or condition"" string:Operator = pattern-matchContext = http-req-uri-pathValue = /\.git/HEADThanks,Phil",1,11-30-2015,07:37 AM
294,66860,mdyragos,"Team - need some help here. Trying to create a custom filter that will allow us to detect TLS 1.0 negotiations and block them at the firewall. Here's the summary info:Justification: TLS needs to be blocked at the perimeter as a interim solution until TLS can be disabled on each server. This is to meet requirements of PCI.Research:Sample PCAP screen capture was found here.Testing:We have tried to do the following:ssl-rsp-server-hello && ssl-req-client-helloPattern=""Version: TLS 1.0""Neither of them are working though. Any suggestions?",0,08-01-2016,03:59 PM
295,66860,Johnkarter123,hello,0,10-08-2018,10:26 PM
296,66860,Anjali,"Hi all,@allplease let me know how can i add the below commands to Panos ansible-playbook to get output just like ios deviceset cli pager offset cli config-output-formatset configureshow,,, Below is output of my playbook. I want this in each line:{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 04:22:03 2021', 'uptime': '34 days, 4:24:47', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}{'response': {'@status': 'success', 'result': {'system': {'hostname': 'PA-VM', 'ip-address': '10.10.10.200', 'public-ip-address': 'unknown', 'netmask': '255.255.255.0', 'default-gateway': '10.10.10.254', 'is-dhcp': 'no', 'ipv6-address': 'unknown', 'ipv6-link-local-address': 'fe80::250:56ff:fe9e:b9cf/64', 'ipv6-default-gateway': None, 'mac-address': '00:50:56:9e:b9:cf', 'time': 'Mon Apr 12 05:23:44 2021', 'uptime': '34 days, 5:26:28', 'devicename': 'PA-VM', 'family': 'vm', 'model': 'PA-VM', 'serial': 'unknown', 'vm-mac-base': 'BA:DB:EE:FB:AD:00', 'vm-mac-count': '255', 'vm-uuid': '421EB442-36E0-565E-1EEA-979DAA2D8C3E', 'vm-cpuid': 'ESX:54060500FFFBAB1F', 'vm-license': 'none', 'vm-mode': 'VMWare ESXi', 'cloud-mode': 'non-cloud', 'sw-version': '9.0.4', 'global-protect-client-package-version': '0.0.0', 'app-version': '8103-5197', 'app-release-date': None, 'av-version': '0', 'av-release-date': None, 'threat-version': '0', 'threat-release-date': None, 'wf-private-version': '0', 'wf-private-release-date': 'unknown', 'url-db': 'paloaltonetworks', 'wildfire-version': '0', 'wildfire-release-date': None, 'url-filtering-version': '0000.00.00.000', 'global-protect-datafile-version': 'unknown', 'global-protect-datafile-release-date': 'unknown', 'global-protect-clientless-vpn-version': '0', 'global-protect-clientless-vpn-release-date': None, 'logdb-version': '9.0.10', 'plugin_versions': {'entry': {'@name': 'vm_series', '@version': '1.0.6', 'pkginfo': 'vm_series-1.0.6'}}, 'platform-family': 'vm', 'vpn-disable-mode': 'off', 'multi-vsys': 'off', 'operational-mode': 'normal'}}}}",0,04-13-2021,01:51 AM
297,67282,cole,"Good afternoon, Viren!Given the nature of our custom signature engine, I cannot think of a way to design a signature to accomplish what you are looking for.However, what you are asking for may be possible with a Zone Protection profile under Reconnaissance Protection.Please see this article for reference:https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Block-an-IP-for-a-Specific-Period...Hope this helps!",1,10-26-2015,11:00 AM
298,67282,viren.parasram,"Hi, Thanks for your suggestion, I will look into that. What I've been trying is to set up strict vulneabilities av virus url profiles with default block and applying them to the policy. I have a request for enhancement to allow for block ip at the group level but in the mean time I've added ip block to some brute force matches to get the desired effect. Waiting to see if this works.THANKS, VIREN",0,10-27-2015,06:22 AM
299,67282,HITSSEC,"Viren,To use custom signatures you need to tirgger on a defined traffic patten based on the contexts you have available for our use when creating a signature. Since you want a honeypot trigger the challenge you would have is what traffic are you going to trigger on? Might I suggest you create a security rule for you honeynet and use a logging profile that can alert you via txt message or email immediately upon being triggered.Thought I would throw that out for your thoughts.regards,Phil",2,10-29-2015,05:17 PM
